const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/PortfolioTracker.1762524666384.DxF55mlU.js","assets/vendor-features.1762524666384.CzT6Gd7C.js","assets/vendor-core.1762524666384.B4_Mh2Lu.js","assets/trading-core.1762524666384.wxmslyL9.js","assets/trading-orders-wrapper.1762524666384.BJVHlmjF.js","assets/vendor-ui.1762524666384.xSx9zIXI.js","assets/trading-advanced-orders.1762524666384.DKpeWv1p.js","assets/chart-features.1762524666384.IgUxqEzq.js","assets/trading-feeds.1762524666384.C2tZP3D-.js","assets/vendor-crypto.1762524666384.TKZXbxVK.js","assets/AutoTradingSignals.1762524666384.CWJrOhB3.js","assets/SocialTrading.1762524666384.CSAPvZta.js","assets/MarketScanner.1762524666384.cWiuPvpm.js","assets/MarketSentiment.1762524666384.DbQHX1T-.js","assets/EconomicCalendar.1762524666384.BHIXT7uy.js","assets/TradeJournal.1762524666384.DU3mhCg2.js"])))=>i.map(i=>d[i]);
var Zo=Object.defineProperty;var sa=r=>{throw TypeError(r)};var Yo=(r,e,t)=>e in r?Zo(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var w=(r,e,t)=>Yo(r,typeof e!="symbol"?e+"":e,t),as=(r,e,t)=>e.has(r)||sa("Cannot "+t);var b=(r,e,t)=>(as(r,e,"read from private field"),t?t.call(r):e.get(r)),F=(r,e,t)=>e.has(r)?sa("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),k=(r,e,t,n)=>(as(r,e,"write to private field"),n?n.call(r,t):e.set(r,t),t),Z=(r,e,t)=>(as(r,e,"access private method"),t);var aa=(r,e,t,n)=>({set _(s){k(r,e,s,t)},get _(){return b(r,e,n)}});import{j as l}from"./vendor-features.1762524666384.CzT6Gd7C.js";import{r as T,L as si}from"./vendor-core.1762524666384.B4_Mh2Lu.js";import{T as Pt,X as Xo,s as qo,R as ec,t as tc,A as Bn,S as rc,d as Yt,u as ai,v as nc,w as sc,x as ia,G as ac,y as oa,M as ic,z as ii,Z as Yr,D as oi,r as oc,F as cc,H as lc,c as dc,I as fc,m as uc,K as hc,J as xc,_ as nr}from"./trading-orders-wrapper.1762524666384.BJVHlmjF.js";import{s as ee,f as zr,g as Qr,h as $r,i as Jr,E as Rn,j as We,B as Re,c as Mr,k as ps,u as W,C as pc,T as ci,a as li,b as Wr,L as xn,I as In,d as bc,M as gc,l as mc,m as is}from"./trading-core.1762524666384.wxmslyL9.js";import{D as yc,I as wc,S as Ac,b as Ot,d as Ec,M as Nc}from"./chart-features.1762524666384.IgUxqEzq.js";import{a as vc,N as Ic}from"./trading-feeds.1762524666384.C2tZP3D-.js";import{C as Cc}from"./vendor-crypto.1762524666384.TKZXbxVK.js";import{A as Pc,R as kc}from"./trading-advanced-orders.1762524666384.DKpeWv1p.js";const di=T.memo(()=>{const[r,e]=T.useState(!1),[t,n]=T.useState(!1);return T.useEffect(()=>{const s=()=>{n(window.scrollY>20)};return window.addEventListener("scroll",s),()=>window.removeEventListener("scroll",s)},[]),l.jsx("nav",{className:`fixed top-0 left-0 right-0 z-50 transition-all duration-500 ${t?"bg-card/80 backdrop-blur-2xl border-b border-primary/30 shadow-xl shadow-primary/10":"bg-transparent"}`,children:l.jsxs("div",{className:"mx-auto max-w-[1800px] px-4 sm:px-6 lg:px-8",children:[l.jsxs("div",{className:"flex h-20 items-center justify-between",children:[l.jsxs(si,{to:"/",className:"flex items-center gap-3 group",children:[l.jsxs("div",{className:"relative flex h-12 w-12 items-center justify-center rounded-2xl bg-gradient-to-br from-primary/20 to-primary/10 shadow-2xl shadow-primary/30 ring-2 ring-primary/30 backdrop-blur-xl transition-all duration-300 group-hover:ring-primary/60 group-hover:shadow-primary/50",children:[l.jsx(Pt,{className:"h-6 w-6 text-primary animate-pulse"}),l.jsx("div",{className:"absolute inset-0 rounded-2xl bg-gradient-to-br from-primary/0 to-primary/20 opacity-0 transition-opacity duration-300 group-hover:opacity-100"})]}),l.jsxs("div",{children:[l.jsx("h1",{className:"bg-gradient-to-r from-primary via-cyan-400 to-primary bg-clip-text text-2xl font-black tracking-tighter text-transparent drop-shadow-[0_0_20px_rgba(56,189,248,0.4)]",children:"KK TRADING"}),l.jsx("p",{className:"text-[10px] font-bold text-muted-foreground uppercase tracking-wider",children:"Trading Platform"})]})]}),l.jsx("button",{onClick:()=>e(!r),className:"md:hidden p-2 rounded-lg bg-primary/10 border border-primary/30 hover:bg-primary/20 transition-all duration-300",children:r?l.jsx(Xo,{className:"h-6 w-6 text-primary"}):l.jsx(qo,{className:"h-6 w-6 text-primary"})})]}),r&&l.jsx("div",{className:"md:hidden py-4 space-y-3 animate-fade-in"})]})})});di.displayName="Navbar";function Tc({exchange:r,symbol:e,source:t,symbols:n,onExchangeChange:s,onSymbolChange:a,onSourceChange:i,onRefresh:o}){const[c,d]=T.useState(null);return T.useEffect(()=>{ee.auth.getSession().then(({data:{session:u}})=>{d((u==null?void 0:u.user)??null)});const{data:{subscription:f}}=ee.auth.onAuthStateChange((u,h)=>{d((h==null?void 0:h.user)??null)});return()=>f.unsubscribe()},[]),l.jsxs("header",{className:"group relative flex flex-wrap items-center justify-between gap-5 overflow-hidden rounded-2xl border-2 border-primary/30 bg-gradient-to-br from-card via-card/80 to-card/60 p-6 shadow-2xl shadow-primary/20 backdrop-blur-2xl transition-all duration-500 hover:border-primary/40 hover:shadow-[0_0_60px_rgba(56,189,248,0.3)]",children:[l.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-primary/8 via-transparent to-accent/8 opacity-0 transition-opacity duration-700 group-hover:opacity-100"}),l.jsx("div",{className:"absolute -top-24 -left-24 w-48 h-48 bg-primary/10 rounded-full blur-3xl"}),l.jsx("div",{className:"absolute -bottom-24 -right-24 w-48 h-48 bg-accent/10 rounded-full blur-3xl"}),l.jsx("div",{className:"relative z-10",children:l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-2xl bg-gradient-to-br from-primary/20 to-primary/10 shadow-2xl shadow-primary/30 ring-2 ring-primary/30 backdrop-blur-xl",children:l.jsx("div",{className:"h-6 w-6 rounded-lg bg-gradient-to-br from-primary via-primary to-primary/60 animate-pulse shadow-lg shadow-primary/50"})}),l.jsxs("div",{children:[l.jsx("h1",{className:"bg-gradient-to-r from-primary via-cyan-400 to-primary bg-clip-text text-3xl font-black tracking-tighter text-transparent drop-shadow-[0_0_20px_rgba(56,189,248,0.4)]",children:"KK TRADING"}),l.jsx("p",{className:"text-xs font-bold text-muted-foreground uppercase tracking-wider",children:"Multi-Exchange Trading Platform"})]})]})}),l.jsxs("div",{className:"relative z-10 flex flex-wrap items-center gap-3",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("label",{className:"text-sm text-muted-foreground",children:"Exchange:"}),l.jsxs(zr,{value:r,onValueChange:f=>s(f),children:[l.jsx(Qr,{className:"w-[140px]",children:l.jsx($r,{})}),l.jsx(Jr,{children:Object.keys(Rn).map(f=>l.jsx(We,{value:f,children:Rn[f].name},f))})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("label",{className:"text-sm text-muted-foreground",children:"Symbol:"}),l.jsxs(zr,{value:e,onValueChange:a,children:[l.jsx(Qr,{className:"w-[140px]",children:l.jsx($r,{})}),l.jsx(Jr,{children:n.map(f=>l.jsx(We,{value:f,children:f.toUpperCase()},f))})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("label",{className:"text-sm text-muted-foreground",children:"Source:"}),l.jsxs(zr,{value:t,onValueChange:f=>i(f),children:[l.jsx(Qr,{className:"w-[100px]",children:l.jsx($r,{})}),l.jsxs(Jr,{children:[l.jsx(We,{value:"ws",children:"WebSocket"}),l.jsx(We,{value:"rest",children:"REST"})]})]})]}),l.jsx(Re,{onClick:o,size:"sm",variant:"outline",children:l.jsx(ec,{className:"h-4 w-4"})}),!c&&l.jsx(si,{to:"/auth",children:l.jsxs(Re,{size:"sm",className:"bg-gradient-to-r from-primary to-chart-2",children:[l.jsx(tc,{className:"mr-2 h-4 w-4"}),"Sign In"]})})]})]})}const Sc="wss://stream.binance.com:9443/ws",Oc="https://api.binance.com/api/v3",Bc=r=>{const[e,t]=T.useState(new Map),[n,s]=T.useState(!0),a=T.useCallback(async()=>{try{s(!0);const o=r.map(async f=>{const u=f.replace("/","").toUpperCase(),h=await fetch(`${Oc}/ticker/24hr?symbol=${u}USDT`);if(!h.ok)return{symbol:f,price:Math.random()*7e4+1e4,change24h:(Math.random()-.5)*10,volume:Math.random()*1e9,high24h:Math.random()*75e3+15e3,low24h:Math.random()*65e3+5e3};const y=await h.json();return{symbol:f,price:parseFloat(y.lastPrice),change24h:parseFloat(y.priceChangePercent),volume:parseFloat(y.volume),high24h:parseFloat(y.highPrice),low24h:parseFloat(y.lowPrice)}}),c=await Promise.all(o),d=new Map(c.map(f=>[f.symbol,f]));t(d)}catch(o){console.error("Error fetching initial prices:",o);const c=new Map(r.map(d=>[d,{symbol:d,price:Math.random()*7e4+1e4,change24h:(Math.random()-.5)*10,volume:Math.random()*1e9,high24h:Math.random()*75e3+15e3,low24h:Math.random()*65e3+5e3}]));t(c)}finally{s(!1)}},[r]);T.useEffect(()=>{a();const o=r.map(u=>`${u.replace("/","").toLowerCase()}usdt@ticker`),c=`${Sc}/${o.join("/")}`;let d;try{d=new WebSocket(c),d.onmessage=u=>{try{const h=JSON.parse(u.data);(Array.isArray(h)?h:[h]).forEach(x=>{if(x.s){const p=x.s.replace("USDT","").toUpperCase();t(g=>{const m=new Map(g);return m.set(p,{symbol:p,price:parseFloat(x.c),change24h:parseFloat(x.P),volume:parseFloat(x.v),high24h:parseFloat(x.h),low24h:parseFloat(x.l)}),m})}})}catch(h){console.error("WebSocket message error:",h)}},d.onerror=()=>{console.error("WebSocket error, using polling fallback")}}catch(u){console.error("WebSocket connection error:",u)}const f=setInterval(()=>{a()},1e4);return()=>{d&&d.close(),clearInterval(f)}},[r,a]);const i=T.useCallback(o=>e.get(o),[e]);return{prices:e,loading:n,getPrice:i}};function Rc({symbols:r,activeSymbol:e,onSymbolClick:t}){const[n,s]=T.useState([]),[a,i]=T.useState(!1),[o,c]=T.useState(new Set),{prices:d,getPrice:f}=Bc(r);T.useEffect(()=>{u()},[]);const u=async()=>{try{const{data:{user:x}}=await ee.auth.getUser();if(!x)return;const{data:p,error:g}=await ee.from("user_watchlist").select("symbol, is_favorite").eq("user_id",x.id);if(g)throw g;const m=new Set((p==null?void 0:p.filter(A=>A.is_favorite).map(A=>A.symbol))||[]);c(m)}catch(x){console.error("Error fetching watchlist:",x)}};T.useEffect(()=>{const x=r.map(p=>{const g=f(p);return{symbol:p,price:(g==null?void 0:g.price)||0,change24h:(g==null?void 0:g.change24h)||0,volume:(g==null?void 0:g.volume)||0,isFavorite:o.has(p)}});s(x)},[r,d,o,f]);const h=async(x,p)=>{p.stopPropagation();try{const{data:{user:g}}=await ee.auth.getUser();if(!g){W.error("Please login to add favorites");return}if(o.has(x)){const{error:A}=await ee.from("user_watchlist").delete().eq("user_id",g.id).eq("symbol",x);if(A)throw A;c(N=>{const I=new Set(N);return I.delete(x),I}),W.success(`${x} removed from favorites`)}else{const{error:A}=await ee.from("user_watchlist").insert({user_id:g.id,symbol:x,is_favorite:!0});if(A)throw A;c(N=>new Set(N).add(x)),W.success(`${x} added to favorites`)}}catch(g){console.error("Error toggling favorite:",g),W.error("Failed to update favorites")}},y=a?n:n.slice(0,6);return l.jsxs("div",{className:"space-y-3 animate-fade-in",children:[l.jsxs("div",{className:"relative overflow-hidden rounded-xl bg-gradient-to-r from-primary/10 via-cyan-500/10 to-primary/10 border border-primary/20 p-3",children:[l.jsx("div",{className:"absolute inset-0 bg-grid-pattern opacity-5"}),l.jsxs("div",{className:"relative z-10 flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"p-1.5 rounded-lg bg-primary/20 backdrop-blur-sm",children:l.jsx(Bn,{className:"w-4 h-4 text-primary animate-pulse"})}),l.jsx("h3",{className:"text-sm font-bold tracking-wide text-foreground",children:"Elite Watchlist"})]}),l.jsx(Re,{variant:"ghost",size:"sm",className:"h-7 gap-1 text-xs hover:bg-primary/20",onClick:()=>i(!a),children:a?"Show Less":`+${n.length-6}`})]})]}),l.jsx("div",{className:"grid grid-cols-1 gap-2",children:y.map(x=>{const p=x.symbol===e,g=x.change24h>=0;return l.jsxs("div",{onClick:()=>t(x.symbol),className:Mr("relative overflow-hidden rounded-xl border p-4 transition-all duration-300 cursor-pointer group",p?"bg-gradient-to-r from-primary/20 via-cyan-500/20 to-primary/20 border-primary/50 shadow-xl shadow-primary/30 scale-[1.02]":"border-border/40 bg-card/20 hover:border-primary/40 hover:bg-card/40 hover:scale-[1.01]"),children:[p&&l.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-white/10 via-transparent to-white/5 animate-shimmer"}),l.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-gradient-to-br from-primary/10 to-transparent rounded-full blur-2xl"}),l.jsxs("div",{className:"relative z-10 space-y-2",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"p-1 rounded bg-primary/10",children:l.jsx("span",{className:"font-mono text-xs font-bold text-foreground",children:x.symbol.toUpperCase()})}),l.jsx(rc,{className:Mr("w-3.5 h-3.5 cursor-pointer transition-all duration-300",x.isFavorite?"fill-yellow-500 text-yellow-500 scale-110":"text-muted-foreground hover:text-yellow-500 hover:scale-110"),onClick:m=>h(x.symbol,m)})]}),l.jsxs(ps,{variant:g?"default":"destructive",className:Mr("text-[10px] font-bold flex items-center gap-1",g?"bg-success/20 text-success border-success/30":"bg-destructive/20 text-destructive border-destructive/30"),children:[g?l.jsx(Pt,{className:"w-3 h-3"}):l.jsx(Yt,{className:"w-3 h-3"}),g?"+":"",x.change24h.toFixed(2),"%"]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("div",{className:"flex items-baseline gap-2",children:l.jsxs("span",{className:"text-2xl font-bold text-foreground tracking-tight",children:["$",x.price.toFixed(2)]})}),l.jsxs("div",{className:"flex items-center justify-between text-xs",children:[l.jsxs("span",{className:"text-muted-foreground flex items-center gap-1",children:[l.jsx(Bn,{className:"w-3 h-3"}),"Vol: $",(x.volume/1e6).toFixed(1),"M"]}),x.isFavorite&&l.jsx(ps,{variant:"outline",className:"text-[9px] bg-yellow-500/10 text-yellow-500 border-yellow-500/30",children:"Favorite"})]})]}),l.jsx("div",{className:"h-10 opacity-0 group-hover:opacity-100 transition-all duration-300 mt-2",children:l.jsx("div",{className:Mr("h-full rounded-lg bg-gradient-to-r relative overflow-hidden",g?"from-success/10 via-success/20 to-success/10":"from-destructive/10 via-destructive/20 to-destructive/10"),children:l.jsx("div",{className:"absolute inset-0 flex items-end justify-around p-1",children:[...Array(12)].map((m,A)=>l.jsx("div",{className:Mr("w-1 rounded-full",g?"bg-success/40":"bg-destructive/40"),style:{height:`${Math.random()*100}%`}},A))})})})]})]},x.symbol)})})]})}const Uc=["1m","5m","15m","1h","4h","1d","1w"],Fc=({selected:r,onChange:e})=>l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(ai,{className:"w-4 h-4 text-primary"}),l.jsx("h3",{className:"text-sm font-semibold text-foreground uppercase tracking-wide",children:"Timeframe"})]}),l.jsx("div",{className:"grid grid-cols-4 gap-2",children:Uc.map(t=>l.jsx(Re,{variant:r===t?"default":"outline",size:"sm",onClick:()=>e(t),className:`h-8 transition-all ${r===t?"shadow-lg shadow-primary/20":"hover:border-primary/30"}`,children:t},t))})]}),Dc=()=>{const[r,e]=T.useState("single"),t=[{id:"single",icon:sc,label:"Single",cols:1},{id:"dual-vertical",icon:ia,label:"Dual V",cols:2},{id:"dual-horizontal",icon:ia,label:"Dual H",cols:1,rotate:!0},{id:"quad",icon:ac,label:"Quad",cols:2}],n=s=>{var a;e(s),W.success("Layout changed",{description:(a=t.find(i=>i.id===s))==null?void 0:a.label})};return l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(nc,{className:"w-4 h-4 text-chart-4"}),l.jsx("h3",{className:"text-sm font-semibold text-foreground uppercase tracking-wide",children:"Chart Layout"})]}),l.jsx("div",{className:"grid grid-cols-4 gap-2",children:t.map(s=>l.jsxs(Re,{variant:r===s.id?"default":"outline",size:"sm",onClick:()=>n(s.id),className:`flex-col h-auto py-3 gap-1 transition-all ${r===s.id?"ring-2 ring-primary":""}`,children:[l.jsx(s.icon,{className:`w-4 h-4 ${s.rotate?"rotate-90":""} ${r===s.id?"text-primary-foreground":"text-chart-4"}`}),l.jsx("span",{className:"text-[10px]",children:s.label})]},s.id))}),l.jsxs("div",{className:"p-4 rounded-lg bg-muted/20 border border-border",children:[l.jsx("div",{className:"text-xs text-muted-foreground mb-3 text-center",children:"Preview"}),r==="single"&&l.jsx("div",{className:"aspect-video rounded border-2 border-dashed border-primary/30 bg-primary/5 flex items-center justify-center",children:l.jsx("span",{className:"text-xs text-muted-foreground",children:"Main Chart"})}),r==="dual-vertical"&&l.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[l.jsx("div",{className:"aspect-video rounded border-2 border-dashed border-primary/30 bg-primary/5 flex items-center justify-center",children:l.jsx("span",{className:"text-xs text-muted-foreground",children:"Chart 1"})}),l.jsx("div",{className:"aspect-video rounded border-2 border-dashed border-chart-4/30 bg-chart-4/5 flex items-center justify-center",children:l.jsx("span",{className:"text-xs text-muted-foreground",children:"Chart 2"})})]}),r==="dual-horizontal"&&l.jsxs("div",{className:"grid grid-rows-2 gap-2",children:[l.jsx("div",{className:"aspect-video rounded border-2 border-dashed border-primary/30 bg-primary/5 flex items-center justify-center",children:l.jsx("span",{className:"text-xs text-muted-foreground",children:"Chart 1"})}),l.jsx("div",{className:"aspect-video rounded border-2 border-dashed border-chart-4/30 bg-chart-4/5 flex items-center justify-center",children:l.jsx("span",{className:"text-xs text-muted-foreground",children:"Chart 2"})})]}),r==="quad"&&l.jsx("div",{className:"grid grid-cols-2 grid-rows-2 gap-2",children:[1,2,3,4].map(s=>l.jsx("div",{className:`aspect-video rounded border-2 border-dashed ${s===1?"border-primary/30 bg-primary/5":s===2?"border-chart-4/30 bg-chart-4/5":s===3?"border-chart-2/30 bg-chart-2/5":"border-chart-3/30 bg-chart-3/5"} flex items-center justify-center`,children:l.jsxs("span",{className:"text-[10px] text-muted-foreground",children:["Chart ",s]})},s))})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("div",{className:"text-xs font-semibold text-muted-foreground uppercase tracking-wide",children:"Chart Assignments"}),r!=="single"&&l.jsx("div",{className:"space-y-1",children:Array.from({length:r==="quad"?4:2}).map((s,a)=>l.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg bg-muted/30 border border-border text-xs",children:[l.jsxs("span",{className:"text-muted-foreground",children:["Chart ",a+1]}),l.jsxs("select",{className:"bg-background border border-border rounded px-2 py-1 text-foreground",children:[l.jsx("option",{children:"BTC/USDT"}),l.jsx("option",{children:"ETH/USDT"}),l.jsx("option",{children:"BNB/USDT"})]})]},a))})]})]})},Lc=({patterns:r})=>{if(r.length===0)return l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(oa,{className:"w-4 h-4 text-chart-2"}),l.jsx("h3",{className:"text-sm font-semibold text-foreground uppercase tracking-wide",children:"Patterns"})]}),l.jsx("div",{className:"text-sm text-muted-foreground p-3 rounded-lg bg-muted/20",children:"No patterns detected"})]});const e=n=>n==="bullish"?Pt:n==="bearish"?Yt:ic,t=n=>n==="bullish"?"text-success bg-success/10 border-success/20":n==="bearish"?"text-destructive bg-destructive/10 border-destructive/20":"text-muted-foreground bg-muted/20 border-muted/20";return l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(oa,{className:"w-4 h-4 text-chart-2"}),l.jsx("h3",{className:"text-sm font-semibold text-foreground uppercase tracking-wide",children:"Patterns"})]}),l.jsx("div",{className:"space-y-2",children:r.slice(0,5).map((n,s)=>{const a=e(n.signal);return l.jsx("div",{className:`p-3 rounded-lg border ${t(n.signal)} transition-all hover:scale-105`,children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(a,{className:"w-4 h-4 flex-shrink-0"}),l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-sm font-medium",children:n.name}),l.jsxs("span",{className:"text-[10px] px-2 py-0.5 rounded-full bg-background/50 uppercase",children:[(n.strength*100).toFixed(0),"%"]})]}),l.jsxs("div",{className:"text-xs text-muted-foreground mt-1 capitalize",children:[n.signal," signal"]})]})]})},s)})})]})};function Mc({candles:r,currentPrice:e,symbol:t}){var x,p;if(r.length===0)return l.jsx("div",{className:"grid grid-cols-2 gap-3",children:[1,2,3,4].map(g=>l.jsxs("div",{className:"glass-panel animate-pulse rounded-xl p-4",children:[l.jsx("div",{className:"h-4 w-20 rounded bg-muted/20"}),l.jsx("div",{className:"mt-2 h-6 w-16 rounded bg-muted/20"})]},g))});const n=r.slice(-1440),s=Math.max(...n.map(g=>g.y[1])),a=Math.min(...n.map(g=>g.y[2])),i=((x=n[0])==null?void 0:x.y[0])||e||0,o=e||((p=n[n.length-1])==null?void 0:p.y[3])||0,c=o-i,d=c/i*100,u=n.map(g=>(g.y[1]-g.y[2])*1e3).reduce((g,m)=>g+m,0),h=(s-a)/a*100,y=[{label:"24h Change",value:`${d>=0?"+":""}${d.toFixed(2)}%`,subValue:`${c>=0?"+":""}$${Math.abs(c).toFixed(2)}`,icon:d>=0?Pt:Yt,color:d>=0?"text-success":"text-destructive",bgColor:d>=0?"bg-success/10":"bg-destructive/10"},{label:"24h High",value:`$${s.toFixed(2)}`,subValue:`+${((s-o)/o*100).toFixed(2)}%`,icon:Pt,color:"text-primary",bgColor:"bg-primary/10"},{label:"24h Low",value:`$${a.toFixed(2)}`,subValue:`${((a-o)/o*100).toFixed(2)}%`,icon:Yt,color:"text-chart-4",bgColor:"bg-chart-4/10"},{label:"24h Volume",value:`${(u/1e6).toFixed(2)}M`,subValue:`${t.toUpperCase()}`,icon:ii,color:"text-chart-2",bgColor:"bg-chart-2/10"},{label:"Volatility",value:`${h.toFixed(2)}%`,subValue:"Price range",icon:Yr,color:"text-chart-5",bgColor:"bg-chart-5/10"},{label:"Market Cap",value:"—",subValue:"N/A",icon:oi,color:"text-muted-foreground",bgColor:"bg-muted/10"}];return l.jsxs("div",{className:"space-y-5",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"flex h-9 w-9 items-center justify-center rounded-xl bg-primary/15 ring-2 ring-primary/35 shadow-lg shadow-primary/20",children:l.jsx(Bn,{className:"h-5 w-5 text-primary animate-pulse"})}),l.jsxs("div",{children:[l.jsx("h4",{className:"text-sm font-black text-foreground uppercase tracking-wide",children:"Performance Matrix"}),l.jsx("p",{className:"text-[9px] text-muted-foreground font-mono",children:"Advanced market analytics"})]})]}),l.jsx("div",{className:"grid grid-cols-2 gap-4",children:y.map((g,m)=>{const A=g.icon;return l.jsxs("div",{className:"group relative overflow-hidden rounded-xl border-2 border-border/40 bg-gradient-to-br from-card to-card/70 p-4 backdrop-blur-xl transition-all duration-500 hover:scale-[1.03] hover:border-primary/40 hover:shadow-2xl hover:shadow-primary/10 animate-fade-in-up",style:{animationDelay:`${m*50}ms`},children:[l.jsx("div",{className:"absolute top-0 left-0 right-0 h-[1px] bg-gradient-to-r from-transparent via-primary/30 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),l.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-primary/3 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),l.jsxs("div",{className:"relative z-10 flex items-start justify-between",children:[l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("div",{className:"text-[10px] font-black text-muted-foreground uppercase tracking-wider mb-2",children:g.label}),l.jsx("div",{className:`font-mono text-xl font-black ${g.color} drop-shadow-[0_0_8px_rgba(56,189,248,0.3)] mb-1`,children:g.value}),l.jsx("div",{className:"text-[10px] text-muted-foreground font-mono font-bold",children:g.subValue})]}),l.jsx("div",{className:`flex h-11 w-11 items-center justify-center rounded-xl ${g.bgColor} ring-2 ring-${g.color.replace("text-","")}/30 shadow-lg`,children:l.jsx(A,{className:`h-5 w-5 ${g.color}`})})]})]},m)})})]})}const jc=({symbol:r,price:e})=>{const t=[{label:"Avg Trade",value:"$1,234.56",icon:ii,change:"+2.5%",positive:!0},{label:"Trades/min",value:"48",icon:ai,change:"+12%",positive:!0},{label:"Buy Pressure",value:"65%",icon:oc,change:"+5%",positive:!0},{label:"Activity",value:"High",icon:Yr,change:"Trending",positive:!0}];return l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"flex h-9 w-9 items-center justify-center rounded-xl bg-primary/15 ring-2 ring-primary/35 shadow-lg shadow-primary/20",children:l.jsx(Yr,{className:"w-5 h-5 text-primary animate-pulse"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-sm font-black text-foreground uppercase tracking-wide",children:"Quick Analytics"}),l.jsx("p",{className:"text-[9px] text-muted-foreground font-mono",children:"Real-time market metrics"})]})]}),l.jsx("div",{className:"grid grid-cols-2 gap-3",children:t.map((n,s)=>l.jsxs("div",{className:"relative overflow-hidden rounded-xl border-2 border-border/40 bg-gradient-to-br from-card to-card/70 p-4 backdrop-blur-xl transition-all duration-300 hover:scale-[1.05] hover:border-primary/40 hover:shadow-xl hover:shadow-primary/10 animate-fade-in",style:{animationDelay:`${s*50}ms`},children:[l.jsx("div",{className:"absolute top-0 left-0 right-0 h-[1px] bg-gradient-to-r from-transparent via-primary/30 to-transparent"}),l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-lg bg-primary/15 ring-2 ring-primary/30",children:l.jsx(n.icon,{className:"w-4 h-4 text-primary"})}),l.jsx("span",{className:`px-2 py-0.5 rounded-lg text-[9px] font-black uppercase tracking-wider ${n.positive?"bg-success/20 text-success ring-1 ring-success/40":"bg-destructive/20 text-destructive ring-1 ring-destructive/40"}`,children:n.change})]}),l.jsx("div",{className:"text-[10px] text-muted-foreground font-bold uppercase tracking-wider mb-1.5",children:n.label}),l.jsx("div",{className:"text-lg font-black text-foreground",children:n.value})]},s))})]})},fi=T.memo(({symbols:r,activeSymbol:e,timeframe:t,indicatorSettings:n,detectedPatterns:s,candles:a,lastPrice:i,logs:o,onSymbolClick:c,onTimeframeChange:d,onApplyIndicators:f})=>l.jsxs("aside",{className:"glass-panel space-y-4 rounded-2xl p-5 shadow-2xl transition-all duration-300 hover:shadow-primary/10 animate-fade-in-up",children:[l.jsx(Rc,{symbols:r,activeSymbol:e,onSymbolClick:c}),l.jsx(Fc,{selected:t,onChange:d}),l.jsx(Dc,{}),l.jsx(yc,{}),l.jsx(wc,{settings:n,onApply:f}),n.showPatterns&&l.jsx(Lc,{patterns:s}),l.jsx(Mc,{candles:a,currentPrice:i,symbol:e}),l.jsx(jc,{symbol:e,price:i}),l.jsx(vc,{candles:a,symbol:e})]}));fi.displayName="LeftSidebar";const oe={binance:{apiKey:"your_binance_api_key",secretKey:"your_binance_secret_key"},alphaVantage:{apiKey:"your_alpha_vantage_key"},polygon:{apiKey:"your_polygon_api_key"},finnhub:{apiKey:"your_finnhub_api_key"},oanda:{apiKey:"your_oanda_api_key",accountId:"your_oanda_account_id",environment:"practice"},coldWallets:{btc:"your_btc_cold_wallet_address",eth:"your_eth_cold_wallet_address",bsc:"your_bsc_cold_wallet_address",polygon:"your_polygon_cold_wallet_address",solana:"your_solana_cold_wallet_address",tron:"your_tron_cold_wallet_address"},trading:{enableRealTrading:!1}},Gc="6.15.0";function _c(r,e,t){const n=e.split("|").map(a=>a.trim());for(let a=0;a<n.length;a++)switch(e){case"any":return;case"bigint":case"boolean":case"number":case"string":if(typeof r===e)return}const s=new Error(`invalid value for type ${e}`);throw s.code="INVALID_ARGUMENT",s.argument=`value.${t}`,s.value=r,s}async function bs(r){const e=Object.keys(r);return(await Promise.all(e.map(n=>Promise.resolve(r[n])))).reduce((n,s,a)=>(n[e[a]]=s,n),{})}function H(r,e,t){for(let n in e){let s=e[n];const a=t?t[n]:null;a&&_c(s,a,n),Object.defineProperty(r,n,{enumerable:!0,value:s,writable:!1})}}function fr(r,e){if(r==null)return"null";if(e==null&&(e=new Set),typeof r=="object"){if(e.has(r))return"[Circular]";e.add(r)}if(Array.isArray(r))return"[ "+r.map(t=>fr(t,e)).join(", ")+" ]";if(r instanceof Uint8Array){const t="0123456789abcdef";let n="0x";for(let s=0;s<r.length;s++)n+=t[r[s]>>4],n+=t[r[s]&15];return n}if(typeof r=="object"&&typeof r.toJSON=="function")return fr(r.toJSON(),e);switch(typeof r){case"boolean":case"number":case"symbol":return r.toString();case"bigint":return BigInt(r).toString();case"string":return JSON.stringify(r);case"object":{const t=Object.keys(r);return t.sort(),"{ "+t.map(n=>`${fr(n,e)}: ${fr(r[n],e)}`).join(", ")+" }"}}return"[ COULD NOT SERIALIZE ]"}function Tr(r,e){return r&&r.code===e}function ui(r){return Tr(r,"CALL_EXCEPTION")}function Xt(r,e,t){let n=r;{const a=[];if(t){if("message"in t||"code"in t||"name"in t)throw new Error(`value will overwrite populated values: ${fr(t)}`);for(const i in t){if(i==="shortMessage")continue;const o=t[i];a.push(i+"="+fr(o))}}a.push(`code=${e}`),a.push(`version=${Gc}`),a.length&&(r+=" ("+a.join(", ")+")")}let s;switch(e){case"INVALID_ARGUMENT":s=new TypeError(r);break;case"NUMERIC_FAULT":case"BUFFER_OVERRUN":s=new RangeError(r);break;default:s=new Error(r)}return H(s,{code:e}),t&&Object.assign(s,t),s.shortMessage==null&&H(s,{shortMessage:n}),s}function U(r,e,t,n){if(!r)throw Xt(e,t,n)}function v(r,e,t,n){U(r,e,"INVALID_ARGUMENT",{argument:t,value:n})}function hi(r,e,t){t==null&&(t=""),t&&(t=": "+t),U(r>=e,"missing argument"+t,"MISSING_ARGUMENT",{count:r,expectedCount:e}),U(r<=e,"too many arguments"+t,"UNEXPECTED_ARGUMENT",{count:r,expectedCount:e})}const Hc=["NFD","NFC","NFKD","NFKC"].reduce((r,e)=>{try{if("test".normalize(e)!=="test")throw new Error("bad");if(e==="NFD"&&"é".normalize("NFD")!=="é")throw new Error("broken");r.push(e)}catch{}return r},[]);function Kc(r){U(Hc.indexOf(r)>=0,"platform missing String.prototype.normalize","UNSUPPORTED_OPERATION",{operation:"String.prototype.normalize",info:{form:r}})}function jn(r,e,t){if(t==null&&(t=""),r!==e){let n=t,s="new";t&&(n+=".",s+=" "+t),U(!1,`private constructor; use ${n}from* methods`,"UNSUPPORTED_OPERATION",{operation:s})}}function xi(r,e,t){if(r instanceof Uint8Array)return t?new Uint8Array(r):r;if(typeof r=="string"&&r.match(/^0x(?:[0-9a-f][0-9a-f])*$/i)){const n=new Uint8Array((r.length-2)/2);let s=2;for(let a=0;a<n.length;a++)n[a]=parseInt(r.substring(s,s+2),16),s+=2;return n}v(!1,"invalid BytesLike value",e||"value",r)}function Y(r,e){return xi(r,e,!1)}function Xe(r,e){return xi(r,e,!0)}function Ae(r,e){return!(typeof r!="string"||!r.match(/^0x[0-9A-Fa-f]*$/)||typeof e=="number"&&r.length!==2+2*e||e===!0&&r.length%2!==0)}function pi(r){return Ae(r,!0)||r instanceof Uint8Array}const ca="0123456789abcdef";function K(r){const e=Y(r);let t="0x";for(let n=0;n<e.length;n++){const s=e[n];t+=ca[(s&240)>>4]+ca[s&15]}return t}function It(r){return"0x"+r.map(e=>K(e).substring(2)).join("")}function la(r){return Ae(r,!0)?(r.length-2)/2:Y(r).length}function cr(r,e,t){const n=Y(r);return t!=null&&t>n.length&&U(!1,"cannot slice beyond data bounds","BUFFER_OVERRUN",{buffer:n,length:n.length,offset:t}),K(n.slice(e??0,t??n.length))}function bi(r,e,t){const n=Y(r);U(e>=n.length,"padding exceeds data length","BUFFER_OVERRUN",{buffer:new Uint8Array(n),length:e,offset:e+1});const s=new Uint8Array(e);return s.fill(0),t?s.set(n,e-n.length):s.set(n,0),K(s)}function gi(r,e){return bi(r,e,!0)}function Vc(r,e){return bi(r,e,!1)}const Gn=BigInt(0),Ge=BigInt(1),ur=9007199254740991;function zc(r,e){const t=_n(r,"value"),n=BigInt(re(e,"width"));if(U(t>>n===Gn,"overflow","NUMERIC_FAULT",{operation:"fromTwos",fault:"overflow",value:r}),t>>n-Ge){const s=(Ge<<n)-Ge;return-((~t&s)+Ge)}return t}function Qc(r,e){let t=te(r,"value");const n=BigInt(re(e,"width")),s=Ge<<n-Ge;if(t<Gn){t=-t,U(t<=s,"too low","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:r});const a=(Ge<<n)-Ge;return(~t&a)+Ge}else U(t<s,"too high","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:r});return t}function pn(r,e){const t=_n(r,"value"),n=BigInt(re(e,"bits"));return t&(Ge<<n)-Ge}function te(r,e){switch(typeof r){case"bigint":return r;case"number":return v(Number.isInteger(r),"underflow",e||"value",r),v(r>=-ur&&r<=ur,"overflow",e||"value",r),BigInt(r);case"string":try{if(r==="")throw new Error("empty string");return r[0]==="-"&&r[1]!=="-"?-BigInt(r.substring(1)):BigInt(r)}catch(t){v(!1,`invalid BigNumberish string: ${t.message}`,e||"value",r)}}v(!1,"invalid BigNumberish value",e||"value",r)}function _n(r,e){const t=te(r,e);return U(t>=Gn,"unsigned value cannot be negative","NUMERIC_FAULT",{fault:"overflow",operation:"getUint",value:r}),t}const da="0123456789abcdef";function mi(r){if(r instanceof Uint8Array){let e="0x0";for(const t of r)e+=da[t>>4],e+=da[t&15];return BigInt(e)}return te(r)}function re(r,e){switch(typeof r){case"bigint":return v(r>=-ur&&r<=ur,"overflow",e||"value",r),Number(r);case"number":return v(Number.isInteger(r),"underflow",e||"value",r),v(r>=-ur&&r<=ur,"overflow",e||"value",r),r;case"string":try{if(r==="")throw new Error("empty string");return re(BigInt(r),e)}catch(t){v(!1,`invalid numeric string: ${t.message}`,e||"value",r)}}v(!1,"invalid numeric value",e||"value",r)}function $c(r){return re(mi(r))}function Hn(r,e){let n=_n(r,"value").toString(16);if(e==null)n.length%2&&(n="0"+n);else{const s=re(e,"width");for(U(s*2>=n.length,`value exceeds width (${s} bytes)`,"NUMERIC_FAULT",{operation:"toBeHex",fault:"overflow",value:r});n.length<s*2;)n="0"+n}return"0x"+n}function Us(r){const e=_n(r,"value");if(e===Gn)return new Uint8Array([]);let t=e.toString(16);t.length%2&&(t="0"+t);const n=new Uint8Array(t.length/2);for(let s=0;s<n.length;s++){const a=s*2;n[s]=parseInt(t.substring(a,a+2),16)}return n}function Jc(r){let e=K(pi(r)?r:Us(r)).substring(2);for(;e.startsWith("0");)e=e.substring(1);return e===""&&(e="0"),"0x"+e}const qf=BigInt(0),eu=BigInt(58);function Wc(r){r=atob(r);const e=new Uint8Array(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return Y(e)}function Zc(r){const e=Y(r);let t="";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return btoa(t)}var gr;class Yc{constructor(e,t,n){w(this,"filter");w(this,"emitter");F(this,gr);k(this,gr,t),H(this,{emitter:e,filter:n})}async removeListener(){b(this,gr)!=null&&await this.emitter.off(this.filter,b(this,gr))}}gr=new WeakMap;function Xc(r,e,t,n,s){v(!1,`invalid codepoint at offset ${e}; ${r}`,"bytes",t)}function yi(r,e,t,n,s){if(r==="BAD_PREFIX"||r==="UNEXPECTED_CONTINUE"){let a=0;for(let i=e+1;i<t.length&&t[i]>>6===2;i++)a++;return a}return r==="OVERRUN"?t.length-e-1:0}function qc(r,e,t,n,s){return r==="OVERLONG"?(v(typeof s=="number","invalid bad code point for replacement","badCodepoint",s),n.push(s),0):(n.push(65533),yi(r,e,t))}const el=Object.freeze({error:Xc,ignore:yi,replace:qc});function tl(r,e){e==null&&(e=el.error);const t=Y(r,"bytes"),n=[];let s=0;for(;s<t.length;){const a=t[s++];if(!(a>>7)){n.push(a);continue}let i=null,o=null;if((a&224)===192)i=1,o=127;else if((a&240)===224)i=2,o=2047;else if((a&248)===240)i=3,o=65535;else{(a&192)===128?s+=e("UNEXPECTED_CONTINUE",s-1,t,n):s+=e("BAD_PREFIX",s-1,t,n);continue}if(s-1+i>=t.length){s+=e("OVERRUN",s-1,t,n);continue}let c=a&(1<<8-i-1)-1;for(let d=0;d<i;d++){let f=t[s];if((f&192)!=128){s+=e("MISSING_CONTINUE",s,t,n),c=null;break}c=c<<6|f&63,s++}if(c!==null){if(c>1114111){s+=e("OUT_OF_RANGE",s-1-i,t,n,c);continue}if(c>=55296&&c<=57343){s+=e("UTF16_SURROGATE",s-1-i,t,n,c);continue}if(c<=o){s+=e("OVERLONG",s-1-i,t,n,c);continue}n.push(c)}}return n}function xr(r,e){v(typeof r=="string","invalid string value","str",r),e!=null&&(Kc(e),r=r.normalize(e));let t=[];for(let n=0;n<r.length;n++){const s=r.charCodeAt(n);if(s<128)t.push(s);else if(s<2048)t.push(s>>6|192),t.push(s&63|128);else if((s&64512)==55296){n++;const a=r.charCodeAt(n);v(n<r.length&&(a&64512)===56320,"invalid surrogate pair","str",r);const i=65536+((s&1023)<<10)+(a&1023);t.push(i>>18|240),t.push(i>>12&63|128),t.push(i>>6&63|128),t.push(i&63|128)}else t.push(s>>12|224),t.push(s>>6&63|128),t.push(s&63|128)}return new Uint8Array(t)}function rl(r){return r.map(e=>e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode((e>>10&1023)+55296,(e&1023)+56320))).join("")}function gs(r,e){return rl(tl(r,e))}function wi(r){async function e(t,n){U(n==null||!n.cancelled,"request cancelled before sending","CANCELLED");const s=t.url.split(":")[0].toLowerCase();U(s==="http"||s==="https",`unsupported protocol ${s}`,"UNSUPPORTED_OPERATION",{info:{protocol:s},operation:"request"}),U(s==="https"||!t.credentials||t.allowInsecureAuthentication,"insecure authorized connections unsupported","UNSUPPORTED_OPERATION",{operation:"request"});let a=null;const i=new AbortController,o=setTimeout(()=>{a=Xt("request timeout","TIMEOUT"),i.abort()},t.timeout);n&&n.addListener(()=>{a=Xt("request cancelled","CANCELLED"),i.abort()});const c=Object.assign({},r,{method:t.method,headers:new Headers(Array.from(t)),body:t.body||void 0,signal:i.signal});let d;try{d=await fetch(t.url,c)}catch(y){throw clearTimeout(o),a||y}clearTimeout(o);const f={};d.headers.forEach((y,x)=>{f[x.toLowerCase()]=y});const u=await d.arrayBuffer(),h=u==null?null:new Uint8Array(u);return{statusCode:d.status,statusMessage:d.statusText,headers:f,body:h}}return e}const nl=12,sl=250;let fa=wi();const al=new RegExp("^data:([^;:]*)?(;base64)?,(.*)$","i"),il=new RegExp("^ipfs://(ipfs/)?(.*)$","i");let os=!1;async function Ai(r,e){try{const t=r.match(al);if(!t)throw new Error("invalid data");return new Ct(200,"OK",{"content-type":t[1]||"text/plain"},t[2]?Wc(t[3]):cl(t[3]))}catch{return new Ct(599,"BAD REQUEST (invalid data: URI)",{},null,new Xr(r))}}function Ei(r){async function e(t,n){try{const s=t.match(il);if(!s)throw new Error("invalid link");return new Xr(`${r}${s[2]}`)}catch{return new Ct(599,"BAD REQUEST (invalid IPFS URI)",{},null,new Xr(t))}}return e}const bn={data:Ai,ipfs:Ei("https://gateway.ipfs.io/ipfs/")},Ni=new WeakMap;var Mt,wt;class ol{constructor(e){F(this,Mt);F(this,wt);k(this,Mt,[]),k(this,wt,!1),Ni.set(e,()=>{if(!b(this,wt)){k(this,wt,!0);for(const t of b(this,Mt))setTimeout(()=>{t()},0);k(this,Mt,[])}})}addListener(e){U(!b(this,wt),"singal already cancelled","UNSUPPORTED_OPERATION",{operation:"fetchCancelSignal.addCancelListener"}),b(this,Mt).push(e)}get cancelled(){return b(this,wt)}checkSignal(){U(!this.cancelled,"cancelled","CANCELLED",{})}}Mt=new WeakMap,wt=new WeakMap;function gn(r){if(r==null)throw new Error("missing signal; should not happen");return r.checkSignal(),r}var mr,yr,Le,nt,wr,Ar,ce,Ie,st,jt,Gt,_t,Ve,Me,At,Ht,Kr;const Dn=class Dn{constructor(e){F(this,Ht);F(this,mr);F(this,yr);F(this,Le);F(this,nt);F(this,wr);F(this,Ar);F(this,ce);F(this,Ie);F(this,st);F(this,jt);F(this,Gt);F(this,_t);F(this,Ve);F(this,Me);F(this,At);k(this,Ar,String(e)),k(this,mr,!1),k(this,yr,!0),k(this,Le,{}),k(this,nt,""),k(this,wr,3e5),k(this,Me,{slotInterval:sl,maxAttempts:nl}),k(this,At,null)}get url(){return b(this,Ar)}set url(e){k(this,Ar,String(e))}get body(){return b(this,ce)==null?null:new Uint8Array(b(this,ce))}set body(e){if(e==null)k(this,ce,void 0),k(this,Ie,void 0);else if(typeof e=="string")k(this,ce,xr(e)),k(this,Ie,"text/plain");else if(e instanceof Uint8Array)k(this,ce,e),k(this,Ie,"application/octet-stream");else if(typeof e=="object")k(this,ce,xr(JSON.stringify(e))),k(this,Ie,"application/json");else throw new Error("invalid body")}hasBody(){return b(this,ce)!=null}get method(){return b(this,nt)?b(this,nt):this.hasBody()?"POST":"GET"}set method(e){e==null&&(e=""),k(this,nt,String(e).toUpperCase())}get headers(){const e=Object.assign({},b(this,Le));return b(this,st)&&(e.authorization=`Basic ${Zc(xr(b(this,st)))}`),this.allowGzip&&(e["accept-encoding"]="gzip"),e["content-type"]==null&&b(this,Ie)&&(e["content-type"]=b(this,Ie)),this.body&&(e["content-length"]=String(this.body.length)),e}getHeader(e){return this.headers[e.toLowerCase()]}setHeader(e,t){b(this,Le)[String(e).toLowerCase()]=String(t)}clearHeaders(){k(this,Le,{})}[Symbol.iterator](){const e=this.headers,t=Object.keys(e);let n=0;return{next:()=>{if(n<t.length){const s=t[n++];return{value:[s,e[s]],done:!1}}return{value:void 0,done:!0}}}}get credentials(){return b(this,st)||null}setCredentials(e,t){v(!e.match(/:/),"invalid basic authentication username","username","[REDACTED]"),k(this,st,`${e}:${t}`)}get allowGzip(){return b(this,yr)}set allowGzip(e){k(this,yr,!!e)}get allowInsecureAuthentication(){return!!b(this,mr)}set allowInsecureAuthentication(e){k(this,mr,!!e)}get timeout(){return b(this,wr)}set timeout(e){v(e>=0,"timeout must be non-zero","timeout",e),k(this,wr,e)}get preflightFunc(){return b(this,jt)||null}set preflightFunc(e){k(this,jt,e)}get processFunc(){return b(this,Gt)||null}set processFunc(e){k(this,Gt,e)}get retryFunc(){return b(this,_t)||null}set retryFunc(e){k(this,_t,e)}get getUrlFunc(){return b(this,At)||fa}set getUrlFunc(e){k(this,At,e)}toString(){return`<FetchRequest method=${JSON.stringify(this.method)} url=${JSON.stringify(this.url)} headers=${JSON.stringify(this.headers)} body=${b(this,ce)?K(b(this,ce)):"null"}>`}setThrottleParams(e){e.slotInterval!=null&&(b(this,Me).slotInterval=e.slotInterval),e.maxAttempts!=null&&(b(this,Me).maxAttempts=e.maxAttempts)}send(){return U(b(this,Ve)==null,"request already sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.send"}),k(this,Ve,new ol(this)),Z(this,Ht,Kr).call(this,0,ua()+this.timeout,0,this,new Ct(0,"",{},null,this))}cancel(){U(b(this,Ve)!=null,"request has not been sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.cancel"});const e=Ni.get(this);if(!e)throw new Error("missing signal; should not happen");e()}redirect(e){const t=this.url.split(":")[0].toLowerCase(),n=e.split(":")[0].toLowerCase();U(this.method==="GET"&&(t!=="https"||n!=="http")&&e.match(/^https?:/),"unsupported redirect","UNSUPPORTED_OPERATION",{operation:`redirect(${this.method} ${JSON.stringify(this.url)} => ${JSON.stringify(e)})`});const s=new Dn(e);return s.method="GET",s.allowGzip=this.allowGzip,s.timeout=this.timeout,k(s,Le,Object.assign({},b(this,Le))),b(this,ce)&&k(s,ce,new Uint8Array(b(this,ce))),k(s,Ie,b(this,Ie)),s}clone(){const e=new Dn(this.url);return k(e,nt,b(this,nt)),b(this,ce)&&k(e,ce,b(this,ce)),k(e,Ie,b(this,Ie)),k(e,Le,Object.assign({},b(this,Le))),k(e,st,b(this,st)),this.allowGzip&&(e.allowGzip=!0),e.timeout=this.timeout,this.allowInsecureAuthentication&&(e.allowInsecureAuthentication=!0),k(e,jt,b(this,jt)),k(e,Gt,b(this,Gt)),k(e,_t,b(this,_t)),k(e,Me,Object.assign({},b(this,Me))),k(e,At,b(this,At)),e}static lockConfig(){os=!0}static getGateway(e){return bn[e.toLowerCase()]||null}static registerGateway(e,t){if(e=e.toLowerCase(),e==="http"||e==="https")throw new Error(`cannot intercept ${e}; use registerGetUrl`);if(os)throw new Error("gateways locked");bn[e]=t}static registerGetUrl(e){if(os)throw new Error("gateways locked");fa=e}static createGetUrlFunc(e){return wi(e)}static createDataGateway(){return Ai}static createIpfsGatewayFunc(e){return Ei(e)}};mr=new WeakMap,yr=new WeakMap,Le=new WeakMap,nt=new WeakMap,wr=new WeakMap,Ar=new WeakMap,ce=new WeakMap,Ie=new WeakMap,st=new WeakMap,jt=new WeakMap,Gt=new WeakMap,_t=new WeakMap,Ve=new WeakMap,Me=new WeakMap,At=new WeakMap,Ht=new WeakSet,Kr=async function(e,t,n,s,a){var f,u,h;if(e>=b(this,Me).maxAttempts)return a.makeServerError("exceeded maximum retry limit");U(ua()<=t,"timeout","TIMEOUT",{operation:"request.send",reason:"timeout",request:s}),n>0&&await ll(n);let i=this.clone();const o=(i.url.split(":")[0]||"").toLowerCase();if(o in bn){const y=await bn[o](i.url,gn(b(s,Ve)));if(y instanceof Ct){let x=y;if(this.processFunc){gn(b(s,Ve));try{x=await this.processFunc(i,x)}catch(p){(p.throttle==null||typeof p.stall!="number")&&x.makeServerError("error in post-processing function",p).assertOk()}}return x}i=y}this.preflightFunc&&(i=await this.preflightFunc(i));const c=await this.getUrlFunc(i,gn(b(s,Ve)));let d=new Ct(c.statusCode,c.statusMessage,c.headers,c.body,s);if(d.statusCode===301||d.statusCode===302){try{const y=d.headers.location||"";return Z(f=i.redirect(y),Ht,Kr).call(f,e+1,t,0,s,d)}catch{}return d}else if(d.statusCode===429&&(this.retryFunc==null||await this.retryFunc(i,d,e))){const y=d.headers["retry-after"];let x=b(this,Me).slotInterval*Math.trunc(Math.random()*Math.pow(2,e));return typeof y=="string"&&y.match(/^[1-9][0-9]*$/)&&(x=parseInt(y)),Z(u=i.clone(),Ht,Kr).call(u,e+1,t,x,s,d)}if(this.processFunc){gn(b(s,Ve));try{d=await this.processFunc(i,d)}catch(y){(y.throttle==null||typeof y.stall!="number")&&d.makeServerError("error in post-processing function",y).assertOk();let x=b(this,Me).slotInterval*Math.trunc(Math.random()*Math.pow(2,e));return y.stall>=0&&(x=y.stall),Z(h=i.clone(),Ht,Kr).call(h,e+1,t,x,s,d)}}return d};let Xr=Dn;var sn,an,on,Ce,Er,Kt;const Xs=class Xs{constructor(e,t,n,s,a){F(this,sn);F(this,an);F(this,on);F(this,Ce);F(this,Er);F(this,Kt);k(this,sn,e),k(this,an,t),k(this,on,Object.keys(n).reduce((i,o)=>(i[o.toLowerCase()]=String(n[o]),i),{})),k(this,Ce,s==null?null:new Uint8Array(s)),k(this,Er,a||null),k(this,Kt,{message:""})}toString(){return`<FetchResponse status=${this.statusCode} body=${b(this,Ce)?K(b(this,Ce)):"null"}>`}get statusCode(){return b(this,sn)}get statusMessage(){return b(this,an)}get headers(){return Object.assign({},b(this,on))}get body(){return b(this,Ce)==null?null:new Uint8Array(b(this,Ce))}get bodyText(){try{return b(this,Ce)==null?"":gs(b(this,Ce))}catch{U(!1,"response body is not valid UTF-8 data","UNSUPPORTED_OPERATION",{operation:"bodyText",info:{response:this}})}}get bodyJson(){try{return JSON.parse(this.bodyText)}catch{U(!1,"response body is not valid JSON","UNSUPPORTED_OPERATION",{operation:"bodyJson",info:{response:this}})}}[Symbol.iterator](){const e=this.headers,t=Object.keys(e);let n=0;return{next:()=>{if(n<t.length){const s=t[n++];return{value:[s,e[s]],done:!1}}return{value:void 0,done:!0}}}}makeServerError(e,t){let n;e?n=`CLIENT ESCALATED SERVER ERROR (${this.statusCode} ${this.statusMessage}; ${e})`:(e=`${this.statusCode} ${this.statusMessage}`,n=`CLIENT ESCALATED SERVER ERROR (${e})`);const s=new Xs(599,n,this.headers,this.body,b(this,Er)||void 0);return k(s,Kt,{message:e,error:t}),s}throwThrottleError(e,t){t==null?t=-1:v(Number.isInteger(t)&&t>=0,"invalid stall timeout","stall",t);const n=new Error(e||"throttling requests");throw H(n,{stall:t,throttle:!0}),n}getHeader(e){return this.headers[e.toLowerCase()]}hasBody(){return b(this,Ce)!=null}get request(){return b(this,Er)}ok(){return b(this,Kt).message===""&&this.statusCode>=200&&this.statusCode<300}assertOk(){if(this.ok())return;let{message:e,error:t}=b(this,Kt);e===""&&(e=`server response ${this.statusCode} ${this.statusMessage}`);let n=null;this.request&&(n=this.request.url);let s=null;try{b(this,Ce)&&(s=gs(b(this,Ce)))}catch{}U(!1,e,"SERVER_ERROR",{request:this.request||"unknown request",response:this,error:t,info:{requestUrl:n,responseBody:s,responseStatus:`${this.statusCode} ${this.statusMessage}`}})}};sn=new WeakMap,an=new WeakMap,on=new WeakMap,Ce=new WeakMap,Er=new WeakMap,Kt=new WeakMap;let Ct=Xs;function ua(){return new Date().getTime()}function cl(r){return xr(r.replace(/%([0-9a-f][0-9a-f])/gi,(e,t)=>String.fromCharCode(parseInt(t,16))))}function ll(r){return new Promise(e=>setTimeout(e,r))}const tu=BigInt(-1),ru=BigInt(0),nu=BigInt(1),su=BigInt(5);let cs="0000";for(;cs.length<80;)cs+=cs;const pe=32,ms=new Uint8Array(pe),dl=["then"],mn={},vi=new WeakMap;function Rt(r){return vi.get(r)}function ha(r,e){vi.set(r,e)}function jr(r,e){const t=new Error(`deferred error during ABI decoding triggered accessing ${r}`);throw t.error=e,t}function ys(r,e,t){return r.indexOf(null)>=0?e.map((n,s)=>n instanceof Sr?ys(Rt(n),n,t):n):r.reduce((n,s,a)=>{let i=e.getValue(s);return s in n||(t&&i instanceof Sr&&(i=ys(Rt(i),i,t)),n[s]=i),n},{})}var Nr;const hr=class hr extends Array{constructor(...t){const n=t[0];let s=t[1],a=(t[2]||[]).slice(),i=!0;n!==mn&&(s=t,a=[],i=!1);super(s.length);F(this,Nr);s.forEach((d,f)=>{this[f]=d});const o=a.reduce((d,f)=>(typeof f=="string"&&d.set(f,(d.get(f)||0)+1),d),new Map);if(ha(this,Object.freeze(s.map((d,f)=>{const u=a[f];return u!=null&&o.get(u)===1?u:null}))),k(this,Nr,[]),b(this,Nr)==null&&b(this,Nr),!i)return;Object.freeze(this);const c=new Proxy(this,{get:(d,f,u)=>{if(typeof f=="string"){if(f.match(/^[0-9]+$/)){const y=re(f,"%index");if(y<0||y>=this.length)throw new RangeError("out of result range");const x=d[y];return x instanceof Error&&jr(`index ${y}`,x),x}if(dl.indexOf(f)>=0)return Reflect.get(d,f,u);const h=d[f];if(h instanceof Function)return function(...y){return h.apply(this===u?d:this,y)};if(!(f in d))return d.getValue.apply(this===u?d:this,[f])}return Reflect.get(d,f,u)}});return ha(c,Rt(this)),c}toArray(t){const n=[];return this.forEach((s,a)=>{s instanceof Error&&jr(`index ${a}`,s),t&&s instanceof hr&&(s=s.toArray(t)),n.push(s)}),n}toObject(t){const n=Rt(this);return n.reduce((s,a,i)=>(U(a!=null,`value at index ${i} unnamed`,"UNSUPPORTED_OPERATION",{operation:"toObject()"}),ys(n,this,t)),{})}slice(t,n){t==null&&(t=0),t<0&&(t+=this.length,t<0&&(t=0)),n==null&&(n=this.length),n<0&&(n+=this.length,n<0&&(n=0)),n>this.length&&(n=this.length);const s=Rt(this),a=[],i=[];for(let o=t;o<n;o++)a.push(this[o]),i.push(s[o]);return new hr(mn,a,i)}filter(t,n){const s=Rt(this),a=[],i=[];for(let o=0;o<this.length;o++){const c=this[o];c instanceof Error&&jr(`index ${o}`,c),t.call(n,c,o,this)&&(a.push(c),i.push(s[o]))}return new hr(mn,a,i)}map(t,n){const s=[];for(let a=0;a<this.length;a++){const i=this[a];i instanceof Error&&jr(`index ${a}`,i),s.push(t.call(n,i,a,this))}return s}getValue(t){const n=Rt(this).indexOf(t);if(n===-1)return;const s=this[n];return s instanceof Error&&jr(`property ${JSON.stringify(t)}`,s.error),s}static fromItems(t,n){return new hr(mn,t,n)}};Nr=new WeakMap;let Sr=hr;function xa(r){let e=Us(r);return U(e.length<=pe,"value out-of-bounds","BUFFER_OVERRUN",{buffer:e,length:pe,offset:e.length}),e.length!==pe&&(e=Xe(It([ms.slice(e.length%pe),e]))),e}class dt{constructor(e,t,n,s){w(this,"name");w(this,"type");w(this,"localName");w(this,"dynamic");H(this,{name:e,type:t,localName:n,dynamic:s},{name:"string",type:"string",localName:"string",dynamic:"boolean"})}_throwError(e,t){v(!1,e,this.localName,t)}}var at,Vt,vr,Cn;class ws{constructor(){F(this,vr);F(this,at);F(this,Vt);k(this,at,[]),k(this,Vt,0)}get data(){return It(b(this,at))}get length(){return b(this,Vt)}appendWriter(e){return Z(this,vr,Cn).call(this,Xe(e.data))}writeBytes(e){let t=Xe(e);const n=t.length%pe;return n&&(t=Xe(It([t,ms.slice(n)]))),Z(this,vr,Cn).call(this,t)}writeValue(e){return Z(this,vr,Cn).call(this,xa(e))}writeUpdatableValue(){const e=b(this,at).length;return b(this,at).push(ms),k(this,Vt,b(this,Vt)+pe),t=>{b(this,at)[e]=xa(t)}}}at=new WeakMap,Vt=new WeakMap,vr=new WeakSet,Cn=function(e){return b(this,at).push(e),k(this,Vt,b(this,Vt)+e.length),e.length};var ge,Pe,zt,Qt,Et,rr,Es,Ii;const qs=class qs{constructor(e,t,n){F(this,rr);w(this,"allowLoose");F(this,ge);F(this,Pe);F(this,zt);F(this,Qt);F(this,Et);H(this,{allowLoose:!!t}),k(this,ge,Xe(e)),k(this,zt,0),k(this,Qt,null),k(this,Et,n??1024),k(this,Pe,0)}get data(){return K(b(this,ge))}get dataLength(){return b(this,ge).length}get consumed(){return b(this,Pe)}get bytes(){return new Uint8Array(b(this,ge))}subReader(e){const t=new qs(b(this,ge).slice(b(this,Pe)+e),this.allowLoose,b(this,Et));return k(t,Qt,this),t}readBytes(e,t){let n=Z(this,rr,Ii).call(this,0,e,!!t);return Z(this,rr,Es).call(this,e),k(this,Pe,b(this,Pe)+n.length),n.slice(0,e)}readValue(){return mi(this.readBytes(pe))}readIndex(){return $c(this.readBytes(pe))}};ge=new WeakMap,Pe=new WeakMap,zt=new WeakMap,Qt=new WeakMap,Et=new WeakMap,rr=new WeakSet,Es=function(e){var t;if(b(this,Qt))return Z(t=b(this,Qt),rr,Es).call(t,e);k(this,zt,b(this,zt)+e),U(b(this,Et)<1||b(this,zt)<=b(this,Et)*this.dataLength,`compressed ABI data exceeds inflation ratio of ${b(this,Et)} ( see: https://github.com/ethers-io/ethers.js/issues/4537 )`,"BUFFER_OVERRUN",{buffer:Xe(b(this,ge)),offset:b(this,Pe),length:e,info:{bytesRead:b(this,zt),dataLength:this.dataLength}})},Ii=function(e,t,n){let s=Math.ceil(t/pe)*pe;return b(this,Pe)+s>b(this,ge).length&&(this.allowLoose&&n&&b(this,Pe)+t<=b(this,ge).length?s=t:U(!1,"data out-of-bounds","BUFFER_OVERRUN",{buffer:Xe(b(this,ge)),length:b(this,ge).length,offset:b(this,Pe)+s})),b(this,ge).slice(b(this,Pe),b(this,Pe)+s)};let As=qs;function ke(r){if(!Number.isSafeInteger(r)||r<0)throw new Error(`Wrong positive integer: ${r}`)}function Fs(r,...e){if(!(r instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(r.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${r.length}`)}function Ci(r){if(typeof r!="function"||typeof r.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");ke(r.outputLen),ke(r.blockLen)}function Or(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function Pi(r,e){Fs(r);const t=e.outputLen;if(r.length<t)throw new Error(`digestInto() expects output buffer of length at least ${t}`)}const ls=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ki=r=>r instanceof Uint8Array,Pn=r=>new Uint32Array(r.buffer,r.byteOffset,Math.floor(r.byteLength/4)),kn=r=>new DataView(r.buffer,r.byteOffset,r.byteLength),Ke=(r,e)=>r<<32-e|r>>>e,fl=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!fl)throw new Error("Non little-endian hardware is not supported");const ul=async()=>{};async function pa(r,e,t){let n=Date.now();for(let s=0;s<r;s++){t(s);const a=Date.now()-n;a>=0&&a<e||(await ul(),n+=a)}}function hl(r){if(typeof r!="string")throw new Error(`utf8ToBytes expected string, got ${typeof r}`);return new Uint8Array(new TextEncoder().encode(r))}function Br(r){if(typeof r=="string"&&(r=hl(r)),!ki(r))throw new Error(`expected Uint8Array, got ${typeof r}`);return r}function xl(...r){const e=new Uint8Array(r.reduce((n,s)=>n+s.length,0));let t=0;return r.forEach(n=>{if(!ki(n))throw new Error("Uint8Array expected");e.set(n,t),t+=n.length}),e}class Ds{clone(){return this._cloneInto()}}const pl={}.toString;function Ti(r,e){if(e!==void 0&&pl.call(e)!=="[object Object]")throw new Error("Options should be object or undefined");return Object.assign(r,e)}function Kn(r){const e=n=>r().update(Br(n)).digest(),t=r();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>r(),e}function bl(r=32){if(ls&&typeof ls.getRandomValues=="function")return ls.getRandomValues(new Uint8Array(r));throw new Error("crypto.getRandomValues must be defined")}class Si extends Ds{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,Ci(e);const n=Br(t);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,a=new Uint8Array(s);a.set(n.length>s?e.create().update(n).digest():n);for(let i=0;i<a.length;i++)a[i]^=54;this.iHash.update(a),this.oHash=e.create();for(let i=0;i<a.length;i++)a[i]^=106;this.oHash.update(a),a.fill(0)}update(e){return Or(this),this.iHash.update(e),this}digestInto(e){Or(this),Fs(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:n,finished:s,destroyed:a,blockLen:i,outputLen:o}=this;return e=e,e.finished=s,e.destroyed=a,e.blockLen=i,e.outputLen=o,e.oHash=t._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const Vn=(r,e,t)=>new Si(r,e).update(t).digest();Vn.create=(r,e)=>new Si(r,e);function gl(r,e,t,n){Ci(r);const s=Ti({dkLen:32,asyncTick:10},n),{c:a,dkLen:i,asyncTick:o}=s;if(ke(a),ke(i),ke(o),a<1)throw new Error("PBKDF2: iterations (c) should be >= 1");const c=Br(e),d=Br(t),f=new Uint8Array(i),u=Vn.create(r,c),h=u._cloneInto().update(d);return{c:a,dkLen:i,asyncTick:o,DK:f,PRF:u,PRFSalt:h}}function ml(r,e,t,n,s){return r.destroy(),e.destroy(),n&&n.destroy(),s.fill(0),t}function Ls(r,e,t,n){const{c:s,dkLen:a,DK:i,PRF:o,PRFSalt:c}=gl(r,e,t,n);let d;const f=new Uint8Array(4),u=kn(f),h=new Uint8Array(o.outputLen);for(let y=1,x=0;x<a;y++,x+=o.outputLen){const p=i.subarray(x,x+o.outputLen);u.setInt32(0,y,!1),(d=c._cloneInto(d)).update(f).digestInto(h),p.set(h.subarray(0,p.length));for(let g=1;g<s;g++){o._cloneInto(d).update(h).digestInto(h);for(let m=0;m<p.length;m++)p[m]^=h[m]}}return ml(o,c,i,d,h)}function yl(r,e,t,n){if(typeof r.setBigUint64=="function")return r.setBigUint64(e,t,n);const s=BigInt(32),a=BigInt(4294967295),i=Number(t>>s&a),o=Number(t&a),c=n?4:0,d=n?0:4;r.setUint32(e+c,i,n),r.setUint32(e+d,o,n)}class Ms extends Ds{constructor(e,t,n,s){super(),this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=kn(this.buffer)}update(e){Or(this);const{view:t,buffer:n,blockLen:s}=this;e=Br(e);const a=e.length;for(let i=0;i<a;){const o=Math.min(s-this.pos,a-i);if(o===s){const c=kn(e);for(;s<=a-i;i+=s)this.process(c,i);continue}n.set(e.subarray(i,i+o),this.pos),this.pos+=o,i+=o,this.pos===s&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Or(this),Pi(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:s,isLE:a}=this;let{pos:i}=this;t[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>s-i&&(this.process(n,0),i=0);for(let u=i;u<s;u++)t[u]=0;yl(n,s-8,BigInt(this.length*8),a),this.process(n,0);const o=kn(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const d=c/4,f=this.get();if(d>f.length)throw new Error("_sha2: outputLen bigger than state");for(let u=0;u<d;u++)o.setUint32(4*u,f[u],a)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:s,finished:a,destroyed:i,pos:o}=this;return e.length=s,e.pos=o,e.finished=a,e.destroyed=i,s%t&&e.buffer.set(n),e}}const wl=(r,e,t)=>r&e^~r&t,Al=(r,e,t)=>r&e^r&t^e&t,El=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),xt=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),pt=new Uint32Array(64);class Nl extends Ms{constructor(){super(64,32,8,!1),this.A=xt[0]|0,this.B=xt[1]|0,this.C=xt[2]|0,this.D=xt[3]|0,this.E=xt[4]|0,this.F=xt[5]|0,this.G=xt[6]|0,this.H=xt[7]|0}get(){const{A:e,B:t,C:n,D:s,E:a,F:i,G:o,H:c}=this;return[e,t,n,s,a,i,o,c]}set(e,t,n,s,a,i,o,c){this.A=e|0,this.B=t|0,this.C=n|0,this.D=s|0,this.E=a|0,this.F=i|0,this.G=o|0,this.H=c|0}process(e,t){for(let u=0;u<16;u++,t+=4)pt[u]=e.getUint32(t,!1);for(let u=16;u<64;u++){const h=pt[u-15],y=pt[u-2],x=Ke(h,7)^Ke(h,18)^h>>>3,p=Ke(y,17)^Ke(y,19)^y>>>10;pt[u]=p+pt[u-7]+x+pt[u-16]|0}let{A:n,B:s,C:a,D:i,E:o,F:c,G:d,H:f}=this;for(let u=0;u<64;u++){const h=Ke(o,6)^Ke(o,11)^Ke(o,25),y=f+h+wl(o,c,d)+El[u]+pt[u]|0,p=(Ke(n,2)^Ke(n,13)^Ke(n,22))+Al(n,s,a)|0;f=d,d=c,c=o,o=i+y|0,i=a,a=s,s=n,n=y+p|0}n=n+this.A|0,s=s+this.B|0,a=a+this.C|0,i=i+this.D|0,o=o+this.E|0,c=c+this.F|0,d=d+this.G|0,f=f+this.H|0,this.set(n,s,a,i,o,c,d,f)}roundClean(){pt.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const Dr=Kn(()=>new Nl),yn=BigInt(2**32-1),Ns=BigInt(32);function Oi(r,e=!1){return e?{h:Number(r&yn),l:Number(r>>Ns&yn)}:{h:Number(r>>Ns&yn)|0,l:Number(r&yn)|0}}function Bi(r,e=!1){let t=new Uint32Array(r.length),n=new Uint32Array(r.length);for(let s=0;s<r.length;s++){const{h:a,l:i}=Oi(r[s],e);[t[s],n[s]]=[a,i]}return[t,n]}const vl=(r,e)=>BigInt(r>>>0)<<Ns|BigInt(e>>>0),Il=(r,e,t)=>r>>>t,Cl=(r,e,t)=>r<<32-t|e>>>t,Pl=(r,e,t)=>r>>>t|e<<32-t,kl=(r,e,t)=>r<<32-t|e>>>t,Tl=(r,e,t)=>r<<64-t|e>>>t-32,Sl=(r,e,t)=>r>>>t-32|e<<64-t,Ol=(r,e)=>e,Bl=(r,e)=>r,Ri=(r,e,t)=>r<<t|e>>>32-t,Ui=(r,e,t)=>e<<t|r>>>32-t,Fi=(r,e,t)=>e<<t-32|r>>>64-t,Di=(r,e,t)=>r<<t-32|e>>>64-t;function Rl(r,e,t,n){const s=(e>>>0)+(n>>>0);return{h:r+t+(s/2**32|0)|0,l:s|0}}const Ul=(r,e,t)=>(r>>>0)+(e>>>0)+(t>>>0),Fl=(r,e,t,n)=>e+t+n+(r/2**32|0)|0,Dl=(r,e,t,n)=>(r>>>0)+(e>>>0)+(t>>>0)+(n>>>0),Ll=(r,e,t,n,s)=>e+t+n+s+(r/2**32|0)|0,Ml=(r,e,t,n,s)=>(r>>>0)+(e>>>0)+(t>>>0)+(n>>>0)+(s>>>0),jl=(r,e,t,n,s,a)=>e+t+n+s+a+(r/2**32|0)|0,_={fromBig:Oi,split:Bi,toBig:vl,shrSH:Il,shrSL:Cl,rotrSH:Pl,rotrSL:kl,rotrBH:Tl,rotrBL:Sl,rotr32H:Ol,rotr32L:Bl,rotlSH:Ri,rotlSL:Ui,rotlBH:Fi,rotlBL:Di,add:Rl,add3L:Ul,add3H:Fl,add4L:Dl,add4H:Ll,add5H:jl,add5L:Ml},[Gl,_l]=_.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(r=>BigInt(r))),bt=new Uint32Array(80),gt=new Uint32Array(80);class Hl extends Ms{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:t,Bh:n,Bl:s,Ch:a,Cl:i,Dh:o,Dl:c,Eh:d,El:f,Fh:u,Fl:h,Gh:y,Gl:x,Hh:p,Hl:g}=this;return[e,t,n,s,a,i,o,c,d,f,u,h,y,x,p,g]}set(e,t,n,s,a,i,o,c,d,f,u,h,y,x,p,g){this.Ah=e|0,this.Al=t|0,this.Bh=n|0,this.Bl=s|0,this.Ch=a|0,this.Cl=i|0,this.Dh=o|0,this.Dl=c|0,this.Eh=d|0,this.El=f|0,this.Fh=u|0,this.Fl=h|0,this.Gh=y|0,this.Gl=x|0,this.Hh=p|0,this.Hl=g|0}process(e,t){for(let N=0;N<16;N++,t+=4)bt[N]=e.getUint32(t),gt[N]=e.getUint32(t+=4);for(let N=16;N<80;N++){const I=bt[N-15]|0,E=gt[N-15]|0,C=_.rotrSH(I,E,1)^_.rotrSH(I,E,8)^_.shrSH(I,E,7),O=_.rotrSL(I,E,1)^_.rotrSL(I,E,8)^_.shrSL(I,E,7),P=bt[N-2]|0,D=gt[N-2]|0,j=_.rotrSH(P,D,19)^_.rotrBH(P,D,61)^_.shrSH(P,D,6),M=_.rotrSL(P,D,19)^_.rotrBL(P,D,61)^_.shrSL(P,D,6),J=_.add4L(O,M,gt[N-7],gt[N-16]),L=_.add4H(J,C,j,bt[N-7],bt[N-16]);bt[N]=L|0,gt[N]=J|0}let{Ah:n,Al:s,Bh:a,Bl:i,Ch:o,Cl:c,Dh:d,Dl:f,Eh:u,El:h,Fh:y,Fl:x,Gh:p,Gl:g,Hh:m,Hl:A}=this;for(let N=0;N<80;N++){const I=_.rotrSH(u,h,14)^_.rotrSH(u,h,18)^_.rotrBH(u,h,41),E=_.rotrSL(u,h,14)^_.rotrSL(u,h,18)^_.rotrBL(u,h,41),C=u&y^~u&p,O=h&x^~h&g,P=_.add5L(A,E,O,_l[N],gt[N]),D=_.add5H(P,m,I,C,Gl[N],bt[N]),j=P|0,M=_.rotrSH(n,s,28)^_.rotrBH(n,s,34)^_.rotrBH(n,s,39),J=_.rotrSL(n,s,28)^_.rotrBL(n,s,34)^_.rotrBL(n,s,39),L=n&a^n&o^a&o,X=s&i^s&c^i&c;m=p|0,A=g|0,p=y|0,g=x|0,y=u|0,x=h|0,{h:u,l:h}=_.add(d|0,f|0,D|0,j|0),d=o|0,f=c|0,o=a|0,c=i|0,a=n|0,i=s|0;const S=_.add3L(j,J,X);n=_.add3H(S,D,M,L),s=S|0}({h:n,l:s}=_.add(this.Ah|0,this.Al|0,n|0,s|0)),{h:a,l:i}=_.add(this.Bh|0,this.Bl|0,a|0,i|0),{h:o,l:c}=_.add(this.Ch|0,this.Cl|0,o|0,c|0),{h:d,l:f}=_.add(this.Dh|0,this.Dl|0,d|0,f|0),{h:u,l:h}=_.add(this.Eh|0,this.El|0,u|0,h|0),{h:y,l:x}=_.add(this.Fh|0,this.Fl|0,y|0,x|0),{h:p,l:g}=_.add(this.Gh|0,this.Gl|0,p|0,g|0),{h:m,l:A}=_.add(this.Hh|0,this.Hl|0,m|0,A|0),this.set(n,s,a,i,o,c,d,f,u,h,y,x,p,g,m,A)}roundClean(){bt.fill(0),gt.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const js=Kn(()=>new Hl);function Kl(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")}const ba=Kl(),ga=ba.crypto||ba.msCrypto;function Vl(r){switch(r){case"sha256":return Dr.create();case"sha512":return js.create()}v(!1,"invalid hashing algorithm name","algorithm",r)}function zl(r,e){const t={sha256:Dr,sha512:js}[r];return v(t!=null,"invalid hmac algorithm","algorithm",r),Vn.create(t,e)}function Ql(r,e,t,n,s){const a={sha256:Dr,sha512:js}[s];return v(a!=null,"invalid pbkdf2 algorithm","algorithm",s),Ls(a,r,e,{c:t,dkLen:n})}function $l(r){U(ga!=null,"platform does not support secure random numbers","UNSUPPORTED_OPERATION",{operation:"randomBytes"}),v(Number.isInteger(r)&&r>0&&r<=1024,"invalid length","length",r);const e=new Uint8Array(r);return ga.getRandomValues(e),e}let Li=!1;const Mi=function(r,e,t){return zl(r,e).update(t).digest()};let ji=Mi;function zn(r,e,t){const n=Y(e,"key"),s=Y(t,"data");return K(ji(r,n,s))}zn._=Mi;zn.lock=function(){Li=!0};zn.register=function(r){if(Li)throw new Error("computeHmac is locked");ji=r};Object.freeze(zn);const[Gi,_i,Hi]=[[],[],[]],Jl=BigInt(0),Gr=BigInt(1),Wl=BigInt(2),Zl=BigInt(7),Yl=BigInt(256),Xl=BigInt(113);for(let r=0,e=Gr,t=1,n=0;r<24;r++){[t,n]=[n,(2*t+3*n)%5],Gi.push(2*(5*n+t)),_i.push((r+1)*(r+2)/2%64);let s=Jl;for(let a=0;a<7;a++)e=(e<<Gr^(e>>Zl)*Xl)%Yl,e&Wl&&(s^=Gr<<(Gr<<BigInt(a))-Gr);Hi.push(s)}const[ql,e0]=Bi(Hi,!0),ma=(r,e,t)=>t>32?Fi(r,e,t):Ri(r,e,t),ya=(r,e,t)=>t>32?Di(r,e,t):Ui(r,e,t);function t0(r,e=24){const t=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let i=0;i<10;i++)t[i]=r[i]^r[i+10]^r[i+20]^r[i+30]^r[i+40];for(let i=0;i<10;i+=2){const o=(i+8)%10,c=(i+2)%10,d=t[c],f=t[c+1],u=ma(d,f,1)^t[o],h=ya(d,f,1)^t[o+1];for(let y=0;y<50;y+=10)r[i+y]^=u,r[i+y+1]^=h}let s=r[2],a=r[3];for(let i=0;i<24;i++){const o=_i[i],c=ma(s,a,o),d=ya(s,a,o),f=Gi[i];s=r[f],a=r[f+1],r[f]=c,r[f+1]=d}for(let i=0;i<50;i+=10){for(let o=0;o<10;o++)t[o]=r[i+o];for(let o=0;o<10;o++)r[i+o]^=~t[(o+2)%10]&t[(o+4)%10]}r[0]^=ql[n],r[1]^=e0[n]}t.fill(0)}class Gs extends Ds{constructor(e,t,n,s=!1,a=24){if(super(),this.blockLen=e,this.suffix=t,this.outputLen=n,this.enableXOF=s,this.rounds=a,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,ke(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=Pn(this.state)}keccak(){t0(this.state32,this.rounds),this.posOut=0,this.pos=0}update(e){Or(this);const{blockLen:t,state:n}=this;e=Br(e);const s=e.length;for(let a=0;a<s;){const i=Math.min(t-this.pos,s-a);for(let o=0;o<i;o++)n[this.pos++]^=e[a++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:n,blockLen:s}=this;e[n]^=t,t&128&&n===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){Or(this,!1),Fs(e),this.finish();const t=this.state,{blockLen:n}=this;for(let s=0,a=e.length;s<a;){this.posOut>=n&&this.keccak();const i=Math.min(n-this.posOut,a-s);e.set(t.subarray(this.posOut,this.posOut+i),s),this.posOut+=i,s+=i}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return ke(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(Pi(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:t,suffix:n,outputLen:s,rounds:a,enableXOF:i}=this;return e||(e=new Gs(t,n,s,i,a)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=a,e.suffix=n,e.outputLen=s,e.enableXOF=i,e.destroyed=this.destroyed,e}}const r0=(r,e,t)=>Kn(()=>new Gs(e,r,t)),n0=r0(1,136,256/8);let Ki=!1;const Vi=function(r){return n0(r)};let zi=Vi;function kt(r){const e=Y(r,"data");return K(zi(e))}kt._=Vi;kt.lock=function(){Ki=!0};kt.register=function(r){if(Ki)throw new TypeError("keccak256 is locked");zi=r};Object.freeze(kt);const s0=new Uint8Array([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),Qi=Uint8Array.from({length:16},(r,e)=>e),a0=Qi.map(r=>(9*r+5)%16);let _s=[Qi],Hs=[a0];for(let r=0;r<4;r++)for(let e of[_s,Hs])e.push(e[r].map(t=>s0[t]));const $i=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map(r=>new Uint8Array(r)),i0=_s.map((r,e)=>r.map(t=>$i[e][t])),o0=Hs.map((r,e)=>r.map(t=>$i[e][t])),c0=new Uint32Array([0,1518500249,1859775393,2400959708,2840853838]),l0=new Uint32Array([1352829926,1548603684,1836072691,2053994217,0]),wn=(r,e)=>r<<e|r>>>32-e;function wa(r,e,t,n){return r===0?e^t^n:r===1?e&t|~e&n:r===2?(e|~t)^n:r===3?e&n|t&~n:e^(t|~n)}const An=new Uint32Array(16);class d0 extends Ms{constructor(){super(64,20,8,!0),this.h0=1732584193,this.h1=-271733879,this.h2=-1732584194,this.h3=271733878,this.h4=-1009589776}get(){const{h0:e,h1:t,h2:n,h3:s,h4:a}=this;return[e,t,n,s,a]}set(e,t,n,s,a){this.h0=e|0,this.h1=t|0,this.h2=n|0,this.h3=s|0,this.h4=a|0}process(e,t){for(let y=0;y<16;y++,t+=4)An[y]=e.getUint32(t,!0);let n=this.h0|0,s=n,a=this.h1|0,i=a,o=this.h2|0,c=o,d=this.h3|0,f=d,u=this.h4|0,h=u;for(let y=0;y<5;y++){const x=4-y,p=c0[y],g=l0[y],m=_s[y],A=Hs[y],N=i0[y],I=o0[y];for(let E=0;E<16;E++){const C=wn(n+wa(y,a,o,d)+An[m[E]]+p,N[E])+u|0;n=u,u=d,d=wn(o,10)|0,o=a,a=C}for(let E=0;E<16;E++){const C=wn(s+wa(x,i,c,f)+An[A[E]]+g,I[E])+h|0;s=h,h=f,f=wn(c,10)|0,c=i,i=C}}this.set(this.h1+o+f|0,this.h2+d+h|0,this.h3+u+s|0,this.h4+n+i|0,this.h0+a+c|0)}roundClean(){An.fill(0)}destroy(){this.destroyed=!0,this.buffer.fill(0),this.set(0,0,0,0,0)}}const f0=Kn(()=>new d0);let Ji=!1;const Wi=function(r){return f0(r)};let Zi=Wi;function Qn(r){const e=Y(r,"data");return K(Zi(e))}Qn._=Wi;Qn.lock=function(){Ji=!0};Qn.register=function(r){if(Ji)throw new TypeError("ripemd160 is locked");Zi=r};Object.freeze(Qn);let Yi=!1;const Xi=function(r,e,t,n,s){return Ql(r,e,t,n,s)};let qi=Xi;function $n(r,e,t,n,s){const a=Y(r,"password"),i=Y(e,"salt");return K(qi(a,i,t,n,s))}$n._=Xi;$n.lock=function(){Yi=!0};$n.register=function(r){if(Yi)throw new Error("pbkdf2 is locked");qi=r};Object.freeze($n);let eo=!1;const to=function(r){return new Uint8Array($l(r))};let ro=to;function Jn(r){return ro(r)}Jn._=to;Jn.lock=function(){eo=!0};Jn.register=function(r){if(eo)throw new Error("randomBytes is locked");ro=r};Object.freeze(Jn);const Q=(r,e)=>r<<e|r>>>32-e;function Aa(r,e,t,n,s,a){let i=r[e++]^t[n++],o=r[e++]^t[n++],c=r[e++]^t[n++],d=r[e++]^t[n++],f=r[e++]^t[n++],u=r[e++]^t[n++],h=r[e++]^t[n++],y=r[e++]^t[n++],x=r[e++]^t[n++],p=r[e++]^t[n++],g=r[e++]^t[n++],m=r[e++]^t[n++],A=r[e++]^t[n++],N=r[e++]^t[n++],I=r[e++]^t[n++],E=r[e++]^t[n++],C=i,O=o,P=c,D=d,j=f,M=u,J=h,L=y,X=x,S=p,B=g,G=m,z=A,V=N,q=I,se=E;for(let ue=0;ue<8;ue+=2)j^=Q(C+z|0,7),X^=Q(j+C|0,9),z^=Q(X+j|0,13),C^=Q(z+X|0,18),S^=Q(M+O|0,7),V^=Q(S+M|0,9),O^=Q(V+S|0,13),M^=Q(O+V|0,18),q^=Q(B+J|0,7),P^=Q(q+B|0,9),J^=Q(P+q|0,13),B^=Q(J+P|0,18),D^=Q(se+G|0,7),L^=Q(D+se|0,9),G^=Q(L+D|0,13),se^=Q(G+L|0,18),O^=Q(C+D|0,7),P^=Q(O+C|0,9),D^=Q(P+O|0,13),C^=Q(D+P|0,18),J^=Q(M+j|0,7),L^=Q(J+M|0,9),j^=Q(L+J|0,13),M^=Q(j+L|0,18),G^=Q(B+S|0,7),X^=Q(G+B|0,9),S^=Q(X+G|0,13),B^=Q(S+X|0,18),z^=Q(se+q|0,7),V^=Q(z+se|0,9),q^=Q(V+z|0,13),se^=Q(q+V|0,18);s[a++]=i+C|0,s[a++]=o+O|0,s[a++]=c+P|0,s[a++]=d+D|0,s[a++]=f+j|0,s[a++]=u+M|0,s[a++]=h+J|0,s[a++]=y+L|0,s[a++]=x+X|0,s[a++]=p+S|0,s[a++]=g+B|0,s[a++]=m+G|0,s[a++]=A+z|0,s[a++]=N+V|0,s[a++]=I+q|0,s[a++]=E+se|0}function pr(r,e,t,n,s){let a=n+0,i=n+16*s;for(let o=0;o<16;o++)t[i+o]=r[e+(2*s-1)*16+o];for(let o=0;o<s;o++,a+=16,e+=16)Aa(t,i,r,e,t,a),o>0&&(i+=16),Aa(t,a,r,e+=16,t,i)}function no(r,e,t){const n=Ti({dkLen:32,asyncTick:10,maxmem:1073742848},t),{N:s,r:a,p:i,dkLen:o,asyncTick:c,maxmem:d,onProgress:f}=n;if(ke(s),ke(a),ke(i),ke(o),ke(c),ke(d),f!==void 0&&typeof f!="function")throw new Error("progressCb should be function");const u=128*a,h=u/4;if(s<=1||s&s-1||s>=2**(u/8)||s>2**32)throw new Error("Scrypt: N must be larger than 1, a power of 2, less than 2^(128 * r / 8) and less than 2^32");if(i<0||i>(2**32-1)*32/u)throw new Error("Scrypt: p must be a positive integer less than or equal to ((2^32 - 1) * 32) / (128 * r)");if(o<0||o>(2**32-1)*32)throw new Error("Scrypt: dkLen should be positive integer less than or equal to (2^32 - 1) * 32");const y=u*(s+i);if(y>d)throw new Error(`Scrypt: parameters too large, ${y} (128 * r * (N + p)) > ${d} (maxmem)`);const x=Ls(Dr,r,e,{c:1,dkLen:u*i}),p=Pn(x),g=Pn(new Uint8Array(u*s)),m=Pn(new Uint8Array(u));let A=()=>{};if(f){const N=2*s*i,I=Math.max(Math.floor(N/1e4),1);let E=0;A=()=>{E++,f&&(!(E%I)||E===N)&&f(E/N)}}return{N:s,r:a,p:i,dkLen:o,blockSize32:h,V:g,B32:p,B:x,tmp:m,blockMixCb:A,asyncTick:c}}function so(r,e,t,n,s){const a=Ls(Dr,r,t,{c:1,dkLen:e});return t.fill(0),n.fill(0),s.fill(0),a}function u0(r,e,t){const{N:n,r:s,p:a,dkLen:i,blockSize32:o,V:c,B32:d,B:f,tmp:u,blockMixCb:h}=no(r,e,t);for(let y=0;y<a;y++){const x=o*y;for(let p=0;p<o;p++)c[p]=d[x+p];for(let p=0,g=0;p<n-1;p++)pr(c,g,c,g+=o,s),h();pr(c,(n-1)*o,d,x,s),h();for(let p=0;p<n;p++){const g=d[x+o-16]%n;for(let m=0;m<o;m++)u[m]=d[x+m]^c[g*o+m];pr(u,0,d,x,s),h()}}return so(r,i,f,c,u)}async function h0(r,e,t){const{N:n,r:s,p:a,dkLen:i,blockSize32:o,V:c,B32:d,B:f,tmp:u,blockMixCb:h,asyncTick:y}=no(r,e,t);for(let x=0;x<a;x++){const p=o*x;for(let m=0;m<o;m++)c[m]=d[p+m];let g=0;await pa(n-1,y,()=>{pr(c,g,c,g+=o,s),h()}),pr(c,(n-1)*o,d,p,s),h(),await pa(n,y,()=>{const m=d[p+o-16]%n;for(let A=0;A<o;A++)u[A]=d[p+A]^c[m*o+A];pr(u,0,d,p,s),h()})}return so(r,i,f,c,u)}let ao=!1,io=!1;const oo=async function(r,e,t,n,s,a,i){return await h0(r,e,{N:t,r:n,p:s,dkLen:a,onProgress:i})},co=function(r,e,t,n,s,a){return u0(r,e,{N:t,r:n,p:s,dkLen:a})};let lo=oo,fo=co;async function Wn(r,e,t,n,s,a,i){const o=Y(r,"passwd"),c=Y(e,"salt");return K(await lo(o,c,t,n,s,a,i))}Wn._=oo;Wn.lock=function(){io=!0};Wn.register=function(r){if(io)throw new Error("scrypt is locked");lo=r};Object.freeze(Wn);function Zn(r,e,t,n,s,a){const i=Y(r,"passwd"),o=Y(e,"salt");return K(fo(i,o,t,n,s,a))}Zn._=co;Zn.lock=function(){ao=!0};Zn.register=function(r){if(ao)throw new Error("scryptSync is locked");fo=r};Object.freeze(Zn);const uo=function(r){return Vl("sha256").update(r).digest()};let ho=uo,xo=!1;function un(r){const e=Y(r,"data");return K(ho(e))}un._=uo;un.lock=function(){xo=!0};un.register=function(r){if(xo)throw new Error("sha256 is locked");ho=r};Object.freeze(un);Object.freeze(un);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const po=BigInt(0),Yn=BigInt(1),x0=BigInt(2),Xn=r=>r instanceof Uint8Array,p0=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));function Rr(r){if(!Xn(r))throw new Error("Uint8Array expected");let e="";for(let t=0;t<r.length;t++)e+=p0[r[t]];return e}function bo(r){const e=r.toString(16);return e.length&1?`0${e}`:e}function Ks(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);return BigInt(r===""?"0":`0x${r}`)}function Ur(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);const e=r.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const t=new Uint8Array(e/2);for(let n=0;n<t.length;n++){const s=n*2,a=r.slice(s,s+2),i=Number.parseInt(a,16);if(Number.isNaN(i)||i<0)throw new Error("Invalid byte sequence");t[n]=i}return t}function Wt(r){return Ks(Rr(r))}function Vs(r){if(!Xn(r))throw new Error("Uint8Array expected");return Ks(Rr(Uint8Array.from(r).reverse()))}function Fr(r,e){return Ur(r.toString(16).padStart(e*2,"0"))}function zs(r,e){return Fr(r,e).reverse()}function b0(r){return Ur(bo(r))}function De(r,e,t){let n;if(typeof e=="string")try{n=Ur(e)}catch(a){throw new Error(`${r} must be valid hex string, got "${e}". Cause: ${a}`)}else if(Xn(e))n=Uint8Array.from(e);else throw new Error(`${r} must be hex string or Uint8Array`);const s=n.length;if(typeof t=="number"&&s!==t)throw new Error(`${r} expected ${t} bytes, got ${s}`);return n}function qr(...r){const e=new Uint8Array(r.reduce((n,s)=>n+s.length,0));let t=0;return r.forEach(n=>{if(!Xn(n))throw new Error("Uint8Array expected");e.set(n,t),t+=n.length}),e}function g0(r,e){if(r.length!==e.length)return!1;for(let t=0;t<r.length;t++)if(r[t]!==e[t])return!1;return!0}function m0(r){if(typeof r!="string")throw new Error(`utf8ToBytes expected string, got ${typeof r}`);return new Uint8Array(new TextEncoder().encode(r))}function y0(r){let e;for(e=0;r>po;r>>=Yn,e+=1);return e}function w0(r,e){return r>>BigInt(e)&Yn}const A0=(r,e,t)=>r|(t?Yn:po)<<BigInt(e),Qs=r=>(x0<<BigInt(r-1))-Yn,ds=r=>new Uint8Array(r),Ea=r=>Uint8Array.from(r);function go(r,e,t){if(typeof r!="number"||r<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof t!="function")throw new Error("hmacFn must be a function");let n=ds(r),s=ds(r),a=0;const i=()=>{n.fill(1),s.fill(0),a=0},o=(...u)=>t(s,n,...u),c=(u=ds())=>{s=o(Ea([0]),u),n=o(),u.length!==0&&(s=o(Ea([1]),u),n=o())},d=()=>{if(a++>=1e3)throw new Error("drbg: tried 1000 values");let u=0;const h=[];for(;u<e;){n=o();const y=n.slice();h.push(y),u+=n.length}return qr(...h)};return(u,h)=>{i(),c(u);let y;for(;!(y=h(d()));)c();return i(),y}}const E0={bigint:r=>typeof r=="bigint",function:r=>typeof r=="function",boolean:r=>typeof r=="boolean",string:r=>typeof r=="string",stringOrUint8Array:r=>typeof r=="string"||r instanceof Uint8Array,isSafeInteger:r=>Number.isSafeInteger(r),array:r=>Array.isArray(r),field:(r,e)=>e.Fp.isValid(r),hash:r=>typeof r=="function"&&Number.isSafeInteger(r.outputLen)};function hn(r,e,t={}){const n=(s,a,i)=>{const o=E0[a];if(typeof o!="function")throw new Error(`Invalid validator "${a}", expected function`);const c=r[s];if(!(i&&c===void 0)&&!o(c,r))throw new Error(`Invalid param ${String(s)}=${c} (${typeof c}), expected ${a}`)};for(const[s,a]of Object.entries(e))n(s,a,!1);for(const[s,a]of Object.entries(t))n(s,a,!0);return r}const N0=Object.freeze(Object.defineProperty({__proto__:null,bitGet:w0,bitLen:y0,bitMask:Qs,bitSet:A0,bytesToHex:Rr,bytesToNumberBE:Wt,bytesToNumberLE:Vs,concatBytes:qr,createHmacDrbg:go,ensureBytes:De,equalBytes:g0,hexToBytes:Ur,hexToNumber:Ks,numberToBytesBE:Fr,numberToBytesLE:zs,numberToHexUnpadded:bo,numberToVarBytesBE:b0,utf8ToBytes:m0,validateObject:hn},Symbol.toStringTag,{value:"Module"}));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const le=BigInt(0),ie=BigInt(1),Ut=BigInt(2),v0=BigInt(3),vs=BigInt(4),Na=BigInt(5),va=BigInt(8);BigInt(9);BigInt(16);function me(r,e){const t=r%e;return t>=le?t:e+t}function I0(r,e,t){if(t<=le||e<le)throw new Error("Expected power/modulo > 0");if(t===ie)return le;let n=ie;for(;e>le;)e&ie&&(n=n*r%t),r=r*r%t,e>>=ie;return n}function Te(r,e,t){let n=r;for(;e-- >le;)n*=n,n%=t;return n}function Is(r,e){if(r===le||e<=le)throw new Error(`invert: expected positive integers, got n=${r} mod=${e}`);let t=me(r,e),n=e,s=le,a=ie;for(;t!==le;){const o=n/t,c=n%t,d=s-a*o;n=t,t=c,s=a,a=d}if(n!==ie)throw new Error("invert: does not exist");return me(s,e)}function C0(r){const e=(r-ie)/Ut;let t,n,s;for(t=r-ie,n=0;t%Ut===le;t/=Ut,n++);for(s=Ut;s<r&&I0(s,e,r)!==r-ie;s++);if(n===1){const i=(r+ie)/vs;return function(c,d){const f=c.pow(d,i);if(!c.eql(c.sqr(f),d))throw new Error("Cannot find square root");return f}}const a=(t+ie)/Ut;return function(o,c){if(o.pow(c,e)===o.neg(o.ONE))throw new Error("Cannot find square root");let d=n,f=o.pow(o.mul(o.ONE,s),t),u=o.pow(c,a),h=o.pow(c,t);for(;!o.eql(h,o.ONE);){if(o.eql(h,o.ZERO))return o.ZERO;let y=1;for(let p=o.sqr(h);y<d&&!o.eql(p,o.ONE);y++)p=o.sqr(p);const x=o.pow(f,ie<<BigInt(d-y-1));f=o.sqr(x),u=o.mul(u,x),h=o.mul(h,f),d=y}return u}}function P0(r){if(r%vs===v0){const e=(r+ie)/vs;return function(n,s){const a=n.pow(s,e);if(!n.eql(n.sqr(a),s))throw new Error("Cannot find square root");return a}}if(r%va===Na){const e=(r-Na)/va;return function(n,s){const a=n.mul(s,Ut),i=n.pow(a,e),o=n.mul(s,i),c=n.mul(n.mul(o,Ut),i),d=n.mul(o,n.sub(c,n.ONE));if(!n.eql(n.sqr(d),s))throw new Error("Cannot find square root");return d}}return C0(r)}const k0=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function T0(r){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},t=k0.reduce((n,s)=>(n[s]="function",n),e);return hn(r,t)}function S0(r,e,t){if(t<le)throw new Error("Expected power > 0");if(t===le)return r.ONE;if(t===ie)return e;let n=r.ONE,s=e;for(;t>le;)t&ie&&(n=r.mul(n,s)),s=r.sqr(s),t>>=ie;return n}function O0(r,e){const t=new Array(e.length),n=e.reduce((a,i,o)=>r.is0(i)?a:(t[o]=a,r.mul(a,i)),r.ONE),s=r.inv(n);return e.reduceRight((a,i,o)=>r.is0(i)?a:(t[o]=r.mul(a,t[o]),r.mul(a,i)),s),t}function mo(r,e){const t=e!==void 0?e:r.toString(2).length,n=Math.ceil(t/8);return{nBitLength:t,nByteLength:n}}function B0(r,e,t=!1,n={}){if(r<=le)throw new Error(`Expected Field ORDER > 0, got ${r}`);const{nBitLength:s,nByteLength:a}=mo(r,e);if(a>2048)throw new Error("Field lengths over 2048 bytes are not supported");const i=P0(r),o=Object.freeze({ORDER:r,BITS:s,BYTES:a,MASK:Qs(s),ZERO:le,ONE:ie,create:c=>me(c,r),isValid:c=>{if(typeof c!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof c}`);return le<=c&&c<r},is0:c=>c===le,isOdd:c=>(c&ie)===ie,neg:c=>me(-c,r),eql:(c,d)=>c===d,sqr:c=>me(c*c,r),add:(c,d)=>me(c+d,r),sub:(c,d)=>me(c-d,r),mul:(c,d)=>me(c*d,r),pow:(c,d)=>S0(o,c,d),div:(c,d)=>me(c*Is(d,r),r),sqrN:c=>c*c,addN:(c,d)=>c+d,subN:(c,d)=>c-d,mulN:(c,d)=>c*d,inv:c=>Is(c,r),sqrt:n.sqrt||(c=>i(o,c)),invertBatch:c=>O0(o,c),cmov:(c,d,f)=>f?d:c,toBytes:c=>t?zs(c,a):Fr(c,a),fromBytes:c=>{if(c.length!==a)throw new Error(`Fp.fromBytes: expected ${a}, got ${c.length}`);return t?Vs(c):Wt(c)}});return Object.freeze(o)}function yo(r){if(typeof r!="bigint")throw new Error("field order must be bigint");const e=r.toString(2).length;return Math.ceil(e/8)}function wo(r){const e=yo(r);return e+Math.ceil(e/2)}function R0(r,e,t=!1){const n=r.length,s=yo(e),a=wo(e);if(n<16||n<a||n>1024)throw new Error(`expected ${a}-1024 bytes of input, got ${n}`);const i=t?Wt(r):Vs(r),o=me(i,e-ie)+ie;return t?zs(o,s):Fr(o,s)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const U0=BigInt(0),fs=BigInt(1);function F0(r,e){const t=(s,a)=>{const i=a.negate();return s?i:a},n=s=>{const a=Math.ceil(e/s)+1,i=2**(s-1);return{windows:a,windowSize:i}};return{constTimeNegate:t,unsafeLadder(s,a){let i=r.ZERO,o=s;for(;a>U0;)a&fs&&(i=i.add(o)),o=o.double(),a>>=fs;return i},precomputeWindow(s,a){const{windows:i,windowSize:o}=n(a),c=[];let d=s,f=d;for(let u=0;u<i;u++){f=d,c.push(f);for(let h=1;h<o;h++)f=f.add(d),c.push(f);d=f.double()}return c},wNAF(s,a,i){const{windows:o,windowSize:c}=n(s);let d=r.ZERO,f=r.BASE;const u=BigInt(2**s-1),h=2**s,y=BigInt(s);for(let x=0;x<o;x++){const p=x*c;let g=Number(i&u);i>>=y,g>c&&(g-=h,i+=fs);const m=p,A=p+Math.abs(g)-1,N=x%2!==0,I=g<0;g===0?f=f.add(t(N,a[m])):d=d.add(t(I,a[A]))}return{p:d,f}},wNAFCached(s,a,i,o){const c=s._WINDOW_SIZE||1;let d=a.get(s);return d||(d=this.precomputeWindow(s,c),c!==1&&a.set(s,o(d))),this.wNAF(c,d,i)}}}function Ao(r){return T0(r.Fp),hn(r,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...mo(r.n,r.nBitLength),...r,p:r.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function D0(r){const e=Ao(r);hn(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:t,Fp:n,a:s}=e;if(t){if(!n.eql(s,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof t!="object"||typeof t.beta!="bigint"||typeof t.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}const{bytesToNumberBE:L0,hexToBytes:M0}=N0,Dt={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(r){const{Err:e}=Dt;if(r.length<2||r[0]!==2)throw new e("Invalid signature integer tag");const t=r[1],n=r.subarray(2,t+2);if(!t||n.length!==t)throw new e("Invalid signature integer: wrong length");if(n[0]&128)throw new e("Invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new e("Invalid signature integer: unnecessary leading zero");return{d:L0(n),l:r.subarray(t+2)}},toSig(r){const{Err:e}=Dt,t=typeof r=="string"?M0(r):r;if(!(t instanceof Uint8Array))throw new Error("ui8a expected");let n=t.length;if(n<2||t[0]!=48)throw new e("Invalid signature tag");if(t[1]!==n-2)throw new e("Invalid signature: incorrect length");const{d:s,l:a}=Dt._parseInt(t.subarray(2)),{d:i,l:o}=Dt._parseInt(a);if(o.length)throw new e("Invalid signature: left bytes after parsing");return{r:s,s:i}},hexFromSig(r){const e=d=>Number.parseInt(d[0],16)&8?"00"+d:d,t=d=>{const f=d.toString(16);return f.length&1?`0${f}`:f},n=e(t(r.s)),s=e(t(r.r)),a=n.length/2,i=s.length/2,o=t(a),c=t(i);return`30${t(i+a+4)}02${c}${s}02${o}${n}`}},it=BigInt(0),Oe=BigInt(1);BigInt(2);const Ia=BigInt(3);BigInt(4);function j0(r){const e=D0(r),{Fp:t}=e,n=e.toBytes||((x,p,g)=>{const m=p.toAffine();return qr(Uint8Array.from([4]),t.toBytes(m.x),t.toBytes(m.y))}),s=e.fromBytes||(x=>{const p=x.subarray(1),g=t.fromBytes(p.subarray(0,t.BYTES)),m=t.fromBytes(p.subarray(t.BYTES,2*t.BYTES));return{x:g,y:m}});function a(x){const{a:p,b:g}=e,m=t.sqr(x),A=t.mul(m,x);return t.add(t.add(A,t.mul(x,p)),g)}if(!t.eql(t.sqr(e.Gy),a(e.Gx)))throw new Error("bad generator point: equation left != right");function i(x){return typeof x=="bigint"&&it<x&&x<e.n}function o(x){if(!i(x))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function c(x){const{allowedPrivateKeyLengths:p,nByteLength:g,wrapPrivateKey:m,n:A}=e;if(p&&typeof x!="bigint"){if(x instanceof Uint8Array&&(x=Rr(x)),typeof x!="string"||!p.includes(x.length))throw new Error("Invalid key");x=x.padStart(g*2,"0")}let N;try{N=typeof x=="bigint"?x:Wt(De("private key",x,g))}catch{throw new Error(`private key must be ${g} bytes, hex or bigint, not ${typeof x}`)}return m&&(N=me(N,A)),o(N),N}const d=new Map;function f(x){if(!(x instanceof u))throw new Error("ProjectivePoint expected")}class u{constructor(p,g,m){if(this.px=p,this.py=g,this.pz=m,p==null||!t.isValid(p))throw new Error("x required");if(g==null||!t.isValid(g))throw new Error("y required");if(m==null||!t.isValid(m))throw new Error("z required")}static fromAffine(p){const{x:g,y:m}=p||{};if(!p||!t.isValid(g)||!t.isValid(m))throw new Error("invalid affine point");if(p instanceof u)throw new Error("projective point not allowed");const A=N=>t.eql(N,t.ZERO);return A(g)&&A(m)?u.ZERO:new u(g,m,t.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(p){const g=t.invertBatch(p.map(m=>m.pz));return p.map((m,A)=>m.toAffine(g[A])).map(u.fromAffine)}static fromHex(p){const g=u.fromAffine(s(De("pointHex",p)));return g.assertValidity(),g}static fromPrivateKey(p){return u.BASE.multiply(c(p))}_setWindowSize(p){this._WINDOW_SIZE=p,d.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!t.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:p,y:g}=this.toAffine();if(!t.isValid(p)||!t.isValid(g))throw new Error("bad point: x or y not FE");const m=t.sqr(g),A=a(p);if(!t.eql(m,A))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:p}=this.toAffine();if(t.isOdd)return!t.isOdd(p);throw new Error("Field doesn't support isOdd")}equals(p){f(p);const{px:g,py:m,pz:A}=this,{px:N,py:I,pz:E}=p,C=t.eql(t.mul(g,E),t.mul(N,A)),O=t.eql(t.mul(m,E),t.mul(I,A));return C&&O}negate(){return new u(this.px,t.neg(this.py),this.pz)}double(){const{a:p,b:g}=e,m=t.mul(g,Ia),{px:A,py:N,pz:I}=this;let E=t.ZERO,C=t.ZERO,O=t.ZERO,P=t.mul(A,A),D=t.mul(N,N),j=t.mul(I,I),M=t.mul(A,N);return M=t.add(M,M),O=t.mul(A,I),O=t.add(O,O),E=t.mul(p,O),C=t.mul(m,j),C=t.add(E,C),E=t.sub(D,C),C=t.add(D,C),C=t.mul(E,C),E=t.mul(M,E),O=t.mul(m,O),j=t.mul(p,j),M=t.sub(P,j),M=t.mul(p,M),M=t.add(M,O),O=t.add(P,P),P=t.add(O,P),P=t.add(P,j),P=t.mul(P,M),C=t.add(C,P),j=t.mul(N,I),j=t.add(j,j),P=t.mul(j,M),E=t.sub(E,P),O=t.mul(j,D),O=t.add(O,O),O=t.add(O,O),new u(E,C,O)}add(p){f(p);const{px:g,py:m,pz:A}=this,{px:N,py:I,pz:E}=p;let C=t.ZERO,O=t.ZERO,P=t.ZERO;const D=e.a,j=t.mul(e.b,Ia);let M=t.mul(g,N),J=t.mul(m,I),L=t.mul(A,E),X=t.add(g,m),S=t.add(N,I);X=t.mul(X,S),S=t.add(M,J),X=t.sub(X,S),S=t.add(g,A);let B=t.add(N,E);return S=t.mul(S,B),B=t.add(M,L),S=t.sub(S,B),B=t.add(m,A),C=t.add(I,E),B=t.mul(B,C),C=t.add(J,L),B=t.sub(B,C),P=t.mul(D,S),C=t.mul(j,L),P=t.add(C,P),C=t.sub(J,P),P=t.add(J,P),O=t.mul(C,P),J=t.add(M,M),J=t.add(J,M),L=t.mul(D,L),S=t.mul(j,S),J=t.add(J,L),L=t.sub(M,L),L=t.mul(D,L),S=t.add(S,L),M=t.mul(J,S),O=t.add(O,M),M=t.mul(B,S),C=t.mul(X,C),C=t.sub(C,M),M=t.mul(X,J),P=t.mul(B,P),P=t.add(P,M),new u(C,O,P)}subtract(p){return this.add(p.negate())}is0(){return this.equals(u.ZERO)}wNAF(p){return y.wNAFCached(this,d,p,g=>{const m=t.invertBatch(g.map(A=>A.pz));return g.map((A,N)=>A.toAffine(m[N])).map(u.fromAffine)})}multiplyUnsafe(p){const g=u.ZERO;if(p===it)return g;if(o(p),p===Oe)return this;const{endo:m}=e;if(!m)return y.unsafeLadder(this,p);let{k1neg:A,k1:N,k2neg:I,k2:E}=m.splitScalar(p),C=g,O=g,P=this;for(;N>it||E>it;)N&Oe&&(C=C.add(P)),E&Oe&&(O=O.add(P)),P=P.double(),N>>=Oe,E>>=Oe;return A&&(C=C.negate()),I&&(O=O.negate()),O=new u(t.mul(O.px,m.beta),O.py,O.pz),C.add(O)}multiply(p){o(p);let g=p,m,A;const{endo:N}=e;if(N){const{k1neg:I,k1:E,k2neg:C,k2:O}=N.splitScalar(g);let{p:P,f:D}=this.wNAF(E),{p:j,f:M}=this.wNAF(O);P=y.constTimeNegate(I,P),j=y.constTimeNegate(C,j),j=new u(t.mul(j.px,N.beta),j.py,j.pz),m=P.add(j),A=D.add(M)}else{const{p:I,f:E}=this.wNAF(g);m=I,A=E}return u.normalizeZ([m,A])[0]}multiplyAndAddUnsafe(p,g,m){const A=u.BASE,N=(E,C)=>C===it||C===Oe||!E.equals(A)?E.multiplyUnsafe(C):E.multiply(C),I=N(this,g).add(N(p,m));return I.is0()?void 0:I}toAffine(p){const{px:g,py:m,pz:A}=this,N=this.is0();p==null&&(p=N?t.ONE:t.inv(A));const I=t.mul(g,p),E=t.mul(m,p),C=t.mul(A,p);if(N)return{x:t.ZERO,y:t.ZERO};if(!t.eql(C,t.ONE))throw new Error("invZ was invalid");return{x:I,y:E}}isTorsionFree(){const{h:p,isTorsionFree:g}=e;if(p===Oe)return!0;if(g)return g(u,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:p,clearCofactor:g}=e;return p===Oe?this:g?g(u,this):this.multiplyUnsafe(e.h)}toRawBytes(p=!0){return this.assertValidity(),n(u,this,p)}toHex(p=!0){return Rr(this.toRawBytes(p))}}u.BASE=new u(e.Gx,e.Gy,t.ONE),u.ZERO=new u(t.ZERO,t.ONE,t.ZERO);const h=e.nBitLength,y=F0(u,e.endo?Math.ceil(h/2):h);return{CURVE:e,ProjectivePoint:u,normPrivateKeyToScalar:c,weierstrassEquation:a,isWithinCurveOrder:i}}function G0(r){const e=Ao(r);return hn(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function _0(r){const e=G0(r),{Fp:t,n}=e,s=t.BYTES+1,a=2*t.BYTES+1;function i(S){return it<S&&S<t.ORDER}function o(S){return me(S,n)}function c(S){return Is(S,n)}const{ProjectivePoint:d,normPrivateKeyToScalar:f,weierstrassEquation:u,isWithinCurveOrder:h}=j0({...e,toBytes(S,B,G){const z=B.toAffine(),V=t.toBytes(z.x),q=qr;return G?q(Uint8Array.from([B.hasEvenY()?2:3]),V):q(Uint8Array.from([4]),V,t.toBytes(z.y))},fromBytes(S){const B=S.length,G=S[0],z=S.subarray(1);if(B===s&&(G===2||G===3)){const V=Wt(z);if(!i(V))throw new Error("Point is not on curve");const q=u(V);let se=t.sqrt(q);const ue=(se&Oe)===Oe;return(G&1)===1!==ue&&(se=t.neg(se)),{x:V,y:se}}else if(B===a&&G===4){const V=t.fromBytes(z.subarray(0,t.BYTES)),q=t.fromBytes(z.subarray(t.BYTES,2*t.BYTES));return{x:V,y:q}}else throw new Error(`Point of length ${B} was invalid. Expected ${s} compressed bytes or ${a} uncompressed bytes`)}}),y=S=>Rr(Fr(S,e.nByteLength));function x(S){const B=n>>Oe;return S>B}function p(S){return x(S)?o(-S):S}const g=(S,B,G)=>Wt(S.slice(B,G));class m{constructor(B,G,z){this.r=B,this.s=G,this.recovery=z,this.assertValidity()}static fromCompact(B){const G=e.nByteLength;return B=De("compactSignature",B,G*2),new m(g(B,0,G),g(B,G,2*G))}static fromDER(B){const{r:G,s:z}=Dt.toSig(De("DER",B));return new m(G,z)}assertValidity(){if(!h(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!h(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(B){return new m(this.r,this.s,B)}recoverPublicKey(B){const{r:G,s:z,recovery:V}=this,q=O(De("msgHash",B));if(V==null||![0,1,2,3].includes(V))throw new Error("recovery id invalid");const se=V===2||V===3?G+e.n:G;if(se>=t.ORDER)throw new Error("recovery id 2 or 3 invalid");const ue=V&1?"03":"02",ft=d.fromHex(ue+y(se)),ut=c(se),sr=o(-q*ut),Lr=o(z*ut),ht=d.BASE.multiplyAndAddUnsafe(ft,sr,Lr);if(!ht)throw new Error("point at infinify");return ht.assertValidity(),ht}hasHighS(){return x(this.s)}normalizeS(){return this.hasHighS()?new m(this.r,o(-this.s),this.recovery):this}toDERRawBytes(){return Ur(this.toDERHex())}toDERHex(){return Dt.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Ur(this.toCompactHex())}toCompactHex(){return y(this.r)+y(this.s)}}const A={isValidPrivateKey(S){try{return f(S),!0}catch{return!1}},normPrivateKeyToScalar:f,randomPrivateKey:()=>{const S=wo(e.n);return R0(e.randomBytes(S),e.n)},precompute(S=8,B=d.BASE){return B._setWindowSize(S),B.multiply(BigInt(3)),B}};function N(S,B=!0){return d.fromPrivateKey(S).toRawBytes(B)}function I(S){const B=S instanceof Uint8Array,G=typeof S=="string",z=(B||G)&&S.length;return B?z===s||z===a:G?z===2*s||z===2*a:S instanceof d}function E(S,B,G=!0){if(I(S))throw new Error("first arg must be private key");if(!I(B))throw new Error("second arg must be public key");return d.fromHex(B).multiply(f(S)).toRawBytes(G)}const C=e.bits2int||function(S){const B=Wt(S),G=S.length*8-e.nBitLength;return G>0?B>>BigInt(G):B},O=e.bits2int_modN||function(S){return o(C(S))},P=Qs(e.nBitLength);function D(S){if(typeof S!="bigint")throw new Error("bigint expected");if(!(it<=S&&S<P))throw new Error(`bigint expected < 2^${e.nBitLength}`);return Fr(S,e.nByteLength)}function j(S,B,G=M){if(["recovered","canonical"].some(St=>St in G))throw new Error("sign() legacy options not supported");const{hash:z,randomBytes:V}=e;let{lowS:q,prehash:se,extraEntropy:ue}=G;q==null&&(q=!0),S=De("msgHash",S),se&&(S=De("prehashed msgHash",z(S)));const ft=O(S),ut=f(B),sr=[D(ut),D(ft)];if(ue!=null){const St=ue===!0?V(t.BYTES):ue;sr.push(De("extraEntropy",St))}const Lr=qr(...sr),ht=ft;function ss(St){const ar=C(St);if(!h(ar))return;const ta=c(ar),ir=d.BASE.multiply(ar).toAffine(),Ue=o(ir.x);if(Ue===it)return;const or=o(ta*o(ht+Ue*ut));if(or===it)return;let ra=(ir.x===Ue?0:2)|Number(ir.y&Oe),na=or;return q&&x(or)&&(na=p(or),ra^=1),new m(Ue,na,ra)}return{seed:Lr,k2sig:ss}}const M={lowS:e.lowS,prehash:!1},J={lowS:e.lowS,prehash:!1};function L(S,B,G=M){const{seed:z,k2sig:V}=j(S,B,G),q=e;return go(q.hash.outputLen,q.nByteLength,q.hmac)(z,V)}d.BASE._setWindowSize(8);function X(S,B,G,z=J){var ir;const V=S;if(B=De("msgHash",B),G=De("publicKey",G),"strict"in z)throw new Error("options.strict was renamed to lowS");const{lowS:q,prehash:se}=z;let ue,ft;try{if(typeof V=="string"||V instanceof Uint8Array)try{ue=m.fromDER(V)}catch(Ue){if(!(Ue instanceof Dt.Err))throw Ue;ue=m.fromCompact(V)}else if(typeof V=="object"&&typeof V.r=="bigint"&&typeof V.s=="bigint"){const{r:Ue,s:or}=V;ue=new m(Ue,or)}else throw new Error("PARSE");ft=d.fromHex(G)}catch(Ue){if(Ue.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(q&&ue.hasHighS())return!1;se&&(B=e.hash(B));const{r:ut,s:sr}=ue,Lr=O(B),ht=c(sr),ss=o(Lr*ht),St=o(ut*ht),ar=(ir=d.BASE.multiplyAndAddUnsafe(ft,ss,St))==null?void 0:ir.toAffine();return ar?o(ar.x)===ut:!1}return{CURVE:e,getPublicKey:N,getSharedSecret:E,sign:L,verify:X,ProjectivePoint:d,Signature:m,utils:A}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function H0(r){return{hash:r,hmac:(e,...t)=>Vn(r,e,xl(...t)),randomBytes:bl}}function K0(r,e){const t=n=>_0({...r,...H0(n)});return Object.freeze({...t(e),create:t})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Eo=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),Ca=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),V0=BigInt(1),Cs=BigInt(2),Pa=(r,e)=>(r+e/Cs)/e;function z0(r){const e=Eo,t=BigInt(3),n=BigInt(6),s=BigInt(11),a=BigInt(22),i=BigInt(23),o=BigInt(44),c=BigInt(88),d=r*r*r%e,f=d*d*r%e,u=Te(f,t,e)*f%e,h=Te(u,t,e)*f%e,y=Te(h,Cs,e)*d%e,x=Te(y,s,e)*y%e,p=Te(x,a,e)*x%e,g=Te(p,o,e)*p%e,m=Te(g,c,e)*g%e,A=Te(m,o,e)*p%e,N=Te(A,t,e)*f%e,I=Te(N,i,e)*x%e,E=Te(I,n,e)*d%e,C=Te(E,Cs,e);if(!Ps.eql(Ps.sqr(C),r))throw new Error("Cannot find square root");return C}const Ps=B0(Eo,void 0,void 0,{sqrt:z0}),Q0=K0({a:BigInt(0),b:BigInt(7),Fp:Ps,n:Ca,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:r=>{const e=Ca,t=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-V0*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),s=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),a=t,i=BigInt("0x100000000000000000000000000000000"),o=Pa(a*r,e),c=Pa(-n*r,e);let d=me(r-o*t-c*s,e),f=me(-o*n-c*a,e);const u=d>i,h=f>i;if(u&&(d=e-d),h&&(f=e-f),d>i||f>i)throw new Error("splitScalar: Endomorphism failed, k="+r);return{k1neg:u,k1:d,k2neg:h,k2:f}}}},Dr);BigInt(0);Q0.ProjectivePoint;const ka="0x0000000000000000000000000000000000000000000000000000000000000000";const Ta=BigInt(0),Sa=BigInt(1),Oa=BigInt(2),Ba=BigInt(27),Ra=BigInt(28),En=BigInt(35),lr={};function Ua(r){return gi(Us(r),32)}var Ir,ze,Cr,$t;const Fe=class Fe{constructor(e,t,n,s){F(this,Ir);F(this,ze);F(this,Cr);F(this,$t);jn(e,lr,"Signature"),k(this,Ir,t),k(this,ze,n),k(this,Cr,s),k(this,$t,null)}get r(){return b(this,Ir)}set r(e){v(la(e)===32,"invalid r","value",e),k(this,Ir,K(e))}get s(){return v(parseInt(b(this,ze).substring(0,3))<8,"non-canonical s; use ._s","s",b(this,ze)),b(this,ze)}set s(e){v(la(e)===32,"invalid s","value",e),k(this,ze,K(e))}get _s(){return b(this,ze)}isValid(){return parseInt(b(this,ze).substring(0,3))<8}get v(){return b(this,Cr)}set v(e){const t=re(e,"value");v(t===27||t===28,"invalid v","v",e),k(this,Cr,t)}get networkV(){return b(this,$t)}get legacyChainId(){const e=this.networkV;return e==null?null:Fe.getChainId(e)}get yParity(){return this.v===27?0:1}get yParityAndS(){const e=Y(this.s);return this.yParity&&(e[0]|=128),K(e)}get compactSerialized(){return It([this.r,this.yParityAndS])}get serialized(){return It([this.r,this.s,this.yParity?"0x1c":"0x1b"])}[Symbol.for("nodejs.util.inspect.custom")](){return`Signature { r: "${this.r}", s: "${this._s}"${this.isValid()?"":', valid: "false"'}, yParity: ${this.yParity}, networkV: ${this.networkV} }`}clone(){const e=new Fe(lr,this.r,this._s,this.v);return this.networkV&&k(e,$t,this.networkV),e}toJSON(){const e=this.networkV;return{_type:"signature",networkV:e!=null?e.toString():null,r:this.r,s:this._s,v:this.v}}static getChainId(e){const t=te(e,"v");return t==Ba||t==Ra?Ta:(v(t>=En,"invalid EIP-155 v","v",e),(t-En)/Oa)}static getChainIdV(e,t){return te(e)*Oa+BigInt(35+t-27)}static getNormalizedV(e){const t=te(e);return t===Ta||t===Ba?27:t===Sa||t===Ra?28:(v(t>=En,"invalid v","v",e),t&Sa?27:28)}static from(e){function t(d,f){v(d,f,"signature",e)}if(e==null)return new Fe(lr,ka,ka,27);if(typeof e=="string"){const d=Y(e,"signature");if(d.length===64){const f=K(d.slice(0,32)),u=d.slice(32,64),h=u[0]&128?28:27;return u[0]&=127,new Fe(lr,f,K(u),h)}if(d.length===65){const f=K(d.slice(0,32)),u=K(d.slice(32,64)),h=Fe.getNormalizedV(d[64]);return new Fe(lr,f,u,h)}t(!1,"invalid raw signature length")}if(e instanceof Fe)return e.clone();const n=e.r;t(n!=null,"missing r");const s=Ua(n),a=function(d,f){if(d!=null)return Ua(d);if(f!=null){t(Ae(f,32),"invalid yParityAndS");const u=Y(f);return u[0]&=127,K(u)}t(!1,"missing s")}(e.s,e.yParityAndS),{networkV:i,v:o}=function(d,f,u){if(d!=null){const h=te(d);return{networkV:h>=En?h:void 0,v:Fe.getNormalizedV(h)}}if(f!=null)return t(Ae(f,32),"invalid yParityAndS"),{v:Y(f)[0]&128?28:27};if(u!=null){switch(re(u,"sig.yParity")){case 0:return{v:27};case 1:return{v:28}}t(!1,"invalid yParity")}t(!1,"missing v")}(e.v,e.yParityAndS,e.yParity),c=new Fe(lr,s,a,o);return i&&k(c,$t,i),t(e.yParity==null||re(e.yParity,"sig.yParity")===c.yParity,"yParity mismatch"),t(e.yParityAndS==null||e.yParityAndS===c.yParityAndS,"yParityAndS mismatch"),c}};Ir=new WeakMap,ze=new WeakMap,Cr=new WeakMap,$t=new WeakMap;let Fa=Fe;const $0=BigInt(0),J0=BigInt(36);function Da(r){r=r.toLowerCase();const e=r.substring(2).split(""),t=new Uint8Array(40);for(let s=0;s<40;s++)t[s]=e[s].charCodeAt(0);const n=Y(kt(t));for(let s=0;s<40;s+=2)n[s>>1]>>4>=8&&(e[s]=e[s].toUpperCase()),(n[s>>1]&15)>=8&&(e[s+1]=e[s+1].toUpperCase());return"0x"+e.join("")}const $s={};for(let r=0;r<10;r++)$s[String(r)]=String(r);for(let r=0;r<26;r++)$s[String.fromCharCode(65+r)]=String(10+r);const La=15;function W0(r){r=r.toUpperCase(),r=r.substring(4)+r.substring(0,2)+"00";let e=r.split("").map(n=>$s[n]).join("");for(;e.length>=La;){let n=e.substring(0,La);e=parseInt(n,10)%97+e.substring(n.length)}let t=String(98-parseInt(e,10)%97);for(;t.length<2;)t="0"+t;return t}const Z0=function(){const r={};for(let e=0;e<36;e++){const t="0123456789abcdefghijklmnopqrstuvwxyz"[e];r[t]=BigInt(e)}return r}();function Y0(r){r=r.toLowerCase();let e=$0;for(let t=0;t<r.length;t++)e=e*J0+Z0[r[t]];return e}function Ee(r){if(v(typeof r=="string","invalid address","address",r),r.match(/^(0x)?[0-9a-fA-F]{40}$/)){r.startsWith("0x")||(r="0x"+r);const e=Da(r);return v(!r.match(/([A-F].*[a-f])|([a-f].*[A-F])/)||e===r,"bad address checksum","address",r),e}if(r.match(/^XE[0-9]{2}[0-9A-Za-z]{30,31}$/)){v(r.substring(2,4)===W0(r),"bad icap checksum","address",r);let e=Y0(r.substring(4)).toString(16);for(;e.length<40;)e="0"+e;return Da("0x"+e)}v(!1,"invalid address","address",r)}function No(r){return r&&typeof r.getAddress=="function"}async function us(r,e){const t=await e;return(t==null||t==="0x0000000000000000000000000000000000000000")&&(U(typeof r!="string","unconfigured name","UNCONFIGURED_NAME",{value:r}),v(!1,"invalid AddressLike value; did not resolve to a value address","target",r)),Ee(t)}function en(r,e){if(typeof r=="string")return r.match(/^0x[0-9a-f]{40}$/i)?Ee(r):(U(e!=null,"ENS resolution requires a provider","UNSUPPORTED_OPERATION",{operation:"resolveName"}),us(r,e.resolveName(r)));if(No(r))return us(r,r.getAddress());if(r&&typeof r.then=="function")return us(r,r);v(!1,"unsupported addressable value","target",r)}const et={};function R(r,e){let t=!1;return e<0&&(t=!0,e*=-1),new xe(et,`${t?"":"u"}int${e}`,r,{signed:t,width:e})}function $(r,e){return new xe(et,`bytes${e||""}`,r,{size:e})}const Ma=Symbol.for("_ethers_typed");var Jt;const tt=class tt{constructor(e,t,n,s){w(this,"type");w(this,"value");F(this,Jt);w(this,"_typedSymbol");s==null&&(s=null),jn(et,e,"Typed"),H(this,{_typedSymbol:Ma,type:t,value:n}),k(this,Jt,s),this.format()}format(){if(this.type==="array")throw new Error("");if(this.type==="dynamicArray")throw new Error("");return this.type==="tuple"?`tuple(${this.value.map(e=>e.format()).join(",")})`:this.type}defaultValue(){return 0}minValue(){return 0}maxValue(){return 0}isBigInt(){return!!this.type.match(/^u?int[0-9]+$/)}isData(){return this.type.startsWith("bytes")}isString(){return this.type==="string"}get tupleName(){if(this.type!=="tuple")throw TypeError("not a tuple");return b(this,Jt)}get arrayLength(){if(this.type!=="array")throw TypeError("not an array");return b(this,Jt)===!0?-1:b(this,Jt)===!1?this.value.length:null}static from(e,t){return new tt(et,e,t)}static uint8(e){return R(e,8)}static uint16(e){return R(e,16)}static uint24(e){return R(e,24)}static uint32(e){return R(e,32)}static uint40(e){return R(e,40)}static uint48(e){return R(e,48)}static uint56(e){return R(e,56)}static uint64(e){return R(e,64)}static uint72(e){return R(e,72)}static uint80(e){return R(e,80)}static uint88(e){return R(e,88)}static uint96(e){return R(e,96)}static uint104(e){return R(e,104)}static uint112(e){return R(e,112)}static uint120(e){return R(e,120)}static uint128(e){return R(e,128)}static uint136(e){return R(e,136)}static uint144(e){return R(e,144)}static uint152(e){return R(e,152)}static uint160(e){return R(e,160)}static uint168(e){return R(e,168)}static uint176(e){return R(e,176)}static uint184(e){return R(e,184)}static uint192(e){return R(e,192)}static uint200(e){return R(e,200)}static uint208(e){return R(e,208)}static uint216(e){return R(e,216)}static uint224(e){return R(e,224)}static uint232(e){return R(e,232)}static uint240(e){return R(e,240)}static uint248(e){return R(e,248)}static uint256(e){return R(e,256)}static uint(e){return R(e,256)}static int8(e){return R(e,-8)}static int16(e){return R(e,-16)}static int24(e){return R(e,-24)}static int32(e){return R(e,-32)}static int40(e){return R(e,-40)}static int48(e){return R(e,-48)}static int56(e){return R(e,-56)}static int64(e){return R(e,-64)}static int72(e){return R(e,-72)}static int80(e){return R(e,-80)}static int88(e){return R(e,-88)}static int96(e){return R(e,-96)}static int104(e){return R(e,-104)}static int112(e){return R(e,-112)}static int120(e){return R(e,-120)}static int128(e){return R(e,-128)}static int136(e){return R(e,-136)}static int144(e){return R(e,-144)}static int152(e){return R(e,-152)}static int160(e){return R(e,-160)}static int168(e){return R(e,-168)}static int176(e){return R(e,-176)}static int184(e){return R(e,-184)}static int192(e){return R(e,-192)}static int200(e){return R(e,-200)}static int208(e){return R(e,-208)}static int216(e){return R(e,-216)}static int224(e){return R(e,-224)}static int232(e){return R(e,-232)}static int240(e){return R(e,-240)}static int248(e){return R(e,-248)}static int256(e){return R(e,-256)}static int(e){return R(e,-256)}static bytes1(e){return $(e,1)}static bytes2(e){return $(e,2)}static bytes3(e){return $(e,3)}static bytes4(e){return $(e,4)}static bytes5(e){return $(e,5)}static bytes6(e){return $(e,6)}static bytes7(e){return $(e,7)}static bytes8(e){return $(e,8)}static bytes9(e){return $(e,9)}static bytes10(e){return $(e,10)}static bytes11(e){return $(e,11)}static bytes12(e){return $(e,12)}static bytes13(e){return $(e,13)}static bytes14(e){return $(e,14)}static bytes15(e){return $(e,15)}static bytes16(e){return $(e,16)}static bytes17(e){return $(e,17)}static bytes18(e){return $(e,18)}static bytes19(e){return $(e,19)}static bytes20(e){return $(e,20)}static bytes21(e){return $(e,21)}static bytes22(e){return $(e,22)}static bytes23(e){return $(e,23)}static bytes24(e){return $(e,24)}static bytes25(e){return $(e,25)}static bytes26(e){return $(e,26)}static bytes27(e){return $(e,27)}static bytes28(e){return $(e,28)}static bytes29(e){return $(e,29)}static bytes30(e){return $(e,30)}static bytes31(e){return $(e,31)}static bytes32(e){return $(e,32)}static address(e){return new tt(et,"address",e)}static bool(e){return new tt(et,"bool",!!e)}static bytes(e){return new tt(et,"bytes",e)}static string(e){return new tt(et,"string",e)}static array(e,t){throw new Error("not implemented yet")}static tuple(e,t){throw new Error("not implemented yet")}static overrides(e){return new tt(et,"overrides",Object.assign({},e))}static isTyped(e){return e&&typeof e=="object"&&"_typedSymbol"in e&&e._typedSymbol===Ma}static dereference(e,t){if(tt.isTyped(e)){if(e.type!==t)throw new Error(`invalid type: expecetd ${t}, got ${e.type}`);return e.value}return e}};Jt=new WeakMap;let xe=tt;class X0 extends dt{constructor(e){super("address","address",e,!1)}defaultValue(){return"0x0000000000000000000000000000000000000000"}encode(e,t){let n=xe.dereference(t,"string");try{n=Ee(n)}catch(s){return this._throwError(s.message,t)}return e.writeValue(n)}decode(e){return Ee(Hn(e.readValue(),20))}}class q0 extends dt{constructor(t){super(t.name,t.type,"_",t.dynamic);w(this,"coder");this.coder=t}defaultValue(){return this.coder.defaultValue()}encode(t,n){return this.coder.encode(t,n)}decode(t){return this.coder.decode(t)}}function vo(r,e,t){let n=[];if(Array.isArray(t))n=t;else if(t&&typeof t=="object"){let c={};n=e.map(d=>{const f=d.localName;return U(f,"cannot encode object for signature with missing names","INVALID_ARGUMENT",{argument:"values",info:{coder:d},value:t}),U(!c[f],"cannot encode object for signature with duplicate names","INVALID_ARGUMENT",{argument:"values",info:{coder:d},value:t}),c[f]=!0,t[f]})}else v(!1,"invalid tuple value","tuple",t);v(e.length===n.length,"types/value length mismatch","tuple",t);let s=new ws,a=new ws,i=[];e.forEach((c,d)=>{let f=n[d];if(c.dynamic){let u=a.length;c.encode(a,f);let h=s.writeUpdatableValue();i.push(y=>{h(y+u)})}else c.encode(s,f)}),i.forEach(c=>{c(s.length)});let o=r.appendWriter(s);return o+=r.appendWriter(a),o}function Io(r,e){let t=[],n=[],s=r.subReader(0);return e.forEach(a=>{let i=null;if(a.dynamic){let o=r.readIndex(),c=s.subReader(o);try{i=a.decode(c)}catch(d){if(Tr(d,"BUFFER_OVERRUN"))throw d;i=d,i.baseType=a.name,i.name=a.localName,i.type=a.type}}else try{i=a.decode(r)}catch(o){if(Tr(o,"BUFFER_OVERRUN"))throw o;i=o,i.baseType=a.name,i.name=a.localName,i.type=a.type}if(i==null)throw new Error("investigate");t.push(i),n.push(a.localName||null)}),Sr.fromItems(t,n)}class ed extends dt{constructor(t,n,s){const a=t.type+"["+(n>=0?n:"")+"]",i=n===-1||t.dynamic;super("array",a,s,i);w(this,"coder");w(this,"length");H(this,{coder:t,length:n})}defaultValue(){const t=this.coder.defaultValue(),n=[];for(let s=0;s<this.length;s++)n.push(t);return n}encode(t,n){const s=xe.dereference(n,"array");Array.isArray(s)||this._throwError("expected array value",s);let a=this.length;a===-1&&(a=s.length,t.writeValue(s.length)),hi(s.length,a,"coder array"+(this.localName?" "+this.localName:""));let i=[];for(let o=0;o<s.length;o++)i.push(this.coder);return vo(t,i,s)}decode(t){let n=this.length;n===-1&&(n=t.readIndex(),U(n*pe<=t.dataLength,"insufficient data length","BUFFER_OVERRUN",{buffer:t.bytes,offset:n*pe,length:t.dataLength}));let s=[];for(let a=0;a<n;a++)s.push(new q0(this.coder));return Io(t,s)}}class td extends dt{constructor(e){super("bool","bool",e,!1)}defaultValue(){return!1}encode(e,t){const n=xe.dereference(t,"bool");return e.writeValue(n?1:0)}decode(e){return!!e.readValue()}}class Co extends dt{constructor(e,t){super(e,e,t,!0)}defaultValue(){return"0x"}encode(e,t){t=Xe(t);let n=e.writeValue(t.length);return n+=e.writeBytes(t),n}decode(e){return e.readBytes(e.readIndex(),!0)}}class rd extends Co{constructor(e){super("bytes",e)}decode(e){return K(super.decode(e))}}class nd extends dt{constructor(t,n){let s="bytes"+String(t);super(s,s,n,!1);w(this,"size");H(this,{size:t},{size:"number"})}defaultValue(){return"0x0000000000000000000000000000000000000000000000000000000000000000".substring(0,2+this.size*2)}encode(t,n){let s=Xe(xe.dereference(n,this.type));return s.length!==this.size&&this._throwError("incorrect data length",n),t.writeBytes(s)}decode(t){return K(t.readBytes(this.size))}}const sd=new Uint8Array([]);class ad extends dt{constructor(e){super("null","",e,!1)}defaultValue(){return null}encode(e,t){return t!=null&&this._throwError("not null",t),e.writeBytes(sd)}decode(e){return e.readBytes(0),null}}const id=BigInt(0),od=BigInt(1),cd=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");class ld extends dt{constructor(t,n,s){const a=(n?"int":"uint")+t*8;super(a,a,s,!1);w(this,"size");w(this,"signed");H(this,{size:t,signed:n},{size:"number",signed:"boolean"})}defaultValue(){return 0}encode(t,n){let s=te(xe.dereference(n,this.type)),a=pn(cd,pe*8);if(this.signed){let i=pn(a,this.size*8-1);(s>i||s<-(i+od))&&this._throwError("value out-of-bounds",n),s=Qc(s,8*pe)}else(s<id||s>pn(a,this.size*8))&&this._throwError("value out-of-bounds",n);return t.writeValue(s)}decode(t){let n=pn(t.readValue(),this.size*8);return this.signed&&(n=zc(n,this.size*8)),n}}class dd extends Co{constructor(e){super("string",e)}defaultValue(){return""}encode(e,t){return super.encode(e,xr(xe.dereference(t,"string")))}decode(e){return gs(super.decode(e))}}class Nn extends dt{constructor(t,n){let s=!1;const a=[];t.forEach(o=>{o.dynamic&&(s=!0),a.push(o.type)});const i="tuple("+a.join(",")+")";super("tuple",i,n,s);w(this,"coders");H(this,{coders:Object.freeze(t.slice())})}defaultValue(){const t=[];this.coders.forEach(s=>{t.push(s.defaultValue())});const n=this.coders.reduce((s,a)=>{const i=a.localName;return i&&(s[i]||(s[i]=0),s[i]++),s},{});return this.coders.forEach((s,a)=>{let i=s.localName;!i||n[i]!==1||(i==="length"&&(i="_length"),t[i]==null&&(t[i]=t[a]))}),Object.freeze(t)}encode(t,n){const s=xe.dereference(n,"tuple");return vo(t,this.coders,s)}decode(t){return Io(t,this.coders)}}function hs(r,e){return{address:Ee(r),storageKeys:e.map((t,n)=>(v(Ae(t,32),"invalid slot",`storageKeys[${n}]`,t),t.toLowerCase()))}}function fd(r){if(Array.isArray(r))return r.map((t,n)=>Array.isArray(t)?(v(t.length===2,"invalid slot set",`value[${n}]`,t),hs(t[0],t[1])):(v(t!=null&&typeof t=="object","invalid address-slot set","value",r),hs(t.address,t.storageKeys)));v(r!=null&&typeof r=="object","invalid access list","value",r);const e=Object.keys(r).map(t=>{const n=r[t].reduce((s,a)=>(s[a]=!0,s),{});return hs(t,Object.keys(n).sort())});return e.sort((t,n)=>t.address.localeCompare(n.address)),e}const iu=BigInt(0),ou=BigInt(2),cu=BigInt(27),lu=BigInt(28),du=BigInt(35),fu=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),uu=4096*32;function tn(r){return kt(xr(r))}const ud=44032,hd=4352,xd=4449,pd=4519,Po=19,ko=21,To=28,bd=ko*To,gd=Po*bd,hu=ud+gd,xu=hd+Po,pu=xd+ko,bu=pd+To;const md=new Uint8Array(32);md.fill(0);const yd=new Uint8Array(32);yd.fill(0);const gu=BigInt(-1),wd=BigInt(0),Ad=BigInt(1),mu=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");const yu=Hn(Ad,32),wu=Hn(wd,32);function ja(r){return function(e){return v(typeof e=="string",`invalid domain value for ${JSON.stringify(r)}`,`domain.${r}`,e),e}}const Au={name:ja("name"),version:ja("version"),chainId:function(r){const e=te(r,"domain.chainId");return v(e>=0,"invalid chain ID","domain.chainId",r),Number.isSafeInteger(e)?Number(e):Jc(e)},verifyingContract:function(r){try{return Ee(r).toLowerCase()}catch{}v(!1,'invalid domain value "verifyingContract"',"domain.verifyingContract",r)},salt:function(r){const e=Y(r,"domain.salt");return v(e.length===32,'invalid domain value "salt"',"domain.salt",r),K(e)}};function be(r){const e=new Set;return r.forEach(t=>e.add(t)),Object.freeze(e)}const Ed="external public payable override",Nd=be(Ed.split(" ")),So="constant external internal payable private public pure view override",vd=be(So.split(" ")),Oo="constructor error event fallback function receive struct",Bo=be(Oo.split(" ")),Ro="calldata memory storage payable indexed",Id=be(Ro.split(" ")),Cd="tuple returns",Pd=[Oo,Ro,Cd,So].join(" "),kd=be(Pd.split(" ")),Td={"(":"OPEN_PAREN",")":"CLOSE_PAREN","[":"OPEN_BRACKET","]":"CLOSE_BRACKET",",":"COMMA","@":"AT"},Sd=new RegExp("^(\\s*)"),Od=new RegExp("^([0-9]+)"),Bd=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)"),Uo=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)$"),Fo=new RegExp("^(address|bool|bytes([0-9]*)|string|u?int([0-9]*))$");var de,je,cn,ks;const Ln=class Ln{constructor(e){F(this,cn);F(this,de);F(this,je);k(this,de,0),k(this,je,e.slice())}get offset(){return b(this,de)}get length(){return b(this,je).length-b(this,de)}clone(){return new Ln(b(this,je))}reset(){k(this,de,0)}popKeyword(e){const t=this.peek();if(t.type!=="KEYWORD"||!e.has(t.text))throw new Error(`expected keyword ${t.text}`);return this.pop().text}popType(e){if(this.peek().type!==e){const t=this.peek();throw new Error(`expected ${e}; got ${t.type} ${JSON.stringify(t.text)}`)}return this.pop().text}popParen(){const e=this.peek();if(e.type!=="OPEN_PAREN")throw new Error("bad start");const t=Z(this,cn,ks).call(this,b(this,de)+1,e.match+1);return k(this,de,e.match+1),t}popParams(){const e=this.peek();if(e.type!=="OPEN_PAREN")throw new Error("bad start");const t=[];for(;b(this,de)<e.match-1;){const n=this.peek().linkNext;t.push(Z(this,cn,ks).call(this,b(this,de)+1,n)),k(this,de,n)}return k(this,de,e.match+1),t}peek(){if(b(this,de)>=b(this,je).length)throw new Error("out-of-bounds");return b(this,je)[b(this,de)]}peekKeyword(e){const t=this.peekType("KEYWORD");return t!=null&&e.has(t)?t:null}peekType(e){if(this.length===0)return null;const t=this.peek();return t.type===e?t.text:null}pop(){const e=this.peek();return aa(this,de)._++,e}toString(){const e=[];for(let t=b(this,de);t<b(this,je).length;t++){const n=b(this,je)[t];e.push(`${n.type}:${n.text}`)}return`<TokenString ${e.join(" ")}>`}};de=new WeakMap,je=new WeakMap,cn=new WeakSet,ks=function(e=0,t=0){return new Ln(b(this,je).slice(e,t).map(n=>Object.freeze(Object.assign({},n,{match:n.match-e,linkBack:n.linkBack-e,linkNext:n.linkNext-e}))))};let _e=Ln;function Tt(r){const e=[],t=i=>{const o=a<r.length?JSON.stringify(r[a]):"$EOI";throw new Error(`invalid token ${o} at ${a}: ${i}`)};let n=[],s=[],a=0;for(;a<r.length;){let i=r.substring(a),o=i.match(Sd);o&&(a+=o[1].length,i=r.substring(a));const c={depth:n.length,linkBack:-1,linkNext:-1,match:-1,type:"",text:"",offset:a,value:-1};e.push(c);let d=Td[i[0]]||"";if(d){if(c.type=d,c.text=i[0],a++,d==="OPEN_PAREN")n.push(e.length-1),s.push(e.length-1);else if(d=="CLOSE_PAREN")n.length===0&&t("no matching open bracket"),c.match=n.pop(),e[c.match].match=e.length-1,c.depth--,c.linkBack=s.pop(),e[c.linkBack].linkNext=e.length-1;else if(d==="COMMA")c.linkBack=s.pop(),e[c.linkBack].linkNext=e.length-1,s.push(e.length-1);else if(d==="OPEN_BRACKET")c.type="BRACKET";else if(d==="CLOSE_BRACKET"){let f=e.pop().text;if(e.length>0&&e[e.length-1].type==="NUMBER"){const u=e.pop().text;f=u+f,e[e.length-1].value=re(u)}if(e.length===0||e[e.length-1].type!=="BRACKET")throw new Error("missing opening bracket");e[e.length-1].text+=f}continue}if(o=i.match(Bd),o){if(c.text=o[1],a+=c.text.length,kd.has(c.text)){c.type="KEYWORD";continue}if(c.text.match(Fo)){c.type="TYPE";continue}c.type="ID";continue}if(o=i.match(Od),o){c.text=o[1],c.type="NUMBER",a+=c.text.length;continue}throw new Error(`unexpected token ${JSON.stringify(i[0])} at position ${a}`)}return new _e(e.map(i=>Object.freeze(i)))}function Ga(r,e){let t=[];for(const n in e.keys())r.has(n)&&t.push(n);if(t.length>1)throw new Error(`conflicting types: ${t.join(", ")}`)}function qn(r,e){if(e.peekKeyword(Bo)){const t=e.pop().text;if(t!==r)throw new Error(`expected ${r}, got ${t}`)}return e.popType("ID")}function lt(r,e){const t=new Set;for(;;){const n=r.peekType("KEYWORD");if(n==null||e&&!e.has(n))break;if(r.pop(),t.has(n))throw new Error(`duplicate keywords: ${JSON.stringify(n)}`);t.add(n)}return Object.freeze(t)}function Do(r){let e=lt(r,vd);return Ga(e,be("constant payable nonpayable".split(" "))),Ga(e,be("pure view payable nonpayable".split(" "))),e.has("view")?"view":e.has("pure")?"pure":e.has("payable")?"payable":e.has("nonpayable")?"nonpayable":e.has("constant")?"view":"nonpayable"}function ct(r,e){return r.popParams().map(t=>fe.from(t,e))}function Lo(r){if(r.peekType("AT")){if(r.pop(),r.peekType("NUMBER"))return te(r.pop().text);throw new Error("invalid gas")}return null}function qt(r){if(r.length)throw new Error(`unexpected tokens at offset ${r.offset}: ${r.toString()}`)}const Rd=new RegExp(/^(.*)\[([0-9]*)\]$/);function _a(r){const e=r.match(Fo);if(v(e,"invalid type","type",r),r==="uint")return"uint256";if(r==="int")return"int256";if(e[2]){const t=parseInt(e[2]);v(t!==0&&t<=32,"invalid bytes length","type",r)}else if(e[3]){const t=parseInt(e[3]);v(t!==0&&t<=256&&t%8===0,"invalid numeric width","type",r)}return r}const ne={},Ne=Symbol.for("_ethers_internal"),Ha="_ParamTypeInternal",Ka="_ErrorInternal",Va="_EventInternal",za="_ConstructorInternal",Qa="_FallbackInternal",$a="_FunctionInternal",Ja="_StructInternal";var Pr,Tn;const Se=class Se{constructor(e,t,n,s,a,i,o,c){F(this,Pr);w(this,"name");w(this,"type");w(this,"baseType");w(this,"indexed");w(this,"components");w(this,"arrayLength");w(this,"arrayChildren");if(jn(e,ne,"ParamType"),Object.defineProperty(this,Ne,{value:Ha}),i&&(i=Object.freeze(i.slice())),s==="array"){if(o==null||c==null)throw new Error("")}else if(o!=null||c!=null)throw new Error("");if(s==="tuple"){if(i==null)throw new Error("")}else if(i!=null)throw new Error("");H(this,{name:t,type:n,baseType:s,indexed:a,components:i,arrayLength:o,arrayChildren:c})}format(e){if(e==null&&(e="sighash"),e==="json"){const n=this.name||"";if(this.isArray()){const a=JSON.parse(this.arrayChildren.format("json"));return a.name=n,a.type+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`,JSON.stringify(a)}const s={type:this.baseType==="tuple"?"tuple":this.type,name:n};return typeof this.indexed=="boolean"&&(s.indexed=this.indexed),this.isTuple()&&(s.components=this.components.map(a=>JSON.parse(a.format(e)))),JSON.stringify(s)}let t="";return this.isArray()?(t+=this.arrayChildren.format(e),t+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`):this.isTuple()?t+="("+this.components.map(n=>n.format(e)).join(e==="full"?", ":",")+")":t+=this.type,e!=="sighash"&&(this.indexed===!0&&(t+=" indexed"),e==="full"&&this.name&&(t+=" "+this.name)),t}isArray(){return this.baseType==="array"}isTuple(){return this.baseType==="tuple"}isIndexable(){return this.indexed!=null}walk(e,t){if(this.isArray()){if(!Array.isArray(e))throw new Error("invalid array value");if(this.arrayLength!==-1&&e.length!==this.arrayLength)throw new Error("array is wrong length");const n=this;return e.map(s=>n.arrayChildren.walk(s,t))}if(this.isTuple()){if(!Array.isArray(e))throw new Error("invalid tuple value");if(e.length!==this.components.length)throw new Error("array is wrong length");const n=this;return e.map((s,a)=>n.components[a].walk(s,t))}return t(this.type,e)}async walkAsync(e,t){const n=[],s=[e];return Z(this,Pr,Tn).call(this,n,e,t,a=>{s[0]=a}),n.length&&await Promise.all(n),s[0]}static from(e,t){if(Se.isParamType(e))return e;if(typeof e=="string")try{return Se.from(Tt(e),t)}catch{v(!1,"invalid param type","obj",e)}else if(e instanceof _e){let o="",c="",d=null;lt(e,be(["tuple"])).has("tuple")||e.peekType("OPEN_PAREN")?(c="tuple",d=e.popParams().map(p=>Se.from(p)),o=`tuple(${d.map(p=>p.format()).join(",")})`):(o=_a(e.popType("TYPE")),c=o);let f=null,u=null;for(;e.length&&e.peekType("BRACKET");){const p=e.pop();f=new Se(ne,"",o,c,null,d,u,f),u=p.value,o+=p.text,c="array",d=null}let h=null;if(lt(e,Id).has("indexed")){if(!t)throw new Error("");h=!0}const x=e.peekType("ID")?e.pop().text:"";if(e.length)throw new Error("leftover tokens");return new Se(ne,x,o,c,h,d,u,f)}const n=e.name;v(!n||typeof n=="string"&&n.match(Uo),"invalid name","obj.name",n);let s=e.indexed;s!=null&&(v(t,"parameter cannot be indexed","obj.indexed",e.indexed),s=!!s);let a=e.type,i=a.match(Rd);if(i){const o=parseInt(i[2]||"-1"),c=Se.from({type:i[1],components:e.components});return new Se(ne,n||"",a,"array",s,null,o,c)}if(a==="tuple"||a.startsWith("tuple(")||a.startsWith("(")){const o=e.components!=null?e.components.map(d=>Se.from(d)):null;return new Se(ne,n||"",a,"tuple",s,o,null,null)}return a=_a(e.type),new Se(ne,n||"",a,a,s,null,null,null)}static isParamType(e){return e&&e[Ne]===Ha}};Pr=new WeakSet,Tn=function(e,t,n,s){if(this.isArray()){if(!Array.isArray(t))throw new Error("invalid array value");if(this.arrayLength!==-1&&t.length!==this.arrayLength)throw new Error("array is wrong length");const i=this.arrayChildren,o=t.slice();o.forEach((c,d)=>{var f;Z(f=i,Pr,Tn).call(f,e,c,n,u=>{o[d]=u})}),s(o);return}if(this.isTuple()){const i=this.components;let o;if(Array.isArray(t))o=t.slice();else{if(t==null||typeof t!="object")throw new Error("invalid tuple value");o=i.map(c=>{if(!c.name)throw new Error("cannot use object value with unnamed components");if(!(c.name in t))throw new Error(`missing value for component ${c.name}`);return t[c.name]})}if(o.length!==this.components.length)throw new Error("array is wrong length");o.forEach((c,d)=>{var f;Z(f=i[d],Pr,Tn).call(f,e,c,n,u=>{o[d]=u})}),s(o);return}const a=n(this.type,t);a.then?e.push(async function(){s(await a)}()):s(a)};let fe=Se;class er{constructor(e,t,n){w(this,"type");w(this,"inputs");jn(e,ne,"Fragment"),n=Object.freeze(n.slice()),H(this,{type:t,inputs:n})}static from(e){if(typeof e=="string"){try{er.from(JSON.parse(e))}catch{}return er.from(Tt(e))}if(e instanceof _e)switch(e.peekKeyword(Bo)){case"constructor":return ot.from(e);case"error":return ye.from(e);case"event":return Ze.from(e);case"fallback":case"receive":return rt.from(e);case"function":return Ye.from(e);case"struct":return Zt.from(e)}else if(typeof e=="object"){switch(e.type){case"constructor":return ot.from(e);case"error":return ye.from(e);case"event":return Ze.from(e);case"fallback":case"receive":return rt.from(e);case"function":return Ye.from(e);case"struct":return Zt.from(e)}U(!1,`unsupported type: ${e.type}`,"UNSUPPORTED_OPERATION",{operation:"Fragment.from"})}v(!1,"unsupported frgament object","obj",e)}static isConstructor(e){return ot.isFragment(e)}static isError(e){return ye.isFragment(e)}static isEvent(e){return Ze.isFragment(e)}static isFunction(e){return Ye.isFragment(e)}static isStruct(e){return Zt.isFragment(e)}}class es extends er{constructor(t,n,s,a){super(t,n,a);w(this,"name");v(typeof s=="string"&&s.match(Uo),"invalid identifier","name",s),a=Object.freeze(a.slice()),H(this,{name:s})}}function rn(r,e){return"("+e.map(t=>t.format(r)).join(r==="full"?", ":",")+")"}class ye extends es{constructor(e,t,n){super(e,"error",t,n),Object.defineProperty(this,Ne,{value:Ka})}get selector(){return tn(this.format("sighash")).substring(0,10)}format(e){if(e==null&&(e="sighash"),e==="json")return JSON.stringify({type:"error",name:this.name,inputs:this.inputs.map(n=>JSON.parse(n.format(e)))});const t=[];return e!=="sighash"&&t.push("error"),t.push(this.name+rn(e,this.inputs)),t.join(" ")}static from(e){if(ye.isFragment(e))return e;if(typeof e=="string")return ye.from(Tt(e));if(e instanceof _e){const t=qn("error",e),n=ct(e);return qt(e),new ye(ne,t,n)}return new ye(ne,e.name,e.inputs?e.inputs.map(fe.from):[])}static isFragment(e){return e&&e[Ne]===Ka}}class Ze extends es{constructor(t,n,s,a){super(t,"event",n,s);w(this,"anonymous");Object.defineProperty(this,Ne,{value:Va}),H(this,{anonymous:a})}get topicHash(){return tn(this.format("sighash"))}format(t){if(t==null&&(t="sighash"),t==="json")return JSON.stringify({type:"event",anonymous:this.anonymous,name:this.name,inputs:this.inputs.map(s=>JSON.parse(s.format(t)))});const n=[];return t!=="sighash"&&n.push("event"),n.push(this.name+rn(t,this.inputs)),t!=="sighash"&&this.anonymous&&n.push("anonymous"),n.join(" ")}static getTopicHash(t,n){return n=(n||[]).map(a=>fe.from(a)),new Ze(ne,t,n,!1).topicHash}static from(t){if(Ze.isFragment(t))return t;if(typeof t=="string")try{return Ze.from(Tt(t))}catch{v(!1,"invalid event fragment","obj",t)}else if(t instanceof _e){const n=qn("event",t),s=ct(t,!0),a=!!lt(t,be(["anonymous"])).has("anonymous");return qt(t),new Ze(ne,n,s,a)}return new Ze(ne,t.name,t.inputs?t.inputs.map(n=>fe.from(n,!0)):[],!!t.anonymous)}static isFragment(t){return t&&t[Ne]===Va}}class ot extends er{constructor(t,n,s,a,i){super(t,n,s);w(this,"payable");w(this,"gas");Object.defineProperty(this,Ne,{value:za}),H(this,{payable:a,gas:i})}format(t){if(U(t!=null&&t!=="sighash","cannot format a constructor for sighash","UNSUPPORTED_OPERATION",{operation:"format(sighash)"}),t==="json")return JSON.stringify({type:"constructor",stateMutability:this.payable?"payable":"undefined",payable:this.payable,gas:this.gas!=null?this.gas:void 0,inputs:this.inputs.map(s=>JSON.parse(s.format(t)))});const n=[`constructor${rn(t,this.inputs)}`];return this.payable&&n.push("payable"),this.gas!=null&&n.push(`@${this.gas.toString()}`),n.join(" ")}static from(t){if(ot.isFragment(t))return t;if(typeof t=="string")try{return ot.from(Tt(t))}catch{v(!1,"invalid constuctor fragment","obj",t)}else if(t instanceof _e){lt(t,be(["constructor"]));const n=ct(t),s=!!lt(t,Nd).has("payable"),a=Lo(t);return qt(t),new ot(ne,"constructor",n,s,a)}return new ot(ne,"constructor",t.inputs?t.inputs.map(fe.from):[],!!t.payable,t.gas!=null?t.gas:null)}static isFragment(t){return t&&t[Ne]===za}}class rt extends er{constructor(t,n,s){super(t,"fallback",n);w(this,"payable");Object.defineProperty(this,Ne,{value:Qa}),H(this,{payable:s})}format(t){const n=this.inputs.length===0?"receive":"fallback";if(t==="json"){const s=this.payable?"payable":"nonpayable";return JSON.stringify({type:n,stateMutability:s})}return`${n}()${this.payable?" payable":""}`}static from(t){if(rt.isFragment(t))return t;if(typeof t=="string")try{return rt.from(Tt(t))}catch{v(!1,"invalid fallback fragment","obj",t)}else if(t instanceof _e){const n=t.toString(),s=t.peekKeyword(be(["fallback","receive"]));if(v(s,"type must be fallback or receive","obj",n),t.popKeyword(be(["fallback","receive"]))==="receive"){const c=ct(t);return v(c.length===0,"receive cannot have arguments","obj.inputs",c),lt(t,be(["payable"])),qt(t),new rt(ne,[],!0)}let i=ct(t);i.length?v(i.length===1&&i[0].type==="bytes","invalid fallback inputs","obj.inputs",i.map(c=>c.format("minimal")).join(", ")):i=[fe.from("bytes")];const o=Do(t);if(v(o==="nonpayable"||o==="payable","fallback cannot be constants","obj.stateMutability",o),lt(t,be(["returns"])).has("returns")){const c=ct(t);v(c.length===1&&c[0].type==="bytes","invalid fallback outputs","obj.outputs",c.map(d=>d.format("minimal")).join(", "))}return qt(t),new rt(ne,i,o==="payable")}if(t.type==="receive")return new rt(ne,[],!0);if(t.type==="fallback"){const n=[fe.from("bytes")],s=t.stateMutability==="payable";return new rt(ne,n,s)}v(!1,"invalid fallback description","obj",t)}static isFragment(t){return t&&t[Ne]===Qa}}class Ye extends es{constructor(t,n,s,a,i,o){super(t,"function",n,a);w(this,"constant");w(this,"outputs");w(this,"stateMutability");w(this,"payable");w(this,"gas");Object.defineProperty(this,Ne,{value:$a}),i=Object.freeze(i.slice()),H(this,{constant:s==="view"||s==="pure",gas:o,outputs:i,payable:s==="payable",stateMutability:s})}get selector(){return tn(this.format("sighash")).substring(0,10)}format(t){if(t==null&&(t="sighash"),t==="json")return JSON.stringify({type:"function",name:this.name,constant:this.constant,stateMutability:this.stateMutability!=="nonpayable"?this.stateMutability:void 0,payable:this.payable,gas:this.gas!=null?this.gas:void 0,inputs:this.inputs.map(s=>JSON.parse(s.format(t))),outputs:this.outputs.map(s=>JSON.parse(s.format(t)))});const n=[];return t!=="sighash"&&n.push("function"),n.push(this.name+rn(t,this.inputs)),t!=="sighash"&&(this.stateMutability!=="nonpayable"&&n.push(this.stateMutability),this.outputs&&this.outputs.length&&(n.push("returns"),n.push(rn(t,this.outputs))),this.gas!=null&&n.push(`@${this.gas.toString()}`)),n.join(" ")}static getSelector(t,n){return n=(n||[]).map(a=>fe.from(a)),new Ye(ne,t,"view",n,[],null).selector}static from(t){if(Ye.isFragment(t))return t;if(typeof t=="string")try{return Ye.from(Tt(t))}catch{v(!1,"invalid function fragment","obj",t)}else if(t instanceof _e){const s=qn("function",t),a=ct(t),i=Do(t);let o=[];lt(t,be(["returns"])).has("returns")&&(o=ct(t));const c=Lo(t);return qt(t),new Ye(ne,s,i,a,o,c)}let n=t.stateMutability;return n==null&&(n="payable",typeof t.constant=="boolean"?(n="view",t.constant||(n="payable",typeof t.payable=="boolean"&&!t.payable&&(n="nonpayable"))):typeof t.payable=="boolean"&&!t.payable&&(n="nonpayable")),new Ye(ne,t.name,n,t.inputs?t.inputs.map(fe.from):[],t.outputs?t.outputs.map(fe.from):[],t.gas!=null?t.gas:null)}static isFragment(t){return t&&t[Ne]===$a}}class Zt extends es{constructor(e,t,n){super(e,"struct",t,n),Object.defineProperty(this,Ne,{value:Ja})}format(){throw new Error("@TODO")}static from(e){if(typeof e=="string")try{return Zt.from(Tt(e))}catch{v(!1,"invalid struct fragment","obj",e)}else if(e instanceof _e){const t=qn("struct",e),n=ct(e);return qt(e),new Zt(ne,t,n)}return new Zt(ne,e.name,e.inputs?e.inputs.map(fe.from):[])}static isFragment(e){return e&&e[Ne]===Ja}}const He=new Map;He.set(0,"GENERIC_PANIC");He.set(1,"ASSERT_FALSE");He.set(17,"OVERFLOW");He.set(18,"DIVIDE_BY_ZERO");He.set(33,"ENUM_RANGE_ERROR");He.set(34,"BAD_STORAGE_DATA");He.set(49,"STACK_UNDERFLOW");He.set(50,"ARRAY_RANGE_ERROR");He.set(65,"OUT_OF_MEMORY");He.set(81,"UNINITIALIZED_FUNCTION_CALL");const Ud=new RegExp(/^bytes([0-9]*)$/),Fd=new RegExp(/^(u?int)([0-9]*)$/);let xs=null,Wa=1024;function Dd(r,e,t,n){let s="missing revert data",a=null;const i=null;let o=null;if(t){s="execution reverted";const d=Y(t);if(t=K(t),d.length===0)s+=" (no data present; likely require(false) occurred",a="require(false)";else if(d.length%32!==4)s+=" (could not decode reason; invalid data length)";else if(K(d.slice(0,4))==="0x08c379a0")try{a=n.decode(["string"],d.slice(4))[0],o={signature:"Error(string)",name:"Error",args:[a]},s+=`: ${JSON.stringify(a)}`}catch{s+=" (could not decode reason; invalid string data)"}else if(K(d.slice(0,4))==="0x4e487b71")try{const f=Number(n.decode(["uint256"],d.slice(4))[0]);o={signature:"Panic(uint256)",name:"Panic",args:[f]},a=`Panic due to ${He.get(f)||"UNKNOWN"}(${f})`,s+=`: ${a}`}catch{s+=" (could not decode panic code)"}else s+=" (unknown custom error)"}const c={to:e.to?Ee(e.to):null,data:e.data||"0x"};return e.from&&(c.from=Ee(e.from)),Xt(s,"CALL_EXCEPTION",{action:r,data:t,reason:a,transaction:c,invocation:i,revert:o})}var Nt,dr;const Mn=class Mn{constructor(){F(this,Nt)}getDefaultValue(e){const t=e.map(s=>Z(this,Nt,dr).call(this,fe.from(s)));return new Nn(t,"_").defaultValue()}encode(e,t){hi(t.length,e.length,"types/values length mismatch");const n=e.map(i=>Z(this,Nt,dr).call(this,fe.from(i))),s=new Nn(n,"_"),a=new ws;return s.encode(a,t),a.data}decode(e,t,n){const s=e.map(i=>Z(this,Nt,dr).call(this,fe.from(i)));return new Nn(s,"_").decode(new As(t,n,Wa))}static _setDefaultMaxInflation(e){v(typeof e=="number"&&Number.isInteger(e),"invalid defaultMaxInflation factor","value",e),Wa=e}static defaultAbiCoder(){return xs==null&&(xs=new Mn),xs}static getBuiltinCallException(e,t,n){return Dd(e,t,n,Mn.defaultAbiCoder())}};Nt=new WeakSet,dr=function(e){if(e.isArray())return new ed(Z(this,Nt,dr).call(this,e.arrayChildren),e.arrayLength,e.name);if(e.isTuple())return new Nn(e.components.map(n=>Z(this,Nt,dr).call(this,n)),e.name);switch(e.baseType){case"address":return new X0(e.name);case"bool":return new td(e.name);case"string":return new dd(e.name);case"bytes":return new rd(e.name);case"":return new ad(e.name)}let t=e.type.match(Fd);if(t){let n=parseInt(t[2]||"256");return v(n!==0&&n<=256&&n%8===0,"invalid "+t[1]+" bit length","param",e),new ld(n/8,t[1]==="int",e.name)}if(t=e.type.match(Ud),t){let n=parseInt(t[1]);return v(n!==0&&n<=32,"invalid bytes length","param",e),new nd(n,e.name)}v(!1,"invalid type","type",e.type)};let Un=Mn;class Ld{constructor(e,t,n){w(this,"fragment");w(this,"name");w(this,"signature");w(this,"topic");w(this,"args");const s=e.name,a=e.format();H(this,{fragment:e,name:s,signature:a,topic:t,args:n})}}class Md{constructor(e,t,n,s){w(this,"fragment");w(this,"name");w(this,"args");w(this,"signature");w(this,"selector");w(this,"value");const a=e.name,i=e.format();H(this,{fragment:e,name:a,args:n,signature:i,selector:t,value:s})}}class jd{constructor(e,t,n){w(this,"fragment");w(this,"name");w(this,"args");w(this,"signature");w(this,"selector");const s=e.name,a=e.format();H(this,{fragment:e,name:s,args:n,signature:a,selector:t})}}class Za{constructor(e){w(this,"hash");w(this,"_isIndexed");H(this,{hash:e,_isIndexed:!0})}static isIndexed(e){return!!(e&&e._isIndexed)}}const Ya={0:"generic panic",1:"assert(false)",17:"arithmetic overflow",18:"division or modulo by zero",33:"enum overflow",34:"invalid encoded storage byte array accessed",49:"out-of-bounds array access; popping on an empty array",50:"out-of-bounds access of an array or bytesN",65:"out of memory",81:"uninitialized function"},Xa={"0x08c379a0":{signature:"Error(string)",name:"Error",inputs:["string"],reason:r=>`reverted with reason string ${JSON.stringify(r)}`},"0x4e487b71":{signature:"Panic(uint256)",name:"Panic",inputs:["uint256"],reason:r=>{let e="unknown panic code";return r>=0&&r<=255&&Ya[r.toString()]&&(e=Ya[r.toString()]),`reverted with panic code 0x${r.toString(16)} (${e})`}}};var Qe,$e,Je,he,qe,Sn,On;const Ft=class Ft{constructor(e){F(this,qe);w(this,"fragments");w(this,"deploy");w(this,"fallback");w(this,"receive");F(this,Qe);F(this,$e);F(this,Je);F(this,he);let t=[];typeof e=="string"?t=JSON.parse(e):t=e,k(this,Je,new Map),k(this,Qe,new Map),k(this,$e,new Map);const n=[];for(const i of t)try{n.push(er.from(i))}catch(o){console.log(`[Warning] Invalid Fragment ${JSON.stringify(i)}:`,o.message)}H(this,{fragments:Object.freeze(n)});let s=null,a=!1;k(this,he,this.getAbiCoder()),this.fragments.forEach((i,o)=>{let c;switch(i.type){case"constructor":if(this.deploy){console.log("duplicate definition - constructor");return}H(this,{deploy:i});return;case"fallback":i.inputs.length===0?a=!0:(v(!s||i.payable!==s.payable,"conflicting fallback fragments",`fragments[${o}]`,i),s=i,a=s.payable);return;case"function":c=b(this,Je);break;case"event":c=b(this,$e);break;case"error":c=b(this,Qe);break;default:return}const d=i.format();c.has(d)||c.set(d,i)}),this.deploy||H(this,{deploy:ot.from("constructor()")}),H(this,{fallback:s,receive:a})}format(e){const t=e?"minimal":"full";return this.fragments.map(s=>s.format(t))}formatJson(){const e=this.fragments.map(t=>t.format("json"));return JSON.stringify(e.map(t=>JSON.parse(t)))}getAbiCoder(){return Un.defaultAbiCoder()}getFunctionName(e){const t=Z(this,qe,Sn).call(this,e,null,!1);return v(t,"no matching function","key",e),t.name}hasFunction(e){return!!Z(this,qe,Sn).call(this,e,null,!1)}getFunction(e,t){return Z(this,qe,Sn).call(this,e,t||null,!0)}forEachFunction(e){const t=Array.from(b(this,Je).keys());t.sort((n,s)=>n.localeCompare(s));for(let n=0;n<t.length;n++){const s=t[n];e(b(this,Je).get(s),n)}}getEventName(e){const t=Z(this,qe,On).call(this,e,null,!1);return v(t,"no matching event","key",e),t.name}hasEvent(e){return!!Z(this,qe,On).call(this,e,null,!1)}getEvent(e,t){return Z(this,qe,On).call(this,e,t||null,!0)}forEachEvent(e){const t=Array.from(b(this,$e).keys());t.sort((n,s)=>n.localeCompare(s));for(let n=0;n<t.length;n++){const s=t[n];e(b(this,$e).get(s),n)}}getError(e,t){if(Ae(e)){const s=e.toLowerCase();if(Xa[s])return ye.from(Xa[s].signature);for(const a of b(this,Qe).values())if(s===a.selector)return a;return null}if(e.indexOf("(")===-1){const s=[];for(const[a,i]of b(this,Qe))a.split("(")[0]===e&&s.push(i);if(s.length===0)return e==="Error"?ye.from("error Error(string)"):e==="Panic"?ye.from("error Panic(uint256)"):null;if(s.length>1){const a=s.map(i=>JSON.stringify(i.format())).join(", ");v(!1,`ambiguous error description (i.e. ${a})`,"name",e)}return s[0]}if(e=ye.from(e).format(),e==="Error(string)")return ye.from("error Error(string)");if(e==="Panic(uint256)")return ye.from("error Panic(uint256)");const n=b(this,Qe).get(e);return n||null}forEachError(e){const t=Array.from(b(this,Qe).keys());t.sort((n,s)=>n.localeCompare(s));for(let n=0;n<t.length;n++){const s=t[n];e(b(this,Qe).get(s),n)}}_decodeParams(e,t){return b(this,he).decode(e,t)}_encodeParams(e,t){return b(this,he).encode(e,t)}encodeDeploy(e){return this._encodeParams(this.deploy.inputs,e||[])}decodeErrorResult(e,t){if(typeof e=="string"){const n=this.getError(e);v(n,"unknown error","fragment",e),e=n}return v(cr(t,0,4)===e.selector,`data signature does not match error ${e.name}.`,"data",t),this._decodeParams(e.inputs,cr(t,4))}encodeErrorResult(e,t){if(typeof e=="string"){const n=this.getError(e);v(n,"unknown error","fragment",e),e=n}return It([e.selector,this._encodeParams(e.inputs,t||[])])}decodeFunctionData(e,t){if(typeof e=="string"){const n=this.getFunction(e);v(n,"unknown function","fragment",e),e=n}return v(cr(t,0,4)===e.selector,`data signature does not match function ${e.name}.`,"data",t),this._decodeParams(e.inputs,cr(t,4))}encodeFunctionData(e,t){if(typeof e=="string"){const n=this.getFunction(e);v(n,"unknown function","fragment",e),e=n}return It([e.selector,this._encodeParams(e.inputs,t||[])])}decodeFunctionResult(e,t){if(typeof e=="string"){const a=this.getFunction(e);v(a,"unknown function","fragment",e),e=a}let n="invalid length for result data";const s=Xe(t);if(s.length%32===0)try{return b(this,he).decode(e.outputs,s)}catch{n="could not decode result data"}U(!1,n,"BAD_DATA",{value:K(s),info:{method:e.name,signature:e.format()}})}makeError(e,t){const n=Y(e,"data"),s=Un.getBuiltinCallException("call",t,n);if(s.message.startsWith("execution reverted (unknown custom error)")){const o=K(n.slice(0,4)),c=this.getError(o);if(c)try{const d=b(this,he).decode(c.inputs,n.slice(4));s.revert={name:c.name,signature:c.format(),args:d},s.reason=s.revert.signature,s.message=`execution reverted: ${s.reason}`}catch{s.message="execution reverted (coult not decode custom error)"}}const i=this.parseTransaction(t);return i&&(s.invocation={method:i.name,signature:i.signature,args:i.args}),s}encodeFunctionResult(e,t){if(typeof e=="string"){const n=this.getFunction(e);v(n,"unknown function","fragment",e),e=n}return K(b(this,he).encode(e.outputs,t||[]))}encodeFilterTopics(e,t){if(typeof e=="string"){const a=this.getEvent(e);v(a,"unknown event","eventFragment",e),e=a}U(t.length<=e.inputs.length,`too many arguments for ${e.format()}`,"UNEXPECTED_ARGUMENT",{count:t.length,expectedCount:e.inputs.length});const n=[];e.anonymous||n.push(e.topicHash);const s=(a,i)=>a.type==="string"?tn(i):a.type==="bytes"?kt(K(i)):(a.type==="bool"&&typeof i=="boolean"?i=i?"0x01":"0x00":a.type.match(/^u?int/)?i=Hn(i):a.type.match(/^bytes/)?i=Vc(i,32):a.type==="address"&&b(this,he).encode(["address"],[i]),gi(K(i),32));for(t.forEach((a,i)=>{const o=e.inputs[i];if(!o.indexed){v(a==null,"cannot filter non-indexed parameters; must be null","contract."+o.name,a);return}a==null?n.push(null):o.baseType==="array"||o.baseType==="tuple"?v(!1,"filtering with tuples or arrays not supported","contract."+o.name,a):Array.isArray(a)?n.push(a.map(c=>s(o,c))):n.push(s(o,a))});n.length&&n[n.length-1]===null;)n.pop();return n}encodeEventLog(e,t){if(typeof e=="string"){const i=this.getEvent(e);v(i,"unknown event","eventFragment",e),e=i}const n=[],s=[],a=[];return e.anonymous||n.push(e.topicHash),v(t.length===e.inputs.length,"event arguments/values mismatch","values",t),e.inputs.forEach((i,o)=>{const c=t[o];if(i.indexed)if(i.type==="string")n.push(tn(c));else if(i.type==="bytes")n.push(kt(c));else{if(i.baseType==="tuple"||i.baseType==="array")throw new Error("not implemented");n.push(b(this,he).encode([i.type],[c]))}else s.push(i),a.push(c)}),{data:b(this,he).encode(s,a),topics:n}}decodeEventLog(e,t,n){if(typeof e=="string"){const y=this.getEvent(e);v(y,"unknown event","eventFragment",e),e=y}if(n!=null&&!e.anonymous){const y=e.topicHash;v(Ae(n[0],32)&&n[0].toLowerCase()===y,"fragment/topic mismatch","topics[0]",n[0]),n=n.slice(1)}const s=[],a=[],i=[];e.inputs.forEach((y,x)=>{y.indexed?y.type==="string"||y.type==="bytes"||y.baseType==="tuple"||y.baseType==="array"?(s.push(fe.from({type:"bytes32",name:y.name})),i.push(!0)):(s.push(y),i.push(!1)):(a.push(y),i.push(!1))});const o=n!=null?b(this,he).decode(s,It(n)):null,c=b(this,he).decode(a,t,!0),d=[],f=[];let u=0,h=0;return e.inputs.forEach((y,x)=>{let p=null;if(y.indexed)if(o==null)p=new Za(null);else if(i[x])p=new Za(o[h++]);else try{p=o[h++]}catch(g){p=g}else try{p=c[u++]}catch(g){p=g}d.push(p),f.push(y.name||null)}),Sr.fromItems(d,f)}parseTransaction(e){const t=Y(e.data,"tx.data"),n=te(e.value!=null?e.value:0,"tx.value"),s=this.getFunction(K(t.slice(0,4)));if(!s)return null;const a=b(this,he).decode(s.inputs,t.slice(4));return new Md(s,s.selector,a,n)}parseCallResult(e){throw new Error("@TODO")}parseLog(e){const t=this.getEvent(e.topics[0]);return!t||t.anonymous?null:new Ld(t,t.topicHash,this.decodeEventLog(t,e.data,e.topics))}parseError(e){const t=K(e),n=this.getError(cr(t,0,4));if(!n)return null;const s=b(this,he).decode(n.inputs,cr(t,4));return new jd(n,n.selector,s)}static from(e){return e instanceof Ft?e:typeof e=="string"?new Ft(JSON.parse(e)):typeof e.formatJson=="function"?new Ft(e.formatJson()):typeof e.format=="function"?new Ft(e.format("json")):new Ft(e)}};Qe=new WeakMap,$e=new WeakMap,Je=new WeakMap,he=new WeakMap,qe=new WeakSet,Sn=function(e,t,n){if(Ae(e)){const a=e.toLowerCase();for(const i of b(this,Je).values())if(a===i.selector)return i;return null}if(e.indexOf("(")===-1){const a=[];for(const[i,o]of b(this,Je))i.split("(")[0]===e&&a.push(o);if(t){const i=t.length>0?t[t.length-1]:null;let o=t.length,c=!0;xe.isTyped(i)&&i.type==="overrides"&&(c=!1,o--);for(let d=a.length-1;d>=0;d--){const f=a[d].inputs.length;f!==o&&(!c||f!==o-1)&&a.splice(d,1)}for(let d=a.length-1;d>=0;d--){const f=a[d].inputs;for(let u=0;u<t.length;u++)if(xe.isTyped(t[u])){if(u>=f.length){if(t[u].type==="overrides")continue;a.splice(d,1);break}if(t[u].type!==f[u].baseType){a.splice(d,1);break}}}}if(a.length===1&&t&&t.length!==a[0].inputs.length){const i=t[t.length-1];(i==null||Array.isArray(i)||typeof i!="object")&&a.splice(0,1)}if(a.length===0)return null;if(a.length>1&&n){const i=a.map(o=>JSON.stringify(o.format())).join(", ");v(!1,`ambiguous function description (i.e. matches ${i})`,"key",e)}return a[0]}const s=b(this,Je).get(Ye.from(e).format());return s||null},On=function(e,t,n){if(Ae(e)){const a=e.toLowerCase();for(const i of b(this,$e).values())if(a===i.topicHash)return i;return null}if(e.indexOf("(")===-1){const a=[];for(const[i,o]of b(this,$e))i.split("(")[0]===e&&a.push(o);if(t){for(let i=a.length-1;i>=0;i--)a[i].inputs.length<t.length&&a.splice(i,1);for(let i=a.length-1;i>=0;i--){const o=a[i].inputs;for(let c=0;c<t.length;c++)if(xe.isTyped(t[c])&&t[c].type!==o[c].baseType){a.splice(i,1);break}}}if(a.length===0)return null;if(a.length>1&&n){const i=a.map(o=>JSON.stringify(o.format())).join(", ");v(!1,`ambiguous event description (i.e. matches ${i})`,"key",e)}return a[0]}const s=b(this,$e).get(Ze.from(e).format());return s||null};let Ts=Ft;const Mo=BigInt(0);function Be(r){return r==null?null:r.toString()}function Gd(r){const e={};r.to&&(e.to=r.to),r.from&&(e.from=r.from),r.data&&(e.data=K(r.data));const t="chainId,gasLimit,gasPrice,maxFeePerBlobGas,maxFeePerGas,maxPriorityFeePerGas,value".split(/,/);for(const s of t)!(s in r)||r[s]==null||(e[s]=te(r[s],`request.${s}`));const n="type,nonce".split(/,/);for(const s of n)!(s in r)||r[s]==null||(e[s]=re(r[s],`request.${s}`));return r.accessList&&(e.accessList=fd(r.accessList)),r.authorizationList&&(e.authorizationList=r.authorizationList.slice()),"blockTag"in r&&(e.blockTag=r.blockTag),"enableCcipRead"in r&&(e.enableCcipRead=!!r.enableCcipRead),"customData"in r&&(e.customData=r.customData),"blobVersionedHashes"in r&&r.blobVersionedHashes&&(e.blobVersionedHashes=r.blobVersionedHashes.slice()),"kzg"in r&&(e.kzg=r.kzg),"blobs"in r&&r.blobs&&(e.blobs=r.blobs.map(s=>pi(s)?K(s):Object.assign({},s))),e}class ts{constructor(e,t){w(this,"provider");w(this,"transactionHash");w(this,"blockHash");w(this,"blockNumber");w(this,"removed");w(this,"address");w(this,"data");w(this,"topics");w(this,"index");w(this,"transactionIndex");this.provider=t;const n=Object.freeze(e.topics.slice());H(this,{transactionHash:e.transactionHash,blockHash:e.blockHash,blockNumber:e.blockNumber,removed:e.removed,address:e.address,data:e.data,topics:n,index:e.index,transactionIndex:e.transactionIndex})}toJSON(){const{address:e,blockHash:t,blockNumber:n,data:s,index:a,removed:i,topics:o,transactionHash:c,transactionIndex:d}=this;return{_type:"log",address:e,blockHash:t,blockNumber:n,data:s,index:a,removed:i,topics:o,transactionHash:c,transactionIndex:d}}async getBlock(){const e=await this.provider.getBlock(this.blockHash);return U(!!e,"failed to find transaction","UNKNOWN_ERROR",{}),e}async getTransaction(){const e=await this.provider.getTransaction(this.transactionHash);return U(!!e,"failed to find transaction","UNKNOWN_ERROR",{}),e}async getTransactionReceipt(){const e=await this.provider.getTransactionReceipt(this.transactionHash);return U(!!e,"failed to find transaction receipt","UNKNOWN_ERROR",{}),e}removedEvent(){return Hd(this)}}var ln;class _d{constructor(e,t){w(this,"provider");w(this,"to");w(this,"from");w(this,"contractAddress");w(this,"hash");w(this,"index");w(this,"blockHash");w(this,"blockNumber");w(this,"logsBloom");w(this,"gasUsed");w(this,"blobGasUsed");w(this,"cumulativeGasUsed");w(this,"gasPrice");w(this,"blobGasPrice");w(this,"type");w(this,"status");w(this,"root");F(this,ln);k(this,ln,Object.freeze(e.logs.map(s=>new ts(s,t))));let n=Mo;e.effectiveGasPrice!=null?n=e.effectiveGasPrice:e.gasPrice!=null&&(n=e.gasPrice),H(this,{provider:t,to:e.to,from:e.from,contractAddress:e.contractAddress,hash:e.hash,index:e.index,blockHash:e.blockHash,blockNumber:e.blockNumber,logsBloom:e.logsBloom,gasUsed:e.gasUsed,cumulativeGasUsed:e.cumulativeGasUsed,blobGasUsed:e.blobGasUsed,gasPrice:n,blobGasPrice:e.blobGasPrice,type:e.type,status:e.status,root:e.root})}get logs(){return b(this,ln)}toJSON(){const{to:e,from:t,contractAddress:n,hash:s,index:a,blockHash:i,blockNumber:o,logsBloom:c,logs:d,status:f,root:u}=this;return{_type:"TransactionReceipt",blockHash:i,blockNumber:o,contractAddress:n,cumulativeGasUsed:Be(this.cumulativeGasUsed),from:t,gasPrice:Be(this.gasPrice),blobGasUsed:Be(this.blobGasUsed),blobGasPrice:Be(this.blobGasPrice),gasUsed:Be(this.gasUsed),hash:s,index:a,logs:d,logsBloom:c,root:u,status:f,to:e}}get length(){return this.logs.length}[Symbol.iterator](){let e=0;return{next:()=>e<this.length?{value:this.logs[e++],done:!1}:{value:void 0,done:!0}}}get fee(){return this.gasUsed*this.gasPrice}async getBlock(){const e=await this.provider.getBlock(this.blockHash);if(e==null)throw new Error("TODO");return e}async getTransaction(){const e=await this.provider.getTransaction(this.hash);if(e==null)throw new Error("TODO");return e}async getResult(){return await this.provider.getTransactionResult(this.hash)}async confirmations(){return await this.provider.getBlockNumber()-this.blockNumber+1}removedEvent(){return Go(this)}reorderedEvent(e){return U(!e||e.isMined(),"unmined 'other' transction cannot be orphaned","UNSUPPORTED_OPERATION",{operation:"reorderedEvent(other)"}),jo(this,e)}}ln=new WeakMap;var vt;const ea=class ea{constructor(e,t){w(this,"provider");w(this,"blockNumber");w(this,"blockHash");w(this,"index");w(this,"hash");w(this,"type");w(this,"to");w(this,"from");w(this,"nonce");w(this,"gasLimit");w(this,"gasPrice");w(this,"maxPriorityFeePerGas");w(this,"maxFeePerGas");w(this,"maxFeePerBlobGas");w(this,"data");w(this,"value");w(this,"chainId");w(this,"signature");w(this,"accessList");w(this,"blobVersionedHashes");w(this,"authorizationList");F(this,vt);this.provider=t,this.blockNumber=e.blockNumber!=null?e.blockNumber:null,this.blockHash=e.blockHash!=null?e.blockHash:null,this.hash=e.hash,this.index=e.index,this.type=e.type,this.from=e.from,this.to=e.to||null,this.gasLimit=e.gasLimit,this.nonce=e.nonce,this.data=e.data,this.value=e.value,this.gasPrice=e.gasPrice,this.maxPriorityFeePerGas=e.maxPriorityFeePerGas!=null?e.maxPriorityFeePerGas:null,this.maxFeePerGas=e.maxFeePerGas!=null?e.maxFeePerGas:null,this.maxFeePerBlobGas=e.maxFeePerBlobGas!=null?e.maxFeePerBlobGas:null,this.chainId=e.chainId,this.signature=e.signature,this.accessList=e.accessList!=null?e.accessList:null,this.blobVersionedHashes=e.blobVersionedHashes!=null?e.blobVersionedHashes:null,this.authorizationList=e.authorizationList!=null?e.authorizationList:null,k(this,vt,-1)}toJSON(){const{blockNumber:e,blockHash:t,index:n,hash:s,type:a,to:i,from:o,nonce:c,data:d,signature:f,accessList:u,blobVersionedHashes:h}=this;return{_type:"TransactionResponse",accessList:u,blockNumber:e,blockHash:t,blobVersionedHashes:h,chainId:Be(this.chainId),data:d,from:o,gasLimit:Be(this.gasLimit),gasPrice:Be(this.gasPrice),hash:s,maxFeePerGas:Be(this.maxFeePerGas),maxPriorityFeePerGas:Be(this.maxPriorityFeePerGas),maxFeePerBlobGas:Be(this.maxFeePerBlobGas),nonce:c,signature:f,to:i,index:n,type:a,value:Be(this.value)}}async getBlock(){let e=this.blockNumber;if(e==null){const n=await this.getTransaction();n&&(e=n.blockNumber)}if(e==null)return null;const t=this.provider.getBlock(e);if(t==null)throw new Error("TODO");return t}async getTransaction(){return this.provider.getTransaction(this.hash)}async confirmations(){if(this.blockNumber==null){const{tx:t,blockNumber:n}=await bs({tx:this.getTransaction(),blockNumber:this.provider.getBlockNumber()});return t==null||t.blockNumber==null?0:n-t.blockNumber+1}return await this.provider.getBlockNumber()-this.blockNumber+1}async wait(e,t){const n=e??1,s=t??0;let a=b(this,vt),i=-1,o=a===-1;const c=async()=>{if(o)return null;const{blockNumber:h,nonce:y}=await bs({blockNumber:this.provider.getBlockNumber(),nonce:this.provider.getTransactionCount(this.from)});if(y<this.nonce){a=h;return}if(o)return null;const x=await this.getTransaction();if(!(x&&x.blockNumber!=null))for(i===-1&&(i=a-3,i<b(this,vt)&&(i=b(this,vt)));i<=h;){if(o)return null;const p=await this.provider.getBlock(i,!0);if(p==null)return;for(const g of p)if(g===this.hash)return;for(let g=0;g<p.length;g++){const m=await p.getTransaction(g);if(m.from===this.from&&m.nonce===this.nonce){if(o)return null;const A=await this.provider.getTransactionReceipt(m.hash);if(A==null||h-A.blockNumber+1<n)return;let N="replaced";m.data===this.data&&m.to===this.to&&m.value===this.value?N="repriced":m.data==="0x"&&m.from===m.to&&m.value===Mo&&(N="cancelled"),U(!1,"transaction was replaced","TRANSACTION_REPLACED",{cancelled:N==="replaced"||N==="cancelled",reason:N,replacement:m.replaceableTransaction(a),hash:m.hash,receipt:A})}}i++}},d=h=>{if(h==null||h.status!==0)return h;U(!1,"transaction execution reverted","CALL_EXCEPTION",{action:"sendTransaction",data:null,reason:null,invocation:null,revert:null,transaction:{to:h.to,from:h.from,data:""},receipt:h})},f=await this.provider.getTransactionReceipt(this.hash);if(n===0)return d(f);if(f){if(n===1||await f.confirmations()>=n)return d(f)}else if(await c(),n===0)return null;return await new Promise((h,y)=>{const x=[],p=()=>{x.forEach(m=>m())};if(x.push(()=>{o=!0}),s>0){const m=setTimeout(()=>{p(),y(Xt("wait for transaction timeout","TIMEOUT"))},s);x.push(()=>{clearTimeout(m)})}const g=async m=>{if(await m.confirmations()>=n){p();try{h(d(m))}catch(A){y(A)}}};if(x.push(()=>{this.provider.off(this.hash,g)}),this.provider.on(this.hash,g),a>=0){const m=async()=>{try{await c()}catch(A){if(Tr(A,"TRANSACTION_REPLACED")){p(),y(A);return}}o||this.provider.once("block",m)};x.push(()=>{this.provider.off("block",m)}),this.provider.once("block",m)}})}isMined(){return this.blockHash!=null}isLegacy(){return this.type===0}isBerlin(){return this.type===1}isLondon(){return this.type===2}isCancun(){return this.type===3}removedEvent(){return U(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),Go(this)}reorderedEvent(e){return U(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),U(!e||e.isMined(),"unmined 'other' transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),jo(this,e)}replaceableTransaction(e){v(Number.isInteger(e)&&e>=0,"invalid startBlock","startBlock",e);const t=new ea(this,this.provider);return k(t,vt,e),t}};vt=new WeakMap;let Ss=ea;function jo(r,e){return{orphan:"reorder-transaction",tx:r,other:e}}function Go(r){return{orphan:"drop-transaction",tx:r}}function Hd(r){return{orphan:"drop-log",log:{transactionHash:r.transactionHash,blockHash:r.blockHash,blockNumber:r.blockNumber,address:r.address,data:r.data,topics:Object.freeze(r.topics.slice()),index:r.index}}}class Js extends ts{constructor(t,n,s){super(t,t.provider);w(this,"interface");w(this,"fragment");w(this,"args");const a=n.decodeEventLog(s,t.data,t.topics);H(this,{args:a,fragment:s,interface:n})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}class _o extends ts{constructor(t,n){super(t,t.provider);w(this,"error");H(this,{error:n})}}var kr;class Kd extends _d{constructor(t,n,s){super(s,n);F(this,kr);k(this,kr,t)}get logs(){return super.logs.map(t=>{const n=t.topics.length?b(this,kr).getEvent(t.topics[0]):null;if(n)try{return new Js(t,b(this,kr),n)}catch(s){return new _o(t,s)}return t})}}kr=new WeakMap;var dn;class Ws extends Ss{constructor(t,n,s){super(s,n);F(this,dn);k(this,dn,t)}async wait(t,n){const s=await super.wait(t,n);return s==null?null:new Kd(b(this,dn),this.provider,s)}}dn=new WeakMap;class Ho extends Yc{constructor(t,n,s,a){super(t,n,s);w(this,"log");H(this,{log:a})}async getBlock(){return await this.log.getBlock()}async getTransaction(){return await this.log.getTransaction()}async getTransactionReceipt(){return await this.log.getTransactionReceipt()}}class Vd extends Ho{constructor(e,t,n,s,a){super(e,t,n,new Js(a,e.interface,s));const i=e.interface.decodeEventLog(s,this.log.data,this.log.topics);H(this,{args:i,fragment:s})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}const qa=BigInt(0);function Ko(r){return r&&typeof r.call=="function"}function Vo(r){return r&&typeof r.estimateGas=="function"}function rs(r){return r&&typeof r.resolveName=="function"}function zo(r){return r&&typeof r.sendTransaction=="function"}function Qo(r){if(r!=null){if(rs(r))return r;if(r.provider)return r.provider}}var fn;class zd{constructor(e,t,n){F(this,fn);w(this,"fragment");if(H(this,{fragment:t}),t.inputs.length<n.length)throw new Error("too many arguments");const s=tr(e.runner,"resolveName"),a=rs(s)?s:null;k(this,fn,async function(){const i=await Promise.all(t.inputs.map((o,c)=>n[c]==null?null:o.walkAsync(n[c],(f,u)=>f==="address"?Array.isArray(u)?Promise.all(u.map(h=>en(h,a))):en(u,a):u)));return e.interface.encodeFilterTopics(t,i)}())}getTopicFilter(){return b(this,fn)}}fn=new WeakMap;function tr(r,e){return r==null?null:typeof r[e]=="function"?r:r.provider&&typeof r.provider[e]=="function"?r.provider:null}function Lt(r){return r==null?null:r.provider||null}async function $o(r,e){const t=xe.dereference(r,"overrides");v(typeof t=="object","invalid overrides parameter","overrides",r);const n=Gd(t);return v(n.to==null||(e||[]).indexOf("to")>=0,"cannot override to","overrides.to",n.to),v(n.data==null||(e||[]).indexOf("data")>=0,"cannot override data","overrides.data",n.data),n.from&&(n.from=n.from),n}async function Qd(r,e,t){const n=tr(r,"resolveName"),s=rs(n)?n:null;return await Promise.all(e.map((a,i)=>a.walkAsync(t[i],(o,c)=>(c=xe.dereference(c,o),o==="address"?en(c,s):c))))}function $d(r){const e=async function(i){const o=await $o(i,["data"]);o.to=await r.getAddress(),o.from&&(o.from=await en(o.from,Qo(r.runner)));const c=r.interface,d=te(o.value||qa,"overrides.value")===qa,f=(o.data||"0x")==="0x";c.fallback&&!c.fallback.payable&&c.receive&&!f&&!d&&v(!1,"cannot send data to receive or send value to non-payable fallback","overrides",i),v(c.fallback||f,"cannot send data to receive-only contract","overrides.data",o.data);const u=c.receive||c.fallback&&c.fallback.payable;return v(u||d,"cannot send value to non-payable fallback","overrides.value",o.value),v(c.fallback||f,"cannot send data to receive-only contract","overrides.data",o.data),o},t=async function(i){const o=tr(r.runner,"call");U(Ko(o),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const c=await e(i);try{return await o.call(c)}catch(d){throw ui(d)&&d.data?r.interface.makeError(d.data,c):d}},n=async function(i){const o=r.runner;U(zo(o),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const c=await o.sendTransaction(await e(i)),d=Lt(r.runner);return new Ws(r.interface,d,c)},s=async function(i){const o=tr(r.runner,"estimateGas");return U(Vo(o),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await o.estimateGas(await e(i))},a=async i=>await n(i);return H(a,{_contract:r,estimateGas:s,populateTransaction:e,send:n,staticCall:t}),a}function Jd(r,e){const t=function(...d){const f=r.interface.getFunction(e,d);return U(f,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e,args:d}}),f},n=async function(...d){const f=t(...d);let u={};if(f.inputs.length+1===d.length&&(u=await $o(d.pop()),u.from&&(u.from=await en(u.from,Qo(r.runner)))),f.inputs.length!==d.length)throw new Error("internal error: fragment inputs doesn't match arguments; should not happen");const h=await Qd(r.runner,f.inputs,d);return Object.assign({},u,await bs({to:r.getAddress(),data:r.interface.encodeFunctionData(f,h)}))},s=async function(...d){const f=await o(...d);return f.length===1?f[0]:f},a=async function(...d){const f=r.runner;U(zo(f),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const u=await f.sendTransaction(await n(...d)),h=Lt(r.runner);return new Ws(r.interface,h,u)},i=async function(...d){const f=tr(r.runner,"estimateGas");return U(Vo(f),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await f.estimateGas(await n(...d))},o=async function(...d){const f=tr(r.runner,"call");U(Ko(f),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const u=await n(...d);let h="0x";try{h=await f.call(u)}catch(x){throw ui(x)&&x.data?r.interface.makeError(x.data,u):x}const y=t(...d);return r.interface.decodeFunctionResult(y,h)},c=async(...d)=>t(...d).constant?await s(...d):await a(...d);return H(c,{name:r.interface.getFunctionName(e),_contract:r,_key:e,getFragment:t,estimateGas:i,populateTransaction:n,send:a,staticCall:s,staticCallResult:o}),Object.defineProperty(c,"fragment",{configurable:!1,enumerable:!0,get:()=>{const d=r.interface.getFunction(e);return U(d,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e}}),d}}),c}function Wd(r,e){const t=function(...s){const a=r.interface.getEvent(e,s);return U(a,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e,args:s}}),a},n=function(...s){return new zd(r,t(...s),s)};return H(n,{name:r.interface.getEventName(e),_contract:r,_key:e,getFragment:t}),Object.defineProperty(n,"fragment",{configurable:!1,enumerable:!0,get:()=>{const s=r.interface.getEvent(e);return U(s,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e}}),s}}),n}const Fn=Symbol.for("_ethersInternal_contract"),Jo=new WeakMap;function Zd(r,e){Jo.set(r[Fn],e)}function ve(r){return Jo.get(r[Fn])}function Yd(r){return r&&typeof r=="object"&&"getTopicFilter"in r&&typeof r.getTopicFilter=="function"&&r.fragment}async function Zs(r,e){let t,n=null;if(Array.isArray(e)){const a=function(i){if(Ae(i,32))return i;const o=r.interface.getEvent(i);return v(o,"unknown fragment","name",i),o.topicHash};t=e.map(i=>i==null?null:Array.isArray(i)?i.map(a):a(i))}else e==="*"?t=[null]:typeof e=="string"?Ae(e,32)?t=[e]:(n=r.interface.getEvent(e),v(n,"unknown fragment","event",e),t=[n.topicHash]):Yd(e)?t=await e.getTopicFilter():"fragment"in e?(n=e.fragment,t=[n.topicHash]):v(!1,"unknown event name","event",e);t=t.map(a=>{if(a==null)return null;if(Array.isArray(a)){const i=Array.from(new Set(a.map(o=>o.toLowerCase())).values());return i.length===1?i[0]:(i.sort(),i)}return a.toLowerCase()});const s=t.map(a=>a==null?"null":Array.isArray(a)?a.join("|"):a).join("&");return{fragment:n,tag:s,topics:t}}async function Vr(r,e){const{subs:t}=ve(r);return t.get((await Zs(r,e)).tag)||null}async function ei(r,e,t){const n=Lt(r.runner);U(n,"contract runner does not support subscribing","UNSUPPORTED_OPERATION",{operation:e});const{fragment:s,tag:a,topics:i}=await Zs(r,t),{addr:o,subs:c}=ve(r);let d=c.get(a);if(!d){const u={address:o||r,topics:i},h=g=>{let m=s;if(m==null)try{m=r.interface.getEvent(g.topics[0])}catch{}if(m){const A=m,N=s?r.interface.decodeEventLog(s,g.data,g.topics):[];Bs(r,t,N,I=>new Vd(r,I,t,A,g))}else Bs(r,t,[],A=>new Ho(r,A,t,g))};let y=[];d={tag:a,listeners:[],start:()=>{y.length||y.push(n.on(u,h))},stop:async()=>{if(y.length==0)return;let g=y;y=[],await Promise.all(g),n.off(u,h)}},c.set(a,d)}return d}let Os=Promise.resolve();async function Xd(r,e,t,n){await Os;const s=await Vr(r,e);if(!s)return!1;const a=s.listeners.length;return s.listeners=s.listeners.filter(({listener:i,once:o})=>{const c=Array.from(t);n&&c.push(n(o?null:i));try{i.call(r,...c)}catch{}return!o}),s.listeners.length===0&&(s.stop(),ve(r).subs.delete(s.tag)),a>0}async function Bs(r,e,t,n){try{await Os}catch{}const s=Xd(r,e,t,n);return Os=s,await s}const vn=["then"];var ni;ni=Fn;const Zr=class Zr{constructor(e,t,n,s){w(this,"target");w(this,"interface");w(this,"runner");w(this,"filters");w(this,ni);w(this,"fallback");v(typeof e=="string"||No(e),"invalid value for Contract target","target",e),n==null&&(n=null);const a=Ts.from(t);H(this,{target:e,runner:n,interface:a}),Object.defineProperty(this,Fn,{value:{}});let i,o=null,c=null;if(s){const u=Lt(n);c=new Ws(this.interface,u,s)}let d=new Map;if(typeof e=="string")if(Ae(e))o=e,i=Promise.resolve(e);else{const u=tr(n,"resolveName");if(!rs(u))throw Xt("contract runner does not support name resolution","UNSUPPORTED_OPERATION",{operation:"resolveName"});i=u.resolveName(e).then(h=>{if(h==null)throw Xt("an ENS name used for a contract target must be correctly configured","UNCONFIGURED_NAME",{value:e});return ve(this).addr=h,h})}else i=e.getAddress().then(u=>{if(u==null)throw new Error("TODO");return ve(this).addr=u,u});Zd(this,{addrPromise:i,addr:o,deployTx:c,subs:d});const f=new Proxy({},{get:(u,h,y)=>{if(typeof h=="symbol"||vn.indexOf(h)>=0)return Reflect.get(u,h,y);try{return this.getEvent(h)}catch(x){if(!Tr(x,"INVALID_ARGUMENT")||x.argument!=="key")throw x}},has:(u,h)=>vn.indexOf(h)>=0?Reflect.has(u,h):Reflect.has(u,h)||this.interface.hasEvent(String(h))});return H(this,{filters:f}),H(this,{fallback:a.receive||a.fallback?$d(this):null}),new Proxy(this,{get:(u,h,y)=>{if(typeof h=="symbol"||h in u||vn.indexOf(h)>=0)return Reflect.get(u,h,y);try{return u.getFunction(h)}catch(x){if(!Tr(x,"INVALID_ARGUMENT")||x.argument!=="key")throw x}},has:(u,h)=>typeof h=="symbol"||h in u||vn.indexOf(h)>=0?Reflect.has(u,h):u.interface.hasFunction(h)})}connect(e){return new Zr(this.target,this.interface,e)}attach(e){return new Zr(e,this.interface,this.runner)}async getAddress(){return await ve(this).addrPromise}async getDeployedCode(){const e=Lt(this.runner);U(e,"runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"getDeployedCode"});const t=await e.getCode(await this.getAddress());return t==="0x"?null:t}async waitForDeployment(){const e=this.deploymentTransaction();if(e)return await e.wait(),this;if(await this.getDeployedCode()!=null)return this;const n=Lt(this.runner);return U(n!=null,"contract runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"waitForDeployment"}),new Promise((s,a)=>{const i=async()=>{try{if(await this.getDeployedCode()!=null)return s(this);n.once("block",i)}catch(o){a(o)}};i()})}deploymentTransaction(){return ve(this).deployTx}getFunction(e){return typeof e!="string"&&(e=e.format()),Jd(this,e)}getEvent(e){return typeof e!="string"&&(e=e.format()),Wd(this,e)}async queryTransaction(e){throw new Error("@TODO")}async queryFilter(e,t,n){t==null&&(t=0),n==null&&(n="latest");const{addr:s,addrPromise:a}=ve(this),i=s||await a,{fragment:o,topics:c}=await Zs(this,e),d={address:i,topics:c,fromBlock:t,toBlock:n},f=Lt(this.runner);return U(f,"contract runner does not have a provider","UNSUPPORTED_OPERATION",{operation:"queryFilter"}),(await f.getLogs(d)).map(u=>{let h=o;if(h==null)try{h=this.interface.getEvent(u.topics[0])}catch{}if(h)try{return new Js(u,this.interface,h)}catch(y){return new _o(u,y)}return new ts(u,f)})}async on(e,t){const n=await ei(this,"on",e);return n.listeners.push({listener:t,once:!1}),n.start(),this}async once(e,t){const n=await ei(this,"once",e);return n.listeners.push({listener:t,once:!0}),n.start(),this}async emit(e,...t){return await Bs(this,e,t,null)}async listenerCount(e){if(e){const s=await Vr(this,e);return s?s.listeners.length:0}const{subs:t}=ve(this);let n=0;for(const{listeners:s}of t.values())n+=s.length;return n}async listeners(e){if(e){const s=await Vr(this,e);return s?s.listeners.map(({listener:a})=>a):[]}const{subs:t}=ve(this);let n=[];for(const{listeners:s}of t.values())n=n.concat(s.map(({listener:a})=>a));return n}async off(e,t){const n=await Vr(this,e);if(!n)return this;if(t){const s=n.listeners.map(({listener:a})=>a).indexOf(t);s>=0&&n.listeners.splice(s,1)}return(t==null||n.listeners.length===0)&&(n.stop(),ve(this).subs.delete(n.tag)),this}async removeAllListeners(e){if(e){const t=await Vr(this,e);if(!t)return this;t.stop(),ve(this).subs.delete(t.tag)}else{const{subs:t}=ve(this);for(const{tag:n,stop:s}of t.values())s(),t.delete(n)}return this}async addListener(e,t){return await this.on(e,t)}async removeListener(e,t){return await this.off(e,t)}static buildClass(e){class t extends Zr{constructor(s,a=null){super(s,e,a)}}return t}static from(e,t,n){return n==null&&(n=null),new this(e,t,n)}};let Rs=Zr;function qd(){return Rs}class Eu extends qd(){}const ef=new RegExp("^(ipfs)://(.*)$","i"),Nu=[new RegExp("^(https)://(.*)$","i"),new RegExp("^(data):(.*)$","i"),ef,new RegExp("^eip155:[0-9]+/(erc[0-9]+):(.*)$","i")];const vu=BigInt(0);function ae(r,e){return function(t){return t==null?e:r(t)}}function Ys(r,e){return t=>{if(e&&t==null)return null;if(!Array.isArray(t))throw new Error("not an array");return t.map(n=>r(n))}}function ns(r,e){return t=>{const n={};for(const s in r){let a=s;if(e&&s in e&&!(a in t)){for(const i of e[s])if(i in t){a=i;break}}try{const i=r[s](t[a]);i!==void 0&&(n[s]=i)}catch(i){const o=i instanceof Error?i.message:"not-an-error";U(!1,`invalid value for value.${s} (${o})`,"BAD_DATA",{value:t})}}return n}}function tf(r){switch(r){case!0:case"true":return!0;case!1:case"false":return!1}v(!1,`invalid boolean; ${JSON.stringify(r)}`,"value",r)}function nn(r){return v(Ae(r,!0),"invalid data","value",r),r}function we(r){return v(Ae(r,32),"invalid hash","value",r),r}const Iu=ns({address:Ee,blockHash:we,blockNumber:re,data:nn,index:re,removed:ae(tf,!1),topics:Ys(we),transactionHash:we,transactionIndex:re},{index:["logIndex"]});const Cu=ns({hash:ae(we),parentHash:we,parentBeaconBlockRoot:ae(we,null),number:re,timestamp:re,nonce:ae(nn),difficulty:te,gasLimit:te,gasUsed:te,stateRoot:ae(we,null),receiptsRoot:ae(we,null),blobGasUsed:ae(te,null),excessBlobGas:ae(te,null),miner:ae(Ee),prevRandao:ae(we,null),extraData:nn,baseFeePerGas:ae(te)},{prevRandao:["mixHash"]});const rf=ns({transactionIndex:re,blockNumber:re,transactionHash:we,address:Ee,topics:Ys(we),data:nn,index:re,blockHash:we},{index:["logIndex"]});function nf(r){return rf(r)}const Pu=ns({to:ae(Ee,null),from:ae(Ee,null),contractAddress:ae(Ee,null),index:re,root:ae(K),gasUsed:te,blobGasUsed:ae(te,null),logsBloom:ae(nn),blockHash:we,hash:we,logs:Ys(nf),blockNumber:re,cumulativeGasUsed:te,effectiveGasPrice:ae(te),blobGasPrice:ae(te,null),status:ae(re),type:ae(re,0)},{effectiveGasPrice:["gasPrice"],hash:["transactionHash"],index:["transactionIndex"]});const ku=BigInt(2);const Tu=new Uint8Array([]);const Su="bigint,boolean,function,number,string,symbol".split(/,/g);const Ou={polling:!1,staticNetwork:null,batchStallTime:10,batchMaxSize:1<<20,batchMaxCount:100,cacheTimeout:250,pollingInterval:4e3};/*! MIT License. Copyright 2015-2022 Richard Moore <me@ricmoo.com>. See LICENSE.txt. */var sf,af,of;sf=new WeakMap,af=new WeakMap,of=new WeakMap;var cf,lf;cf=new WeakMap,lf=new WeakMap;var df,ff,uf;df=new WeakMap,ff=new WeakMap,uf=new WeakMap;const Bu=new Uint8Array([66,105,116,99,111,105,110,32,115,101,101,100]);const Ru=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141");class hf{constructor(){w(this,"userId",null);w(this,"coldWallets",new Map);this.getDefaultWallets().forEach(e=>{this.coldWallets.set(e.id,e)})}getDefaultWallets(){const e=[];return e.push({id:"cw_btc_1",address:oe.coldWallets.btc,chain:"bitcoin",currency:"BTC",minAmount:1e-5,enabled:!0,label:"Primary BTC Cold Wallet"}),e.push({id:"cw_eth_1",address:oe.coldWallets.eth,chain:"ethereum",currency:"ETH",minAmount:1e-4,enabled:!0,label:"Primary ETH Cold Wallet"}),e.push({id:"cw_bsc_1",address:oe.coldWallets.bsc,chain:"binance-smart-chain",currency:"BNB",minAmount:.001,enabled:!0,label:"Primary BSC Cold Wallet"}),e.push({id:"cw_polygon_1",address:oe.coldWallets.polygon,chain:"polygon",currency:"MATIC",minAmount:.01,enabled:!0,label:"Primary Polygon Cold Wallet"}),e.push({id:"cw_solana_1",address:oe.coldWallets.solana,chain:"solana",currency:"SOL",minAmount:.001,enabled:!0,label:"Primary Solana Cold Wallet"}),e.push({id:"cw_tron_1",address:oe.coldWallets.tron,chain:"tron",currency:"TRX",minAmount:1,enabled:!0,label:"Primary Tron Cold Wallet"}),e}async initialize(e){this.userId=e,await this.loadUserWallets()}async loadUserWallets(){if(this.userId)try{const{data:e,error:t}=await ee.from("cold_wallets").select("*").eq("user_id",this.userId).eq("enabled",!0);if(t)throw t;e&&e.length>0&&e.forEach(n=>{this.coldWallets.set(n.id,{id:n.id,address:n.address,chain:n.chain,currency:n.currency,minAmount:n.min_amount,enabled:n.enabled,label:n.label})})}catch(e){console.error("Failed to load user wallets:",e)}}getColdWallets(){return Array.from(this.coldWallets.values()).filter(e=>e.enabled)}getWalletByChain(e){return Array.from(this.coldWallets.values()).find(t=>t.chain===e&&t.enabled)}async addCustomWallet(e){if(!this.userId)throw new Error("User not initialized");const t=`cw_custom_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,{error:n}=await ee.from("cold_wallets").insert({id:t,user_id:this.userId,address:e.address,chain:e.chain,currency:e.currency,min_amount:e.minAmount,enabled:e.enabled,label:e.label,created_at:new Date().toISOString()});if(n)throw n;this.coldWallets.set(t,{id:t,...e})}async processMicroPayment(e,t,n,s){if(!this.userId)throw new Error("User not initialized");const a=this.getWalletByChain(s);if(!a)throw new Error(`No cold wallet configured for chain: ${s}`);if(t<a.minAmount)throw new Error(`Amount below minimum threshold: ${a.minAmount} ${n}`);const o=t*.001,d=t*5e-4,f={id:`mp_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,userId:this.userId,orderId:e,walletAddress:a.address,amount:t,currency:n,chain:s,status:"pending",timestamp:new Date,feeAmount:o,exchangeFee:d};try{const{error:u}=await ee.from("micro_payments").insert({id:f.id,user_id:f.userId,order_id:f.orderId,wallet_address:f.walletAddress,amount:f.amount,currency:f.currency,chain:f.chain,status:f.status,created_at:f.timestamp.toISOString(),fee_amount:f.feeAmount,exchange_fee:f.exchangeFee});if(u)throw u;return this.queuePaymentProcessing(f.id),f}catch(u){throw console.error("Failed to process micro payment:",u),u}}async queuePaymentProcessing(e){setTimeout(async()=>{try{await ee.from("micro_payments").update({status:"processing"}).eq("id",e),setTimeout(async()=>{const n="",s="";let a=null;a||(a=`0x${Math.random().toString(16).slice(2,66)}`),await ee.from("micro_payments").update({status:"completed",tx_hash:a,completed_at:new Date().toISOString()}).eq("id",e)},3e3)}catch(t){console.error("Payment processing failed:",t),await ee.from("micro_payments").update({status:"failed"}).eq("id",e)}},1e3)}async getPaymentHistory(e=50){if(!this.userId)throw new Error("User not initialized");const{data:t,error:n}=await ee.from("micro_payments").select("*").eq("user_id",this.userId).order("created_at",{ascending:!1}).limit(e);if(n)throw n;return(t||[]).map(s=>({id:s.id,userId:s.user_id,orderId:s.order_id,walletAddress:s.wallet_address,amount:s.amount,currency:s.currency,chain:s.chain,txHash:s.tx_hash,status:s.status,timestamp:new Date(s.created_at),feeAmount:s.fee_amount,exchangeFee:s.exchange_fee}))}async getTotalPayments(){if(!this.userId)throw new Error("User not initialized");const{data:e,error:t}=await ee.from("micro_payments").select("status, amount").eq("user_id",this.userId);if(t)throw t;return(e||[]).reduce((s,a)=>(s.total+=a.amount,a.status==="completed"&&(s.completed+=a.amount),(a.status==="pending"||a.status==="processing")&&(s.pending+=a.amount),s),{total:0,completed:0,pending:0})}async automatePaymentOnTrade(e,t,n,s){const i=t*2e-4;let o="ethereum";n.includes("BNB")?o="binance-smart-chain":n.includes("MATIC")?o="polygon":n.includes("BTC")&&(o="bitcoin");try{await this.processMicroPayment(e,i,n,o)}catch(c){console.error("Automated payment failed:",c)}}}new hf;class xf{constructor(){w(this,"baseUrl");w(this,"wsBaseUrl","wss://stream.binance.com:9443/ws");w(this,"apiKey");w(this,"secretKey");w(this,"rateLimits",{weight:1200,orders:10,rawRequests:6100});w(this,"defaultPairs",["BTCUSDT","ETHUSDT","BNBUSDT","SOLUSDT","ADAUSDT","XRPUSDT","DOGEUSDT","DOTUSDT","MATICUSDT","AVAXUSDT"]);this.apiKey=oe.binance.apiKey,this.secretKey=oe.binance.secretKey,this.baseUrl="https://api.binance.com/api/v3"}getKlinesUrl(e,t,n=500){return`${this.baseUrl}/klines?symbol=${e.toUpperCase()}&interval=${t}&limit=${n}`}getDepthUrl(e,t=100){return`${this.baseUrl}/depth?symbol=${e.toUpperCase()}&limit=${t}`}getTickerUrl(e){return`${this.baseUrl}/ticker/price?symbol=${e.toUpperCase()}`}get24hrTickerUrl(e){return`${this.baseUrl}/ticker/24hr?symbol=${e.toUpperCase()}`}getTradeWebSocketUrl(e){return`${this.wsBaseUrl}/${e.toLowerCase()}@trade`}getDepthWebSocketUrl(e){return`${this.wsBaseUrl}/${e.toLowerCase()}@depth`}getKlineWebSocketUrl(e,t){return`${this.wsBaseUrl}/${e.toLowerCase()}@kline_${t}`}formatKlinesToCandles(e){return e.map(t=>({x:t[0],y:[parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3]),parseFloat(t[4])]}))}formatDepthResponse(e){return{bids:e.bids.map(([t,n])=>({price:parseFloat(t),volume:parseFloat(n)})),asks:e.asks.map(([t,n])=>({price:parseFloat(t),volume:parseFloat(n)}))}}formatTradeMessage(e){return{price:parseFloat(e.p),volume:parseFloat(e.q),timestamp:e.T,side:e.m?"sell":"buy"}}convertTimeframe(e){return{"1m":"1m","5m":"5m","15m":"15m","1h":"1h","4h":"4h","1d":"1d","1w":"1w"}[e]||"1m"}formatSymbol(e,t){return`${e.toUpperCase()}${t.toUpperCase()}`}parseSymbol(e){const t=["USDT","USDC","BUSD","BTC","ETH","BNB"];for(const n of t)if(e.endsWith(n))return{base:e.slice(0,-n.length),quote:n};return{base:e.slice(0,-4),quote:e.slice(-4)}}validateSymbol(e){return/^[A-Z]{3,10}$/.test(e.toUpperCase())}createSignature(e){return Cc.HmacSHA256(e,this.secretKey).toString()}createAuthHeaders(){return{"X-MBX-APIKEY":this.apiKey,"Content-Type":"application/json"}}createSignedParams(e){const t=Date.now(),n=new URLSearchParams({...e,timestamp:t.toString()}).toString(),s=this.createSignature(n);return`${n}&signature=${s}`}async getAccountInfo(){if(!this.apiKey||!this.secretKey)throw new Error("Binance API credentials not configured");const e=this.createSignedParams({}),t=`${this.baseUrl}/account?${e}`,n=await fetch(t,{method:"GET",headers:this.createAuthHeaders()});if(!n.ok){const s=await n.json();throw new Error(`Binance API Error: ${s.msg||"Unknown error"}`)}return n.json()}async getBalance(e){const n=(await this.getAccountInfo()).balances.find(s=>s.asset===e.toUpperCase());return{free:parseFloat((n==null?void 0:n.free)||"0"),locked:parseFloat((n==null?void 0:n.locked)||"0")}}async placeBuyOrder(e,t,n,s="MARKET"){throw!this.apiKey||!this.secretKey?new Error("Binance API credentials not configured"):new Error("Real trading is disabled. Enable in configuration.")}async placeSellOrder(e,t,n,s="MARKET"){throw!this.apiKey||!this.secretKey?new Error("Binance API credentials not configured"):new Error("Real trading is disabled. Enable in configuration.")}async cancelOrder(e,t){if(!this.apiKey||!this.secretKey)throw new Error("Binance API credentials not configured");const n=this.createSignedParams({symbol:e.toUpperCase(),orderId:t.toString()}),s=`${this.baseUrl}/order`,a=await fetch(s,{method:"DELETE",headers:this.createAuthHeaders(),body:n});if(!a.ok){const i=await a.json();throw new Error(`Binance Cancel Error: ${i.msg||"Unknown error"}`)}return a.json()}async getOpenOrders(e){if(!this.apiKey||!this.secretKey)throw new Error("Binance API credentials not configured");const t={};e&&(t.symbol=e.toUpperCase());const n=this.createSignedParams(t),s=`${this.baseUrl}/openOrders?${n}`,a=await fetch(s,{method:"GET",headers:this.createAuthHeaders()});if(!a.ok){const i=await a.json();throw new Error(`Binance API Error: ${i.msg||"Unknown error"}`)}return a.json()}async fetchKlines(e,t,n=500){try{const s=this.getKlinesUrl(e,t,n),a=await fetch(s);if(!a.ok)throw new Error(`HTTP ${a.status}: ${a.statusText}`);const i=await a.json();return this.formatKlinesToCandles(i)}catch(s){throw console.error("Binance fetchKlines error:",s),s}}async fetchOrderBook(e,t=100){try{const n=this.getDepthUrl(e,t),s=await fetch(n);if(!s.ok)throw new Error(`HTTP ${s.status}: ${s.statusText}`);const a=await s.json();return this.formatDepthResponse(a)}catch(n){throw console.error("Binance fetchOrderBook error:",n),n}}async fetchTicker(e){try{const[t,n]=await Promise.all([fetch(this.getTickerUrl(e)),fetch(this.get24hrTickerUrl(e))]);if(!t.ok||!n.ok)throw new Error("Failed to fetch ticker data");const s=await t.json(),a=await n.json();return{price:parseFloat(s.price),change24h:parseFloat(a.priceChangePercent)}}catch(t){throw console.error("Binance fetchTicker error:",t),t}}createAuthenticatedWebSocket(){return!this.apiKey||!this.secretKey?(console.warn("Binance API credentials not configured for WebSocket"),null):new WebSocket(this.wsBaseUrl)}isConfigured(){return!!(this.apiKey&&this.secretKey)}getConfiguration(){return{hasCredentials:this.isConfigured(),testnet:!1,tradingEnabled:oe.trading.enableRealTrading}}handleError(e){var t,n;return(n=(t=e.response)==null?void 0:t.data)!=null&&n.msg?`Binance Error: ${e.response.data.msg}`:e.message?`Binance Error: ${e.message}`:"Binance: Unknown error occurred"}}const mt=new xf;class pf{constructor(){w(this,"baseUrl","https://www.alphavantage.co/query");w(this,"apiKey");this.apiKey=oe.alphaVantage.apiKey}async getQuote(e){if(!this.apiKey)throw new Error("Alpha Vantage API key not configured");const t=`${this.baseUrl}?function=GLOBAL_QUOTE&symbol=${e}&apikey=${this.apiKey}`,n=await fetch(t);if(!n.ok)throw new Error(`Alpha Vantage API error: ${n.statusText}`);const a=(await n.json())["Global Quote"];if(!a)throw new Error("Invalid symbol or API limit reached");return{symbol:a["01. symbol"],price:parseFloat(a["05. price"]),change:parseFloat(a["09. change"]),changePercent:parseFloat(a["10. change percent"].replace("%","")),volume:parseInt(a["06. volume"])}}async getIntradayData(e,t="5min"){if(!this.apiKey)throw new Error("Alpha Vantage API key not configured");const n=`${this.baseUrl}?function=TIME_SERIES_INTRADAY&symbol=${e}&interval=${t}&apikey=${this.apiKey}`,s=await fetch(n);if(!s.ok)throw new Error(`Alpha Vantage API error: ${s.statusText}`);const i=(await s.json())[`Time Series (${t})`];if(!i)throw new Error("No data available or API limit reached");return Object.entries(i).map(([o,c])=>({x:new Date(o).getTime(),y:[parseFloat(c["1. open"]),parseFloat(c["2. high"]),parseFloat(c["3. low"]),parseFloat(c["4. close"])]})).reverse()}async getDailyData(e){if(!this.apiKey)throw new Error("Alpha Vantage API key not configured");const t=`${this.baseUrl}?function=TIME_SERIES_DAILY&symbol=${e}&apikey=${this.apiKey}`,n=await fetch(t);if(!n.ok)throw new Error(`Alpha Vantage API error: ${n.statusText}`);const a=(await n.json())["Time Series (Daily)"];if(!a)throw new Error("No data available or API limit reached");return Object.entries(a).slice(0,100).map(([i,o])=>({x:new Date(i).getTime(),y:[parseFloat(o["1. open"]),parseFloat(o["2. high"]),parseFloat(o["3. low"]),parseFloat(o["4. close"])]})).reverse()}}class bf{constructor(){w(this,"baseUrl","https://api.polygon.io");w(this,"apiKey");this.apiKey=oe.polygon.apiKey}async getQuote(e){var i,o,c;if(!this.apiKey)throw new Error("Polygon API key not configured");const t=`${this.baseUrl}/v2/snapshot/locale/us/markets/stocks/tickers/${e}?apikey=${this.apiKey}`,n=await fetch(t);if(!n.ok)throw new Error(`Polygon API error: ${n.statusText}`);const a=(await n.json()).results;if(!a)throw new Error("Invalid symbol or no data available");return{symbol:a.ticker,price:((i=a.lastQuote)==null?void 0:i.price)||((o=a.prevDay)==null?void 0:o.c)||0,change:a.todaysChange||0,changePercent:a.todaysChangePerc||0,volume:((c=a.day)==null?void 0:c.v)||0}}async getAggregates(e,t=1,n="minute",s,a){if(!this.apiKey)throw new Error("Polygon API key not configured");const i=`${this.baseUrl}/v2/aggs/ticker/${e}/range/${t}/${n}/${s}/${a}?adjusted=true&sort=asc&limit=5000&apikey=${this.apiKey}`,o=await fetch(i);if(!o.ok)throw new Error(`Polygon API error: ${o.statusText}`);const c=await o.json();if(!c.results)throw new Error("No data available");return c.results.map(d=>({x:d.t,y:[d.o,d.h,d.l,d.c]}))}}class gf{constructor(){w(this,"baseUrl","https://finnhub.io/api/v1");w(this,"apiKey");this.apiKey=oe.finnhub.apiKey}async getQuote(e){if(!this.apiKey)throw new Error("Finnhub API key not configured");const t=`${this.baseUrl}/quote?symbol=${e}&token=${this.apiKey}`,n=await fetch(t);if(!n.ok)throw new Error(`Finnhub API error: ${n.statusText}`);const s=await n.json();if(s.error)throw new Error(`Finnhub error: ${s.error}`);return{symbol:e,price:s.c||0,change:s.d||0,changePercent:s.dp||0,volume:0}}async getCandles(e,t="5",n,s){if(!this.apiKey)throw new Error("Finnhub API key not configured");const a=`${this.baseUrl}/stock/candle?symbol=${e}&resolution=${t}&from=${n}&to=${s}&token=${this.apiKey}`,i=await fetch(a);if(!i.ok)throw new Error(`Finnhub API error: ${i.statusText}`);const o=await i.json();if(o.s!=="ok")throw new Error("No data available");return o.t.map((c,d)=>({x:c*1e3,y:[o.o[d],o.h[d],o.l[d],o.c[d]]}))}async getCompanyProfile(e){if(!this.apiKey)throw new Error("Finnhub API key not configured");const t=`${this.baseUrl}/stock/profile2?symbol=${e}&token=${this.apiKey}`,n=await fetch(t);if(!n.ok)throw new Error(`Finnhub API error: ${n.statusText}`);return n.json()}}class mf{constructor(){w(this,"alphaVantage");w(this,"polygon");w(this,"finnhub");this.alphaVantage=new pf,this.polygon=new bf,this.finnhub=new gf}async getQuote(e,t="finnhub"){switch(t){case"alphavantage":return this.alphaVantage.getQuote(e);case"polygon":return this.polygon.getQuote(e);case"finnhub":return this.finnhub.getQuote(e);default:throw new Error("Invalid provider")}}async getCandles(e,t="5m",n="finnhub"){const s=Date.now(),a=s-24*60*60*1e3;switch(n){case"alphavantage":if(t.includes("m")){const u=t.replace("m","min");return this.alphaVantage.getIntradayData(e,u)}else return this.alphaVantage.getDailyData(e);case"polygon":const i=parseInt(t.replace(/[a-zA-Z]/g,"")),o=t.includes("m")?"minute":t.includes("h")?"hour":"day",c=new Date(a).toISOString().split("T")[0],d=new Date(s).toISOString().split("T")[0];return this.polygon.getAggregates(e,i,o,c,d);case"finnhub":let f="5";return t==="1m"?f="1":t==="5m"?f="5":t==="15m"?f="15":t==="30m"?f="30":t==="1h"?f="60":t==="1d"&&(f="D"),this.finnhub.getCandles(e,f,Math.floor(a/1e3),Math.floor(s/1e3));default:throw new Error("Invalid provider")}}getAvailableProviders(){const e=[];return e.push("alphavantage"),e.push("polygon"),e.push("finnhub"),e}isConfigured(){return this.getAvailableProviders().length>0}}const br=new mf;class yf{constructor(){w(this,"baseUrl");w(this,"apiKey");w(this,"accountId");this.apiKey=oe.oanda.apiKey,this.accountId=oe.oanda.accountId,this.baseUrl="https://api-fxpractice.oanda.com"}getHeaders(){return{Authorization:`Bearer ${this.apiKey}`,"Content-Type":"application/json"}}async getQuote(e){if(!this.apiKey)throw new Error("OANDA API key not configured");const t=`${this.baseUrl}/v3/accounts/${this.accountId}/pricing?instruments=${e}`,n=await fetch(t,{headers:this.getHeaders()});if(!n.ok)throw new Error(`OANDA API error: ${n.statusText}`);const a=(await n.json()).prices[0];if(!a)throw new Error("No pricing data available");return{instrument:a.instrument,bid:parseFloat(a.bids[0].price),ask:parseFloat(a.asks[0].price),spread:parseFloat(a.asks[0].price)-parseFloat(a.bids[0].price),timestamp:new Date(a.time).getTime()}}async getCandles(e,t="M5",n=500){if(!this.apiKey)throw new Error("OANDA API key not configured");const s=`${this.baseUrl}/v3/instruments/${e}/candles?granularity=${t}&count=${n}`,a=await fetch(s,{headers:this.getHeaders()});if(!a.ok)throw new Error(`OANDA API error: ${a.statusText}`);return(await a.json()).candles.map(o=>({x:new Date(o.time).getTime(),y:[parseFloat(o.mid.o),parseFloat(o.mid.h),parseFloat(o.mid.l),parseFloat(o.mid.c)]}))}async getAccountInfo(){if(!this.apiKey||!this.accountId)throw new Error("OANDA credentials not configured");const e=`${this.baseUrl}/v3/accounts/${this.accountId}`,t=await fetch(e,{headers:this.getHeaders()});if(!t.ok)throw new Error(`OANDA API error: ${t.statusText}`);return t.json()}async placeOrder(e,t,n="MARKET",s){throw!this.apiKey||!this.accountId?new Error("OANDA credentials not configured"):new Error("Real trading is disabled. Enable in configuration.")}async getPositions(){if(!this.apiKey||!this.accountId)throw new Error("OANDA credentials not configured");const e=`${this.baseUrl}/v3/accounts/${this.accountId}/positions`,t=await fetch(e,{headers:this.getHeaders()});if(!t.ok)throw new Error(`OANDA API error: ${t.statusText}`);return t.json()}}class wf{constructor(){w(this,"oanda");this.oanda=new yf}async getQuote(e){return this.oanda.getQuote(e)}async getCandles(e,t="5m"){let n="M5";switch(t){case"1m":n="M1";break;case"5m":n="M5";break;case"15m":n="M15";break;case"30m":n="M30";break;case"1h":n="H1";break;case"4h":n="H4";break;case"1d":n="D";break}return this.oanda.getCandles(e,n)}async getAccountInfo(){return this.oanda.getAccountInfo()}async placeBuyOrder(e,t,n){return this.oanda.placeOrder(e,Math.abs(t),n?"LIMIT":"MARKET",n)}async placeSellOrder(e,t,n){return this.oanda.placeOrder(e,-Math.abs(t),n?"LIMIT":"MARKET",n)}async getPositions(){return this.oanda.getPositions()}isConfigured(){return!!oe.oanda.accountId}getConfiguration(){return{hasCredentials:this.isConfigured(),environment:oe.oanda.environment,tradingEnabled:oe.trading.enableRealTrading}}}const yt=new wf;class Af{constructor(){w(this,"userId",null);w(this,"tradingEnabled",!0)}async initialize(e){this.userId=e,this.tradingEnabled=!0}async saveCredentials(e,t,n,s=!1){if(!this.userId)throw new Error("User not initialized");const{error:a}=await ee.from("exchange_credentials").upsert({user_id:this.userId,exchange:e,api_key:t,api_secret:n,testnet,updated_at:new Date().toISOString()},{onConflict:"user_id,exchange"});if(a)throw a}async getCredentials(e){if(!this.userId)throw new Error("User not initialized");const{data:t,error:n}=await ee.from("exchange_credentials").select("*").eq("user_id",this.userId).eq("exchange",e).maybeSingle();if(n)throw n;return t}async executeCryptoOrder(e,t,n,s,a,i){throw this.userId?new Error("Real trading is disabled. Enable in configuration."):new Error("User not initialized")}async executeForexOrder(e,t,n,s){throw this.userId?new Error("Real trading is disabled. Enable in configuration."):new Error("User not initialized")}async executeOrder(e,t,n,s,a,i){return e.toLowerCase()==="oanda"||t.includes("_")?this.executeForexOrder(t,n,a,i):this.executeCryptoOrder(e,t,n,s,a,i)}async getOrders(e){if(!this.userId)throw new Error("User not initialized");let t=ee.from("orders").select("*").eq("user_id",this.userId);e!=null&&e.exchange&&(t=t.eq("exchange",e.exchange)),e!=null&&e.symbol&&(t=t.eq("symbol",e.symbol)),e!=null&&e.status&&(t=t.eq("status",e.status));const{data:n,error:s}=await t.order("created_at",{ascending:!1});if(s)throw s;return(n||[]).map(a=>({id:a.id,userId:a.user_id,exchange:a.exchange,symbol:a.symbol,side:a.side,type:a.type,price:a.price,amount:a.amount,filled:a.filled,status:a.status,timestamp:new Date(a.created_at),externalOrderId:a.external_order_id}))}async cancelOrder(e){if(!this.userId)throw new Error("User not initialized");const{error:t}=await ee.from("orders").update({status:"cancelled"}).eq("id",e).eq("user_id",this.userId);return!t}async getRealBalance(e){if(!this.userId)throw new Error("User not initialized");try{switch(e.toLowerCase()){case"binance":if(!mt.isConfigured())throw new Error("Binance API credentials not configured");const t=await mt.getAccountInfo(),n={};return t.balances.forEach(a=>{const i=parseFloat(a.free),o=parseFloat(a.locked);(i>0||o>0)&&(n[a.asset]={free:i,locked:o})}),n;case"oanda":if(!yt.isConfigured())throw new Error("OANDA credentials not configured");const s=await yt.getAccountInfo();return{USD:{free:parseFloat(s.account.balance),locked:parseFloat(s.account.marginUsed||"0")}};default:throw new Error(`Exchange ${e} not supported for real balance fetching`)}}catch(t){throw console.error(`Failed to fetch real balance from ${e}:`,t),t}}async getBalance(e){if(!this.userId)throw new Error("User not initialized");try{const t=await this.getRealBalance(e),n={};return Object.entries(t).forEach(([s,a])=>{n[s]=a.free+a.locked}),n}catch{const{data:n,error:s}=await ee.from("balances").select("*").eq("user_id",this.userId).eq("exchange",e);if(s)throw s;const a={};return(n||[]).forEach(i=>{a[i.asset]=i.amount}),a}}async syncBalances(e){if(!this.userId)throw new Error("User not initialized");try{const t=await this.getRealBalance(e);for(const[n,s]of Object.entries(t)){const a=s.free+s.locked;await ee.from("balances").upsert({user_id:this.userId,exchange:e,asset:n,amount:a,free:s.free,locked:s.locked,updated_at:new Date().toISOString()},{onConflict:"user_id,exchange,asset"})}}catch(t){throw console.error(`Failed to sync balances for ${e}:`,t),t}}async getAccountSummary(){if(!this.userId)throw new Error("User not initialized");const e=[];let t=0;mt.isConfigured()&&e.push("Binance"),yt.isConfigured()&&e.push("OANDA"),br.isConfigured()&&e.push("Stocks");const{data:n}=await ee.from("orders").select("id").eq("user_id",this.userId).in("status",["pending","partial"]),s=(n==null?void 0:n.length)||0;return{exchanges:e,totalValue:t,activeOrders:s,tradingEnabled:oe.trading.enableRealTrading}}async getAvailableAssets(e){switch(e){case"crypto":return mt.defaultPairs;case"forex":return[...yt.constructor.prototype.MAJOR_FOREX_PAIRS||[]];case"stocks":return br.constructor.prototype.POPULAR_STOCKS||[];default:return[]}}isRealTradingEnabled(){return oe.trading.enableRealTrading}getConfiguredExchanges(){return[{exchange:"Binance",assetType:"crypto",configured:mt.isConfigured()},{exchange:"OANDA",assetType:"forex",configured:yt.isConfigured()},{exchange:"Stocks",assetType:"stocks",configured:br.isConfigured()}]}}const _r=new Af;class Bt{constructor(e){w(this,"config");w(this,"sandboxMode",!1);this.config=e,console.warn("CCXT cannot run in browser environment. Please implement a backend service to proxy exchange API calls. See documentation: https://docs.ccxt.com/en/latest/manual.html#proxy")}setSandboxMode(e){this.sandboxMode=e}throwNotImplemented(e){throw new Error(`${e} is not available in browser mode. Implement a backend service to handle exchange operations.`)}async fetchBalance(){this.throwNotImplemented("fetchBalance")}async createOrder(e,t,n,s,a){this.throwNotImplemented("createOrder")}async cancelOrder(e,t){this.throwNotImplemented("cancelOrder")}async fetchOrders(e){this.throwNotImplemented("fetchOrders")}async fetchOpenOrders(e){this.throwNotImplemented("fetchOpenOrders")}async fetchTicker(e){this.throwNotImplemented("fetchTicker")}async fetchOHLCV(e,t,n,s){this.throwNotImplemented("fetchOHLCV")}async withdraw(e,t,n,s){this.throwNotImplemented("withdraw")}async fetchDeposits(e){this.throwNotImplemented("fetchDeposits")}async fetchWithdrawals(e){this.throwNotImplemented("fetchWithdrawals")}async fetchDepositAddress(e){this.throwNotImplemented("fetchDepositAddress")}}const Ef={binance:Bt,coinbasepro:Bt,okx:Bt,kucoin:Bt,kraken:Bt,bybit:Bt,bitfinex:Bt},Nf={BINANCE:{id:"BINANCE",name:"Binance",type:"crypto",ccxtId:"binance",requiresCredentials:!0,isActive:!0,supportedFeatures:{spot:!0,margin:!0,futures:!0,options:!0,swap:!0}},COINBASE:{id:"COINBASE",name:"Coinbase Pro",type:"crypto",ccxtId:"coinbasepro",requiresCredentials:!0,supportedFeatures:{spot:!0,margin:!1,futures:!1,options:!1,swap:!1}},OKX:{id:"OKX",name:"OKX",type:"crypto",ccxtId:"okx",requiresCredentials:!0,supportedFeatures:{spot:!0,margin:!0,futures:!0,options:!0,swap:!0}},KUCOIN:{id:"KUCOIN",name:"KuCoin",type:"crypto",ccxtId:"kucoin",requiresCredentials:!0,supportedFeatures:{spot:!0,margin:!0,futures:!0,options:!1,swap:!1}},KRAKEN:{id:"KRAKEN",name:"Kraken",type:"crypto",ccxtId:"kraken",requiresCredentials:!0,supportedFeatures:{spot:!0,margin:!0,futures:!0,options:!1,swap:!1}},BYBIT:{id:"BYBIT",name:"Bybit",type:"crypto",ccxtId:"bybit",requiresCredentials:!0,supportedFeatures:{spot:!0,margin:!1,futures:!0,options:!0,swap:!0}},BITFINEX:{id:"BITFINEX",name:"Bitfinex",type:"crypto",ccxtId:"bitfinex",requiresCredentials:!0,supportedFeatures:{spot:!0,margin:!0,futures:!1,options:!1,swap:!1}},NASDAQ:{id:"NASDAQ",name:"NASDAQ",type:"stock",requiresCredentials:!0,supportedFeatures:{spot:!0,margin:!0,futures:!1,options:!0,swap:!1}},NYSE:{id:"NYSE",name:"New York Stock Exchange",type:"stock",requiresCredentials:!0,supportedFeatures:{spot:!0,margin:!0,futures:!1,options:!0,swap:!1}},FOREX:{id:"FOREX",name:"Forex Market",type:"forex",requiresCredentials:!0,supportedFeatures:{spot:!0,margin:!0,futures:!1,options:!1,swap:!0}},CME:{id:"CME",name:"Chicago Mercantile Exchange",type:"commodity",requiresCredentials:!0,supportedFeatures:{spot:!1,margin:!1,futures:!0,options:!0,swap:!1}}};class vf{constructor(){w(this,"exchanges",new Map)}createExchange(e,t,n,s=!0){const a=Nf[e];if(!a||!a.ccxtId)throw new Error(`Exchange ${e} not supported for real trading`);const i=Ef[a.ccxtId];if(!i)throw new Error(`CCXT exchange ${a.ccxtId} not found`);const o=new i({apiKey:t,secret:n,enableRateLimit:!0,options:{defaultType:"spot",adjustForTimeDifference:!0}});return s&&o.setSandboxMode(!0),this.exchanges.set(e,o),o}getExchange(e){return this.exchanges.get(e)}async fetchBalance(e){const t=this.getExchange(e);if(!t)throw new Error(`Exchange ${e} not connected`);return await t.fetchBalance()}async createOrder(e,t,n,s,a,i){const o=this.getExchange(e);if(!o)throw new Error(`Exchange ${e} not connected`);return await o.createOrder(t,n,s,a,i)}async cancelOrder(e,t,n){const s=this.getExchange(e);if(!s)throw new Error(`Exchange ${e} not connected`);return await s.cancelOrder(t,n)}async fetchOrders(e,t){const n=this.getExchange(e);if(!n)throw new Error(`Exchange ${e} not connected`);return await n.fetchOrders(t)}async fetchOpenOrders(e,t){const n=this.getExchange(e);if(!n)throw new Error(`Exchange ${e} not connected`);return await n.fetchOpenOrders(t)}async fetchTicker(e,t){const n=this.getExchange(e);if(!n)throw new Error(`Exchange ${e} not connected`);return await n.fetchTicker(t)}async fetchOHLCV(e,t,n,s=100){const a=this.getExchange(e);if(!a)throw new Error(`Exchange ${e} not connected`);return await a.fetchOHLCV(t,n,void 0,s)}async withdraw(e,t,n,s,a){const i=this.getExchange(e);if(!i)throw new Error(`Exchange ${e} not connected`);return await i.withdraw(t,n,s,a)}async fetchDeposits(e,t){const n=this.getExchange(e);if(!n)throw new Error(`Exchange ${e} not connected`);return await n.fetchDeposits(t)}async fetchWithdrawals(e,t){const n=this.getExchange(e);if(!n)throw new Error(`Exchange ${e} not connected`);return await n.fetchWithdrawals(t)}async fetchDepositAddress(e,t){const n=this.getExchange(e);if(!n)throw new Error(`Exchange ${e} not connected`);return await n.fetchDepositAddress(t)}disconnectExchange(e){this.exchanges.delete(e)}disconnectAll(){this.exchanges.clear()}}const Hr=new vf,If=()=>{const[r,e]=T.useState([]),[t,n]=T.useState([]),[s,a]=T.useState([]),[i,o]=T.useState({}),[c,d]=T.useState(!1),[f,u]=T.useState(!1);T.useEffect(()=>{(async()=>{const{data:{session:E}}=await ee.auth.getSession();E!=null&&E.user&&(await _r.initialize(E.user.id),u(!0),await m(),await x())})()},[]);const h=T.useCallback(async(I,E,C,O=!0)=>{try{await _r.saveCredentials(I,E,C,O),Hr.createExchange(I,E,C,O),W.success(`Connected to ${I}`),await x()}catch(P){console.error("Failed to connect exchange:",P),W.error(`Failed to connect to ${I}: ${P.message}`)}},[]),y=T.useCallback(I=>{Hr.disconnectExchange(I),W.success(`Disconnected from ${I}`)},[]),x=T.useCallback(async()=>{if(f)try{const{data:I}=await ee.from("exchange_credentials").select("exchange");if(!I)return;const E={};for(const C of I)try{const O=await Hr.fetchBalance(C.exchange);E[C.exchange]=O.free||{}}catch(O){console.error(`Failed to fetch balance for ${C.exchange}:`,O)}o(E)}catch(I){console.error("Failed to refresh balances:",I)}},[f]),p=T.useCallback(async(I,E,C,O,P,D)=>{if(!f)return W.error("Trading engine not initialized"),null;d(!0);try{const j=await Hr.createOrder(I,E,O,C,P,D),M=await _r.executeOrder(I,E,C,O,P,D||j.price);return e(J=>[M,...J]),W.success(`Order executed: ${C.toUpperCase()} ${P} ${E} @ $${(D||j.price).toFixed(2)}`),await x(),await m(),M}catch(j){return console.error("Order execution error:",j),W.error(`Failed to execute order: ${j.message}`),null}finally{d(!1)}},[f]),g=T.useCallback(async(I,E,C)=>{try{await Hr.cancelOrder(I,E,C),await _r.cancelOrder(E),e(O=>O.map(P=>P.id===E?{...P,status:"cancelled"}:P)),W.success("Order cancelled"),await m()}catch(O){console.error("Failed to cancel order:",O),W.error(`Failed to cancel order: ${O.message}`)}},[]),m=T.useCallback(async()=>{if(f)try{const I=await _r.getOrders();e(I)}catch(I){console.error("Failed to refresh orders:",I)}},[f]),A=T.useCallback((I,E="USDT")=>{var C;return((C=i[I])==null?void 0:C[E])||0},[i]),N=T.useCallback((I="USDT")=>{let E=0;return Object.values(i).forEach(C=>{E+=C[I]||0}),E},[i]);return{orders:r,positions:t,trades:s,balances:i,isExecuting:c,isInitialized:f,connectExchange:h,disconnectExchange:y,executeOrder:p,cancelOrder:g,refreshOrders:m,refreshBalances:x,getBalance:A,getTotalBalance:N}},Cf=({exchange:r,symbol:e,currentPrice:t})=>{const{executeOrder:n,isExecuting:s,getBalance:a}=If(),[i,o]=T.useState("market"),[c,d]=T.useState("buy"),[f,u]=T.useState(""),[h,y]=T.useState(t.toString()),[x,p]=T.useState(!1),[g,m]=T.useState("25"),A=a(r,"USDT"),N=()=>{if(x){const E=parseFloat(g)/100;return A*E/(i==="market"?t:parseFloat(h))}return parseFloat(f)},I=async()=>{const E=N();if(isNaN(E)||E<=0){W.error("Invalid amount");return}const C=i==="market"?void 0:parseFloat(h);if(i!=="market"&&(!C||isNaN(C))){W.error("Invalid price");return}const O=E*(C||t);if(c==="buy"&&O>A){W.error(`Insufficient balance. Required: ${O.toFixed(2)} USDT, Available: ${A.toFixed(2)} USDT`);return}try{await n(r,e,c,i,E,C),W.success(`${c.toUpperCase()} order executed successfully`),u(""),m("25")}catch(P){W.error(`Order execution failed: ${P instanceof Error?P.message:"Unknown error"}`)}};return l.jsxs(pc,{className:"p-4 bg-gradient-to-br from-background to-primary/5 border-primary/20",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Bn,{className:"w-5 h-5 text-primary"}),l.jsx("h3",{className:"text-lg font-bold",children:"Place Order"})]}),l.jsxs(ps,{variant:"outline",className:"text-xs",children:[l.jsx(oi,{className:"w-3 h-3 mr-1"}),A.toFixed(2)," USDT"]})]}),l.jsx(ci,{value:i,onValueChange:E=>o(E),className:"mb-4",children:l.jsxs(li,{className:"grid w-full grid-cols-3",children:[l.jsx(Wr,{value:"market",children:"Market"}),l.jsx(Wr,{value:"limit",children:"Limit"}),l.jsx(Wr,{value:"stop",children:"Stop"})]})}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[l.jsxs(Re,{variant:c==="buy"?"default":"outline",onClick:()=>d("buy"),className:c==="buy"?"bg-success hover:bg-success/90":"",children:[l.jsx(Pt,{className:"w-4 h-4 mr-1"}),"Buy"]}),l.jsxs(Re,{variant:c==="sell"?"default":"outline",onClick:()=>d("sell"),className:c==="sell"?"bg-destructive hover:bg-destructive/90":"",children:[l.jsx(Yt,{className:"w-4 h-4 mr-1"}),"Sell"]})]}),i!=="market"&&l.jsxs("div",{className:"space-y-2",children:[l.jsx(xn,{htmlFor:"price",className:"text-xs",children:"Price (USDT)"}),l.jsx(In,{id:"price",type:"number",step:"0.01",value:h,onChange:E=>y(E.target.value),className:"h-9 text-sm"})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx(xn,{htmlFor:"usePercentage",className:"text-xs",children:"Use % of Balance"}),l.jsx(Ac,{id:"usePercentage",checked:x,onCheckedChange:p})]}),x?l.jsxs("div",{className:"space-y-2",children:[l.jsx(xn,{htmlFor:"percentage",className:"text-xs",children:"Percentage (%)"}),l.jsx(In,{id:"percentage",type:"number",min:"1",max:"100",value:g,onChange:E=>m(E.target.value),className:"h-9 text-sm"}),l.jsx("div",{className:"flex gap-2",children:["25","50","75","100"].map(E=>l.jsxs(Re,{variant:"outline",size:"sm",onClick:()=>m(E),className:"flex-1 h-7 text-xs",children:[E,"%"]},E))})]}):l.jsxs("div",{className:"space-y-2",children:[l.jsxs(xn,{htmlFor:"amount",className:"text-xs",children:["Amount (",e.replace("USDT",""),")"]}),l.jsx(In,{id:"amount",type:"number",step:"0.00001",value:f,onChange:E=>u(E.target.value),placeholder:"0.00",className:"h-9 text-sm"})]}),l.jsxs("div",{className:"p-3 bg-muted/50 rounded-lg space-y-1 text-xs",children:[l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-muted-foreground",children:"Order Type:"}),l.jsx("span",{className:"font-semibold uppercase",children:i})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-muted-foreground",children:"Est. Cost:"}),l.jsxs("span",{className:"font-semibold",children:[(N()*(i==="market"?t:parseFloat(h)||0)).toFixed(2)," USDT"]})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-muted-foreground",children:"Fee (0.1%):"}),l.jsxs("span",{className:"font-semibold",children:[(N()*(i==="market"?t:parseFloat(h)||0)*.001).toFixed(2)," USDT"]})]})]}),l.jsx(Re,{onClick:I,disabled:s,className:`w-full ${c==="buy"?"bg-success hover:bg-success/90":"bg-destructive hover:bg-destructive/90"}`,children:s?"Executing...":l.jsxs(l.Fragment,{children:[l.jsx(Yr,{className:"w-4 h-4 mr-1"}),c==="buy"?"Buy":"Sell"," ",e]})}),l.jsxs("div",{className:"text-xs text-muted-foreground text-center",children:[l.jsx(cc,{className:"w-3 h-3 inline mr-1"}),"Real trades executed on ",r]})]})]})},Pf=()=>{const[r,e]=T.useState([{id:"1",symbol:"BTCUSDT",condition:"above",price:7e4,active:!0},{id:"2",symbol:"ETHUSDT",condition:"below",price:3e3,active:!0}]),[t,n]=T.useState("BTCUSDT"),[s,a]=T.useState("above"),[i,o]=T.useState(""),c=()=>{if(!i||parseFloat(i)<=0){W.error("Please enter a valid price");return}const f={id:Date.now().toString(),symbol:t,condition:s,price:parseFloat(i),active:!0};e([f,...r]),o(""),W.success("Alert created!")},d=f=>{e(r.filter(u=>u.id!==f)),W.info("Alert deleted")};return l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(lc,{className:"w-4 h-4 text-chart-4"}),l.jsx("h3",{className:"text-sm font-semibold text-foreground uppercase tracking-wide",children:"Price Alerts"})]}),l.jsxs("div",{className:"space-y-2 p-3 rounded-lg bg-muted/20 border border-border",children:[l.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[l.jsxs(zr,{value:t,onValueChange:n,children:[l.jsx(Qr,{className:"h-9",children:l.jsx($r,{})}),l.jsxs(Jr,{children:[l.jsx(We,{value:"BTCUSDT",children:"BTC"}),l.jsx(We,{value:"ETHUSDT",children:"ETH"}),l.jsx(We,{value:"BNBUSDT",children:"BNB"}),l.jsx(We,{value:"SOLUSDT",children:"SOL"})]})]}),l.jsxs(zr,{value:s,onValueChange:f=>a(f),children:[l.jsx(Qr,{className:"h-9",children:l.jsx($r,{})}),l.jsxs(Jr,{children:[l.jsx(We,{value:"above",children:"Above"}),l.jsx(We,{value:"below",children:"Below"})]})]})]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx(In,{type:"number",placeholder:"Price...",value:i,onChange:f=>o(f.target.value),className:"h-9"}),l.jsxs(Re,{onClick:c,size:"sm",className:"gap-1",children:[l.jsx(dc,{className:"w-3 h-3"}),"Add"]})]})]}),l.jsx("div",{className:"space-y-2",children:r.length===0?l.jsx("div",{className:"text-sm text-muted-foreground text-center py-4",children:"No alerts set"}):r.map(f=>l.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-muted/30 border border-border hover:border-primary/30 transition-colors group",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[f.condition==="above"?l.jsx(Pt,{className:"w-4 h-4 text-success"}):l.jsx(Yt,{className:"w-4 h-4 text-destructive"}),l.jsxs("div",{children:[l.jsx("div",{className:"text-sm font-medium text-foreground",children:f.symbol.replace("USDT","")}),l.jsxs("div",{className:"text-xs text-muted-foreground",children:[f.condition," $",f.price.toLocaleString()]})]})]}),l.jsx(Re,{variant:"ghost",size:"sm",onClick:()=>d(f.id),className:"h-7 w-7 p-0 opacity-0 group-hover:opacity-100 transition-opacity",children:l.jsx(fc,{className:"w-3 h-3 text-destructive"})})]},f.id))})]})},kf=()=>{const[r]=T.useState([{price:7e4,volume:125e4,type:"resistance",strength:"strong"},{price:68500,volume:85e4,type:"resistance",strength:"medium"},{price:66e3,volume:21e5,type:"support",strength:"strong"},{price:64500,volume:65e4,type:"support",strength:"weak"},{price:62e3,volume:18e5,type:"support",strength:"strong"}]),e=n=>{switch(n){case"strong":return"bg-primary/30 border-primary/50";case"medium":return"bg-chart-2/30 border-chart-2/50";case"weak":return"bg-muted/30 border-muted-foreground/30";default:return"bg-muted/30 border-border"}},t=n=>{switch(n){case"strong":return"w-full";case"medium":return"w-2/3";case"weak":return"w-1/3";default:return"w-1/2"}};return l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(uc,{className:"w-4 h-4 text-chart-4"}),l.jsx("h3",{className:"text-sm font-semibold text-foreground uppercase tracking-wide",children:"Liquidity Zones"})]}),l.jsxs("div",{className:"flex items-center justify-between text-xs",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-2 h-2 rounded-full bg-success"}),l.jsx("span",{className:"text-muted-foreground",children:"Support"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-2 h-2 rounded-full bg-destructive"}),l.jsx("span",{className:"text-muted-foreground",children:"Resistance"})]})]}),l.jsx("div",{className:"space-y-2",children:r.map((n,s)=>l.jsxs("div",{className:`p-3 rounded-lg border transition-all hover:scale-[1.02] ${e(n.strength)}`,children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[n.type==="support"?l.jsx(Pt,{className:"w-3 h-3 text-success"}):l.jsx(Yt,{className:"w-3 h-3 text-destructive"}),l.jsxs("span",{className:"text-sm font-bold text-foreground",children:["$",n.price.toLocaleString()]})]}),l.jsx("span",{className:`text-[10px] px-2 py-0.5 rounded uppercase font-medium ${n.type==="support"?"bg-success/20 text-success":"bg-destructive/20 text-destructive"}`,children:n.type})]}),l.jsxs("div",{className:"space-y-1",children:[l.jsxs("div",{className:"flex items-center justify-between text-xs",children:[l.jsx("span",{className:"text-muted-foreground",children:"Volume"}),l.jsxs("span",{className:"text-foreground font-medium",children:["$",(n.volume/1e6).toFixed(2),"M"]})]}),l.jsxs("div",{className:"space-y-1",children:[l.jsxs("div",{className:"flex items-center justify-between text-[10px]",children:[l.jsx("span",{className:"text-muted-foreground",children:"Strength"}),l.jsx("span",{className:"text-foreground capitalize",children:n.strength})]}),l.jsx("div",{className:"h-1.5 w-full bg-muted/50 rounded-full overflow-hidden",children:l.jsx("div",{className:`h-full bg-gradient-to-r ${n.type==="support"?"from-success to-success/50":"from-destructive to-destructive/50"} ${t(n.strength)} transition-all`})})]})]})]},s))}),l.jsx("div",{className:"p-3 rounded-lg bg-muted/20 border border-border text-xs text-muted-foreground",children:"💡 Zones are calculated based on volume profile and historical price action"})]})},Tf=()=>{const[r]=T.useState([{key:"B",description:"Quick Buy Order",category:"trading"},{key:"S",description:"Quick Sell Order",category:"trading"},{key:"Esc",description:"Cancel All Orders",category:"trading"},{key:"Space",description:"Toggle Chart Type",category:"chart"},{key:"1-7",description:"Switch Timeframes",category:"chart"},{key:"I",description:"Toggle Indicators",category:"chart"},{key:"H",description:"Toggle Heatmap",category:"navigation"},{key:"P",description:"Open Portfolio",category:"navigation"},{key:"W",description:"Open Watchlist",category:"navigation"},{key:"T",description:"Toggle Terminal",category:"navigation"},{key:"/",description:"Search Symbols",category:"navigation"},{key:"F",description:"Fullscreen Chart",category:"chart"}]),e=n=>{switch(n){case"trading":return"text-success";case"chart":return"text-chart-4";case"navigation":return"text-primary";default:return"text-muted-foreground"}},t=Array.from(new Set(r.map(n=>n.category)));return l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(hc,{className:"w-4 h-4 text-chart-4"}),l.jsx("h3",{className:"text-sm font-semibold text-foreground uppercase tracking-wide",children:"Keyboard Shortcuts"})]}),l.jsx(Yr,{className:"w-4 h-4 text-chart-4 animate-pulse"})]}),t.map(n=>l.jsxs("div",{className:"space-y-2",children:[l.jsx("div",{className:`text-xs font-semibold uppercase tracking-wide ${e(n)}`,children:n}),l.jsx("div",{className:"space-y-1",children:r.filter(s=>s.category===n).map((s,a)=>l.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg bg-muted/30 border border-border hover:border-primary/30 transition-colors",children:[l.jsx("span",{className:"text-xs text-muted-foreground",children:s.description}),l.jsx("kbd",{className:"px-2 py-1 text-xs font-semibold text-foreground bg-background border border-border rounded",children:s.key})]},a))})]},n)),l.jsxs(Re,{variant:"outline",size:"sm",className:"w-full gap-2",children:[l.jsx(xc,{className:"w-3 h-3"}),"Customize Hotkeys"]})]})},Sf=T.lazy(()=>nr(()=>import("./PortfolioTracker.1762524666384.DxF55mlU.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9])).then(r=>({default:r.PortfolioTracker}))),Of=T.lazy(()=>nr(()=>import("./AutoTradingSignals.1762524666384.CWJrOhB3.js"),__vite__mapDeps([10,1,2,3,4,5,7,8])).then(r=>({default:r.AutoTradingSignals}))),Bf=T.lazy(()=>nr(()=>import("./SocialTrading.1762524666384.CSAPvZta.js"),__vite__mapDeps([11,1,2,3,4,5])).then(r=>({default:r.SocialTrading}))),Rf=T.lazy(()=>nr(()=>import("./MarketScanner.1762524666384.cWiuPvpm.js"),__vite__mapDeps([12,1,2,3,4,5])).then(r=>({default:r.MarketScanner}))),Uf=T.lazy(()=>nr(()=>import("./MarketSentiment.1762524666384.DbQHX1T-.js"),__vite__mapDeps([13,1,2,6,3,4,5])).then(r=>({default:r.MarketSentiment}))),Ff=T.lazy(()=>nr(()=>import("./EconomicCalendar.1762524666384.BHIXT7uy.js"),__vite__mapDeps([14,1,2,3,4,5])).then(r=>({default:r.EconomicCalendar}))),Df=T.lazy(()=>nr(()=>import("./TradeJournal.1762524666384.DU3mhCg2.js"),__vite__mapDeps([15,1,2,3,4,5])).then(r=>({default:r.TradeJournal}))),Wo=T.memo(({symbol:r,exchange:e,currentPrice:t,assetType:n,onSelectSymbol:s})=>l.jsxs("aside",{className:"glass-panel space-y-4 rounded-2xl p-5 shadow-2xl transition-all duration-300 hover:shadow-primary/10 animate-slide-in-right",children:[l.jsxs(ci,{defaultValue:"trading",className:"w-full",children:[l.jsxs(li,{className:"grid w-full grid-cols-2",children:[l.jsx(Wr,{value:"trading",children:"Trading"}),l.jsx(Wr,{value:"settings",children:"Settings"})]}),l.jsxs(bc,{value:"trading",className:"space-y-4 mt-4",children:[l.jsx(gc,{onSelectSymbol:s,selectedSymbol:r}),l.jsx(Cf,{exchange:e,symbol:r,currentPrice:t}),l.jsx(Pc,{}),l.jsx(T.Suspense,{fallback:l.jsx(Ot,{className:"h-48 w-full rounded-lg"}),children:l.jsx(Sf,{})}),l.jsx(Pf,{}),l.jsx(kc,{}),l.jsx(kf,{}),l.jsx(Tf,{}),l.jsx(mc,{exchange:e,symbol:r})]})]}),l.jsx(T.Suspense,{fallback:l.jsx(Ot,{className:"h-48 w-full rounded-lg"}),children:l.jsx(Of,{})}),l.jsx(T.Suspense,{fallback:l.jsx(Ot,{className:"h-48 w-full rounded-lg"}),children:l.jsx(Bf,{})}),l.jsx(T.Suspense,{fallback:l.jsx(Ot,{className:"h-48 w-full rounded-lg"}),children:l.jsx(Rf,{})}),l.jsx(T.Suspense,{fallback:l.jsx(Ot,{className:"h-48 w-full rounded-lg"}),children:l.jsx(Uf,{})}),l.jsx(T.Suspense,{fallback:l.jsx(Ot,{className:"h-48 w-full rounded-lg"}),children:l.jsx(Ff,{})}),l.jsx(T.Suspense,{fallback:l.jsx(Ot,{className:"h-48 w-full rounded-lg"}),children:l.jsx(Df,{})}),l.jsx(Ic,{})]}));Wo.displayName="RightSidebar";const ti={"1m":500,"5m":500,"15m":500,"1h":500,"4h":400,"1d":365,"1w":200},ri={"1m":"1m","5m":"5m","15m":"15m","1h":"1h","4h":"4h","1d":"1d","1w":"1w"};function Lf(r,e,t,n="15m"){const[s,a]=T.useState([]),[i,o]=T.useState(null),[c,d]=T.useState([]),[f,u]=T.useState(!1),h=T.useRef(null),y=T.useRef(null),x=T.useCallback(async()=>{try{u(!0);let m=[];if(r==="BINANCE"&&mt.isConfigured()){const A=ri[n],N=ti[n];m=await mt.fetchKlines(e,A,N);const I=await mt.fetchTicker(e);I&&I.price!==void 0&&o(Number(I.price))}else if(r==="STOCKS"&&br.isConfigured()){m=await br.getCandles(e,n);const A=await br.getQuote(e);A&&A.price!==void 0&&o(Number(A.price))}else if(r==="FOREX"&&yt.isConfigured()){m=await yt.getCandles(e,n);const A=await yt.getQuote(e);A&&A.bid!==void 0&&A.ask!==void 0&&o((Number(A.bid)+Number(A.ask))/2)}else{const A=Rn[r],N=ti[n],I=ri[n];let E=A.restKlines(e,N);r==="BINANCE"&&(E=E.replace(/interval=[^&]*/,`interval=${I}`));const C=await fetch(E);if(!C.ok)throw new Error(`HTTP ${C.status}`);const O=await C.json();if(r==="BINANCE"?m=O.map(P=>({x:P[0],y:[parseFloat(P[1]),parseFloat(P[2]),parseFloat(P[3]),parseFloat(P[4])]})):r==="OKX"?m=(O.data||O||[]).map(D=>({x:parseInt(D[0]),y:[parseFloat(D[1]),parseFloat(D[2]),parseFloat(D[3]),parseFloat(D[4])]})):r==="KUCOIN"?m=(O.data||O||[]).map(D=>({x:D[0]>1e12?D[0]:D[0]*1e3,y:[parseFloat(D[1]),parseFloat(D[2]),parseFloat(D[3]),parseFloat(D[4])]})):r==="COINBASE"&&(m=O.map(P=>({x:P[0]*1e3,y:[parseFloat(P[3]),parseFloat(P[2]),parseFloat(P[1]),parseFloat(P[4])]}))),m=m.map(P=>({x:P.x>1e12?P.x:P.x*1e3,y:P.y.map(D=>parseFloat(D.toString()))})),m.length>0){const P=m[m.length-1];P&&P.y&&P.y[3]!==void 0&&o(Number(P.y[3]))}}a(m),W.success(`Loaded ${m.length} candles from real API`)}catch(m){console.error("Failed to fetch candles:",m),W.error("Failed to load chart data")}finally{u(!1)}},[r,e,n]),p=T.useCallback(()=>{h.current&&h.current.close();try{if(r==="BINANCE"){const m=new WebSocket(Rn.BINANCE.wsTrade(e));h.current=m,m.onopen=()=>{W.success("WebSocket connected")},m.onmessage=A=>{try{const N=JSON.parse(A.data),I=parseFloat(N.p||N.price),E=parseFloat(N.q||N.qty||0),C=N.T?Math.floor(N.T/1e3):Math.floor(Date.now()/1e3);I&&(o(I),d(O=>[{price:I,volume:E,timestamp:C*1e3,side:"buy"},...O.slice(0,99)]))}catch(N){console.error("WebSocket message error:",N)}},m.onerror=()=>{W.error("WebSocket error")},m.onclose=()=>{h.current=null}}}catch(m){console.error("WebSocket connection error:",m),W.error("Failed to connect WebSocket")}},[r,e]),g=T.useCallback(()=>{x(),y.current&&clearInterval(y.current),y.current=setInterval(()=>{x()},15e3)},[x]);return T.useEffect(()=>(x(),t==="ws"?p():g(),()=>{h.current&&h.current.close(),y.current&&clearInterval(y.current)}),[r,e,t,x,p,g]),{candles:s,lastPrice:i,trades:c,loading:f,refetch:x}}const Mf=T.memo(di),jf=T.memo(Tc),Gf=T.memo(fi),_f=T.memo(Wo),Hf=T.memo(Nc),Kf=()=>{const[r,e]=T.useState(localStorage.getItem("omni_exchange")||"BINANCE"),[t,n]=T.useState(localStorage.getItem("omni_symbol")||is("BINANCE")[0].toLowerCase()),[s,a]=T.useState(localStorage.getItem("omni_source")||"ws"),[i,o]=T.useState(localStorage.getItem("omni_timeframe")||"15m"),[c,d]=T.useState(null),[f,u]=T.useState([]),[h,y]=T.useState("crypto"),[x,p]=T.useState({showSMA:!0,showEMA:!0,showRSI:!0,showMACD:!1,showBB:!1,showFib:!1,showPatterns:!0,smaPeriod:parseInt(localStorage.getItem("omni_sma")||"20"),emaPeriod:parseInt(localStorage.getItem("omni_ema")||"20"),rsiPeriod:parseInt(localStorage.getItem("omni_rsi")||"14")}),[g,m]=T.useState([]),A=T.useCallback((L,X="info")=>{m(S=>[{message:L,level:X,timestamp:new Date},...S.slice(0,199)])},[]),{candles:N,lastPrice:I,trades:E,refetch:C}=Lf(r,t,s,i),O=T.useMemo(()=>!x.showPatterns||N.length<10?[]:Ec(N),[N,x.showPatterns]);T.useEffect(()=>{const L=is(r).map(X=>X.toLowerCase());u(L),L.includes(t)||n(L[0])},[r]),T.useEffect(()=>{localStorage.setItem("omni_exchange",r),localStorage.setItem("omni_symbol",t),localStorage.setItem("omni_source",s),localStorage.setItem("omni_timeframe",i)},[r,t,s,i]),T.useEffect(()=>{I!=null&&c!==null&&A(`Price updated: $${Number(I).toFixed(6)}`,"info"),d(I)},[I]),T.useEffect(()=>{t&&r&&A(`Trading terminal initialized - ${r} / ${t.toUpperCase()}`,"info")},[]);const P=L=>{e(L);const X=is(L);n(X[0].toLowerCase()),A(`Switched to ${L}`,"info"),W.success(`Switched to ${L}`)},D=L=>{L&&(n(L),A(`Symbol changed to ${L.toUpperCase()}`,"info"))},j=L=>{a(L),A(`Data source changed to ${L.toUpperCase()}`,"info"),W.info(`Using ${L.toUpperCase()} data source`)},M=()=>{C(),A("Manual refresh triggered","info"),W.success("Data refreshed")},J=L=>{p(L),localStorage.setItem("omni_sma",L.smaPeriod.toString()),localStorage.setItem("omni_ema",L.emaPeriod.toString()),localStorage.setItem("omni_rsi",L.rsiPeriod.toString()),A("Indicators updated","info"),W.success("Indicators applied")};return l.jsxs(l.Fragment,{children:[l.jsx(Mf,{}),l.jsx("div",{className:"relative min-h-screen pt-24 p-4 animate-fade-in",children:l.jsxs("div",{className:"relative z-10 mx-auto max-w-[1800px] space-y-4",children:[l.jsx("div",{className:"glass-panel-strong rounded-2xl p-4 neon-border-strong animate-slide-fade-down",children:l.jsx(jf,{exchange:r,symbol:t,source:s,symbols:f,onExchangeChange:P,onSymbolChange:D,onSourceChange:j,onRefresh:M})}),l.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-[380px_1fr_380px]",children:[l.jsx(Gf,{symbols:f,activeSymbol:t,timeframe:i,indicatorSettings:x,detectedPatterns:O,candles:N,lastPrice:I,logs:g,onSymbolClick:D,onTimeframeChange:o,onApplyIndicators:J}),l.jsx(Hf,{symbol:t,exchange:r,source:s,candles:N,trades:E,lastPrice:I,previousPrice:c,indicatorSettings:x}),l.jsx(_f,{symbol:t,exchange:r,currentPrice:I,assetType:h,onSelectSymbol:(L,X)=>{n(L.toLowerCase()),y(X)}})]})]})})]})},Uu=Object.freeze(Object.defineProperty({__proto__:null,default:Kf},Symbol.toStringTag,{value:"Module"}));export{Uu as I,Bc as u};
