const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Watchlist.1762542307880.CIMx5d9a.js","assets/vendor.1762542307880.BMnP9qq1.js","assets/trading.1762542307880.BKH5-5S9.js","assets/charts.1762542307880.DO8aXVP3.js","assets/TimeframeSelector.1762542307880.BpOcVI2F.js","assets/CandlestickPatterns.1762542307880.BHRQlaRi.js"])))=>i.map(i=>d[i]);
var ue=Object.defineProperty;var pe=(r,a,t)=>a in r?ue(r,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[a]=t;var x=(r,a,t)=>pe(r,typeof a!="symbol"?a+"":a,t);import{r as i,j as e,aa as oe,ab as me}from"./vendor.1762542307880.BMnP9qq1.js";import{o as ge,B as k,V as X,T as K,W as G,w as Y,r as J,ac as Z,K as ye,ad as fe,Y as ee,A as xe,O as C,e as ae,Q as te,g as we,a3 as B,a4 as O,a5 as R,a6 as M,a7 as D,ae as be,af as ve,l as je,m as ke,n as L,s as V,_ as T,ag as Ne,u as E,ah as z,ai as Se,aj as Ie}from"./trading.1762542307880.BKH5-5S9.js";import"./charts.1762542307880.DO8aXVP3.js";const ie=i.memo(()=>{const[r,a]=i.useState(!1),[t,s]=i.useState(!1);return i.useEffect(()=>{const n=()=>{s(window.scrollY>20)};return window.addEventListener("scroll",n),()=>window.removeEventListener("scroll",n)},[]),e.jsx("nav",{className:`fixed top-0 left-0 right-0 z-50 transition-all duration-500 ${t?"bg-black/90 backdrop-blur-3xl border-b border-cyan-500/20 shadow-2xl shadow-cyan-500/10":"bg-black/70 backdrop-blur-xl border-b border-cyan-500/10"}`,children:e.jsxs("div",{className:"mx-auto max-w-[2000px] px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex h-16 items-center justify-between",children:[e.jsxs(oe,{to:"/",className:"flex items-center gap-3 group",children:[e.jsxs("div",{className:"relative flex h-10 w-10 items-center justify-center rounded-xl bg-gradient-to-br from-cyan-500/30 to-blue-600/30 shadow-2xl shadow-cyan-500/30 ring-1 ring-cyan-500/40 backdrop-blur-xl transition-all duration-300 group-hover:ring-cyan-400/60 group-hover:shadow-cyan-400/40",children:[e.jsx(ge,{className:"h-5 w-5 text-cyan-400"}),e.jsx("div",{className:"absolute inset-0 rounded-xl bg-gradient-to-br from-cyan-400/0 to-cyan-400/20 opacity-0 transition-opacity duration-300 group-hover:opacity-100"})]}),e.jsxs("div",{children:[e.jsx("h1",{className:"bg-gradient-to-r from-cyan-400 via-blue-400 to-purple-400 bg-clip-text text-xl font-black tracking-tight text-transparent",children:"NEXUS TRADE"}),e.jsx("p",{className:"text-[9px] font-semibold text-cyan-400/60 uppercase tracking-widest",children:"Pro Trading Suite"})]})]}),e.jsxs("div",{className:"hidden md:flex items-center gap-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(k,{variant:"ghost",size:"sm",className:"text-cyan-400/80 hover:text-cyan-400 hover:bg-cyan-500/10 transition-all duration-300",children:[e.jsx(X,{className:"h-4 w-4 mr-2"}),"Markets"]}),e.jsxs(k,{variant:"ghost",size:"sm",className:"text-cyan-400/80 hover:text-cyan-400 hover:bg-cyan-500/10 transition-all duration-300",children:[e.jsx(K,{className:"h-4 w-4 mr-2"}),"Analytics"]}),e.jsxs(k,{variant:"ghost",size:"sm",className:"text-cyan-400/80 hover:text-cyan-400 hover:bg-cyan-500/10 transition-all duration-300",children:[e.jsx(G,{className:"h-4 w-4 mr-2"}),"Portfolio"]})]}),e.jsxs("div",{className:"flex items-center gap-3 pl-4 border-l border-cyan-500/20",children:[e.jsxs(k,{variant:"ghost",size:"sm",className:"relative text-cyan-400/80 hover:text-cyan-400 hover:bg-cyan-500/10 transition-all duration-300",children:[e.jsx(Y,{className:"h-4 w-4"}),e.jsx("div",{className:"absolute -top-1 -right-1 h-2 w-2 bg-red-500 rounded-full animate-pulse"})]}),e.jsx(k,{variant:"ghost",size:"sm",className:"text-cyan-400/80 hover:text-cyan-400 hover:bg-cyan-500/10 transition-all duration-300",children:e.jsx(J,{className:"h-4 w-4"})}),e.jsx(k,{variant:"ghost",size:"sm",className:"text-cyan-400/80 hover:text-cyan-400 hover:bg-cyan-500/10 transition-all duration-300",children:e.jsx(Z,{className:"h-4 w-4"})})]})]}),e.jsx("button",{onClick:()=>a(!r),className:"md:hidden p-2 rounded-lg bg-cyan-500/10 border border-cyan-500/30 hover:bg-cyan-500/20 transition-all duration-300",children:r?e.jsx(ye,{className:"h-5 w-5 text-cyan-400"}):e.jsx(fe,{className:"h-5 w-5 text-cyan-400"})})]}),r&&e.jsxs("div",{className:"md:hidden py-4 space-y-3 animate-fade-in border-t border-cyan-500/20",children:[e.jsxs(k,{variant:"ghost",className:"w-full justify-start text-cyan-400/80 hover:text-cyan-400 hover:bg-cyan-500/10",children:[e.jsx(X,{className:"h-4 w-4 mr-3"}),"Markets"]}),e.jsxs(k,{variant:"ghost",className:"w-full justify-start text-cyan-400/80 hover:text-cyan-400 hover:bg-cyan-500/10",children:[e.jsx(K,{className:"h-4 w-4 mr-3"}),"Analytics"]}),e.jsxs(k,{variant:"ghost",className:"w-full justify-start text-cyan-400/80 hover:text-cyan-400 hover:bg-cyan-500/10",children:[e.jsx(G,{className:"h-4 w-4 mr-3"}),"Portfolio"]}),e.jsxs("div",{className:"border-t border-cyan-500/20 pt-3",children:[e.jsxs(k,{variant:"ghost",className:"w-full justify-start text-cyan-400/80 hover:text-cyan-400 hover:bg-cyan-500/10",children:[e.jsx(Y,{className:"h-4 w-4 mr-3"}),"Notifications"]}),e.jsxs(k,{variant:"ghost",className:"w-full justify-start text-cyan-400/80 hover:text-cyan-400 hover:bg-cyan-500/10",children:[e.jsx(J,{className:"h-4 w-4 mr-3"}),"Settings"]}),e.jsxs(k,{variant:"ghost",className:"w-full justify-start text-cyan-400/80 hover:text-cyan-400 hover:bg-cyan-500/10",children:[e.jsx(Z,{className:"h-4 w-4 mr-3"}),"Profile"]})]})]})]})})});ie.displayName="Navbar";function Ae({exchange:r,symbol:a,source:t,symbols:s,onExchangeChange:n,onSymbolChange:o,onSourceChange:l,onRefresh:c}){const[y,f]=i.useState(null);i.useEffect(()=>{ee.auth.getSession().then(({data:{session:j}})=>{f((j==null?void 0:j.user)??null)});const{data:{subscription:p}}=ee.auth.onAuthStateChange((j,N)=>{f((N==null?void 0:N.user)??null)});return()=>p.unsubscribe()},[]);const h=C[r];return e.jsxs("header",{className:"group relative overflow-hidden",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4 p-4",children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-gradient-to-br from-cyan-500/30 to-blue-600/30 shadow-lg shadow-cyan-500/30 ring-1 ring-cyan-500/40",children:e.jsx(xe,{className:"h-5 w-5 text-cyan-400"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-cyan-400",children:h.name}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-cyan-400/60",children:[e.jsx(ae,{variant:"secondary",className:"bg-cyan-500/10 text-cyan-400 border-cyan-500/20",children:h.type}),e.jsx("span",{children:"•"}),e.jsx("span",{children:h.region})]})]})]}),e.jsxs("div",{className:"hidden md:flex items-center gap-4 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1 text-cyan-400/80",children:[e.jsx(te,{className:"h-3 w-3"}),e.jsxs("span",{children:["Vol: ",h.volume24h]})]}),e.jsxs("div",{className:"flex items-center gap-1 text-cyan-400/80",children:[e.jsx(K,{className:"h-3 w-3"}),e.jsxs("span",{children:[h.pairs," pairs"]})]}),e.jsxs("div",{className:"flex items-center gap-1 text-cyan-400/80",children:[e.jsx(we,{className:"h-3 w-3"}),e.jsxs("span",{children:["Fee: ",h.fees]})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(B,{value:r,onValueChange:p=>n(p),children:[e.jsx(O,{className:"w-[160px] bg-black/40 border-cyan-500/20 text-cyan-400",children:e.jsx(R,{})}),e.jsx(M,{className:"bg-black/90 border-cyan-500/20",children:Object.keys(C).map(p=>e.jsx(D,{value:p,className:"text-cyan-400 focus:bg-cyan-500/10",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ae,{variant:"outline",className:"text-xs border-cyan-500/30 text-cyan-400/80",children:C[p].type}),C[p].name]})},p))})]})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(B,{value:a,onValueChange:o,children:[e.jsx(O,{className:"w-[120px] bg-black/40 border-cyan-500/20 text-cyan-400",children:e.jsx(R,{})}),e.jsx(M,{className:"bg-black/90 border-cyan-500/20",children:s.map(p=>e.jsx(D,{value:p,className:"text-cyan-400 focus:bg-cyan-500/10",children:p.toUpperCase()},p))})]})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(B,{value:t,onValueChange:p=>l(p),children:[e.jsx(O,{className:"w-[100px] bg-black/40 border-cyan-500/20 text-cyan-400",children:e.jsx(R,{})}),e.jsxs(M,{className:"bg-black/90 border-cyan-500/20",children:[e.jsx(D,{value:"ws",className:"text-cyan-400 focus:bg-cyan-500/10",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-2 bg-green-500 rounded-full animate-pulse"}),"WebSocket"]})}),e.jsx(D,{value:"rest",className:"text-cyan-400 focus:bg-cyan-500/10",children:"REST"})]})]})}),e.jsx(k,{onClick:c,size:"sm",variant:"outline",className:"bg-black/40 border-cyan-500/20 text-cyan-400 hover:bg-cyan-500/10 hover:border-cyan-400/40",children:e.jsx(be,{className:"h-4 w-4"})}),!y&&e.jsx(oe,{to:"/auth",children:e.jsxs(k,{size:"sm",className:"bg-gradient-to-r from-cyan-500 to-blue-600 hover:from-cyan-400 hover:to-blue-500 text-black font-semibold",children:[e.jsx(ve,{className:"mr-2 h-4 w-4"}),"Sign In"]})})]})]}),e.jsx("div",{className:"md:hidden border-t border-cyan-500/20 p-3",children:e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-1 text-cyan-400/80",children:[e.jsx(te,{className:"h-3 w-3"}),e.jsx("span",{children:h.volume24h})]}),e.jsxs("div",{className:"flex items-center gap-1 text-cyan-400/80",children:[e.jsx(K,{className:"h-3 w-3"}),e.jsxs("span",{children:[h.pairs," pairs"]})]})]}),e.jsxs("div",{className:"text-cyan-400/60",children:["Fee: ",h.fees]})]})})]})}const Ee=i.lazy(()=>T(()=>import("./Watchlist.1762542307880.CIMx5d9a.js"),__vite__mapDeps([0,1,2,3])).then(r=>({default:r.Watchlist}))),Te=i.lazy(()=>T(()=>import("./TimeframeSelector.1762542307880.BpOcVI2F.js"),__vite__mapDeps([4,1,2,3])).then(r=>({default:r.TimeframeSelector}))),Pe=i.lazy(()=>T(()=>import("./charts.1762542307880.DO8aXVP3.js").then(r=>r.D),__vite__mapDeps([3,1,2])).then(r=>({default:r.DrawingTools}))),$e=i.lazy(()=>T(()=>import("./charts.1762542307880.DO8aXVP3.js").then(r=>r.I),__vite__mapDeps([3,1,2])).then(r=>({default:r.IndicatorControls}))),Ce=i.lazy(()=>T(()=>import("./CandlestickPatterns.1762542307880.BHRQlaRi.js"),__vite__mapDeps([5,1,2,3])).then(r=>({default:r.CandlestickPatterns}))),_e=i.lazy(()=>T(()=>import("./trading.1762542307880.BKH5-5S9.js").then(r=>r.aq),__vite__mapDeps([2,1,3])).then(r=>({default:r.TradingSignals}))),Ue=i.lazy(()=>T(()=>import("./trading.1762542307880.BKH5-5S9.js").then(r=>r.ar),__vite__mapDeps([2,1,3])).then(r=>({default:r.OrderPanel}))),De=i.lazy(()=>T(()=>import("./trading.1762542307880.BKH5-5S9.js").then(r=>r.as),__vite__mapDeps([2,1,3])).then(r=>({default:r.MarketSelector}))),Ke=i.lazy(()=>T(()=>import("./trading.1762542307880.BKH5-5S9.js").then(r=>r.at),__vite__mapDeps([2,1,3])).then(r=>({default:r.RiskCalculator}))),ce=({mode:r,symbols:a,activeSymbol:t,timeframe:s,exchange:n,assetType:o,indicatorSettings:l,detectedPatterns:c,candles:y,lastPrice:f,onSymbolClick:h,onTimeframeChange:p,onApplyIndicators:j})=>{const N=()=>e.jsx("div",{className:"w-full h-32",children:e.jsx(Ne,{className:"h-full"})});return r==="left"?e.jsx("aside",{className:"glass-panel space-y-4 rounded-2xl p-5 shadow-2xl transition-all duration-300 hover:shadow-primary/10 animate-fade-in-up",children:e.jsxs(i.Suspense,{fallback:e.jsx(N,{}),children:[e.jsx(Ee,{symbols:a,activeSymbol:t,onSymbolClick:h}),e.jsx(Te,{selected:s,onChange:p}),e.jsx(Pe,{}),e.jsx($e,{settings:l,onApply:j}),l.showPatterns&&e.jsx(Ce,{patterns:c}),e.jsx(_e,{candles:y,symbol:t})]})}):e.jsx("aside",{className:"glass-panel space-y-4 rounded-2xl p-5 shadow-2xl transition-all duration-300 hover:shadow-primary/10 animate-fade-in-up",children:e.jsx(i.Suspense,{fallback:e.jsx(N,{}),children:e.jsxs(je,{defaultValue:"market",className:"w-full",children:[e.jsxs(ke,{className:"grid w-full grid-cols-3",children:[e.jsx(L,{value:"market",children:"Market"}),e.jsx(L,{value:"trade",children:"Trade"}),e.jsx(L,{value:"risk",children:"Risk"})]}),e.jsx(V,{value:"market",children:e.jsx(De,{})}),e.jsx(V,{value:"trade",children:e.jsx(Ue,{symbol:t,currentPrice:f,exchange:n,assetType:o})}),e.jsx(V,{value:"risk",children:e.jsx(Ke,{symbol:t,currentPrice:f})})]})})})};ce.displayName="Sidebar";const A={binance:{apiKey:"your_binance_api_key",secretKey:"your_binance_secret_key"},alphaVantage:{apiKey:"your_alpha_vantage_key"},polygon:{apiKey:"your_polygon_api_key"},finnhub:{apiKey:"your_finnhub_api_key"},oanda:{apiKey:"your_oanda_api_key",accountId:"your_oanda_account_id",environment:"practice"},trading:{enableRealTrading:!1}};class Fe{constructor(){x(this,"baseUrl");x(this,"wsBaseUrl","wss://stream.binance.com:9443/ws");x(this,"apiKey");x(this,"secretKey");x(this,"rateLimits",{weight:1200,orders:10,rawRequests:6100});x(this,"defaultPairs",["BTCUSDT","ETHUSDT","BNBUSDT","SOLUSDT","ADAUSDT","XRPUSDT","DOGEUSDT","DOTUSDT","MATICUSDT","AVAXUSDT"]);this.apiKey=A.binance.apiKey,this.secretKey=A.binance.secretKey,this.baseUrl="https://api.binance.com/api/v3"}getKlinesUrl(a,t,s=500){return`${this.baseUrl}/klines?symbol=${a.toUpperCase()}&interval=${t}&limit=${s}`}getDepthUrl(a,t=100){return`${this.baseUrl}/depth?symbol=${a.toUpperCase()}&limit=${t}`}getTickerUrl(a){return`${this.baseUrl}/ticker/price?symbol=${a.toUpperCase()}`}get24hrTickerUrl(a){return`${this.baseUrl}/ticker/24hr?symbol=${a.toUpperCase()}`}getTradeWebSocketUrl(a){return`${this.wsBaseUrl}/${a.toLowerCase()}@trade`}getDepthWebSocketUrl(a){return`${this.wsBaseUrl}/${a.toLowerCase()}@depth`}getKlineWebSocketUrl(a,t){return`${this.wsBaseUrl}/${a.toLowerCase()}@kline_${t}`}formatKlinesToCandles(a){return a.map(t=>({x:t[0],y:[parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3]),parseFloat(t[4])]}))}formatDepthResponse(a){return{bids:a.bids.map(([t,s])=>({price:parseFloat(t),volume:parseFloat(s)})),asks:a.asks.map(([t,s])=>({price:parseFloat(t),volume:parseFloat(s)}))}}formatTradeMessage(a){return{price:parseFloat(a.p),volume:parseFloat(a.q),timestamp:a.T,side:a.m?"sell":"buy"}}convertTimeframe(a){return{"1m":"1m","5m":"5m","15m":"15m","1h":"1h","4h":"4h","1d":"1d","1w":"1w"}[a]||"1m"}formatSymbol(a,t){return`${a.toUpperCase()}${t.toUpperCase()}`}parseSymbol(a){const t=["USDT","USDC","BUSD","BTC","ETH","BNB"];for(const s of t)if(a.endsWith(s))return{base:a.slice(0,-s.length),quote:s};return{base:a.slice(0,-4),quote:a.slice(-4)}}validateSymbol(a){return/^[A-Z]{3,10}$/.test(a.toUpperCase())}createSignature(a){return me.HmacSHA256(a,this.secretKey).toString()}createAuthHeaders(){return{"X-MBX-APIKEY":this.apiKey,"Content-Type":"application/json"}}createSignedParams(a){const t=Date.now(),s=new URLSearchParams({...a,timestamp:t.toString()}).toString(),n=this.createSignature(s);return`${s}&signature=${n}`}async getAccountInfo(){if(!this.apiKey||!this.secretKey)throw new Error("Binance API credentials not configured");const a=this.createSignedParams({}),t=`${this.baseUrl}/account?${a}`,s=await fetch(t,{method:"GET",headers:this.createAuthHeaders()});if(!s.ok){const n=await s.json();throw new Error(`Binance API Error: ${n.msg||"Unknown error"}`)}return s.json()}async getBalance(a){const s=(await this.getAccountInfo()).balances.find(n=>n.asset===a.toUpperCase());return{free:parseFloat((s==null?void 0:s.free)||"0"),locked:parseFloat((s==null?void 0:s.locked)||"0")}}async placeBuyOrder(a,t,s,n="MARKET"){throw!this.apiKey||!this.secretKey?new Error("Binance API credentials not configured"):new Error("Real trading is disabled. Enable in configuration.")}async placeSellOrder(a,t,s,n="MARKET"){throw!this.apiKey||!this.secretKey?new Error("Binance API credentials not configured"):new Error("Real trading is disabled. Enable in configuration.")}async cancelOrder(a,t){if(!this.apiKey||!this.secretKey)throw new Error("Binance API credentials not configured");const s=this.createSignedParams({symbol:a.toUpperCase(),orderId:t.toString()}),n=`${this.baseUrl}/order`,o=await fetch(n,{method:"DELETE",headers:this.createAuthHeaders(),body:s});if(!o.ok){const l=await o.json();throw new Error(`Binance Cancel Error: ${l.msg||"Unknown error"}`)}return o.json()}async getOpenOrders(a){if(!this.apiKey||!this.secretKey)throw new Error("Binance API credentials not configured");const t={};a&&(t.symbol=a.toUpperCase());const s=this.createSignedParams(t),n=`${this.baseUrl}/openOrders?${s}`,o=await fetch(n,{method:"GET",headers:this.createAuthHeaders()});if(!o.ok){const l=await o.json();throw new Error(`Binance API Error: ${l.msg||"Unknown error"}`)}return o.json()}async fetchKlines(a,t,s=500){try{const n=this.getKlinesUrl(a,t,s),o=await fetch(n);if(!o.ok)throw new Error(`HTTP ${o.status}: ${o.statusText}`);const l=await o.json();return this.formatKlinesToCandles(l)}catch(n){throw console.error("Binance fetchKlines error:",n),n}}async fetchOrderBook(a,t=100){try{const s=this.getDepthUrl(a,t),n=await fetch(s);if(!n.ok)throw new Error(`HTTP ${n.status}: ${n.statusText}`);const o=await n.json();return this.formatDepthResponse(o)}catch(s){throw console.error("Binance fetchOrderBook error:",s),s}}async fetchTicker(a){try{const[t,s]=await Promise.all([fetch(this.getTickerUrl(a)),fetch(this.get24hrTickerUrl(a))]);if(!t.ok||!s.ok)throw new Error("Failed to fetch ticker data");const n=await t.json(),o=await s.json();return{price:parseFloat(n.price),change24h:parseFloat(o.priceChangePercent)}}catch(t){throw console.error("Binance fetchTicker error:",t),t}}createAuthenticatedWebSocket(){return!this.apiKey||!this.secretKey?(console.warn("Binance API credentials not configured for WebSocket"),null):new WebSocket(this.wsBaseUrl)}isConfigured(){return!!(this.apiKey&&this.secretKey)}getConfiguration(){return{hasCredentials:this.isConfigured(),testnet:!1,tradingEnabled:A.trading.enableRealTrading}}handleError(a){var t,s;return(s=(t=a.response)==null?void 0:t.data)!=null&&s.msg?`Binance Error: ${a.response.data.msg}`:a.message?`Binance Error: ${a.message}`:"Binance: Unknown error occurred"}}const H=new Fe;class Be{constructor(){x(this,"baseUrl","https://www.alphavantage.co/query");x(this,"apiKey");this.apiKey=A.alphaVantage.apiKey}async getQuote(a){if(!this.apiKey)throw new Error("Alpha Vantage API key not configured");const t=`${this.baseUrl}?function=GLOBAL_QUOTE&symbol=${a}&apikey=${this.apiKey}`,s=await fetch(t);if(!s.ok)throw new Error(`Alpha Vantage API error: ${s.statusText}`);const o=(await s.json())["Global Quote"];if(!o)throw new Error("Invalid symbol or API limit reached");return{symbol:o["01. symbol"],price:parseFloat(o["05. price"]),change:parseFloat(o["09. change"]),changePercent:parseFloat(o["10. change percent"].replace("%","")),volume:parseInt(o["06. volume"])}}async getIntradayData(a,t="5min"){if(!this.apiKey)throw new Error("Alpha Vantage API key not configured");const s=`${this.baseUrl}?function=TIME_SERIES_INTRADAY&symbol=${a}&interval=${t}&apikey=${this.apiKey}`,n=await fetch(s);if(!n.ok)throw new Error(`Alpha Vantage API error: ${n.statusText}`);const l=(await n.json())[`Time Series (${t})`];if(!l)throw new Error("No data available or API limit reached");return Object.entries(l).map(([c,y])=>({x:new Date(c).getTime(),y:[parseFloat(y["1. open"]),parseFloat(y["2. high"]),parseFloat(y["3. low"]),parseFloat(y["4. close"])]})).reverse()}async getDailyData(a){if(!this.apiKey)throw new Error("Alpha Vantage API key not configured");const t=`${this.baseUrl}?function=TIME_SERIES_DAILY&symbol=${a}&apikey=${this.apiKey}`,s=await fetch(t);if(!s.ok)throw new Error(`Alpha Vantage API error: ${s.statusText}`);const o=(await s.json())["Time Series (Daily)"];if(!o)throw new Error("No data available or API limit reached");return Object.entries(o).slice(0,100).map(([l,c])=>({x:new Date(l).getTime(),y:[parseFloat(c["1. open"]),parseFloat(c["2. high"]),parseFloat(c["3. low"]),parseFloat(c["4. close"])]})).reverse()}}class Oe{constructor(){x(this,"baseUrl","https://api.polygon.io");x(this,"apiKey");this.apiKey=A.polygon.apiKey}async getQuote(a){var l,c,y;if(!this.apiKey)throw new Error("Polygon API key not configured");const t=`${this.baseUrl}/v2/snapshot/locale/us/markets/stocks/tickers/${a}?apikey=${this.apiKey}`,s=await fetch(t);if(!s.ok)throw new Error(`Polygon API error: ${s.statusText}`);const o=(await s.json()).results;if(!o)throw new Error("Invalid symbol or no data available");return{symbol:o.ticker,price:((l=o.lastQuote)==null?void 0:l.price)||((c=o.prevDay)==null?void 0:c.c)||0,change:o.todaysChange||0,changePercent:o.todaysChangePerc||0,volume:((y=o.day)==null?void 0:y.v)||0}}async getAggregates(a,t=1,s="minute",n,o){if(!this.apiKey)throw new Error("Polygon API key not configured");const l=`${this.baseUrl}/v2/aggs/ticker/${a}/range/${t}/${s}/${n}/${o}?adjusted=true&sort=asc&limit=5000&apikey=${this.apiKey}`,c=await fetch(l);if(!c.ok)throw new Error(`Polygon API error: ${c.statusText}`);const y=await c.json();if(!y.results)throw new Error("No data available");return y.results.map(f=>({x:f.t,y:[f.o,f.h,f.l,f.c]}))}}class Re{constructor(){x(this,"baseUrl","https://finnhub.io/api/v1");x(this,"apiKey");this.apiKey=A.finnhub.apiKey}async getQuote(a){if(!this.apiKey)throw new Error("Finnhub API key not configured");const t=`${this.baseUrl}/quote?symbol=${a}&token=${this.apiKey}`,s=await fetch(t);if(!s.ok)throw new Error(`Finnhub API error: ${s.statusText}`);const n=await s.json();if(n.error)throw new Error(`Finnhub error: ${n.error}`);return{symbol:a,price:n.c||0,change:n.d||0,changePercent:n.dp||0,volume:0}}async getCandles(a,t="5",s,n){if(!this.apiKey)throw new Error("Finnhub API key not configured");const o=`${this.baseUrl}/stock/candle?symbol=${a}&resolution=${t}&from=${s}&to=${n}&token=${this.apiKey}`,l=await fetch(o);if(!l.ok)throw new Error(`Finnhub API error: ${l.statusText}`);const c=await l.json();if(c.s!=="ok")throw new Error("No data available");return c.t.map((y,f)=>({x:y*1e3,y:[c.o[f],c.h[f],c.l[f],c.c[f]]}))}async getCompanyProfile(a){if(!this.apiKey)throw new Error("Finnhub API key not configured");const t=`${this.baseUrl}/stock/profile2?symbol=${a}&token=${this.apiKey}`,s=await fetch(t);if(!s.ok)throw new Error(`Finnhub API error: ${s.statusText}`);return s.json()}}class Me{constructor(){x(this,"alphaVantage");x(this,"polygon");x(this,"finnhub");this.alphaVantage=new Be,this.polygon=new Oe,this.finnhub=new Re}async getQuote(a,t="finnhub"){switch(t){case"alphavantage":return this.alphaVantage.getQuote(a);case"polygon":return this.polygon.getQuote(a);case"finnhub":return this.finnhub.getQuote(a);default:throw new Error("Invalid provider")}}async getCandles(a,t="5m",s="finnhub"){const n=Date.now(),o=n-24*60*60*1e3;switch(s){case"alphavantage":if(t.includes("m")){const p=t.replace("m","min");return this.alphaVantage.getIntradayData(a,p)}else return this.alphaVantage.getDailyData(a);case"polygon":const l=parseInt(t.replace(/[a-zA-Z]/g,"")),c=t.includes("m")?"minute":t.includes("h")?"hour":"day",y=new Date(o).toISOString().split("T")[0],f=new Date(n).toISOString().split("T")[0];return this.polygon.getAggregates(a,l,c,y,f);case"finnhub":let h="5";return t==="1m"?h="1":t==="5m"?h="5":t==="15m"?h="15":t==="30m"?h="30":t==="1h"?h="60":t==="1d"&&(h="D"),this.finnhub.getCandles(a,h,Math.floor(o/1e3),Math.floor(n/1e3));default:throw new Error("Invalid provider")}}getAvailableProviders(){const a=[];return a.push("alphavantage"),a.push("polygon"),a.push("finnhub"),a}isConfigured(){return this.getAvailableProviders().length>0}}const W=new Me;class Le{constructor(){x(this,"baseUrl");x(this,"apiKey");x(this,"accountId");this.apiKey=A.oanda.apiKey,this.accountId=A.oanda.accountId,this.baseUrl="https://api-fxpractice.oanda.com"}getHeaders(){return{Authorization:`Bearer ${this.apiKey}`,"Content-Type":"application/json"}}async getQuote(a){if(!this.apiKey)throw new Error("OANDA API key not configured");const t=`${this.baseUrl}/v3/accounts/${this.accountId}/pricing?instruments=${a}`,s=await fetch(t,{headers:this.getHeaders()});if(!s.ok)throw new Error(`OANDA API error: ${s.statusText}`);const o=(await s.json()).prices[0];if(!o)throw new Error("No pricing data available");return{instrument:o.instrument,bid:parseFloat(o.bids[0].price),ask:parseFloat(o.asks[0].price),spread:parseFloat(o.asks[0].price)-parseFloat(o.bids[0].price),timestamp:new Date(o.time).getTime()}}async getCandles(a,t="M5",s=500){if(!this.apiKey)throw new Error("OANDA API key not configured");const n=`${this.baseUrl}/v3/instruments/${a}/candles?granularity=${t}&count=${s}`,o=await fetch(n,{headers:this.getHeaders()});if(!o.ok)throw new Error(`OANDA API error: ${o.statusText}`);return(await o.json()).candles.map(c=>({x:new Date(c.time).getTime(),y:[parseFloat(c.mid.o),parseFloat(c.mid.h),parseFloat(c.mid.l),parseFloat(c.mid.c)]}))}async getAccountInfo(){if(!this.apiKey||!this.accountId)throw new Error("OANDA credentials not configured");const a=`${this.baseUrl}/v3/accounts/${this.accountId}`,t=await fetch(a,{headers:this.getHeaders()});if(!t.ok)throw new Error(`OANDA API error: ${t.statusText}`);return t.json()}async placeOrder(a,t,s="MARKET",n){throw!this.apiKey||!this.accountId?new Error("OANDA credentials not configured"):new Error("Real trading is disabled. Enable in configuration.")}async getPositions(){if(!this.apiKey||!this.accountId)throw new Error("OANDA credentials not configured");const a=`${this.baseUrl}/v3/accounts/${this.accountId}/positions`,t=await fetch(a,{headers:this.getHeaders()});if(!t.ok)throw new Error(`OANDA API error: ${t.statusText}`);return t.json()}}class Ve{constructor(){x(this,"oanda");this.oanda=new Le}async getQuote(a){return this.oanda.getQuote(a)}async getCandles(a,t="5m"){let s="M5";switch(t){case"1m":s="M1";break;case"5m":s="M5";break;case"15m":s="M15";break;case"30m":s="M30";break;case"1h":s="H1";break;case"4h":s="H4";break;case"1d":s="D";break}return this.oanda.getCandles(a,s)}async getAccountInfo(){return this.oanda.getAccountInfo()}async placeBuyOrder(a,t,s){return this.oanda.placeOrder(a,Math.abs(t),s?"LIMIT":"MARKET",s)}async placeSellOrder(a,t,s){return this.oanda.placeOrder(a,-Math.abs(t),s?"LIMIT":"MARKET",s)}async getPositions(){return this.oanda.getPositions()}isConfigured(){return!!A.oanda.accountId}getConfiguration(){return{hasCredentials:this.isConfigured(),environment:A.oanda.environment,tradingEnabled:A.trading.enableRealTrading}}}const q=new Ve,se={"1m":500,"5m":500,"15m":500,"1h":500,"4h":400,"1d":365,"1w":200},re={"1m":"1m","5m":"5m","15m":"15m","1h":"1h","4h":"4h","1d":"1d","1w":"1w"};function ze(r,a,t,s="15m"){const[n,o]=i.useState([]),[l,c]=i.useState(0),[y,f]=i.useState([]),[h,p]=i.useState(!1),j=i.useRef(null),N=i.useRef(null),S=i.useCallback(async()=>{try{p(!0);let d=[];if(r==="BINANCE"&&H.isConfigured()){const m=re[s],w=se[s];d=await H.fetchKlines(a,m,w);const v=await H.fetchTicker(a);v&&v.price!==void 0&&c(Number(v.price))}else if(r==="STOCKS"&&W.isConfigured()){d=await W.getCandles(a,s);const m=await W.getQuote(a);m&&m.price!==void 0&&c(Number(m.price))}else if(r==="FOREX"&&q.isConfigured()){d=await q.getCandles(a,s);const m=await q.getQuote(a);m&&m.bid!==void 0&&m.ask!==void 0&&c((Number(m.bid)+Number(m.ask))/2)}else{const m=C[r],w=se[s],v=re[s];let P=m.restKlines(a,w);r==="BINANCE"&&(P=P.replace(/interval=[^&]*/,`interval=${v}`));const $=await fetch(P);if(!$.ok)throw new Error(`HTTP ${$.status}`);const I=await $.json();if(r==="BINANCE"?d=I.map(u=>({x:u[0],y:[parseFloat(u[1]),parseFloat(u[2]),parseFloat(u[3]),parseFloat(u[4])]})):r==="OKX"?d=(I.data||I||[]).map(b=>({x:parseInt(b[0]),y:[parseFloat(b[1]),parseFloat(b[2]),parseFloat(b[3]),parseFloat(b[4])]})):r==="KUCOIN"?d=(I.data||I||[]).map(b=>({x:b[0]>1e12?b[0]:b[0]*1e3,y:[parseFloat(b[1]),parseFloat(b[2]),parseFloat(b[3]),parseFloat(b[4])]})):r==="COINBASE"&&(d=I.map(u=>({x:u[0]*1e3,y:[parseFloat(u[3]),parseFloat(u[2]),parseFloat(u[1]),parseFloat(u[4])]}))),d=d.map(u=>({x:u.x>1e12?u.x:u.x*1e3,y:u.y.map(b=>parseFloat(b.toString()))})),d.length>0){const u=d[d.length-1];u&&u.y&&u.y[3]!==void 0&&c(Number(u.y[3]))}}o(d),E.success(`Loaded ${d.length} candles from real API`)}catch(d){console.error("Failed to fetch candles:",d),E.error("Failed to load chart data")}finally{p(!1)}},[r,a,s]),U=i.useCallback(()=>{j.current&&j.current.close();try{if(r==="BINANCE"){const d=new WebSocket(C.BINANCE.wsTrade(a));j.current=d,d.onopen=()=>{E.success("WebSocket connected")},d.onmessage=m=>{try{const w=JSON.parse(m.data),v=parseFloat(w.p||w.price),P=parseFloat(w.q||w.qty||0),$=w.T?Math.floor(w.T/1e3):Math.floor(Date.now()/1e3);v&&(c(v),f(I=>[{price:v,volume:P,timestamp:$*1e3,side:"buy"},...I.slice(0,99)]))}catch(w){console.error("WebSocket message error:",w)}},d.onerror=()=>{E.error("WebSocket error")},d.onclose=()=>{j.current=null}}}catch(d){console.error("WebSocket connection error:",d),E.error("Failed to connect WebSocket")}},[r,a]),F=i.useCallback(()=>{S(),N.current&&clearInterval(N.current),N.current=setInterval(()=>{S()},15e3)},[S]);return i.useEffect(()=>(S(),t==="ws"?U():F(),()=>{j.current&&j.current.close(),N.current&&clearInterval(N.current)}),[r,a,t,S,U,F]),{candles:n,lastPrice:l,trades:y,loading:h,refetch:S}}const He=i.memo(ie),We=i.memo(Ae),ne=i.memo(ce),qe=i.memo(Ie),Je=()=>{const[r,a]=i.useState(localStorage.getItem("omni_exchange")||"BINANCE"),[t,s]=i.useState(localStorage.getItem("omni_symbol")||z("BINANCE")[0].toLowerCase()),[n,o]=i.useState(localStorage.getItem("omni_source")||"ws"),[l,c]=i.useState(localStorage.getItem("omni_timeframe")||"15m"),[y,f]=i.useState(null),[h,p]=i.useState([]),[j,N]=i.useState("crypto"),[S,U]=i.useState({showSMA:!0,showEMA:!0,showRSI:!0,showMACD:!1,showBB:!1,showFib:!1,showPatterns:!0,smaPeriod:parseInt(localStorage.getItem("omni_sma")||"20"),emaPeriod:parseInt(localStorage.getItem("omni_ema")||"20"),rsiPeriod:parseInt(localStorage.getItem("omni_rsi")||"14")}),[F,d]=i.useState([]),m=i.useCallback((g,_="info")=>{d(he=>[{message:g,level:_,timestamp:new Date},...he.slice(0,199)])},[]),{candles:w,lastPrice:v,trades:P,refetch:$}=ze(r,t,n,l),I=i.useMemo(()=>!S.showPatterns||w.length<10?[]:Se(w),[w,S.showPatterns]);i.useEffect(()=>{const g=z(r).map(_=>_.toLowerCase());p(g),g.includes(t)||s(g[0])},[r]),i.useEffect(()=>{localStorage.setItem("omni_exchange",r),localStorage.setItem("omni_symbol",t),localStorage.setItem("omni_source",n),localStorage.setItem("omni_timeframe",l)},[r,t,n,l]),i.useEffect(()=>{typeof v=="number"&&(m(`Price updated: $${v.toFixed(6)}`,"info"),f(v))},[v]),i.useEffect(()=>{t&&r&&m(`Trading terminal initialized - ${r} / ${t.toUpperCase()}`,"info")},[]);const u=g=>{a(g);const _=z(g);s(_[0].toLowerCase()),m(`Switched to ${g}`,"info"),E.success(`Switched to ${g}`)},b=g=>{g&&(s(g),m(`Symbol changed to ${g.toUpperCase()}`,"info"))},le=g=>{o(g),m(`Data source changed to ${g.toUpperCase()}`,"info"),E.info(`Using ${g.toUpperCase()} data source`)},de=()=>{$(),m("Manual refresh triggered","info"),E.success("Data refreshed")},Q=g=>{U(g),localStorage.setItem("omni_sma",g.smaPeriod.toString()),localStorage.setItem("omni_ema",g.emaPeriod.toString()),localStorage.setItem("omni_rsi",g.rsiPeriod.toString()),m("Indicators updated","info"),E.success("Indicators applied")};return e.jsxs(e.Fragment,{children:[e.jsx(He,{}),e.jsxs("div",{className:"relative min-h-screen bg-gradient-to-br from-black via-gray-900 to-black",children:[e.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-cyan-900/20 via-transparent to-transparent"}),e.jsx("div",{className:"absolute inset-0 bg-grid-white/[0.02] bg-[size:50px_50px]"}),e.jsx("div",{className:"relative z-10 pt-20 p-4 animate-fade-in",children:e.jsxs("div",{className:"mx-auto max-w-[2000px] space-y-4",children:[e.jsx("div",{className:"bg-black/40 backdrop-blur-xl border border-cyan-500/20 rounded-2xl p-4 shadow-2xl shadow-cyan-500/10",children:e.jsx(We,{exchange:r,symbol:t,source:n,symbols:h,onExchangeChange:u,onSymbolChange:b,onSourceChange:le,onRefresh:de})}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 xl:grid-cols-[320px_1fr_320px] lg:grid-cols-[280px_1fr_280px]",children:[e.jsx("div",{className:"bg-black/40 backdrop-blur-xl border border-cyan-500/20 rounded-2xl shadow-2xl shadow-cyan-500/10 overflow-hidden",children:e.jsx(ne,{mode:"left",symbols:h,activeSymbol:t,timeframe:l,indicatorSettings:S,detectedPatterns:I,candles:w,lastPrice:v,onSymbolClick:b,onTimeframeChange:c,onApplyIndicators:Q})}),e.jsx("div",{className:"bg-black/40 backdrop-blur-xl border border-cyan-500/20 rounded-2xl shadow-2xl shadow-cyan-500/10 overflow-hidden",children:e.jsx(qe,{symbol:t,exchange:r,source:n,candles:w,trades:P,lastPrice:v,previousPrice:y,indicatorSettings:S})}),e.jsx("div",{className:"bg-black/40 backdrop-blur-xl border border-cyan-500/20 rounded-2xl shadow-2xl shadow-cyan-500/10 overflow-hidden",children:e.jsx(ne,{mode:"right",symbols:h,activeSymbol:t,exchange:r,assetType:j,timeframe:l,indicatorSettings:S,detectedPatterns:I,candles:w,lastPrice:v,onSymbolClick:b,onTimeframeChange:c,onApplyIndicators:Q})})]}),e.jsx("div",{className:"bg-black/40 backdrop-blur-xl border border-cyan-500/20 rounded-2xl p-4 shadow-2xl shadow-cyan-500/10",children:e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-2 bg-green-500 rounded-full animate-pulse"}),e.jsx("span",{className:"text-cyan-400/80",children:"Live Data"})]}),e.jsxs("div",{className:"text-cyan-400/60",children:["Last Update: ",new Date().toLocaleTimeString()]})]}),e.jsxs("div",{className:"flex items-center gap-4 text-cyan-400/60",children:[e.jsx("span",{children:"Latency: 12ms"}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:["Connected: ",r]})]})]})})]})})]})]})};export{Je as default};
