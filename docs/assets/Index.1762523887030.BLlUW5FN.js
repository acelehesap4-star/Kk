const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/PortfolioTracker.1762523887030.4G10t9ZY.js","assets/vendor-features.1762523887030.7B19jVWJ.js","assets/vendor-core.1762523887030.BKSqPkvP.js","assets/trading-core.1762523887030.WpTtevx6.js","assets/trading-orders-wrapper.1762523887030.CUerKqEw.js","assets/vendor-ui.1762523887030.YpqZk-8-.js","assets/trading-advanced-orders.1762523887030.CVJHxKCx.js","assets/ParticleBackground.1762523887030.Bd4SDvNB.js","assets/chart-features.1762523887030.CrPx4KWV.js","assets/trading-feeds.1762523887030.BsG3br1g.js","assets/vendor-crypto.1762523887030.BoD6tFuA.js","assets/AutoTradingSignals.1762523887030.DKccxYMh.js","assets/SocialTrading.1762523887030.CSPjgEnq.js","assets/MarketScanner.1762523887030.D1-oI2Xh.js","assets/MarketSentiment.1762523887030.B-_Xd836.js","assets/EconomicCalendar.1762523887030.3qAKzGEg.js","assets/TradeJournal.1762523887030.-XCE7d2Z.js","assets/admin-dashboard.1762523887030.Dco3yzit.js"])))=>i.map(i=>d[i]);
var rc=Object.defineProperty;var ia=n=>{throw TypeError(n)};var nc=(n,e,t)=>e in n?rc(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var w=(n,e,t)=>nc(n,typeof e!="symbol"?e+"":e,t),is=(n,e,t)=>e.has(n)||ia("Cannot "+t);var g=(n,e,t)=>(is(n,e,"read from private field"),t?t.call(n):e.get(n)),L=(n,e,t)=>e.has(n)?ia("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),k=(n,e,t,r)=>(is(n,e,"write to private field"),r?r.call(n,t):e.set(n,t),t),q=(n,e,t)=>(is(n,e,"access private method"),t);var oa=(n,e,t,r)=>({set _(s){k(n,e,s,t)},get _(){return g(n,e,r)}});import{T as kt,o as ca,x as la,y as bs,w as sc,z as ac,R as ic,A as Rn,S as oc,d as qt,u as di,F as cc,G as lc,I as da,J as dc,K as ua,M as uc,N as ui,Z as Yr,D as fi,r as fc,O as hc,Q as xc,c as pc,V as bc,m as gc,W as mc,Y as yc,_ as St}from"./trading-orders-wrapper.1762523887030.CUerKqEw.js";import{j as l}from"./vendor-features.1762523887030.7B19jVWJ.js";import{r as C,u as hi,L as In}from"./vendor-core.1762523887030.BKSqPkvP.js";import{s as Z,B as le,u as $,h as zr,i as Qr,j as $r,k as Jr,E as Un,l as We,c as Mr,e as gs,C as wc,T as xi,a as pi,b as Wr,L as xn,I as Cn,d as Ac,M as Ec,m as Nc,n as os}from"./trading-core.1762523887030.WpTtevx6.js";import{P as fa}from"./ParticleBackground.1762523887030.Bd4SDvNB.js";import{D as vc,I as Ic,S as Cc,b as mt,d as Pc,M as kc}from"./chart-features.1762523887030.CrPx4KWV.js";import{a as Tc,N as Sc}from"./trading-feeds.1762523887030.BsG3br1g.js";import{C as Oc}from"./vendor-crypto.1762523887030.BoD6tFuA.js";import{A as Bc,R as Rc}from"./trading-advanced-orders.1762523887030.CVJHxKCx.js";const bi=C.memo(({onAdminClick:n,isAdmin:e})=>{var u,f;const t=hi(),[r,s]=C.useState(null),[a,i]=C.useState(!1),[o,c]=C.useState(!1);C.useEffect(()=>{const h=()=>{c(window.scrollY>20)};return window.addEventListener("scroll",h),()=>window.removeEventListener("scroll",h)},[]),C.useEffect(()=>{Z.auth.getSession().then(({data:{session:b}})=>{s((b==null?void 0:b.user)??null)});const{data:{subscription:h}}=Z.auth.onAuthStateChange((b,x)=>{s((x==null?void 0:x.user)??null)});return()=>h.unsubscribe()},[]);const d=async()=>{await Z.auth.signOut(),$.success("Oturumunuz sonlandırıldı"),t("/auth")};return l.jsx("nav",{className:`fixed top-0 left-0 right-0 z-50 transition-all duration-500 ${o?"bg-card/80 backdrop-blur-2xl border-b border-primary/30 shadow-xl shadow-primary/10":"bg-transparent"}`,children:l.jsxs("div",{className:"mx-auto max-w-[1800px] px-4 sm:px-6 lg:px-8",children:[l.jsxs("div",{className:"flex h-20 items-center justify-between",children:[l.jsxs(In,{to:"/",className:"flex items-center gap-3 group",children:[l.jsxs("div",{className:"relative flex h-12 w-12 items-center justify-center rounded-2xl bg-gradient-to-br from-primary/20 to-primary/10 shadow-2xl shadow-primary/30 ring-2 ring-primary/30 backdrop-blur-xl transition-all duration-300 group-hover:ring-primary/60 group-hover:shadow-primary/50",children:[l.jsx(kt,{className:"h-6 w-6 text-primary animate-pulse"}),l.jsx("div",{className:"absolute inset-0 rounded-2xl bg-gradient-to-br from-primary/0 to-primary/20 opacity-0 transition-opacity duration-300 group-hover:opacity-100"})]}),l.jsxs("div",{children:[l.jsx("h1",{className:"bg-gradient-to-r from-primary via-cyan-400 to-primary bg-clip-text text-2xl font-black tracking-tighter text-transparent drop-shadow-[0_0_20px_rgba(56,189,248,0.4)]",children:"KK TRADING"}),l.jsx("p",{className:"text-[10px] font-bold text-muted-foreground uppercase tracking-wider",children:"Trading Platform"})]})]}),l.jsx("div",{className:"hidden md:flex items-center gap-4",children:r?l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 rounded-xl bg-gradient-to-r from-primary/10 to-primary/5 border border-primary/20",children:[l.jsx("div",{className:"h-2 w-2 rounded-full bg-success animate-breathe"}),l.jsx("span",{className:"text-sm font-bold text-foreground",children:(u=r.email)==null?void 0:u.split("@")[0]})]}),e&&n&&l.jsxs(le,{onClick:n,variant:"outline",size:"sm",className:"border-primary/30 bg-gradient-to-r from-primary/10 to-primary/5 hover:from-primary/20 hover:to-primary/10 hover:border-primary/50 transition-all duration-300",children:[l.jsx(ca,{className:"w-4 h-4 mr-2"}),"Admin"]}),l.jsxs(le,{onClick:d,variant:"outline",size:"sm",className:"border-destructive/30 bg-gradient-to-r from-destructive/10 to-destructive/5 hover:from-destructive/20 hover:to-destructive/10 hover:border-destructive/50 transition-all duration-300",children:[l.jsx(la,{className:"w-4 h-4 mr-2"}),"Çıkış"]})]}):l.jsx(In,{to:"/auth",children:l.jsxs(le,{size:"sm",className:"bg-gradient-to-r from-primary to-chart-2 hover:from-primary-dark hover:to-chart-2 shadow-lg shadow-primary/30 hover:shadow-primary/50 transition-all duration-300",children:[l.jsx(bs,{className:"mr-2 h-4 w-4"}),"Giriş Yap"]})})}),l.jsx("button",{onClick:()=>i(!a),className:"md:hidden p-2 rounded-lg bg-primary/10 border border-primary/30 hover:bg-primary/20 transition-all duration-300",children:a?l.jsx(sc,{className:"h-6 w-6 text-primary"}):l.jsx(ac,{className:"h-6 w-6 text-primary"})})]}),a&&l.jsx("div",{className:"md:hidden py-4 space-y-3 animate-fade-in",children:r?l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"flex items-center justify-center gap-2 px-4 py-3 rounded-xl bg-gradient-to-r from-primary/10 to-primary/5 border border-primary/20",children:[l.jsx("div",{className:"h-2 w-2 rounded-full bg-success animate-breathe"}),l.jsx("span",{className:"text-sm font-bold text-foreground",children:(f=r.email)==null?void 0:f.split("@")[0]})]}),e&&n&&l.jsxs(le,{onClick:()=>{n(),i(!1)},variant:"outline",className:"w-full border-primary/30 bg-gradient-to-r from-primary/10 to-primary/5",children:[l.jsx(ca,{className:"w-4 h-4 mr-2"}),"Admin Panel"]}),l.jsxs(le,{onClick:()=>{d(),i(!1)},variant:"outline",className:"w-full border-destructive/30 bg-gradient-to-r from-destructive/10 to-destructive/5",children:[l.jsx(la,{className:"w-4 h-4 mr-2"}),"Çıkış Yap"]})]}):l.jsx(In,{to:"/auth",onClick:()=>i(!1),children:l.jsxs(le,{className:"w-full bg-gradient-to-r from-primary to-chart-2 shadow-lg shadow-primary/30",children:[l.jsx(bs,{className:"mr-2 h-4 w-4"}),"Giriş Yap"]})})})]})})});bi.displayName="Navbar";function Uc({exchange:n,symbol:e,source:t,symbols:r,onExchangeChange:s,onSymbolChange:a,onSourceChange:i,onRefresh:o}){const[c,d]=C.useState(null);return C.useEffect(()=>{Z.auth.getSession().then(({data:{session:f}})=>{d((f==null?void 0:f.user)??null)});const{data:{subscription:u}}=Z.auth.onAuthStateChange((f,h)=>{d((h==null?void 0:h.user)??null)});return()=>u.unsubscribe()},[]),l.jsxs("header",{className:"group relative flex flex-wrap items-center justify-between gap-5 overflow-hidden rounded-2xl border-2 border-primary/30 bg-gradient-to-br from-card via-card/80 to-card/60 p-6 shadow-2xl shadow-primary/20 backdrop-blur-2xl transition-all duration-500 hover:border-primary/40 hover:shadow-[0_0_60px_rgba(56,189,248,0.3)]",children:[l.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-primary/8 via-transparent to-accent/8 opacity-0 transition-opacity duration-700 group-hover:opacity-100"}),l.jsx("div",{className:"absolute -top-24 -left-24 w-48 h-48 bg-primary/10 rounded-full blur-3xl"}),l.jsx("div",{className:"absolute -bottom-24 -right-24 w-48 h-48 bg-accent/10 rounded-full blur-3xl"}),l.jsx("div",{className:"relative z-10",children:l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-2xl bg-gradient-to-br from-primary/20 to-primary/10 shadow-2xl shadow-primary/30 ring-2 ring-primary/30 backdrop-blur-xl",children:l.jsx("div",{className:"h-6 w-6 rounded-lg bg-gradient-to-br from-primary via-primary to-primary/60 animate-pulse shadow-lg shadow-primary/50"})}),l.jsxs("div",{children:[l.jsx("h1",{className:"bg-gradient-to-r from-primary via-cyan-400 to-primary bg-clip-text text-3xl font-black tracking-tighter text-transparent drop-shadow-[0_0_20px_rgba(56,189,248,0.4)]",children:"KK TRADING"}),l.jsx("p",{className:"text-xs font-bold text-muted-foreground uppercase tracking-wider",children:"Multi-Exchange Trading Platform"})]})]})}),l.jsxs("div",{className:"relative z-10 flex flex-wrap items-center gap-3",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("label",{className:"text-sm text-muted-foreground",children:"Exchange:"}),l.jsxs(zr,{value:n,onValueChange:u=>s(u),children:[l.jsx(Qr,{className:"w-[140px]",children:l.jsx($r,{})}),l.jsx(Jr,{children:Object.keys(Un).map(u=>l.jsx(We,{value:u,children:Un[u].name},u))})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("label",{className:"text-sm text-muted-foreground",children:"Symbol:"}),l.jsxs(zr,{value:e,onValueChange:a,children:[l.jsx(Qr,{className:"w-[140px]",children:l.jsx($r,{})}),l.jsx(Jr,{children:r.map(u=>l.jsx(We,{value:u,children:u.toUpperCase()},u))})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("label",{className:"text-sm text-muted-foreground",children:"Source:"}),l.jsxs(zr,{value:t,onValueChange:u=>i(u),children:[l.jsx(Qr,{className:"w-[100px]",children:l.jsx($r,{})}),l.jsxs(Jr,{children:[l.jsx(We,{value:"ws",children:"WebSocket"}),l.jsx(We,{value:"rest",children:"REST"})]})]})]}),l.jsx(le,{onClick:o,size:"sm",variant:"outline",children:l.jsx(ic,{className:"h-4 w-4"})}),!c&&l.jsx(In,{to:"/auth",children:l.jsxs(le,{size:"sm",className:"bg-gradient-to-r from-primary to-chart-2",children:[l.jsx(bs,{className:"mr-2 h-4 w-4"}),"Sign In"]})})]})]})}const Fc="wss://stream.binance.com:9443/ws",Dc="https://api.binance.com/api/v3",Lc=n=>{const[e,t]=C.useState(new Map),[r,s]=C.useState(!0),a=C.useCallback(async()=>{try{s(!0);const o=n.map(async u=>{const f=u.replace("/","").toUpperCase(),h=await fetch(`${Dc}/ticker/24hr?symbol=${f}USDT`);if(!h.ok)return{symbol:u,price:Math.random()*7e4+1e4,change24h:(Math.random()-.5)*10,volume:Math.random()*1e9,high24h:Math.random()*75e3+15e3,low24h:Math.random()*65e3+5e3};const b=await h.json();return{symbol:u,price:parseFloat(b.lastPrice),change24h:parseFloat(b.priceChangePercent),volume:parseFloat(b.volume),high24h:parseFloat(b.highPrice),low24h:parseFloat(b.lowPrice)}}),c=await Promise.all(o),d=new Map(c.map(u=>[u.symbol,u]));t(d)}catch(o){console.error("Error fetching initial prices:",o);const c=new Map(n.map(d=>[d,{symbol:d,price:Math.random()*7e4+1e4,change24h:(Math.random()-.5)*10,volume:Math.random()*1e9,high24h:Math.random()*75e3+15e3,low24h:Math.random()*65e3+5e3}]));t(c)}finally{s(!1)}},[n]);C.useEffect(()=>{a();const o=n.map(f=>`${f.replace("/","").toLowerCase()}usdt@ticker`),c=`${Fc}/${o.join("/")}`;let d;try{d=new WebSocket(c),d.onmessage=f=>{try{const h=JSON.parse(f.data);(Array.isArray(h)?h:[h]).forEach(x=>{if(x.s){const p=x.s.replace("USDT","").toUpperCase();t(m=>{const y=new Map(m);return y.set(p,{symbol:p,price:parseFloat(x.c),change24h:parseFloat(x.P),volume:parseFloat(x.v),high24h:parseFloat(x.h),low24h:parseFloat(x.l)}),y})}})}catch(h){console.error("WebSocket message error:",h)}},d.onerror=()=>{console.error("WebSocket error, using polling fallback")}}catch(f){console.error("WebSocket connection error:",f)}const u=setInterval(()=>{a()},1e4);return()=>{d&&d.close(),clearInterval(u)}},[n,a]);const i=C.useCallback(o=>e.get(o),[e]);return{prices:e,loading:r,getPrice:i}};function Mc({symbols:n,activeSymbol:e,onSymbolClick:t}){const[r,s]=C.useState([]),[a,i]=C.useState(!1),[o,c]=C.useState(new Set),{prices:d,getPrice:u}=Lc(n);C.useEffect(()=>{f()},[]);const f=async()=>{try{const{data:{user:x}}=await Z.auth.getUser();if(!x)return;const{data:p,error:m}=await Z.from("user_watchlist").select("symbol, is_favorite").eq("user_id",x.id);if(m)throw m;const y=new Set((p==null?void 0:p.filter(A=>A.is_favorite).map(A=>A.symbol))||[]);c(y)}catch(x){console.error("Error fetching watchlist:",x)}};C.useEffect(()=>{const x=n.map(p=>{const m=u(p);return{symbol:p,price:(m==null?void 0:m.price)||0,change24h:(m==null?void 0:m.change24h)||0,volume:(m==null?void 0:m.volume)||0,isFavorite:o.has(p)}});s(x)},[n,d,o,u]);const h=async(x,p)=>{p.stopPropagation();try{const{data:{user:m}}=await Z.auth.getUser();if(!m){$.error("Please login to add favorites");return}if(o.has(x)){const{error:A}=await Z.from("user_watchlist").delete().eq("user_id",m.id).eq("symbol",x);if(A)throw A;c(N=>{const T=new Set(N);return T.delete(x),T}),$.success(`${x} removed from favorites`)}else{const{error:A}=await Z.from("user_watchlist").insert({user_id:m.id,symbol:x,is_favorite:!0});if(A)throw A;c(N=>new Set(N).add(x)),$.success(`${x} added to favorites`)}}catch(m){console.error("Error toggling favorite:",m),$.error("Failed to update favorites")}},b=a?r:r.slice(0,6);return l.jsxs("div",{className:"space-y-3 animate-fade-in",children:[l.jsxs("div",{className:"relative overflow-hidden rounded-xl bg-gradient-to-r from-primary/10 via-cyan-500/10 to-primary/10 border border-primary/20 p-3",children:[l.jsx("div",{className:"absolute inset-0 bg-grid-pattern opacity-5"}),l.jsxs("div",{className:"relative z-10 flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"p-1.5 rounded-lg bg-primary/20 backdrop-blur-sm",children:l.jsx(Rn,{className:"w-4 h-4 text-primary animate-pulse"})}),l.jsx("h3",{className:"text-sm font-bold tracking-wide text-foreground",children:"Elite Watchlist"})]}),l.jsx(le,{variant:"ghost",size:"sm",className:"h-7 gap-1 text-xs hover:bg-primary/20",onClick:()=>i(!a),children:a?"Show Less":`+${r.length-6}`})]})]}),l.jsx("div",{className:"grid grid-cols-1 gap-2",children:b.map(x=>{const p=x.symbol===e,m=x.change24h>=0;return l.jsxs("div",{onClick:()=>t(x.symbol),className:Mr("relative overflow-hidden rounded-xl border p-4 transition-all duration-300 cursor-pointer group",p?"bg-gradient-to-r from-primary/20 via-cyan-500/20 to-primary/20 border-primary/50 shadow-xl shadow-primary/30 scale-[1.02]":"border-border/40 bg-card/20 hover:border-primary/40 hover:bg-card/40 hover:scale-[1.01]"),children:[p&&l.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-white/10 via-transparent to-white/5 animate-shimmer"}),l.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-gradient-to-br from-primary/10 to-transparent rounded-full blur-2xl"}),l.jsxs("div",{className:"relative z-10 space-y-2",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"p-1 rounded bg-primary/10",children:l.jsx("span",{className:"font-mono text-xs font-bold text-foreground",children:x.symbol.toUpperCase()})}),l.jsx(oc,{className:Mr("w-3.5 h-3.5 cursor-pointer transition-all duration-300",x.isFavorite?"fill-yellow-500 text-yellow-500 scale-110":"text-muted-foreground hover:text-yellow-500 hover:scale-110"),onClick:y=>h(x.symbol,y)})]}),l.jsxs(gs,{variant:m?"default":"destructive",className:Mr("text-[10px] font-bold flex items-center gap-1",m?"bg-success/20 text-success border-success/30":"bg-destructive/20 text-destructive border-destructive/30"),children:[m?l.jsx(kt,{className:"w-3 h-3"}):l.jsx(qt,{className:"w-3 h-3"}),m?"+":"",x.change24h.toFixed(2),"%"]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("div",{className:"flex items-baseline gap-2",children:l.jsxs("span",{className:"text-2xl font-bold text-foreground tracking-tight",children:["$",x.price.toFixed(2)]})}),l.jsxs("div",{className:"flex items-center justify-between text-xs",children:[l.jsxs("span",{className:"text-muted-foreground flex items-center gap-1",children:[l.jsx(Rn,{className:"w-3 h-3"}),"Vol: $",(x.volume/1e6).toFixed(1),"M"]}),x.isFavorite&&l.jsx(gs,{variant:"outline",className:"text-[9px] bg-yellow-500/10 text-yellow-500 border-yellow-500/30",children:"Favorite"})]})]}),l.jsx("div",{className:"h-10 opacity-0 group-hover:opacity-100 transition-all duration-300 mt-2",children:l.jsx("div",{className:Mr("h-full rounded-lg bg-gradient-to-r relative overflow-hidden",m?"from-success/10 via-success/20 to-success/10":"from-destructive/10 via-destructive/20 to-destructive/10"),children:l.jsx("div",{className:"absolute inset-0 flex items-end justify-around p-1",children:[...Array(12)].map((y,A)=>l.jsx("div",{className:Mr("w-1 rounded-full",m?"bg-success/40":"bg-destructive/40"),style:{height:`${Math.random()*100}%`}},A))})})})]})]},x.symbol)})})]})}const jc=["1m","5m","15m","1h","4h","1d","1w"],Gc=({selected:n,onChange:e})=>l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(di,{className:"w-4 h-4 text-primary"}),l.jsx("h3",{className:"text-sm font-semibold text-foreground uppercase tracking-wide",children:"Timeframe"})]}),l.jsx("div",{className:"grid grid-cols-4 gap-2",children:jc.map(t=>l.jsx(le,{variant:n===t?"default":"outline",size:"sm",onClick:()=>e(t),className:`h-8 transition-all ${n===t?"shadow-lg shadow-primary/20":"hover:border-primary/30"}`,children:t},t))})]}),_c=()=>{const[n,e]=C.useState("single"),t=[{id:"single",icon:lc,label:"Single",cols:1},{id:"dual-vertical",icon:da,label:"Dual V",cols:2},{id:"dual-horizontal",icon:da,label:"Dual H",cols:1,rotate:!0},{id:"quad",icon:dc,label:"Quad",cols:2}],r=s=>{var a;e(s),$.success("Layout changed",{description:(a=t.find(i=>i.id===s))==null?void 0:a.label})};return l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(cc,{className:"w-4 h-4 text-chart-4"}),l.jsx("h3",{className:"text-sm font-semibold text-foreground uppercase tracking-wide",children:"Chart Layout"})]}),l.jsx("div",{className:"grid grid-cols-4 gap-2",children:t.map(s=>l.jsxs(le,{variant:n===s.id?"default":"outline",size:"sm",onClick:()=>r(s.id),className:`flex-col h-auto py-3 gap-1 transition-all ${n===s.id?"ring-2 ring-primary":""}`,children:[l.jsx(s.icon,{className:`w-4 h-4 ${s.rotate?"rotate-90":""} ${n===s.id?"text-primary-foreground":"text-chart-4"}`}),l.jsx("span",{className:"text-[10px]",children:s.label})]},s.id))}),l.jsxs("div",{className:"p-4 rounded-lg bg-muted/20 border border-border",children:[l.jsx("div",{className:"text-xs text-muted-foreground mb-3 text-center",children:"Preview"}),n==="single"&&l.jsx("div",{className:"aspect-video rounded border-2 border-dashed border-primary/30 bg-primary/5 flex items-center justify-center",children:l.jsx("span",{className:"text-xs text-muted-foreground",children:"Main Chart"})}),n==="dual-vertical"&&l.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[l.jsx("div",{className:"aspect-video rounded border-2 border-dashed border-primary/30 bg-primary/5 flex items-center justify-center",children:l.jsx("span",{className:"text-xs text-muted-foreground",children:"Chart 1"})}),l.jsx("div",{className:"aspect-video rounded border-2 border-dashed border-chart-4/30 bg-chart-4/5 flex items-center justify-center",children:l.jsx("span",{className:"text-xs text-muted-foreground",children:"Chart 2"})})]}),n==="dual-horizontal"&&l.jsxs("div",{className:"grid grid-rows-2 gap-2",children:[l.jsx("div",{className:"aspect-video rounded border-2 border-dashed border-primary/30 bg-primary/5 flex items-center justify-center",children:l.jsx("span",{className:"text-xs text-muted-foreground",children:"Chart 1"})}),l.jsx("div",{className:"aspect-video rounded border-2 border-dashed border-chart-4/30 bg-chart-4/5 flex items-center justify-center",children:l.jsx("span",{className:"text-xs text-muted-foreground",children:"Chart 2"})})]}),n==="quad"&&l.jsx("div",{className:"grid grid-cols-2 grid-rows-2 gap-2",children:[1,2,3,4].map(s=>l.jsx("div",{className:`aspect-video rounded border-2 border-dashed ${s===1?"border-primary/30 bg-primary/5":s===2?"border-chart-4/30 bg-chart-4/5":s===3?"border-chart-2/30 bg-chart-2/5":"border-chart-3/30 bg-chart-3/5"} flex items-center justify-center`,children:l.jsxs("span",{className:"text-[10px] text-muted-foreground",children:["Chart ",s]})},s))})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("div",{className:"text-xs font-semibold text-muted-foreground uppercase tracking-wide",children:"Chart Assignments"}),n!=="single"&&l.jsx("div",{className:"space-y-1",children:Array.from({length:n==="quad"?4:2}).map((s,a)=>l.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg bg-muted/30 border border-border text-xs",children:[l.jsxs("span",{className:"text-muted-foreground",children:["Chart ",a+1]}),l.jsxs("select",{className:"bg-background border border-border rounded px-2 py-1 text-foreground",children:[l.jsx("option",{children:"BTC/USDT"}),l.jsx("option",{children:"ETH/USDT"}),l.jsx("option",{children:"BNB/USDT"})]})]},a))})]})]})},Hc=({patterns:n})=>{if(n.length===0)return l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(ua,{className:"w-4 h-4 text-chart-2"}),l.jsx("h3",{className:"text-sm font-semibold text-foreground uppercase tracking-wide",children:"Patterns"})]}),l.jsx("div",{className:"text-sm text-muted-foreground p-3 rounded-lg bg-muted/20",children:"No patterns detected"})]});const e=r=>r==="bullish"?kt:r==="bearish"?qt:uc,t=r=>r==="bullish"?"text-success bg-success/10 border-success/20":r==="bearish"?"text-destructive bg-destructive/10 border-destructive/20":"text-muted-foreground bg-muted/20 border-muted/20";return l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(ua,{className:"w-4 h-4 text-chart-2"}),l.jsx("h3",{className:"text-sm font-semibold text-foreground uppercase tracking-wide",children:"Patterns"})]}),l.jsx("div",{className:"space-y-2",children:n.slice(0,5).map((r,s)=>{const a=e(r.signal);return l.jsx("div",{className:`p-3 rounded-lg border ${t(r.signal)} transition-all hover:scale-105`,children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(a,{className:"w-4 h-4 flex-shrink-0"}),l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-sm font-medium",children:r.name}),l.jsxs("span",{className:"text-[10px] px-2 py-0.5 rounded-full bg-background/50 uppercase",children:[(r.strength*100).toFixed(0),"%"]})]}),l.jsxs("div",{className:"text-xs text-muted-foreground mt-1 capitalize",children:[r.signal," signal"]})]})]})},s)})})]})};function Kc({candles:n,currentPrice:e,symbol:t}){var x,p;if(n.length===0)return l.jsx("div",{className:"grid grid-cols-2 gap-3",children:[1,2,3,4].map(m=>l.jsxs("div",{className:"glass-panel animate-pulse rounded-xl p-4",children:[l.jsx("div",{className:"h-4 w-20 rounded bg-muted/20"}),l.jsx("div",{className:"mt-2 h-6 w-16 rounded bg-muted/20"})]},m))});const r=n.slice(-1440),s=Math.max(...r.map(m=>m.y[1])),a=Math.min(...r.map(m=>m.y[2])),i=((x=r[0])==null?void 0:x.y[0])||e||0,o=e||((p=r[r.length-1])==null?void 0:p.y[3])||0,c=o-i,d=c/i*100,f=r.map(m=>(m.y[1]-m.y[2])*1e3).reduce((m,y)=>m+y,0),h=(s-a)/a*100,b=[{label:"24h Change",value:`${d>=0?"+":""}${d.toFixed(2)}%`,subValue:`${c>=0?"+":""}$${Math.abs(c).toFixed(2)}`,icon:d>=0?kt:qt,color:d>=0?"text-success":"text-destructive",bgColor:d>=0?"bg-success/10":"bg-destructive/10"},{label:"24h High",value:`$${s.toFixed(2)}`,subValue:`+${((s-o)/o*100).toFixed(2)}%`,icon:kt,color:"text-primary",bgColor:"bg-primary/10"},{label:"24h Low",value:`$${a.toFixed(2)}`,subValue:`${((a-o)/o*100).toFixed(2)}%`,icon:qt,color:"text-chart-4",bgColor:"bg-chart-4/10"},{label:"24h Volume",value:`${(f/1e6).toFixed(2)}M`,subValue:`${t.toUpperCase()}`,icon:ui,color:"text-chart-2",bgColor:"bg-chart-2/10"},{label:"Volatility",value:`${h.toFixed(2)}%`,subValue:"Price range",icon:Yr,color:"text-chart-5",bgColor:"bg-chart-5/10"},{label:"Market Cap",value:"—",subValue:"N/A",icon:fi,color:"text-muted-foreground",bgColor:"bg-muted/10"}];return l.jsxs("div",{className:"space-y-5",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"flex h-9 w-9 items-center justify-center rounded-xl bg-primary/15 ring-2 ring-primary/35 shadow-lg shadow-primary/20",children:l.jsx(Rn,{className:"h-5 w-5 text-primary animate-pulse"})}),l.jsxs("div",{children:[l.jsx("h4",{className:"text-sm font-black text-foreground uppercase tracking-wide",children:"Performance Matrix"}),l.jsx("p",{className:"text-[9px] text-muted-foreground font-mono",children:"Advanced market analytics"})]})]}),l.jsx("div",{className:"grid grid-cols-2 gap-4",children:b.map((m,y)=>{const A=m.icon;return l.jsxs("div",{className:"group relative overflow-hidden rounded-xl border-2 border-border/40 bg-gradient-to-br from-card to-card/70 p-4 backdrop-blur-xl transition-all duration-500 hover:scale-[1.03] hover:border-primary/40 hover:shadow-2xl hover:shadow-primary/10 animate-fade-in-up",style:{animationDelay:`${y*50}ms`},children:[l.jsx("div",{className:"absolute top-0 left-0 right-0 h-[1px] bg-gradient-to-r from-transparent via-primary/30 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),l.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-primary/3 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),l.jsxs("div",{className:"relative z-10 flex items-start justify-between",children:[l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("div",{className:"text-[10px] font-black text-muted-foreground uppercase tracking-wider mb-2",children:m.label}),l.jsx("div",{className:`font-mono text-xl font-black ${m.color} drop-shadow-[0_0_8px_rgba(56,189,248,0.3)] mb-1`,children:m.value}),l.jsx("div",{className:"text-[10px] text-muted-foreground font-mono font-bold",children:m.subValue})]}),l.jsx("div",{className:`flex h-11 w-11 items-center justify-center rounded-xl ${m.bgColor} ring-2 ring-${m.color.replace("text-","")}/30 shadow-lg`,children:l.jsx(A,{className:`h-5 w-5 ${m.color}`})})]})]},y)})})]})}const Vc=({symbol:n,price:e})=>{const t=[{label:"Avg Trade",value:"$1,234.56",icon:ui,change:"+2.5%",positive:!0},{label:"Trades/min",value:"48",icon:di,change:"+12%",positive:!0},{label:"Buy Pressure",value:"65%",icon:fc,change:"+5%",positive:!0},{label:"Activity",value:"High",icon:Yr,change:"Trending",positive:!0}];return l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"flex h-9 w-9 items-center justify-center rounded-xl bg-primary/15 ring-2 ring-primary/35 shadow-lg shadow-primary/20",children:l.jsx(Yr,{className:"w-5 h-5 text-primary animate-pulse"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-sm font-black text-foreground uppercase tracking-wide",children:"Quick Analytics"}),l.jsx("p",{className:"text-[9px] text-muted-foreground font-mono",children:"Real-time market metrics"})]})]}),l.jsx("div",{className:"grid grid-cols-2 gap-3",children:t.map((r,s)=>l.jsxs("div",{className:"relative overflow-hidden rounded-xl border-2 border-border/40 bg-gradient-to-br from-card to-card/70 p-4 backdrop-blur-xl transition-all duration-300 hover:scale-[1.05] hover:border-primary/40 hover:shadow-xl hover:shadow-primary/10 animate-fade-in",style:{animationDelay:`${s*50}ms`},children:[l.jsx("div",{className:"absolute top-0 left-0 right-0 h-[1px] bg-gradient-to-r from-transparent via-primary/30 to-transparent"}),l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-lg bg-primary/15 ring-2 ring-primary/30",children:l.jsx(r.icon,{className:"w-4 h-4 text-primary"})}),l.jsx("span",{className:`px-2 py-0.5 rounded-lg text-[9px] font-black uppercase tracking-wider ${r.positive?"bg-success/20 text-success ring-1 ring-success/40":"bg-destructive/20 text-destructive ring-1 ring-destructive/40"}`,children:r.change})]}),l.jsx("div",{className:"text-[10px] text-muted-foreground font-bold uppercase tracking-wider mb-1.5",children:r.label}),l.jsx("div",{className:"text-lg font-black text-foreground",children:r.value})]},s))})]})},gi=C.memo(({symbols:n,activeSymbol:e,timeframe:t,indicatorSettings:r,detectedPatterns:s,candles:a,lastPrice:i,logs:o,onSymbolClick:c,onTimeframeChange:d,onApplyIndicators:u})=>l.jsxs("aside",{className:"glass-panel space-y-4 rounded-2xl p-5 shadow-2xl transition-all duration-300 hover:shadow-primary/10 animate-fade-in-up",children:[l.jsx(Mc,{symbols:n,activeSymbol:e,onSymbolClick:c}),l.jsx(Gc,{selected:t,onChange:d}),l.jsx(_c,{}),l.jsx(vc,{}),l.jsx(Ic,{settings:r,onApply:u}),r.showPatterns&&l.jsx(Hc,{patterns:s}),l.jsx(Kc,{candles:a,currentPrice:i,symbol:e}),l.jsx(Vc,{symbol:e,price:i}),l.jsx(Tc,{candles:a,symbol:e})]}));gi.displayName="LeftSidebar";const oe={binance:{apiKey:"your_binance_api_key",secretKey:"your_binance_secret_key"},alphaVantage:{apiKey:"your_alpha_vantage_key"},polygon:{apiKey:"your_polygon_api_key"},finnhub:{apiKey:"your_finnhub_api_key"},oanda:{apiKey:"your_oanda_api_key",accountId:"your_oanda_account_id",environment:"practice"},coldWallets:{btc:"your_btc_cold_wallet_address",eth:"your_eth_cold_wallet_address",bsc:"your_bsc_cold_wallet_address",polygon:"your_polygon_cold_wallet_address",solana:"your_solana_cold_wallet_address",tron:"your_tron_cold_wallet_address"},trading:{enableRealTrading:!1}},zc="6.15.0";function Qc(n,e,t){const r=e.split("|").map(a=>a.trim());for(let a=0;a<r.length;a++)switch(e){case"any":return;case"bigint":case"boolean":case"number":case"string":if(typeof n===e)return}const s=new Error(`invalid value for type ${e}`);throw s.code="INVALID_ARGUMENT",s.argument=`value.${t}`,s.value=n,s}async function ms(n){const e=Object.keys(n);return(await Promise.all(e.map(r=>Promise.resolve(n[r])))).reduce((r,s,a)=>(r[e[a]]=s,r),{})}function K(n,e,t){for(let r in e){let s=e[r];const a=t?t[r]:null;a&&Qc(s,a,r),Object.defineProperty(n,r,{enumerable:!0,value:s,writable:!1})}}function ur(n,e){if(n==null)return"null";if(e==null&&(e=new Set),typeof n=="object"){if(e.has(n))return"[Circular]";e.add(n)}if(Array.isArray(n))return"[ "+n.map(t=>ur(t,e)).join(", ")+" ]";if(n instanceof Uint8Array){const t="0123456789abcdef";let r="0x";for(let s=0;s<n.length;s++)r+=t[n[s]>>4],r+=t[n[s]&15];return r}if(typeof n=="object"&&typeof n.toJSON=="function")return ur(n.toJSON(),e);switch(typeof n){case"boolean":case"number":case"symbol":return n.toString();case"bigint":return BigInt(n).toString();case"string":return JSON.stringify(n);case"object":{const t=Object.keys(n);return t.sort(),"{ "+t.map(r=>`${ur(r,e)}: ${ur(n[r],e)}`).join(", ")+" }"}}return"[ COULD NOT SERIALIZE ]"}function Tr(n,e){return n&&n.code===e}function mi(n){return Tr(n,"CALL_EXCEPTION")}function Xt(n,e,t){let r=n;{const a=[];if(t){if("message"in t||"code"in t||"name"in t)throw new Error(`value will overwrite populated values: ${ur(t)}`);for(const i in t){if(i==="shortMessage")continue;const o=t[i];a.push(i+"="+ur(o))}}a.push(`code=${e}`),a.push(`version=${zc}`),a.length&&(n+=" ("+a.join(", ")+")")}let s;switch(e){case"INVALID_ARGUMENT":s=new TypeError(n);break;case"NUMERIC_FAULT":case"BUFFER_OVERRUN":s=new RangeError(n);break;default:s=new Error(n)}return K(s,{code:e}),t&&Object.assign(s,t),s.shortMessage==null&&K(s,{shortMessage:r}),s}function U(n,e,t,r){if(!n)throw Xt(e,t,r)}function v(n,e,t,r){U(n,e,"INVALID_ARGUMENT",{argument:t,value:r})}function yi(n,e,t){t==null&&(t=""),t&&(t=": "+t),U(n>=e,"missing argument"+t,"MISSING_ARGUMENT",{count:n,expectedCount:e}),U(n<=e,"too many arguments"+t,"UNEXPECTED_ARGUMENT",{count:n,expectedCount:e})}const $c=["NFD","NFC","NFKD","NFKC"].reduce((n,e)=>{try{if("test".normalize(e)!=="test")throw new Error("bad");if(e==="NFD"&&"é".normalize("NFD")!=="é")throw new Error("broken");n.push(e)}catch{}return n},[]);function Jc(n){U($c.indexOf(n)>=0,"platform missing String.prototype.normalize","UNSUPPORTED_OPERATION",{operation:"String.prototype.normalize",info:{form:n}})}function Gn(n,e,t){if(t==null&&(t=""),n!==e){let r=t,s="new";t&&(r+=".",s+=" "+t),U(!1,`private constructor; use ${r}from* methods`,"UNSUPPORTED_OPERATION",{operation:s})}}function wi(n,e,t){if(n instanceof Uint8Array)return t?new Uint8Array(n):n;if(typeof n=="string"&&n.match(/^0x(?:[0-9a-f][0-9a-f])*$/i)){const r=new Uint8Array((n.length-2)/2);let s=2;for(let a=0;a<r.length;a++)r[a]=parseInt(n.substring(s,s+2),16),s+=2;return r}v(!1,"invalid BytesLike value",e||"value",n)}function X(n,e){return wi(n,e,!1)}function qe(n,e){return wi(n,e,!0)}function Ee(n,e){return!(typeof n!="string"||!n.match(/^0x[0-9A-Fa-f]*$/)||typeof e=="number"&&n.length!==2+2*e||e===!0&&n.length%2!==0)}function Ai(n){return Ee(n,!0)||n instanceof Uint8Array}const ha="0123456789abcdef";function V(n){const e=X(n);let t="0x";for(let r=0;r<e.length;r++){const s=e[r];t+=ha[(s&240)>>4]+ha[s&15]}return t}function Ct(n){return"0x"+n.map(e=>V(e).substring(2)).join("")}function xa(n){return Ee(n,!0)?(n.length-2)/2:X(n).length}function cr(n,e,t){const r=X(n);return t!=null&&t>r.length&&U(!1,"cannot slice beyond data bounds","BUFFER_OVERRUN",{buffer:r,length:r.length,offset:t}),V(r.slice(e??0,t??r.length))}function Ei(n,e,t){const r=X(n);U(e>=r.length,"padding exceeds data length","BUFFER_OVERRUN",{buffer:new Uint8Array(r),length:e,offset:e+1});const s=new Uint8Array(e);return s.fill(0),t?s.set(r,e-r.length):s.set(r,0),V(s)}function Ni(n,e){return Ei(n,e,!0)}function Wc(n,e){return Ei(n,e,!1)}const _n=BigInt(0),Ge=BigInt(1),fr=9007199254740991;function Zc(n,e){const t=Hn(n,"value"),r=BigInt(te(e,"width"));if(U(t>>r===_n,"overflow","NUMERIC_FAULT",{operation:"fromTwos",fault:"overflow",value:n}),t>>r-Ge){const s=(Ge<<r)-Ge;return-((~t&s)+Ge)}return t}function Yc(n,e){let t=ee(n,"value");const r=BigInt(te(e,"width")),s=Ge<<r-Ge;if(t<_n){t=-t,U(t<=s,"too low","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:n});const a=(Ge<<r)-Ge;return(~t&a)+Ge}else U(t<s,"too high","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:n});return t}function pn(n,e){const t=Hn(n,"value"),r=BigInt(te(e,"bits"));return t&(Ge<<r)-Ge}function ee(n,e){switch(typeof n){case"bigint":return n;case"number":return v(Number.isInteger(n),"underflow",e||"value",n),v(n>=-fr&&n<=fr,"overflow",e||"value",n),BigInt(n);case"string":try{if(n==="")throw new Error("empty string");return n[0]==="-"&&n[1]!=="-"?-BigInt(n.substring(1)):BigInt(n)}catch(t){v(!1,`invalid BigNumberish string: ${t.message}`,e||"value",n)}}v(!1,"invalid BigNumberish value",e||"value",n)}function Hn(n,e){const t=ee(n,e);return U(t>=_n,"unsigned value cannot be negative","NUMERIC_FAULT",{fault:"overflow",operation:"getUint",value:n}),t}const pa="0123456789abcdef";function vi(n){if(n instanceof Uint8Array){let e="0x0";for(const t of n)e+=pa[t>>4],e+=pa[t&15];return BigInt(e)}return ee(n)}function te(n,e){switch(typeof n){case"bigint":return v(n>=-fr&&n<=fr,"overflow",e||"value",n),Number(n);case"number":return v(Number.isInteger(n),"underflow",e||"value",n),v(n>=-fr&&n<=fr,"overflow",e||"value",n),n;case"string":try{if(n==="")throw new Error("empty string");return te(BigInt(n),e)}catch(t){v(!1,`invalid numeric string: ${t.message}`,e||"value",n)}}v(!1,"invalid numeric value",e||"value",n)}function qc(n){return te(vi(n))}function Kn(n,e){let r=Hn(n,"value").toString(16);if(e==null)r.length%2&&(r="0"+r);else{const s=te(e,"width");for(U(s*2>=r.length,`value exceeds width (${s} bytes)`,"NUMERIC_FAULT",{operation:"toBeHex",fault:"overflow",value:n});r.length<s*2;)r="0"+r}return"0x"+r}function Ds(n){const e=Hn(n,"value");if(e===_n)return new Uint8Array([]);let t=e.toString(16);t.length%2&&(t="0"+t);const r=new Uint8Array(t.length/2);for(let s=0;s<r.length;s++){const a=s*2;r[s]=parseInt(t.substring(a,a+2),16)}return r}function Xc(n){let e=V(Ai(n)?n:Ds(n)).substring(2);for(;e.startsWith("0");)e=e.substring(1);return e===""&&(e="0"),"0x"+e}const sf=BigInt(0),af=BigInt(58);function el(n){n=atob(n);const e=new Uint8Array(n.length);for(let t=0;t<n.length;t++)e[t]=n.charCodeAt(t);return X(e)}function tl(n){const e=X(n);let t="";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return btoa(t)}var gr;class rl{constructor(e,t,r){w(this,"filter");w(this,"emitter");L(this,gr);k(this,gr,t),K(this,{emitter:e,filter:r})}async removeListener(){g(this,gr)!=null&&await this.emitter.off(this.filter,g(this,gr))}}gr=new WeakMap;function nl(n,e,t,r,s){v(!1,`invalid codepoint at offset ${e}; ${n}`,"bytes",t)}function Ii(n,e,t,r,s){if(n==="BAD_PREFIX"||n==="UNEXPECTED_CONTINUE"){let a=0;for(let i=e+1;i<t.length&&t[i]>>6===2;i++)a++;return a}return n==="OVERRUN"?t.length-e-1:0}function sl(n,e,t,r,s){return n==="OVERLONG"?(v(typeof s=="number","invalid bad code point for replacement","badCodepoint",s),r.push(s),0):(r.push(65533),Ii(n,e,t))}const al=Object.freeze({error:nl,ignore:Ii,replace:sl});function il(n,e){e==null&&(e=al.error);const t=X(n,"bytes"),r=[];let s=0;for(;s<t.length;){const a=t[s++];if(!(a>>7)){r.push(a);continue}let i=null,o=null;if((a&224)===192)i=1,o=127;else if((a&240)===224)i=2,o=2047;else if((a&248)===240)i=3,o=65535;else{(a&192)===128?s+=e("UNEXPECTED_CONTINUE",s-1,t,r):s+=e("BAD_PREFIX",s-1,t,r);continue}if(s-1+i>=t.length){s+=e("OVERRUN",s-1,t,r);continue}let c=a&(1<<8-i-1)-1;for(let d=0;d<i;d++){let u=t[s];if((u&192)!=128){s+=e("MISSING_CONTINUE",s,t,r),c=null;break}c=c<<6|u&63,s++}if(c!==null){if(c>1114111){s+=e("OUT_OF_RANGE",s-1-i,t,r,c);continue}if(c>=55296&&c<=57343){s+=e("UTF16_SURROGATE",s-1-i,t,r,c);continue}if(c<=o){s+=e("OVERLONG",s-1-i,t,r,c);continue}r.push(c)}}return r}function xr(n,e){v(typeof n=="string","invalid string value","str",n),e!=null&&(Jc(e),n=n.normalize(e));let t=[];for(let r=0;r<n.length;r++){const s=n.charCodeAt(r);if(s<128)t.push(s);else if(s<2048)t.push(s>>6|192),t.push(s&63|128);else if((s&64512)==55296){r++;const a=n.charCodeAt(r);v(r<n.length&&(a&64512)===56320,"invalid surrogate pair","str",n);const i=65536+((s&1023)<<10)+(a&1023);t.push(i>>18|240),t.push(i>>12&63|128),t.push(i>>6&63|128),t.push(i&63|128)}else t.push(s>>12|224),t.push(s>>6&63|128),t.push(s&63|128)}return new Uint8Array(t)}function ol(n){return n.map(e=>e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode((e>>10&1023)+55296,(e&1023)+56320))).join("")}function ys(n,e){return ol(il(n,e))}function Ci(n){async function e(t,r){U(r==null||!r.cancelled,"request cancelled before sending","CANCELLED");const s=t.url.split(":")[0].toLowerCase();U(s==="http"||s==="https",`unsupported protocol ${s}`,"UNSUPPORTED_OPERATION",{info:{protocol:s},operation:"request"}),U(s==="https"||!t.credentials||t.allowInsecureAuthentication,"insecure authorized connections unsupported","UNSUPPORTED_OPERATION",{operation:"request"});let a=null;const i=new AbortController,o=setTimeout(()=>{a=Xt("request timeout","TIMEOUT"),i.abort()},t.timeout);r&&r.addListener(()=>{a=Xt("request cancelled","CANCELLED"),i.abort()});const c=Object.assign({},n,{method:t.method,headers:new Headers(Array.from(t)),body:t.body||void 0,signal:i.signal});let d;try{d=await fetch(t.url,c)}catch(b){throw clearTimeout(o),a||b}clearTimeout(o);const u={};d.headers.forEach((b,x)=>{u[x.toLowerCase()]=b});const f=await d.arrayBuffer(),h=f==null?null:new Uint8Array(f);return{statusCode:d.status,statusMessage:d.statusText,headers:u,body:h}}return e}const cl=12,ll=250;let ba=Ci();const dl=new RegExp("^data:([^;:]*)?(;base64)?,(.*)$","i"),ul=new RegExp("^ipfs://(ipfs/)?(.*)$","i");let cs=!1;async function Pi(n,e){try{const t=n.match(dl);if(!t)throw new Error("invalid data");return new Pt(200,"OK",{"content-type":t[1]||"text/plain"},t[2]?el(t[3]):hl(t[3]))}catch{return new Pt(599,"BAD REQUEST (invalid data: URI)",{},null,new qr(n))}}function ki(n){async function e(t,r){try{const s=t.match(ul);if(!s)throw new Error("invalid link");return new qr(`${n}${s[2]}`)}catch{return new Pt(599,"BAD REQUEST (invalid IPFS URI)",{},null,new qr(t))}}return e}const bn={data:Pi,ipfs:ki("https://gateway.ipfs.io/ipfs/")},Ti=new WeakMap;var jt,At;class fl{constructor(e){L(this,jt);L(this,At);k(this,jt,[]),k(this,At,!1),Ti.set(e,()=>{if(!g(this,At)){k(this,At,!0);for(const t of g(this,jt))setTimeout(()=>{t()},0);k(this,jt,[])}})}addListener(e){U(!g(this,At),"singal already cancelled","UNSUPPORTED_OPERATION",{operation:"fetchCancelSignal.addCancelListener"}),g(this,jt).push(e)}get cancelled(){return g(this,At)}checkSignal(){U(!this.cancelled,"cancelled","CANCELLED",{})}}jt=new WeakMap,At=new WeakMap;function gn(n){if(n==null)throw new Error("missing signal; should not happen");return n.checkSignal(),n}var mr,yr,Le,nt,wr,Ar,ce,Ce,st,Gt,_t,Ht,Ve,Me,Et,Kt,Kr;const Ln=class Ln{constructor(e){L(this,Kt);L(this,mr);L(this,yr);L(this,Le);L(this,nt);L(this,wr);L(this,Ar);L(this,ce);L(this,Ce);L(this,st);L(this,Gt);L(this,_t);L(this,Ht);L(this,Ve);L(this,Me);L(this,Et);k(this,Ar,String(e)),k(this,mr,!1),k(this,yr,!0),k(this,Le,{}),k(this,nt,""),k(this,wr,3e5),k(this,Me,{slotInterval:ll,maxAttempts:cl}),k(this,Et,null)}get url(){return g(this,Ar)}set url(e){k(this,Ar,String(e))}get body(){return g(this,ce)==null?null:new Uint8Array(g(this,ce))}set body(e){if(e==null)k(this,ce,void 0),k(this,Ce,void 0);else if(typeof e=="string")k(this,ce,xr(e)),k(this,Ce,"text/plain");else if(e instanceof Uint8Array)k(this,ce,e),k(this,Ce,"application/octet-stream");else if(typeof e=="object")k(this,ce,xr(JSON.stringify(e))),k(this,Ce,"application/json");else throw new Error("invalid body")}hasBody(){return g(this,ce)!=null}get method(){return g(this,nt)?g(this,nt):this.hasBody()?"POST":"GET"}set method(e){e==null&&(e=""),k(this,nt,String(e).toUpperCase())}get headers(){const e=Object.assign({},g(this,Le));return g(this,st)&&(e.authorization=`Basic ${tl(xr(g(this,st)))}`),this.allowGzip&&(e["accept-encoding"]="gzip"),e["content-type"]==null&&g(this,Ce)&&(e["content-type"]=g(this,Ce)),this.body&&(e["content-length"]=String(this.body.length)),e}getHeader(e){return this.headers[e.toLowerCase()]}setHeader(e,t){g(this,Le)[String(e).toLowerCase()]=String(t)}clearHeaders(){k(this,Le,{})}[Symbol.iterator](){const e=this.headers,t=Object.keys(e);let r=0;return{next:()=>{if(r<t.length){const s=t[r++];return{value:[s,e[s]],done:!1}}return{value:void 0,done:!0}}}}get credentials(){return g(this,st)||null}setCredentials(e,t){v(!e.match(/:/),"invalid basic authentication username","username","[REDACTED]"),k(this,st,`${e}:${t}`)}get allowGzip(){return g(this,yr)}set allowGzip(e){k(this,yr,!!e)}get allowInsecureAuthentication(){return!!g(this,mr)}set allowInsecureAuthentication(e){k(this,mr,!!e)}get timeout(){return g(this,wr)}set timeout(e){v(e>=0,"timeout must be non-zero","timeout",e),k(this,wr,e)}get preflightFunc(){return g(this,Gt)||null}set preflightFunc(e){k(this,Gt,e)}get processFunc(){return g(this,_t)||null}set processFunc(e){k(this,_t,e)}get retryFunc(){return g(this,Ht)||null}set retryFunc(e){k(this,Ht,e)}get getUrlFunc(){return g(this,Et)||ba}set getUrlFunc(e){k(this,Et,e)}toString(){return`<FetchRequest method=${JSON.stringify(this.method)} url=${JSON.stringify(this.url)} headers=${JSON.stringify(this.headers)} body=${g(this,ce)?V(g(this,ce)):"null"}>`}setThrottleParams(e){e.slotInterval!=null&&(g(this,Me).slotInterval=e.slotInterval),e.maxAttempts!=null&&(g(this,Me).maxAttempts=e.maxAttempts)}send(){return U(g(this,Ve)==null,"request already sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.send"}),k(this,Ve,new fl(this)),q(this,Kt,Kr).call(this,0,ga()+this.timeout,0,this,new Pt(0,"",{},null,this))}cancel(){U(g(this,Ve)!=null,"request has not been sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.cancel"});const e=Ti.get(this);if(!e)throw new Error("missing signal; should not happen");e()}redirect(e){const t=this.url.split(":")[0].toLowerCase(),r=e.split(":")[0].toLowerCase();U(this.method==="GET"&&(t!=="https"||r!=="http")&&e.match(/^https?:/),"unsupported redirect","UNSUPPORTED_OPERATION",{operation:`redirect(${this.method} ${JSON.stringify(this.url)} => ${JSON.stringify(e)})`});const s=new Ln(e);return s.method="GET",s.allowGzip=this.allowGzip,s.timeout=this.timeout,k(s,Le,Object.assign({},g(this,Le))),g(this,ce)&&k(s,ce,new Uint8Array(g(this,ce))),k(s,Ce,g(this,Ce)),s}clone(){const e=new Ln(this.url);return k(e,nt,g(this,nt)),g(this,ce)&&k(e,ce,g(this,ce)),k(e,Ce,g(this,Ce)),k(e,Le,Object.assign({},g(this,Le))),k(e,st,g(this,st)),this.allowGzip&&(e.allowGzip=!0),e.timeout=this.timeout,this.allowInsecureAuthentication&&(e.allowInsecureAuthentication=!0),k(e,Gt,g(this,Gt)),k(e,_t,g(this,_t)),k(e,Ht,g(this,Ht)),k(e,Me,Object.assign({},g(this,Me))),k(e,Et,g(this,Et)),e}static lockConfig(){cs=!0}static getGateway(e){return bn[e.toLowerCase()]||null}static registerGateway(e,t){if(e=e.toLowerCase(),e==="http"||e==="https")throw new Error(`cannot intercept ${e}; use registerGetUrl`);if(cs)throw new Error("gateways locked");bn[e]=t}static registerGetUrl(e){if(cs)throw new Error("gateways locked");ba=e}static createGetUrlFunc(e){return Ci(e)}static createDataGateway(){return Pi}static createIpfsGatewayFunc(e){return ki(e)}};mr=new WeakMap,yr=new WeakMap,Le=new WeakMap,nt=new WeakMap,wr=new WeakMap,Ar=new WeakMap,ce=new WeakMap,Ce=new WeakMap,st=new WeakMap,Gt=new WeakMap,_t=new WeakMap,Ht=new WeakMap,Ve=new WeakMap,Me=new WeakMap,Et=new WeakMap,Kt=new WeakSet,Kr=async function(e,t,r,s,a){var u,f,h;if(e>=g(this,Me).maxAttempts)return a.makeServerError("exceeded maximum retry limit");U(ga()<=t,"timeout","TIMEOUT",{operation:"request.send",reason:"timeout",request:s}),r>0&&await xl(r);let i=this.clone();const o=(i.url.split(":")[0]||"").toLowerCase();if(o in bn){const b=await bn[o](i.url,gn(g(s,Ve)));if(b instanceof Pt){let x=b;if(this.processFunc){gn(g(s,Ve));try{x=await this.processFunc(i,x)}catch(p){(p.throttle==null||typeof p.stall!="number")&&x.makeServerError("error in post-processing function",p).assertOk()}}return x}i=b}this.preflightFunc&&(i=await this.preflightFunc(i));const c=await this.getUrlFunc(i,gn(g(s,Ve)));let d=new Pt(c.statusCode,c.statusMessage,c.headers,c.body,s);if(d.statusCode===301||d.statusCode===302){try{const b=d.headers.location||"";return q(u=i.redirect(b),Kt,Kr).call(u,e+1,t,0,s,d)}catch{}return d}else if(d.statusCode===429&&(this.retryFunc==null||await this.retryFunc(i,d,e))){const b=d.headers["retry-after"];let x=g(this,Me).slotInterval*Math.trunc(Math.random()*Math.pow(2,e));return typeof b=="string"&&b.match(/^[1-9][0-9]*$/)&&(x=parseInt(b)),q(f=i.clone(),Kt,Kr).call(f,e+1,t,x,s,d)}if(this.processFunc){gn(g(s,Ve));try{d=await this.processFunc(i,d)}catch(b){(b.throttle==null||typeof b.stall!="number")&&d.makeServerError("error in post-processing function",b).assertOk();let x=g(this,Me).slotInterval*Math.trunc(Math.random()*Math.pow(2,e));return b.stall>=0&&(x=b.stall),q(h=i.clone(),Kt,Kr).call(h,e+1,t,x,s,d)}}return d};let qr=Ln;var sn,an,on,Pe,Er,Vt;const ea=class ea{constructor(e,t,r,s,a){L(this,sn);L(this,an);L(this,on);L(this,Pe);L(this,Er);L(this,Vt);k(this,sn,e),k(this,an,t),k(this,on,Object.keys(r).reduce((i,o)=>(i[o.toLowerCase()]=String(r[o]),i),{})),k(this,Pe,s==null?null:new Uint8Array(s)),k(this,Er,a||null),k(this,Vt,{message:""})}toString(){return`<FetchResponse status=${this.statusCode} body=${g(this,Pe)?V(g(this,Pe)):"null"}>`}get statusCode(){return g(this,sn)}get statusMessage(){return g(this,an)}get headers(){return Object.assign({},g(this,on))}get body(){return g(this,Pe)==null?null:new Uint8Array(g(this,Pe))}get bodyText(){try{return g(this,Pe)==null?"":ys(g(this,Pe))}catch{U(!1,"response body is not valid UTF-8 data","UNSUPPORTED_OPERATION",{operation:"bodyText",info:{response:this}})}}get bodyJson(){try{return JSON.parse(this.bodyText)}catch{U(!1,"response body is not valid JSON","UNSUPPORTED_OPERATION",{operation:"bodyJson",info:{response:this}})}}[Symbol.iterator](){const e=this.headers,t=Object.keys(e);let r=0;return{next:()=>{if(r<t.length){const s=t[r++];return{value:[s,e[s]],done:!1}}return{value:void 0,done:!0}}}}makeServerError(e,t){let r;e?r=`CLIENT ESCALATED SERVER ERROR (${this.statusCode} ${this.statusMessage}; ${e})`:(e=`${this.statusCode} ${this.statusMessage}`,r=`CLIENT ESCALATED SERVER ERROR (${e})`);const s=new ea(599,r,this.headers,this.body,g(this,Er)||void 0);return k(s,Vt,{message:e,error:t}),s}throwThrottleError(e,t){t==null?t=-1:v(Number.isInteger(t)&&t>=0,"invalid stall timeout","stall",t);const r=new Error(e||"throttling requests");throw K(r,{stall:t,throttle:!0}),r}getHeader(e){return this.headers[e.toLowerCase()]}hasBody(){return g(this,Pe)!=null}get request(){return g(this,Er)}ok(){return g(this,Vt).message===""&&this.statusCode>=200&&this.statusCode<300}assertOk(){if(this.ok())return;let{message:e,error:t}=g(this,Vt);e===""&&(e=`server response ${this.statusCode} ${this.statusMessage}`);let r=null;this.request&&(r=this.request.url);let s=null;try{g(this,Pe)&&(s=ys(g(this,Pe)))}catch{}U(!1,e,"SERVER_ERROR",{request:this.request||"unknown request",response:this,error:t,info:{requestUrl:r,responseBody:s,responseStatus:`${this.statusCode} ${this.statusMessage}`}})}};sn=new WeakMap,an=new WeakMap,on=new WeakMap,Pe=new WeakMap,Er=new WeakMap,Vt=new WeakMap;let Pt=ea;function ga(){return new Date().getTime()}function hl(n){return xr(n.replace(/%([0-9a-f][0-9a-f])/gi,(e,t)=>String.fromCharCode(parseInt(t,16))))}function xl(n){return new Promise(e=>setTimeout(e,n))}const of=BigInt(-1),cf=BigInt(0),lf=BigInt(1),df=BigInt(5);let ls="0000";for(;ls.length<80;)ls+=ls;const be=32,ws=new Uint8Array(be),pl=["then"],mn={},Si=new WeakMap;function Ut(n){return Si.get(n)}function ma(n,e){Si.set(n,e)}function jr(n,e){const t=new Error(`deferred error during ABI decoding triggered accessing ${n}`);throw t.error=e,t}function As(n,e,t){return n.indexOf(null)>=0?e.map((r,s)=>r instanceof Sr?As(Ut(r),r,t):r):n.reduce((r,s,a)=>{let i=e.getValue(s);return s in r||(t&&i instanceof Sr&&(i=As(Ut(i),i,t)),r[s]=i),r},{})}var Nr;const hr=class hr extends Array{constructor(...t){const r=t[0];let s=t[1],a=(t[2]||[]).slice(),i=!0;r!==mn&&(s=t,a=[],i=!1);super(s.length);L(this,Nr);s.forEach((d,u)=>{this[u]=d});const o=a.reduce((d,u)=>(typeof u=="string"&&d.set(u,(d.get(u)||0)+1),d),new Map);if(ma(this,Object.freeze(s.map((d,u)=>{const f=a[u];return f!=null&&o.get(f)===1?f:null}))),k(this,Nr,[]),g(this,Nr)==null&&g(this,Nr),!i)return;Object.freeze(this);const c=new Proxy(this,{get:(d,u,f)=>{if(typeof u=="string"){if(u.match(/^[0-9]+$/)){const b=te(u,"%index");if(b<0||b>=this.length)throw new RangeError("out of result range");const x=d[b];return x instanceof Error&&jr(`index ${b}`,x),x}if(pl.indexOf(u)>=0)return Reflect.get(d,u,f);const h=d[u];if(h instanceof Function)return function(...b){return h.apply(this===f?d:this,b)};if(!(u in d))return d.getValue.apply(this===f?d:this,[u])}return Reflect.get(d,u,f)}});return ma(c,Ut(this)),c}toArray(t){const r=[];return this.forEach((s,a)=>{s instanceof Error&&jr(`index ${a}`,s),t&&s instanceof hr&&(s=s.toArray(t)),r.push(s)}),r}toObject(t){const r=Ut(this);return r.reduce((s,a,i)=>(U(a!=null,`value at index ${i} unnamed`,"UNSUPPORTED_OPERATION",{operation:"toObject()"}),As(r,this,t)),{})}slice(t,r){t==null&&(t=0),t<0&&(t+=this.length,t<0&&(t=0)),r==null&&(r=this.length),r<0&&(r+=this.length,r<0&&(r=0)),r>this.length&&(r=this.length);const s=Ut(this),a=[],i=[];for(let o=t;o<r;o++)a.push(this[o]),i.push(s[o]);return new hr(mn,a,i)}filter(t,r){const s=Ut(this),a=[],i=[];for(let o=0;o<this.length;o++){const c=this[o];c instanceof Error&&jr(`index ${o}`,c),t.call(r,c,o,this)&&(a.push(c),i.push(s[o]))}return new hr(mn,a,i)}map(t,r){const s=[];for(let a=0;a<this.length;a++){const i=this[a];i instanceof Error&&jr(`index ${a}`,i),s.push(t.call(r,i,a,this))}return s}getValue(t){const r=Ut(this).indexOf(t);if(r===-1)return;const s=this[r];return s instanceof Error&&jr(`property ${JSON.stringify(t)}`,s.error),s}static fromItems(t,r){return new hr(mn,t,r)}};Nr=new WeakMap;let Sr=hr;function ya(n){let e=Ds(n);return U(e.length<=be,"value out-of-bounds","BUFFER_OVERRUN",{buffer:e,length:be,offset:e.length}),e.length!==be&&(e=qe(Ct([ws.slice(e.length%be),e]))),e}class dt{constructor(e,t,r,s){w(this,"name");w(this,"type");w(this,"localName");w(this,"dynamic");K(this,{name:e,type:t,localName:r,dynamic:s},{name:"string",type:"string",localName:"string",dynamic:"boolean"})}_throwError(e,t){v(!1,e,this.localName,t)}}var at,zt,vr,Pn;class Es{constructor(){L(this,vr);L(this,at);L(this,zt);k(this,at,[]),k(this,zt,0)}get data(){return Ct(g(this,at))}get length(){return g(this,zt)}appendWriter(e){return q(this,vr,Pn).call(this,qe(e.data))}writeBytes(e){let t=qe(e);const r=t.length%be;return r&&(t=qe(Ct([t,ws.slice(r)]))),q(this,vr,Pn).call(this,t)}writeValue(e){return q(this,vr,Pn).call(this,ya(e))}writeUpdatableValue(){const e=g(this,at).length;return g(this,at).push(ws),k(this,zt,g(this,zt)+be),t=>{g(this,at)[e]=ya(t)}}}at=new WeakMap,zt=new WeakMap,vr=new WeakSet,Pn=function(e){return g(this,at).push(e),k(this,zt,g(this,zt)+e.length),e.length};var me,ke,Qt,$t,Nt,nr,vs,Oi;const ta=class ta{constructor(e,t,r){L(this,nr);w(this,"allowLoose");L(this,me);L(this,ke);L(this,Qt);L(this,$t);L(this,Nt);K(this,{allowLoose:!!t}),k(this,me,qe(e)),k(this,Qt,0),k(this,$t,null),k(this,Nt,r??1024),k(this,ke,0)}get data(){return V(g(this,me))}get dataLength(){return g(this,me).length}get consumed(){return g(this,ke)}get bytes(){return new Uint8Array(g(this,me))}subReader(e){const t=new ta(g(this,me).slice(g(this,ke)+e),this.allowLoose,g(this,Nt));return k(t,$t,this),t}readBytes(e,t){let r=q(this,nr,Oi).call(this,0,e,!!t);return q(this,nr,vs).call(this,e),k(this,ke,g(this,ke)+r.length),r.slice(0,e)}readValue(){return vi(this.readBytes(be))}readIndex(){return qc(this.readBytes(be))}};me=new WeakMap,ke=new WeakMap,Qt=new WeakMap,$t=new WeakMap,Nt=new WeakMap,nr=new WeakSet,vs=function(e){var t;if(g(this,$t))return q(t=g(this,$t),nr,vs).call(t,e);k(this,Qt,g(this,Qt)+e),U(g(this,Nt)<1||g(this,Qt)<=g(this,Nt)*this.dataLength,`compressed ABI data exceeds inflation ratio of ${g(this,Nt)} ( see: https://github.com/ethers-io/ethers.js/issues/4537 )`,"BUFFER_OVERRUN",{buffer:qe(g(this,me)),offset:g(this,ke),length:e,info:{bytesRead:g(this,Qt),dataLength:this.dataLength}})},Oi=function(e,t,r){let s=Math.ceil(t/be)*be;return g(this,ke)+s>g(this,me).length&&(this.allowLoose&&r&&g(this,ke)+t<=g(this,me).length?s=t:U(!1,"data out-of-bounds","BUFFER_OVERRUN",{buffer:qe(g(this,me)),length:g(this,me).length,offset:g(this,ke)+s})),g(this,me).slice(g(this,ke),g(this,ke)+s)};let Ns=ta;function Te(n){if(!Number.isSafeInteger(n)||n<0)throw new Error(`Wrong positive integer: ${n}`)}function Ls(n,...e){if(!(n instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(n.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${n.length}`)}function Bi(n){if(typeof n!="function"||typeof n.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Te(n.outputLen),Te(n.blockLen)}function Or(n,e=!0){if(n.destroyed)throw new Error("Hash instance has been destroyed");if(e&&n.finished)throw new Error("Hash#digest() has already been called")}function Ri(n,e){Ls(n);const t=e.outputLen;if(n.length<t)throw new Error(`digestInto() expects output buffer of length at least ${t}`)}const ds=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Ui=n=>n instanceof Uint8Array,kn=n=>new Uint32Array(n.buffer,n.byteOffset,Math.floor(n.byteLength/4)),Tn=n=>new DataView(n.buffer,n.byteOffset,n.byteLength),Ke=(n,e)=>n<<32-e|n>>>e,bl=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!bl)throw new Error("Non little-endian hardware is not supported");const gl=async()=>{};async function wa(n,e,t){let r=Date.now();for(let s=0;s<n;s++){t(s);const a=Date.now()-r;a>=0&&a<e||(await gl(),r+=a)}}function ml(n){if(typeof n!="string")throw new Error(`utf8ToBytes expected string, got ${typeof n}`);return new Uint8Array(new TextEncoder().encode(n))}function Br(n){if(typeof n=="string"&&(n=ml(n)),!Ui(n))throw new Error(`expected Uint8Array, got ${typeof n}`);return n}function yl(...n){const e=new Uint8Array(n.reduce((r,s)=>r+s.length,0));let t=0;return n.forEach(r=>{if(!Ui(r))throw new Error("Uint8Array expected");e.set(r,t),t+=r.length}),e}class Ms{clone(){return this._cloneInto()}}const wl={}.toString;function Fi(n,e){if(e!==void 0&&wl.call(e)!=="[object Object]")throw new Error("Options should be object or undefined");return Object.assign(n,e)}function Vn(n){const e=r=>n().update(Br(r)).digest(),t=n();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>n(),e}function Al(n=32){if(ds&&typeof ds.getRandomValues=="function")return ds.getRandomValues(new Uint8Array(n));throw new Error("crypto.getRandomValues must be defined")}class Di extends Ms{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,Bi(e);const r=Br(t);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,a=new Uint8Array(s);a.set(r.length>s?e.create().update(r).digest():r);for(let i=0;i<a.length;i++)a[i]^=54;this.iHash.update(a),this.oHash=e.create();for(let i=0;i<a.length;i++)a[i]^=106;this.oHash.update(a),a.fill(0)}update(e){return Or(this),this.iHash.update(e),this}digestInto(e){Or(this),Ls(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:r,finished:s,destroyed:a,blockLen:i,outputLen:o}=this;return e=e,e.finished=s,e.destroyed=a,e.blockLen=i,e.outputLen=o,e.oHash=t._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const zn=(n,e,t)=>new Di(n,e).update(t).digest();zn.create=(n,e)=>new Di(n,e);function El(n,e,t,r){Bi(n);const s=Fi({dkLen:32,asyncTick:10},r),{c:a,dkLen:i,asyncTick:o}=s;if(Te(a),Te(i),Te(o),a<1)throw new Error("PBKDF2: iterations (c) should be >= 1");const c=Br(e),d=Br(t),u=new Uint8Array(i),f=zn.create(n,c),h=f._cloneInto().update(d);return{c:a,dkLen:i,asyncTick:o,DK:u,PRF:f,PRFSalt:h}}function Nl(n,e,t,r,s){return n.destroy(),e.destroy(),r&&r.destroy(),s.fill(0),t}function js(n,e,t,r){const{c:s,dkLen:a,DK:i,PRF:o,PRFSalt:c}=El(n,e,t,r);let d;const u=new Uint8Array(4),f=Tn(u),h=new Uint8Array(o.outputLen);for(let b=1,x=0;x<a;b++,x+=o.outputLen){const p=i.subarray(x,x+o.outputLen);f.setInt32(0,b,!1),(d=c._cloneInto(d)).update(u).digestInto(h),p.set(h.subarray(0,p.length));for(let m=1;m<s;m++){o._cloneInto(d).update(h).digestInto(h);for(let y=0;y<p.length;y++)p[y]^=h[y]}}return Nl(o,c,i,d,h)}function vl(n,e,t,r){if(typeof n.setBigUint64=="function")return n.setBigUint64(e,t,r);const s=BigInt(32),a=BigInt(4294967295),i=Number(t>>s&a),o=Number(t&a),c=r?4:0,d=r?0:4;n.setUint32(e+c,i,r),n.setUint32(e+d,o,r)}class Gs extends Ms{constructor(e,t,r,s){super(),this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Tn(this.buffer)}update(e){Or(this);const{view:t,buffer:r,blockLen:s}=this;e=Br(e);const a=e.length;for(let i=0;i<a;){const o=Math.min(s-this.pos,a-i);if(o===s){const c=Tn(e);for(;s<=a-i;i+=s)this.process(c,i);continue}r.set(e.subarray(i,i+o),this.pos),this.pos+=o,i+=o,this.pos===s&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Or(this),Ri(e,this),this.finished=!0;const{buffer:t,view:r,blockLen:s,isLE:a}=this;let{pos:i}=this;t[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>s-i&&(this.process(r,0),i=0);for(let f=i;f<s;f++)t[f]=0;vl(r,s-8,BigInt(this.length*8),a),this.process(r,0);const o=Tn(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const d=c/4,u=this.get();if(d>u.length)throw new Error("_sha2: outputLen bigger than state");for(let f=0;f<d;f++)o.setUint32(4*f,u[f],a)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:r,length:s,finished:a,destroyed:i,pos:o}=this;return e.length=s,e.pos=o,e.finished=a,e.destroyed=i,s%t&&e.buffer.set(r),e}}const Il=(n,e,t)=>n&e^~n&t,Cl=(n,e,t)=>n&e^n&t^e&t,Pl=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),xt=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),pt=new Uint32Array(64);class kl extends Gs{constructor(){super(64,32,8,!1),this.A=xt[0]|0,this.B=xt[1]|0,this.C=xt[2]|0,this.D=xt[3]|0,this.E=xt[4]|0,this.F=xt[5]|0,this.G=xt[6]|0,this.H=xt[7]|0}get(){const{A:e,B:t,C:r,D:s,E:a,F:i,G:o,H:c}=this;return[e,t,r,s,a,i,o,c]}set(e,t,r,s,a,i,o,c){this.A=e|0,this.B=t|0,this.C=r|0,this.D=s|0,this.E=a|0,this.F=i|0,this.G=o|0,this.H=c|0}process(e,t){for(let f=0;f<16;f++,t+=4)pt[f]=e.getUint32(t,!1);for(let f=16;f<64;f++){const h=pt[f-15],b=pt[f-2],x=Ke(h,7)^Ke(h,18)^h>>>3,p=Ke(b,17)^Ke(b,19)^b>>>10;pt[f]=p+pt[f-7]+x+pt[f-16]|0}let{A:r,B:s,C:a,D:i,E:o,F:c,G:d,H:u}=this;for(let f=0;f<64;f++){const h=Ke(o,6)^Ke(o,11)^Ke(o,25),b=u+h+Il(o,c,d)+Pl[f]+pt[f]|0,p=(Ke(r,2)^Ke(r,13)^Ke(r,22))+Cl(r,s,a)|0;u=d,d=c,c=o,o=i+b|0,i=a,a=s,s=r,r=b+p|0}r=r+this.A|0,s=s+this.B|0,a=a+this.C|0,i=i+this.D|0,o=o+this.E|0,c=c+this.F|0,d=d+this.G|0,u=u+this.H|0,this.set(r,s,a,i,o,c,d,u)}roundClean(){pt.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const Dr=Vn(()=>new kl),yn=BigInt(2**32-1),Is=BigInt(32);function Li(n,e=!1){return e?{h:Number(n&yn),l:Number(n>>Is&yn)}:{h:Number(n>>Is&yn)|0,l:Number(n&yn)|0}}function Mi(n,e=!1){let t=new Uint32Array(n.length),r=new Uint32Array(n.length);for(let s=0;s<n.length;s++){const{h:a,l:i}=Li(n[s],e);[t[s],r[s]]=[a,i]}return[t,r]}const Tl=(n,e)=>BigInt(n>>>0)<<Is|BigInt(e>>>0),Sl=(n,e,t)=>n>>>t,Ol=(n,e,t)=>n<<32-t|e>>>t,Bl=(n,e,t)=>n>>>t|e<<32-t,Rl=(n,e,t)=>n<<32-t|e>>>t,Ul=(n,e,t)=>n<<64-t|e>>>t-32,Fl=(n,e,t)=>n>>>t-32|e<<64-t,Dl=(n,e)=>e,Ll=(n,e)=>n,ji=(n,e,t)=>n<<t|e>>>32-t,Gi=(n,e,t)=>e<<t|n>>>32-t,_i=(n,e,t)=>e<<t-32|n>>>64-t,Hi=(n,e,t)=>n<<t-32|e>>>64-t;function Ml(n,e,t,r){const s=(e>>>0)+(r>>>0);return{h:n+t+(s/2**32|0)|0,l:s|0}}const jl=(n,e,t)=>(n>>>0)+(e>>>0)+(t>>>0),Gl=(n,e,t,r)=>e+t+r+(n/2**32|0)|0,_l=(n,e,t,r)=>(n>>>0)+(e>>>0)+(t>>>0)+(r>>>0),Hl=(n,e,t,r,s)=>e+t+r+s+(n/2**32|0)|0,Kl=(n,e,t,r,s)=>(n>>>0)+(e>>>0)+(t>>>0)+(r>>>0)+(s>>>0),Vl=(n,e,t,r,s,a)=>e+t+r+s+a+(n/2**32|0)|0,H={fromBig:Li,split:Mi,toBig:Tl,shrSH:Sl,shrSL:Ol,rotrSH:Bl,rotrSL:Rl,rotrBH:Ul,rotrBL:Fl,rotr32H:Dl,rotr32L:Ll,rotlSH:ji,rotlSL:Gi,rotlBH:_i,rotlBL:Hi,add:Ml,add3L:jl,add3H:Gl,add4L:_l,add4H:Hl,add5H:Vl,add5L:Kl},[zl,Ql]=H.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(n=>BigInt(n))),bt=new Uint32Array(80),gt=new Uint32Array(80);class $l extends Gs{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:t,Bh:r,Bl:s,Ch:a,Cl:i,Dh:o,Dl:c,Eh:d,El:u,Fh:f,Fl:h,Gh:b,Gl:x,Hh:p,Hl:m}=this;return[e,t,r,s,a,i,o,c,d,u,f,h,b,x,p,m]}set(e,t,r,s,a,i,o,c,d,u,f,h,b,x,p,m){this.Ah=e|0,this.Al=t|0,this.Bh=r|0,this.Bl=s|0,this.Ch=a|0,this.Cl=i|0,this.Dh=o|0,this.Dl=c|0,this.Eh=d|0,this.El=u|0,this.Fh=f|0,this.Fl=h|0,this.Gh=b|0,this.Gl=x|0,this.Hh=p|0,this.Hl=m|0}process(e,t){for(let N=0;N<16;N++,t+=4)bt[N]=e.getUint32(t),gt[N]=e.getUint32(t+=4);for(let N=16;N<80;N++){const T=bt[N-15]|0,E=gt[N-15]|0,P=H.rotrSH(T,E,1)^H.rotrSH(T,E,8)^H.shrSH(T,E,7),S=H.rotrSL(T,E,1)^H.rotrSL(T,E,8)^H.shrSL(T,E,7),I=bt[N-2]|0,D=gt[N-2]|0,_=H.rotrSH(I,D,19)^H.rotrBH(I,D,61)^H.shrSH(I,D,6),G=H.rotrSL(I,D,19)^H.rotrBL(I,D,61)^H.shrSL(I,D,6),W=H.add4L(S,G,gt[N-7],gt[N-16]),Y=H.add4H(W,P,_,bt[N-7],bt[N-16]);bt[N]=Y|0,gt[N]=W|0}let{Ah:r,Al:s,Bh:a,Bl:i,Ch:o,Cl:c,Dh:d,Dl:u,Eh:f,El:h,Fh:b,Fl:x,Gh:p,Gl:m,Hh:y,Hl:A}=this;for(let N=0;N<80;N++){const T=H.rotrSH(f,h,14)^H.rotrSH(f,h,18)^H.rotrBH(f,h,41),E=H.rotrSL(f,h,14)^H.rotrSL(f,h,18)^H.rotrBL(f,h,41),P=f&b^~f&p,S=h&x^~h&m,I=H.add5L(A,E,S,Ql[N],gt[N]),D=H.add5H(I,y,T,P,zl[N],bt[N]),_=I|0,G=H.rotrSH(r,s,28)^H.rotrBH(r,s,34)^H.rotrBH(r,s,39),W=H.rotrSL(r,s,28)^H.rotrBL(r,s,34)^H.rotrBL(r,s,39),Y=r&a^r&o^a&o,ne=s&i^s&c^i&c;y=p|0,A=m|0,p=b|0,m=x|0,b=f|0,x=h|0,{h:f,l:h}=H.add(d|0,u|0,D|0,_|0),d=o|0,u=c|0,o=a|0,c=i|0,a=r|0,i=s|0;const O=H.add3L(_,W,ne);r=H.add3H(O,D,G,Y),s=O|0}({h:r,l:s}=H.add(this.Ah|0,this.Al|0,r|0,s|0)),{h:a,l:i}=H.add(this.Bh|0,this.Bl|0,a|0,i|0),{h:o,l:c}=H.add(this.Ch|0,this.Cl|0,o|0,c|0),{h:d,l:u}=H.add(this.Dh|0,this.Dl|0,d|0,u|0),{h:f,l:h}=H.add(this.Eh|0,this.El|0,f|0,h|0),{h:b,l:x}=H.add(this.Fh|0,this.Fl|0,b|0,x|0),{h:p,l:m}=H.add(this.Gh|0,this.Gl|0,p|0,m|0),{h:y,l:A}=H.add(this.Hh|0,this.Hl|0,y|0,A|0),this.set(r,s,a,i,o,c,d,u,f,h,b,x,p,m,y,A)}roundClean(){bt.fill(0),gt.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const _s=Vn(()=>new $l);function Jl(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")}const Aa=Jl(),Ea=Aa.crypto||Aa.msCrypto;function Wl(n){switch(n){case"sha256":return Dr.create();case"sha512":return _s.create()}v(!1,"invalid hashing algorithm name","algorithm",n)}function Zl(n,e){const t={sha256:Dr,sha512:_s}[n];return v(t!=null,"invalid hmac algorithm","algorithm",n),zn.create(t,e)}function Yl(n,e,t,r,s){const a={sha256:Dr,sha512:_s}[s];return v(a!=null,"invalid pbkdf2 algorithm","algorithm",s),js(a,n,e,{c:t,dkLen:r})}function ql(n){U(Ea!=null,"platform does not support secure random numbers","UNSUPPORTED_OPERATION",{operation:"randomBytes"}),v(Number.isInteger(n)&&n>0&&n<=1024,"invalid length","length",n);const e=new Uint8Array(n);return Ea.getRandomValues(e),e}let Ki=!1;const Vi=function(n,e,t){return Zl(n,e).update(t).digest()};let zi=Vi;function Qn(n,e,t){const r=X(e,"key"),s=X(t,"data");return V(zi(n,r,s))}Qn._=Vi;Qn.lock=function(){Ki=!0};Qn.register=function(n){if(Ki)throw new Error("computeHmac is locked");zi=n};Object.freeze(Qn);const[Qi,$i,Ji]=[[],[],[]],Xl=BigInt(0),Gr=BigInt(1),e0=BigInt(2),t0=BigInt(7),r0=BigInt(256),n0=BigInt(113);for(let n=0,e=Gr,t=1,r=0;n<24;n++){[t,r]=[r,(2*t+3*r)%5],Qi.push(2*(5*r+t)),$i.push((n+1)*(n+2)/2%64);let s=Xl;for(let a=0;a<7;a++)e=(e<<Gr^(e>>t0)*n0)%r0,e&e0&&(s^=Gr<<(Gr<<BigInt(a))-Gr);Ji.push(s)}const[s0,a0]=Mi(Ji,!0),Na=(n,e,t)=>t>32?_i(n,e,t):ji(n,e,t),va=(n,e,t)=>t>32?Hi(n,e,t):Gi(n,e,t);function i0(n,e=24){const t=new Uint32Array(10);for(let r=24-e;r<24;r++){for(let i=0;i<10;i++)t[i]=n[i]^n[i+10]^n[i+20]^n[i+30]^n[i+40];for(let i=0;i<10;i+=2){const o=(i+8)%10,c=(i+2)%10,d=t[c],u=t[c+1],f=Na(d,u,1)^t[o],h=va(d,u,1)^t[o+1];for(let b=0;b<50;b+=10)n[i+b]^=f,n[i+b+1]^=h}let s=n[2],a=n[3];for(let i=0;i<24;i++){const o=$i[i],c=Na(s,a,o),d=va(s,a,o),u=Qi[i];s=n[u],a=n[u+1],n[u]=c,n[u+1]=d}for(let i=0;i<50;i+=10){for(let o=0;o<10;o++)t[o]=n[i+o];for(let o=0;o<10;o++)n[i+o]^=~t[(o+2)%10]&t[(o+4)%10]}n[0]^=s0[r],n[1]^=a0[r]}t.fill(0)}class Hs extends Ms{constructor(e,t,r,s=!1,a=24){if(super(),this.blockLen=e,this.suffix=t,this.outputLen=r,this.enableXOF=s,this.rounds=a,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,Te(r),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=kn(this.state)}keccak(){i0(this.state32,this.rounds),this.posOut=0,this.pos=0}update(e){Or(this);const{blockLen:t,state:r}=this;e=Br(e);const s=e.length;for(let a=0;a<s;){const i=Math.min(t-this.pos,s-a);for(let o=0;o<i;o++)r[this.pos++]^=e[a++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:r,blockLen:s}=this;e[r]^=t,t&128&&r===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){Or(this,!1),Ls(e),this.finish();const t=this.state,{blockLen:r}=this;for(let s=0,a=e.length;s<a;){this.posOut>=r&&this.keccak();const i=Math.min(r-this.posOut,a-s);e.set(t.subarray(this.posOut,this.posOut+i),s),this.posOut+=i,s+=i}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return Te(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(Ri(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:t,suffix:r,outputLen:s,rounds:a,enableXOF:i}=this;return e||(e=new Hs(t,r,s,i,a)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=a,e.suffix=r,e.outputLen=s,e.enableXOF=i,e.destroyed=this.destroyed,e}}const o0=(n,e,t)=>Vn(()=>new Hs(e,n,t)),c0=o0(1,136,256/8);let Wi=!1;const Zi=function(n){return c0(n)};let Yi=Zi;function Tt(n){const e=X(n,"data");return V(Yi(e))}Tt._=Zi;Tt.lock=function(){Wi=!0};Tt.register=function(n){if(Wi)throw new TypeError("keccak256 is locked");Yi=n};Object.freeze(Tt);const l0=new Uint8Array([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),qi=Uint8Array.from({length:16},(n,e)=>e),d0=qi.map(n=>(9*n+5)%16);let Ks=[qi],Vs=[d0];for(let n=0;n<4;n++)for(let e of[Ks,Vs])e.push(e[n].map(t=>l0[t]));const Xi=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map(n=>new Uint8Array(n)),u0=Ks.map((n,e)=>n.map(t=>Xi[e][t])),f0=Vs.map((n,e)=>n.map(t=>Xi[e][t])),h0=new Uint32Array([0,1518500249,1859775393,2400959708,2840853838]),x0=new Uint32Array([1352829926,1548603684,1836072691,2053994217,0]),wn=(n,e)=>n<<e|n>>>32-e;function Ia(n,e,t,r){return n===0?e^t^r:n===1?e&t|~e&r:n===2?(e|~t)^r:n===3?e&r|t&~r:e^(t|~r)}const An=new Uint32Array(16);class p0 extends Gs{constructor(){super(64,20,8,!0),this.h0=1732584193,this.h1=-271733879,this.h2=-1732584194,this.h3=271733878,this.h4=-1009589776}get(){const{h0:e,h1:t,h2:r,h3:s,h4:a}=this;return[e,t,r,s,a]}set(e,t,r,s,a){this.h0=e|0,this.h1=t|0,this.h2=r|0,this.h3=s|0,this.h4=a|0}process(e,t){for(let b=0;b<16;b++,t+=4)An[b]=e.getUint32(t,!0);let r=this.h0|0,s=r,a=this.h1|0,i=a,o=this.h2|0,c=o,d=this.h3|0,u=d,f=this.h4|0,h=f;for(let b=0;b<5;b++){const x=4-b,p=h0[b],m=x0[b],y=Ks[b],A=Vs[b],N=u0[b],T=f0[b];for(let E=0;E<16;E++){const P=wn(r+Ia(b,a,o,d)+An[y[E]]+p,N[E])+f|0;r=f,f=d,d=wn(o,10)|0,o=a,a=P}for(let E=0;E<16;E++){const P=wn(s+Ia(x,i,c,u)+An[A[E]]+m,T[E])+h|0;s=h,h=u,u=wn(c,10)|0,c=i,i=P}}this.set(this.h1+o+u|0,this.h2+d+h|0,this.h3+f+s|0,this.h4+r+i|0,this.h0+a+c|0)}roundClean(){An.fill(0)}destroy(){this.destroyed=!0,this.buffer.fill(0),this.set(0,0,0,0,0)}}const b0=Vn(()=>new p0);let eo=!1;const to=function(n){return b0(n)};let ro=to;function $n(n){const e=X(n,"data");return V(ro(e))}$n._=to;$n.lock=function(){eo=!0};$n.register=function(n){if(eo)throw new TypeError("ripemd160 is locked");ro=n};Object.freeze($n);let no=!1;const so=function(n,e,t,r,s){return Yl(n,e,t,r,s)};let ao=so;function Jn(n,e,t,r,s){const a=X(n,"password"),i=X(e,"salt");return V(ao(a,i,t,r,s))}Jn._=so;Jn.lock=function(){no=!0};Jn.register=function(n){if(no)throw new Error("pbkdf2 is locked");ao=n};Object.freeze(Jn);let io=!1;const oo=function(n){return new Uint8Array(ql(n))};let co=oo;function Wn(n){return co(n)}Wn._=oo;Wn.lock=function(){io=!0};Wn.register=function(n){if(io)throw new Error("randomBytes is locked");co=n};Object.freeze(Wn);const z=(n,e)=>n<<e|n>>>32-e;function Ca(n,e,t,r,s,a){let i=n[e++]^t[r++],o=n[e++]^t[r++],c=n[e++]^t[r++],d=n[e++]^t[r++],u=n[e++]^t[r++],f=n[e++]^t[r++],h=n[e++]^t[r++],b=n[e++]^t[r++],x=n[e++]^t[r++],p=n[e++]^t[r++],m=n[e++]^t[r++],y=n[e++]^t[r++],A=n[e++]^t[r++],N=n[e++]^t[r++],T=n[e++]^t[r++],E=n[e++]^t[r++],P=i,S=o,I=c,D=d,_=u,G=f,W=h,Y=b,ne=x,O=p,B=m,M=y,F=A,j=N,J=T,se=E;for(let he=0;he<8;he+=2)_^=z(P+F|0,7),ne^=z(_+P|0,9),F^=z(ne+_|0,13),P^=z(F+ne|0,18),O^=z(G+S|0,7),j^=z(O+G|0,9),S^=z(j+O|0,13),G^=z(S+j|0,18),J^=z(B+W|0,7),I^=z(J+B|0,9),W^=z(I+J|0,13),B^=z(W+I|0,18),D^=z(se+M|0,7),Y^=z(D+se|0,9),M^=z(Y+D|0,13),se^=z(M+Y|0,18),S^=z(P+D|0,7),I^=z(S+P|0,9),D^=z(I+S|0,13),P^=z(D+I|0,18),W^=z(G+_|0,7),Y^=z(W+G|0,9),_^=z(Y+W|0,13),G^=z(_+Y|0,18),M^=z(B+O|0,7),ne^=z(M+B|0,9),O^=z(ne+M|0,13),B^=z(O+ne|0,18),F^=z(se+J|0,7),j^=z(F+se|0,9),J^=z(j+F|0,13),se^=z(J+j|0,18);s[a++]=i+P|0,s[a++]=o+S|0,s[a++]=c+I|0,s[a++]=d+D|0,s[a++]=u+_|0,s[a++]=f+G|0,s[a++]=h+W|0,s[a++]=b+Y|0,s[a++]=x+ne|0,s[a++]=p+O|0,s[a++]=m+B|0,s[a++]=y+M|0,s[a++]=A+F|0,s[a++]=N+j|0,s[a++]=T+J|0,s[a++]=E+se|0}function pr(n,e,t,r,s){let a=r+0,i=r+16*s;for(let o=0;o<16;o++)t[i+o]=n[e+(2*s-1)*16+o];for(let o=0;o<s;o++,a+=16,e+=16)Ca(t,i,n,e,t,a),o>0&&(i+=16),Ca(t,a,n,e+=16,t,i)}function lo(n,e,t){const r=Fi({dkLen:32,asyncTick:10,maxmem:1073742848},t),{N:s,r:a,p:i,dkLen:o,asyncTick:c,maxmem:d,onProgress:u}=r;if(Te(s),Te(a),Te(i),Te(o),Te(c),Te(d),u!==void 0&&typeof u!="function")throw new Error("progressCb should be function");const f=128*a,h=f/4;if(s<=1||s&s-1||s>=2**(f/8)||s>2**32)throw new Error("Scrypt: N must be larger than 1, a power of 2, less than 2^(128 * r / 8) and less than 2^32");if(i<0||i>(2**32-1)*32/f)throw new Error("Scrypt: p must be a positive integer less than or equal to ((2^32 - 1) * 32) / (128 * r)");if(o<0||o>(2**32-1)*32)throw new Error("Scrypt: dkLen should be positive integer less than or equal to (2^32 - 1) * 32");const b=f*(s+i);if(b>d)throw new Error(`Scrypt: parameters too large, ${b} (128 * r * (N + p)) > ${d} (maxmem)`);const x=js(Dr,n,e,{c:1,dkLen:f*i}),p=kn(x),m=kn(new Uint8Array(f*s)),y=kn(new Uint8Array(f));let A=()=>{};if(u){const N=2*s*i,T=Math.max(Math.floor(N/1e4),1);let E=0;A=()=>{E++,u&&(!(E%T)||E===N)&&u(E/N)}}return{N:s,r:a,p:i,dkLen:o,blockSize32:h,V:m,B32:p,B:x,tmp:y,blockMixCb:A,asyncTick:c}}function uo(n,e,t,r,s){const a=js(Dr,n,t,{c:1,dkLen:e});return t.fill(0),r.fill(0),s.fill(0),a}function g0(n,e,t){const{N:r,r:s,p:a,dkLen:i,blockSize32:o,V:c,B32:d,B:u,tmp:f,blockMixCb:h}=lo(n,e,t);for(let b=0;b<a;b++){const x=o*b;for(let p=0;p<o;p++)c[p]=d[x+p];for(let p=0,m=0;p<r-1;p++)pr(c,m,c,m+=o,s),h();pr(c,(r-1)*o,d,x,s),h();for(let p=0;p<r;p++){const m=d[x+o-16]%r;for(let y=0;y<o;y++)f[y]=d[x+y]^c[m*o+y];pr(f,0,d,x,s),h()}}return uo(n,i,u,c,f)}async function m0(n,e,t){const{N:r,r:s,p:a,dkLen:i,blockSize32:o,V:c,B32:d,B:u,tmp:f,blockMixCb:h,asyncTick:b}=lo(n,e,t);for(let x=0;x<a;x++){const p=o*x;for(let y=0;y<o;y++)c[y]=d[p+y];let m=0;await wa(r-1,b,()=>{pr(c,m,c,m+=o,s),h()}),pr(c,(r-1)*o,d,p,s),h(),await wa(r,b,()=>{const y=d[p+o-16]%r;for(let A=0;A<o;A++)f[A]=d[p+A]^c[y*o+A];pr(f,0,d,p,s),h()})}return uo(n,i,u,c,f)}let fo=!1,ho=!1;const xo=async function(n,e,t,r,s,a,i){return await m0(n,e,{N:t,r,p:s,dkLen:a,onProgress:i})},po=function(n,e,t,r,s,a){return g0(n,e,{N:t,r,p:s,dkLen:a})};let bo=xo,go=po;async function Zn(n,e,t,r,s,a,i){const o=X(n,"passwd"),c=X(e,"salt");return V(await bo(o,c,t,r,s,a,i))}Zn._=xo;Zn.lock=function(){ho=!0};Zn.register=function(n){if(ho)throw new Error("scrypt is locked");bo=n};Object.freeze(Zn);function Yn(n,e,t,r,s,a){const i=X(n,"passwd"),o=X(e,"salt");return V(go(i,o,t,r,s,a))}Yn._=po;Yn.lock=function(){fo=!0};Yn.register=function(n){if(fo)throw new Error("scryptSync is locked");go=n};Object.freeze(Yn);const mo=function(n){return Wl("sha256").update(n).digest()};let yo=mo,wo=!1;function fn(n){const e=X(n,"data");return V(yo(e))}fn._=mo;fn.lock=function(){wo=!0};fn.register=function(n){if(wo)throw new Error("sha256 is locked");yo=n};Object.freeze(fn);Object.freeze(fn);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Ao=BigInt(0),qn=BigInt(1),y0=BigInt(2),Xn=n=>n instanceof Uint8Array,w0=Array.from({length:256},(n,e)=>e.toString(16).padStart(2,"0"));function Rr(n){if(!Xn(n))throw new Error("Uint8Array expected");let e="";for(let t=0;t<n.length;t++)e+=w0[n[t]];return e}function Eo(n){const e=n.toString(16);return e.length&1?`0${e}`:e}function zs(n){if(typeof n!="string")throw new Error("hex string expected, got "+typeof n);return BigInt(n===""?"0":`0x${n}`)}function Ur(n){if(typeof n!="string")throw new Error("hex string expected, got "+typeof n);const e=n.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const t=new Uint8Array(e/2);for(let r=0;r<t.length;r++){const s=r*2,a=n.slice(s,s+2),i=Number.parseInt(a,16);if(Number.isNaN(i)||i<0)throw new Error("Invalid byte sequence");t[r]=i}return t}function Zt(n){return zs(Rr(n))}function Qs(n){if(!Xn(n))throw new Error("Uint8Array expected");return zs(Rr(Uint8Array.from(n).reverse()))}function Fr(n,e){return Ur(n.toString(16).padStart(e*2,"0"))}function $s(n,e){return Fr(n,e).reverse()}function A0(n){return Ur(Eo(n))}function De(n,e,t){let r;if(typeof e=="string")try{r=Ur(e)}catch(a){throw new Error(`${n} must be valid hex string, got "${e}". Cause: ${a}`)}else if(Xn(e))r=Uint8Array.from(e);else throw new Error(`${n} must be hex string or Uint8Array`);const s=r.length;if(typeof t=="number"&&s!==t)throw new Error(`${n} expected ${t} bytes, got ${s}`);return r}function Xr(...n){const e=new Uint8Array(n.reduce((r,s)=>r+s.length,0));let t=0;return n.forEach(r=>{if(!Xn(r))throw new Error("Uint8Array expected");e.set(r,t),t+=r.length}),e}function E0(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}function N0(n){if(typeof n!="string")throw new Error(`utf8ToBytes expected string, got ${typeof n}`);return new Uint8Array(new TextEncoder().encode(n))}function v0(n){let e;for(e=0;n>Ao;n>>=qn,e+=1);return e}function I0(n,e){return n>>BigInt(e)&qn}const C0=(n,e,t)=>n|(t?qn:Ao)<<BigInt(e),Js=n=>(y0<<BigInt(n-1))-qn,us=n=>new Uint8Array(n),Pa=n=>Uint8Array.from(n);function No(n,e,t){if(typeof n!="number"||n<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof t!="function")throw new Error("hmacFn must be a function");let r=us(n),s=us(n),a=0;const i=()=>{r.fill(1),s.fill(0),a=0},o=(...f)=>t(s,r,...f),c=(f=us())=>{s=o(Pa([0]),f),r=o(),f.length!==0&&(s=o(Pa([1]),f),r=o())},d=()=>{if(a++>=1e3)throw new Error("drbg: tried 1000 values");let f=0;const h=[];for(;f<e;){r=o();const b=r.slice();h.push(b),f+=r.length}return Xr(...h)};return(f,h)=>{i(),c(f);let b;for(;!(b=h(d()));)c();return i(),b}}const P0={bigint:n=>typeof n=="bigint",function:n=>typeof n=="function",boolean:n=>typeof n=="boolean",string:n=>typeof n=="string",stringOrUint8Array:n=>typeof n=="string"||n instanceof Uint8Array,isSafeInteger:n=>Number.isSafeInteger(n),array:n=>Array.isArray(n),field:(n,e)=>e.Fp.isValid(n),hash:n=>typeof n=="function"&&Number.isSafeInteger(n.outputLen)};function hn(n,e,t={}){const r=(s,a,i)=>{const o=P0[a];if(typeof o!="function")throw new Error(`Invalid validator "${a}", expected function`);const c=n[s];if(!(i&&c===void 0)&&!o(c,n))throw new Error(`Invalid param ${String(s)}=${c} (${typeof c}), expected ${a}`)};for(const[s,a]of Object.entries(e))r(s,a,!1);for(const[s,a]of Object.entries(t))r(s,a,!0);return n}const k0=Object.freeze(Object.defineProperty({__proto__:null,bitGet:I0,bitLen:v0,bitMask:Js,bitSet:C0,bytesToHex:Rr,bytesToNumberBE:Zt,bytesToNumberLE:Qs,concatBytes:Xr,createHmacDrbg:No,ensureBytes:De,equalBytes:E0,hexToBytes:Ur,hexToNumber:zs,numberToBytesBE:Fr,numberToBytesLE:$s,numberToHexUnpadded:Eo,numberToVarBytesBE:A0,utf8ToBytes:N0,validateObject:hn},Symbol.toStringTag,{value:"Module"}));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const de=BigInt(0),ie=BigInt(1),Ft=BigInt(2),T0=BigInt(3),Cs=BigInt(4),ka=BigInt(5),Ta=BigInt(8);BigInt(9);BigInt(16);function ye(n,e){const t=n%e;return t>=de?t:e+t}function S0(n,e,t){if(t<=de||e<de)throw new Error("Expected power/modulo > 0");if(t===ie)return de;let r=ie;for(;e>de;)e&ie&&(r=r*n%t),n=n*n%t,e>>=ie;return r}function Se(n,e,t){let r=n;for(;e-- >de;)r*=r,r%=t;return r}function Ps(n,e){if(n===de||e<=de)throw new Error(`invert: expected positive integers, got n=${n} mod=${e}`);let t=ye(n,e),r=e,s=de,a=ie;for(;t!==de;){const o=r/t,c=r%t,d=s-a*o;r=t,t=c,s=a,a=d}if(r!==ie)throw new Error("invert: does not exist");return ye(s,e)}function O0(n){const e=(n-ie)/Ft;let t,r,s;for(t=n-ie,r=0;t%Ft===de;t/=Ft,r++);for(s=Ft;s<n&&S0(s,e,n)!==n-ie;s++);if(r===1){const i=(n+ie)/Cs;return function(c,d){const u=c.pow(d,i);if(!c.eql(c.sqr(u),d))throw new Error("Cannot find square root");return u}}const a=(t+ie)/Ft;return function(o,c){if(o.pow(c,e)===o.neg(o.ONE))throw new Error("Cannot find square root");let d=r,u=o.pow(o.mul(o.ONE,s),t),f=o.pow(c,a),h=o.pow(c,t);for(;!o.eql(h,o.ONE);){if(o.eql(h,o.ZERO))return o.ZERO;let b=1;for(let p=o.sqr(h);b<d&&!o.eql(p,o.ONE);b++)p=o.sqr(p);const x=o.pow(u,ie<<BigInt(d-b-1));u=o.sqr(x),f=o.mul(f,x),h=o.mul(h,u),d=b}return f}}function B0(n){if(n%Cs===T0){const e=(n+ie)/Cs;return function(r,s){const a=r.pow(s,e);if(!r.eql(r.sqr(a),s))throw new Error("Cannot find square root");return a}}if(n%Ta===ka){const e=(n-ka)/Ta;return function(r,s){const a=r.mul(s,Ft),i=r.pow(a,e),o=r.mul(s,i),c=r.mul(r.mul(o,Ft),i),d=r.mul(o,r.sub(c,r.ONE));if(!r.eql(r.sqr(d),s))throw new Error("Cannot find square root");return d}}return O0(n)}const R0=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function U0(n){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},t=R0.reduce((r,s)=>(r[s]="function",r),e);return hn(n,t)}function F0(n,e,t){if(t<de)throw new Error("Expected power > 0");if(t===de)return n.ONE;if(t===ie)return e;let r=n.ONE,s=e;for(;t>de;)t&ie&&(r=n.mul(r,s)),s=n.sqr(s),t>>=ie;return r}function D0(n,e){const t=new Array(e.length),r=e.reduce((a,i,o)=>n.is0(i)?a:(t[o]=a,n.mul(a,i)),n.ONE),s=n.inv(r);return e.reduceRight((a,i,o)=>n.is0(i)?a:(t[o]=n.mul(a,t[o]),n.mul(a,i)),s),t}function vo(n,e){const t=e!==void 0?e:n.toString(2).length,r=Math.ceil(t/8);return{nBitLength:t,nByteLength:r}}function L0(n,e,t=!1,r={}){if(n<=de)throw new Error(`Expected Field ORDER > 0, got ${n}`);const{nBitLength:s,nByteLength:a}=vo(n,e);if(a>2048)throw new Error("Field lengths over 2048 bytes are not supported");const i=B0(n),o=Object.freeze({ORDER:n,BITS:s,BYTES:a,MASK:Js(s),ZERO:de,ONE:ie,create:c=>ye(c,n),isValid:c=>{if(typeof c!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof c}`);return de<=c&&c<n},is0:c=>c===de,isOdd:c=>(c&ie)===ie,neg:c=>ye(-c,n),eql:(c,d)=>c===d,sqr:c=>ye(c*c,n),add:(c,d)=>ye(c+d,n),sub:(c,d)=>ye(c-d,n),mul:(c,d)=>ye(c*d,n),pow:(c,d)=>F0(o,c,d),div:(c,d)=>ye(c*Ps(d,n),n),sqrN:c=>c*c,addN:(c,d)=>c+d,subN:(c,d)=>c-d,mulN:(c,d)=>c*d,inv:c=>Ps(c,n),sqrt:r.sqrt||(c=>i(o,c)),invertBatch:c=>D0(o,c),cmov:(c,d,u)=>u?d:c,toBytes:c=>t?$s(c,a):Fr(c,a),fromBytes:c=>{if(c.length!==a)throw new Error(`Fp.fromBytes: expected ${a}, got ${c.length}`);return t?Qs(c):Zt(c)}});return Object.freeze(o)}function Io(n){if(typeof n!="bigint")throw new Error("field order must be bigint");const e=n.toString(2).length;return Math.ceil(e/8)}function Co(n){const e=Io(n);return e+Math.ceil(e/2)}function M0(n,e,t=!1){const r=n.length,s=Io(e),a=Co(e);if(r<16||r<a||r>1024)throw new Error(`expected ${a}-1024 bytes of input, got ${r}`);const i=t?Zt(n):Qs(n),o=ye(i,e-ie)+ie;return t?$s(o,s):Fr(o,s)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const j0=BigInt(0),fs=BigInt(1);function G0(n,e){const t=(s,a)=>{const i=a.negate();return s?i:a},r=s=>{const a=Math.ceil(e/s)+1,i=2**(s-1);return{windows:a,windowSize:i}};return{constTimeNegate:t,unsafeLadder(s,a){let i=n.ZERO,o=s;for(;a>j0;)a&fs&&(i=i.add(o)),o=o.double(),a>>=fs;return i},precomputeWindow(s,a){const{windows:i,windowSize:o}=r(a),c=[];let d=s,u=d;for(let f=0;f<i;f++){u=d,c.push(u);for(let h=1;h<o;h++)u=u.add(d),c.push(u);d=u.double()}return c},wNAF(s,a,i){const{windows:o,windowSize:c}=r(s);let d=n.ZERO,u=n.BASE;const f=BigInt(2**s-1),h=2**s,b=BigInt(s);for(let x=0;x<o;x++){const p=x*c;let m=Number(i&f);i>>=b,m>c&&(m-=h,i+=fs);const y=p,A=p+Math.abs(m)-1,N=x%2!==0,T=m<0;m===0?u=u.add(t(N,a[y])):d=d.add(t(T,a[A]))}return{p:d,f:u}},wNAFCached(s,a,i,o){const c=s._WINDOW_SIZE||1;let d=a.get(s);return d||(d=this.precomputeWindow(s,c),c!==1&&a.set(s,o(d))),this.wNAF(c,d,i)}}}function Po(n){return U0(n.Fp),hn(n,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...vo(n.n,n.nBitLength),...n,p:n.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function _0(n){const e=Po(n);hn(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:t,Fp:r,a:s}=e;if(t){if(!r.eql(s,r.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof t!="object"||typeof t.beta!="bigint"||typeof t.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}const{bytesToNumberBE:H0,hexToBytes:K0}=k0,Lt={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(n){const{Err:e}=Lt;if(n.length<2||n[0]!==2)throw new e("Invalid signature integer tag");const t=n[1],r=n.subarray(2,t+2);if(!t||r.length!==t)throw new e("Invalid signature integer: wrong length");if(r[0]&128)throw new e("Invalid signature integer: negative");if(r[0]===0&&!(r[1]&128))throw new e("Invalid signature integer: unnecessary leading zero");return{d:H0(r),l:n.subarray(t+2)}},toSig(n){const{Err:e}=Lt,t=typeof n=="string"?K0(n):n;if(!(t instanceof Uint8Array))throw new Error("ui8a expected");let r=t.length;if(r<2||t[0]!=48)throw new e("Invalid signature tag");if(t[1]!==r-2)throw new e("Invalid signature: incorrect length");const{d:s,l:a}=Lt._parseInt(t.subarray(2)),{d:i,l:o}=Lt._parseInt(a);if(o.length)throw new e("Invalid signature: left bytes after parsing");return{r:s,s:i}},hexFromSig(n){const e=d=>Number.parseInt(d[0],16)&8?"00"+d:d,t=d=>{const u=d.toString(16);return u.length&1?`0${u}`:u},r=e(t(n.s)),s=e(t(n.r)),a=r.length/2,i=s.length/2,o=t(a),c=t(i);return`30${t(i+a+4)}02${c}${s}02${o}${r}`}},it=BigInt(0),Be=BigInt(1);BigInt(2);const Sa=BigInt(3);BigInt(4);function V0(n){const e=_0(n),{Fp:t}=e,r=e.toBytes||((x,p,m)=>{const y=p.toAffine();return Xr(Uint8Array.from([4]),t.toBytes(y.x),t.toBytes(y.y))}),s=e.fromBytes||(x=>{const p=x.subarray(1),m=t.fromBytes(p.subarray(0,t.BYTES)),y=t.fromBytes(p.subarray(t.BYTES,2*t.BYTES));return{x:m,y}});function a(x){const{a:p,b:m}=e,y=t.sqr(x),A=t.mul(y,x);return t.add(t.add(A,t.mul(x,p)),m)}if(!t.eql(t.sqr(e.Gy),a(e.Gx)))throw new Error("bad generator point: equation left != right");function i(x){return typeof x=="bigint"&&it<x&&x<e.n}function o(x){if(!i(x))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function c(x){const{allowedPrivateKeyLengths:p,nByteLength:m,wrapPrivateKey:y,n:A}=e;if(p&&typeof x!="bigint"){if(x instanceof Uint8Array&&(x=Rr(x)),typeof x!="string"||!p.includes(x.length))throw new Error("Invalid key");x=x.padStart(m*2,"0")}let N;try{N=typeof x=="bigint"?x:Zt(De("private key",x,m))}catch{throw new Error(`private key must be ${m} bytes, hex or bigint, not ${typeof x}`)}return y&&(N=ye(N,A)),o(N),N}const d=new Map;function u(x){if(!(x instanceof f))throw new Error("ProjectivePoint expected")}class f{constructor(p,m,y){if(this.px=p,this.py=m,this.pz=y,p==null||!t.isValid(p))throw new Error("x required");if(m==null||!t.isValid(m))throw new Error("y required");if(y==null||!t.isValid(y))throw new Error("z required")}static fromAffine(p){const{x:m,y}=p||{};if(!p||!t.isValid(m)||!t.isValid(y))throw new Error("invalid affine point");if(p instanceof f)throw new Error("projective point not allowed");const A=N=>t.eql(N,t.ZERO);return A(m)&&A(y)?f.ZERO:new f(m,y,t.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(p){const m=t.invertBatch(p.map(y=>y.pz));return p.map((y,A)=>y.toAffine(m[A])).map(f.fromAffine)}static fromHex(p){const m=f.fromAffine(s(De("pointHex",p)));return m.assertValidity(),m}static fromPrivateKey(p){return f.BASE.multiply(c(p))}_setWindowSize(p){this._WINDOW_SIZE=p,d.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!t.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:p,y:m}=this.toAffine();if(!t.isValid(p)||!t.isValid(m))throw new Error("bad point: x or y not FE");const y=t.sqr(m),A=a(p);if(!t.eql(y,A))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:p}=this.toAffine();if(t.isOdd)return!t.isOdd(p);throw new Error("Field doesn't support isOdd")}equals(p){u(p);const{px:m,py:y,pz:A}=this,{px:N,py:T,pz:E}=p,P=t.eql(t.mul(m,E),t.mul(N,A)),S=t.eql(t.mul(y,E),t.mul(T,A));return P&&S}negate(){return new f(this.px,t.neg(this.py),this.pz)}double(){const{a:p,b:m}=e,y=t.mul(m,Sa),{px:A,py:N,pz:T}=this;let E=t.ZERO,P=t.ZERO,S=t.ZERO,I=t.mul(A,A),D=t.mul(N,N),_=t.mul(T,T),G=t.mul(A,N);return G=t.add(G,G),S=t.mul(A,T),S=t.add(S,S),E=t.mul(p,S),P=t.mul(y,_),P=t.add(E,P),E=t.sub(D,P),P=t.add(D,P),P=t.mul(E,P),E=t.mul(G,E),S=t.mul(y,S),_=t.mul(p,_),G=t.sub(I,_),G=t.mul(p,G),G=t.add(G,S),S=t.add(I,I),I=t.add(S,I),I=t.add(I,_),I=t.mul(I,G),P=t.add(P,I),_=t.mul(N,T),_=t.add(_,_),I=t.mul(_,G),E=t.sub(E,I),S=t.mul(_,D),S=t.add(S,S),S=t.add(S,S),new f(E,P,S)}add(p){u(p);const{px:m,py:y,pz:A}=this,{px:N,py:T,pz:E}=p;let P=t.ZERO,S=t.ZERO,I=t.ZERO;const D=e.a,_=t.mul(e.b,Sa);let G=t.mul(m,N),W=t.mul(y,T),Y=t.mul(A,E),ne=t.add(m,y),O=t.add(N,T);ne=t.mul(ne,O),O=t.add(G,W),ne=t.sub(ne,O),O=t.add(m,A);let B=t.add(N,E);return O=t.mul(O,B),B=t.add(G,Y),O=t.sub(O,B),B=t.add(y,A),P=t.add(T,E),B=t.mul(B,P),P=t.add(W,Y),B=t.sub(B,P),I=t.mul(D,O),P=t.mul(_,Y),I=t.add(P,I),P=t.sub(W,I),I=t.add(W,I),S=t.mul(P,I),W=t.add(G,G),W=t.add(W,G),Y=t.mul(D,Y),O=t.mul(_,O),W=t.add(W,Y),Y=t.sub(G,Y),Y=t.mul(D,Y),O=t.add(O,Y),G=t.mul(W,O),S=t.add(S,G),G=t.mul(B,O),P=t.mul(ne,P),P=t.sub(P,G),G=t.mul(ne,W),I=t.mul(B,I),I=t.add(I,G),new f(P,S,I)}subtract(p){return this.add(p.negate())}is0(){return this.equals(f.ZERO)}wNAF(p){return b.wNAFCached(this,d,p,m=>{const y=t.invertBatch(m.map(A=>A.pz));return m.map((A,N)=>A.toAffine(y[N])).map(f.fromAffine)})}multiplyUnsafe(p){const m=f.ZERO;if(p===it)return m;if(o(p),p===Be)return this;const{endo:y}=e;if(!y)return b.unsafeLadder(this,p);let{k1neg:A,k1:N,k2neg:T,k2:E}=y.splitScalar(p),P=m,S=m,I=this;for(;N>it||E>it;)N&Be&&(P=P.add(I)),E&Be&&(S=S.add(I)),I=I.double(),N>>=Be,E>>=Be;return A&&(P=P.negate()),T&&(S=S.negate()),S=new f(t.mul(S.px,y.beta),S.py,S.pz),P.add(S)}multiply(p){o(p);let m=p,y,A;const{endo:N}=e;if(N){const{k1neg:T,k1:E,k2neg:P,k2:S}=N.splitScalar(m);let{p:I,f:D}=this.wNAF(E),{p:_,f:G}=this.wNAF(S);I=b.constTimeNegate(T,I),_=b.constTimeNegate(P,_),_=new f(t.mul(_.px,N.beta),_.py,_.pz),y=I.add(_),A=D.add(G)}else{const{p:T,f:E}=this.wNAF(m);y=T,A=E}return f.normalizeZ([y,A])[0]}multiplyAndAddUnsafe(p,m,y){const A=f.BASE,N=(E,P)=>P===it||P===Be||!E.equals(A)?E.multiplyUnsafe(P):E.multiply(P),T=N(this,m).add(N(p,y));return T.is0()?void 0:T}toAffine(p){const{px:m,py:y,pz:A}=this,N=this.is0();p==null&&(p=N?t.ONE:t.inv(A));const T=t.mul(m,p),E=t.mul(y,p),P=t.mul(A,p);if(N)return{x:t.ZERO,y:t.ZERO};if(!t.eql(P,t.ONE))throw new Error("invZ was invalid");return{x:T,y:E}}isTorsionFree(){const{h:p,isTorsionFree:m}=e;if(p===Be)return!0;if(m)return m(f,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:p,clearCofactor:m}=e;return p===Be?this:m?m(f,this):this.multiplyUnsafe(e.h)}toRawBytes(p=!0){return this.assertValidity(),r(f,this,p)}toHex(p=!0){return Rr(this.toRawBytes(p))}}f.BASE=new f(e.Gx,e.Gy,t.ONE),f.ZERO=new f(t.ZERO,t.ONE,t.ZERO);const h=e.nBitLength,b=G0(f,e.endo?Math.ceil(h/2):h);return{CURVE:e,ProjectivePoint:f,normPrivateKeyToScalar:c,weierstrassEquation:a,isWithinCurveOrder:i}}function z0(n){const e=Po(n);return hn(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function Q0(n){const e=z0(n),{Fp:t,n:r}=e,s=t.BYTES+1,a=2*t.BYTES+1;function i(O){return it<O&&O<t.ORDER}function o(O){return ye(O,r)}function c(O){return Ps(O,r)}const{ProjectivePoint:d,normPrivateKeyToScalar:u,weierstrassEquation:f,isWithinCurveOrder:h}=V0({...e,toBytes(O,B,M){const F=B.toAffine(),j=t.toBytes(F.x),J=Xr;return M?J(Uint8Array.from([B.hasEvenY()?2:3]),j):J(Uint8Array.from([4]),j,t.toBytes(F.y))},fromBytes(O){const B=O.length,M=O[0],F=O.subarray(1);if(B===s&&(M===2||M===3)){const j=Zt(F);if(!i(j))throw new Error("Point is not on curve");const J=f(j);let se=t.sqrt(J);const he=(se&Be)===Be;return(M&1)===1!==he&&(se=t.neg(se)),{x:j,y:se}}else if(B===a&&M===4){const j=t.fromBytes(F.subarray(0,t.BYTES)),J=t.fromBytes(F.subarray(t.BYTES,2*t.BYTES));return{x:j,y:J}}else throw new Error(`Point of length ${B} was invalid. Expected ${s} compressed bytes or ${a} uncompressed bytes`)}}),b=O=>Rr(Fr(O,e.nByteLength));function x(O){const B=r>>Be;return O>B}function p(O){return x(O)?o(-O):O}const m=(O,B,M)=>Zt(O.slice(B,M));class y{constructor(B,M,F){this.r=B,this.s=M,this.recovery=F,this.assertValidity()}static fromCompact(B){const M=e.nByteLength;return B=De("compactSignature",B,M*2),new y(m(B,0,M),m(B,M,2*M))}static fromDER(B){const{r:M,s:F}=Lt.toSig(De("DER",B));return new y(M,F)}assertValidity(){if(!h(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!h(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(B){return new y(this.r,this.s,B)}recoverPublicKey(B){const{r:M,s:F,recovery:j}=this,J=S(De("msgHash",B));if(j==null||![0,1,2,3].includes(j))throw new Error("recovery id invalid");const se=j===2||j===3?M+e.n:M;if(se>=t.ORDER)throw new Error("recovery id 2 or 3 invalid");const he=j&1?"03":"02",ut=d.fromHex(he+b(se)),ft=c(se),sr=o(-J*ft),Lr=o(F*ft),ht=d.BASE.multiplyAndAddUnsafe(ut,sr,Lr);if(!ht)throw new Error("point at infinify");return ht.assertValidity(),ht}hasHighS(){return x(this.s)}normalizeS(){return this.hasHighS()?new y(this.r,o(-this.s),this.recovery):this}toDERRawBytes(){return Ur(this.toDERHex())}toDERHex(){return Lt.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Ur(this.toCompactHex())}toCompactHex(){return b(this.r)+b(this.s)}}const A={isValidPrivateKey(O){try{return u(O),!0}catch{return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>{const O=Co(e.n);return M0(e.randomBytes(O),e.n)},precompute(O=8,B=d.BASE){return B._setWindowSize(O),B.multiply(BigInt(3)),B}};function N(O,B=!0){return d.fromPrivateKey(O).toRawBytes(B)}function T(O){const B=O instanceof Uint8Array,M=typeof O=="string",F=(B||M)&&O.length;return B?F===s||F===a:M?F===2*s||F===2*a:O instanceof d}function E(O,B,M=!0){if(T(O))throw new Error("first arg must be private key");if(!T(B))throw new Error("second arg must be public key");return d.fromHex(B).multiply(u(O)).toRawBytes(M)}const P=e.bits2int||function(O){const B=Zt(O),M=O.length*8-e.nBitLength;return M>0?B>>BigInt(M):B},S=e.bits2int_modN||function(O){return o(P(O))},I=Js(e.nBitLength);function D(O){if(typeof O!="bigint")throw new Error("bigint expected");if(!(it<=O&&O<I))throw new Error(`bigint expected < 2^${e.nBitLength}`);return Fr(O,e.nByteLength)}function _(O,B,M=G){if(["recovered","canonical"].some(Bt=>Bt in M))throw new Error("sign() legacy options not supported");const{hash:F,randomBytes:j}=e;let{lowS:J,prehash:se,extraEntropy:he}=M;J==null&&(J=!0),O=De("msgHash",O),se&&(O=De("prehashed msgHash",F(O)));const ut=S(O),ft=u(B),sr=[D(ft),D(ut)];if(he!=null){const Bt=he===!0?j(t.BYTES):he;sr.push(De("extraEntropy",Bt))}const Lr=Xr(...sr),ht=ut;function as(Bt){const ar=P(Bt);if(!h(ar))return;const na=c(ar),ir=d.BASE.multiply(ar).toAffine(),Ue=o(ir.x);if(Ue===it)return;const or=o(na*o(ht+Ue*ft));if(or===it)return;let sa=(ir.x===Ue?0:2)|Number(ir.y&Be),aa=or;return J&&x(or)&&(aa=p(or),sa^=1),new y(Ue,aa,sa)}return{seed:Lr,k2sig:as}}const G={lowS:e.lowS,prehash:!1},W={lowS:e.lowS,prehash:!1};function Y(O,B,M=G){const{seed:F,k2sig:j}=_(O,B,M),J=e;return No(J.hash.outputLen,J.nByteLength,J.hmac)(F,j)}d.BASE._setWindowSize(8);function ne(O,B,M,F=W){var ir;const j=O;if(B=De("msgHash",B),M=De("publicKey",M),"strict"in F)throw new Error("options.strict was renamed to lowS");const{lowS:J,prehash:se}=F;let he,ut;try{if(typeof j=="string"||j instanceof Uint8Array)try{he=y.fromDER(j)}catch(Ue){if(!(Ue instanceof Lt.Err))throw Ue;he=y.fromCompact(j)}else if(typeof j=="object"&&typeof j.r=="bigint"&&typeof j.s=="bigint"){const{r:Ue,s:or}=j;he=new y(Ue,or)}else throw new Error("PARSE");ut=d.fromHex(M)}catch(Ue){if(Ue.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(J&&he.hasHighS())return!1;se&&(B=e.hash(B));const{r:ft,s:sr}=he,Lr=S(B),ht=c(sr),as=o(Lr*ht),Bt=o(ft*ht),ar=(ir=d.BASE.multiplyAndAddUnsafe(ut,as,Bt))==null?void 0:ir.toAffine();return ar?o(ar.x)===ft:!1}return{CURVE:e,getPublicKey:N,getSharedSecret:E,sign:Y,verify:ne,ProjectivePoint:d,Signature:y,utils:A}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function $0(n){return{hash:n,hmac:(e,...t)=>zn(n,e,yl(...t)),randomBytes:Al}}function J0(n,e){const t=r=>Q0({...n,...$0(r)});return Object.freeze({...t(e),create:t})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ko=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),Oa=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),W0=BigInt(1),ks=BigInt(2),Ba=(n,e)=>(n+e/ks)/e;function Z0(n){const e=ko,t=BigInt(3),r=BigInt(6),s=BigInt(11),a=BigInt(22),i=BigInt(23),o=BigInt(44),c=BigInt(88),d=n*n*n%e,u=d*d*n%e,f=Se(u,t,e)*u%e,h=Se(f,t,e)*u%e,b=Se(h,ks,e)*d%e,x=Se(b,s,e)*b%e,p=Se(x,a,e)*x%e,m=Se(p,o,e)*p%e,y=Se(m,c,e)*m%e,A=Se(y,o,e)*p%e,N=Se(A,t,e)*u%e,T=Se(N,i,e)*x%e,E=Se(T,r,e)*d%e,P=Se(E,ks,e);if(!Ts.eql(Ts.sqr(P),n))throw new Error("Cannot find square root");return P}const Ts=L0(ko,void 0,void 0,{sqrt:Z0}),Y0=J0({a:BigInt(0),b:BigInt(7),Fp:Ts,n:Oa,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:n=>{const e=Oa,t=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-W0*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),s=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),a=t,i=BigInt("0x100000000000000000000000000000000"),o=Ba(a*n,e),c=Ba(-r*n,e);let d=ye(n-o*t-c*s,e),u=ye(-o*r-c*a,e);const f=d>i,h=u>i;if(f&&(d=e-d),h&&(u=e-u),d>i||u>i)throw new Error("splitScalar: Endomorphism failed, k="+n);return{k1neg:f,k1:d,k2neg:h,k2:u}}}},Dr);BigInt(0);Y0.ProjectivePoint;const Ra="0x0000000000000000000000000000000000000000000000000000000000000000";const Ua=BigInt(0),Fa=BigInt(1),Da=BigInt(2),La=BigInt(27),Ma=BigInt(28),En=BigInt(35),lr={};function ja(n){return Ni(Ds(n),32)}var Ir,ze,Cr,Jt;const Fe=class Fe{constructor(e,t,r,s){L(this,Ir);L(this,ze);L(this,Cr);L(this,Jt);Gn(e,lr,"Signature"),k(this,Ir,t),k(this,ze,r),k(this,Cr,s),k(this,Jt,null)}get r(){return g(this,Ir)}set r(e){v(xa(e)===32,"invalid r","value",e),k(this,Ir,V(e))}get s(){return v(parseInt(g(this,ze).substring(0,3))<8,"non-canonical s; use ._s","s",g(this,ze)),g(this,ze)}set s(e){v(xa(e)===32,"invalid s","value",e),k(this,ze,V(e))}get _s(){return g(this,ze)}isValid(){return parseInt(g(this,ze).substring(0,3))<8}get v(){return g(this,Cr)}set v(e){const t=te(e,"value");v(t===27||t===28,"invalid v","v",e),k(this,Cr,t)}get networkV(){return g(this,Jt)}get legacyChainId(){const e=this.networkV;return e==null?null:Fe.getChainId(e)}get yParity(){return this.v===27?0:1}get yParityAndS(){const e=X(this.s);return this.yParity&&(e[0]|=128),V(e)}get compactSerialized(){return Ct([this.r,this.yParityAndS])}get serialized(){return Ct([this.r,this.s,this.yParity?"0x1c":"0x1b"])}[Symbol.for("nodejs.util.inspect.custom")](){return`Signature { r: "${this.r}", s: "${this._s}"${this.isValid()?"":', valid: "false"'}, yParity: ${this.yParity}, networkV: ${this.networkV} }`}clone(){const e=new Fe(lr,this.r,this._s,this.v);return this.networkV&&k(e,Jt,this.networkV),e}toJSON(){const e=this.networkV;return{_type:"signature",networkV:e!=null?e.toString():null,r:this.r,s:this._s,v:this.v}}static getChainId(e){const t=ee(e,"v");return t==La||t==Ma?Ua:(v(t>=En,"invalid EIP-155 v","v",e),(t-En)/Da)}static getChainIdV(e,t){return ee(e)*Da+BigInt(35+t-27)}static getNormalizedV(e){const t=ee(e);return t===Ua||t===La?27:t===Fa||t===Ma?28:(v(t>=En,"invalid v","v",e),t&Fa?27:28)}static from(e){function t(d,u){v(d,u,"signature",e)}if(e==null)return new Fe(lr,Ra,Ra,27);if(typeof e=="string"){const d=X(e,"signature");if(d.length===64){const u=V(d.slice(0,32)),f=d.slice(32,64),h=f[0]&128?28:27;return f[0]&=127,new Fe(lr,u,V(f),h)}if(d.length===65){const u=V(d.slice(0,32)),f=V(d.slice(32,64)),h=Fe.getNormalizedV(d[64]);return new Fe(lr,u,f,h)}t(!1,"invalid raw signature length")}if(e instanceof Fe)return e.clone();const r=e.r;t(r!=null,"missing r");const s=ja(r),a=function(d,u){if(d!=null)return ja(d);if(u!=null){t(Ee(u,32),"invalid yParityAndS");const f=X(u);return f[0]&=127,V(f)}t(!1,"missing s")}(e.s,e.yParityAndS),{networkV:i,v:o}=function(d,u,f){if(d!=null){const h=ee(d);return{networkV:h>=En?h:void 0,v:Fe.getNormalizedV(h)}}if(u!=null)return t(Ee(u,32),"invalid yParityAndS"),{v:X(u)[0]&128?28:27};if(f!=null){switch(te(f,"sig.yParity")){case 0:return{v:27};case 1:return{v:28}}t(!1,"invalid yParity")}t(!1,"missing v")}(e.v,e.yParityAndS,e.yParity),c=new Fe(lr,s,a,o);return i&&k(c,Jt,i),t(e.yParity==null||te(e.yParity,"sig.yParity")===c.yParity,"yParity mismatch"),t(e.yParityAndS==null||e.yParityAndS===c.yParityAndS,"yParityAndS mismatch"),c}};Ir=new WeakMap,ze=new WeakMap,Cr=new WeakMap,Jt=new WeakMap;let Ga=Fe;const q0=BigInt(0),X0=BigInt(36);function _a(n){n=n.toLowerCase();const e=n.substring(2).split(""),t=new Uint8Array(40);for(let s=0;s<40;s++)t[s]=e[s].charCodeAt(0);const r=X(Tt(t));for(let s=0;s<40;s+=2)r[s>>1]>>4>=8&&(e[s]=e[s].toUpperCase()),(r[s>>1]&15)>=8&&(e[s+1]=e[s+1].toUpperCase());return"0x"+e.join("")}const Ws={};for(let n=0;n<10;n++)Ws[String(n)]=String(n);for(let n=0;n<26;n++)Ws[String.fromCharCode(65+n)]=String(10+n);const Ha=15;function ed(n){n=n.toUpperCase(),n=n.substring(4)+n.substring(0,2)+"00";let e=n.split("").map(r=>Ws[r]).join("");for(;e.length>=Ha;){let r=e.substring(0,Ha);e=parseInt(r,10)%97+e.substring(r.length)}let t=String(98-parseInt(e,10)%97);for(;t.length<2;)t="0"+t;return t}const td=function(){const n={};for(let e=0;e<36;e++){const t="0123456789abcdefghijklmnopqrstuvwxyz"[e];n[t]=BigInt(e)}return n}();function rd(n){n=n.toLowerCase();let e=q0;for(let t=0;t<n.length;t++)e=e*X0+td[n[t]];return e}function Ne(n){if(v(typeof n=="string","invalid address","address",n),n.match(/^(0x)?[0-9a-fA-F]{40}$/)){n.startsWith("0x")||(n="0x"+n);const e=_a(n);return v(!n.match(/([A-F].*[a-f])|([a-f].*[A-F])/)||e===n,"bad address checksum","address",n),e}if(n.match(/^XE[0-9]{2}[0-9A-Za-z]{30,31}$/)){v(n.substring(2,4)===ed(n),"bad icap checksum","address",n);let e=rd(n.substring(4)).toString(16);for(;e.length<40;)e="0"+e;return _a("0x"+e)}v(!1,"invalid address","address",n)}function To(n){return n&&typeof n.getAddress=="function"}async function hs(n,e){const t=await e;return(t==null||t==="0x0000000000000000000000000000000000000000")&&(U(typeof n!="string","unconfigured name","UNCONFIGURED_NAME",{value:n}),v(!1,"invalid AddressLike value; did not resolve to a value address","target",n)),Ne(t)}function en(n,e){if(typeof n=="string")return n.match(/^0x[0-9a-f]{40}$/i)?Ne(n):(U(e!=null,"ENS resolution requires a provider","UNSUPPORTED_OPERATION",{operation:"resolveName"}),hs(n,e.resolveName(n)));if(To(n))return hs(n,n.getAddress());if(n&&typeof n.then=="function")return hs(n,n);v(!1,"unsupported addressable value","target",n)}const et={};function R(n,e){let t=!1;return e<0&&(t=!0,e*=-1),new pe(et,`${t?"":"u"}int${e}`,n,{signed:t,width:e})}function Q(n,e){return new pe(et,`bytes${e||""}`,n,{size:e})}const Ka=Symbol.for("_ethers_typed");var Wt;const tt=class tt{constructor(e,t,r,s){w(this,"type");w(this,"value");L(this,Wt);w(this,"_typedSymbol");s==null&&(s=null),Gn(et,e,"Typed"),K(this,{_typedSymbol:Ka,type:t,value:r}),k(this,Wt,s),this.format()}format(){if(this.type==="array")throw new Error("");if(this.type==="dynamicArray")throw new Error("");return this.type==="tuple"?`tuple(${this.value.map(e=>e.format()).join(",")})`:this.type}defaultValue(){return 0}minValue(){return 0}maxValue(){return 0}isBigInt(){return!!this.type.match(/^u?int[0-9]+$/)}isData(){return this.type.startsWith("bytes")}isString(){return this.type==="string"}get tupleName(){if(this.type!=="tuple")throw TypeError("not a tuple");return g(this,Wt)}get arrayLength(){if(this.type!=="array")throw TypeError("not an array");return g(this,Wt)===!0?-1:g(this,Wt)===!1?this.value.length:null}static from(e,t){return new tt(et,e,t)}static uint8(e){return R(e,8)}static uint16(e){return R(e,16)}static uint24(e){return R(e,24)}static uint32(e){return R(e,32)}static uint40(e){return R(e,40)}static uint48(e){return R(e,48)}static uint56(e){return R(e,56)}static uint64(e){return R(e,64)}static uint72(e){return R(e,72)}static uint80(e){return R(e,80)}static uint88(e){return R(e,88)}static uint96(e){return R(e,96)}static uint104(e){return R(e,104)}static uint112(e){return R(e,112)}static uint120(e){return R(e,120)}static uint128(e){return R(e,128)}static uint136(e){return R(e,136)}static uint144(e){return R(e,144)}static uint152(e){return R(e,152)}static uint160(e){return R(e,160)}static uint168(e){return R(e,168)}static uint176(e){return R(e,176)}static uint184(e){return R(e,184)}static uint192(e){return R(e,192)}static uint200(e){return R(e,200)}static uint208(e){return R(e,208)}static uint216(e){return R(e,216)}static uint224(e){return R(e,224)}static uint232(e){return R(e,232)}static uint240(e){return R(e,240)}static uint248(e){return R(e,248)}static uint256(e){return R(e,256)}static uint(e){return R(e,256)}static int8(e){return R(e,-8)}static int16(e){return R(e,-16)}static int24(e){return R(e,-24)}static int32(e){return R(e,-32)}static int40(e){return R(e,-40)}static int48(e){return R(e,-48)}static int56(e){return R(e,-56)}static int64(e){return R(e,-64)}static int72(e){return R(e,-72)}static int80(e){return R(e,-80)}static int88(e){return R(e,-88)}static int96(e){return R(e,-96)}static int104(e){return R(e,-104)}static int112(e){return R(e,-112)}static int120(e){return R(e,-120)}static int128(e){return R(e,-128)}static int136(e){return R(e,-136)}static int144(e){return R(e,-144)}static int152(e){return R(e,-152)}static int160(e){return R(e,-160)}static int168(e){return R(e,-168)}static int176(e){return R(e,-176)}static int184(e){return R(e,-184)}static int192(e){return R(e,-192)}static int200(e){return R(e,-200)}static int208(e){return R(e,-208)}static int216(e){return R(e,-216)}static int224(e){return R(e,-224)}static int232(e){return R(e,-232)}static int240(e){return R(e,-240)}static int248(e){return R(e,-248)}static int256(e){return R(e,-256)}static int(e){return R(e,-256)}static bytes1(e){return Q(e,1)}static bytes2(e){return Q(e,2)}static bytes3(e){return Q(e,3)}static bytes4(e){return Q(e,4)}static bytes5(e){return Q(e,5)}static bytes6(e){return Q(e,6)}static bytes7(e){return Q(e,7)}static bytes8(e){return Q(e,8)}static bytes9(e){return Q(e,9)}static bytes10(e){return Q(e,10)}static bytes11(e){return Q(e,11)}static bytes12(e){return Q(e,12)}static bytes13(e){return Q(e,13)}static bytes14(e){return Q(e,14)}static bytes15(e){return Q(e,15)}static bytes16(e){return Q(e,16)}static bytes17(e){return Q(e,17)}static bytes18(e){return Q(e,18)}static bytes19(e){return Q(e,19)}static bytes20(e){return Q(e,20)}static bytes21(e){return Q(e,21)}static bytes22(e){return Q(e,22)}static bytes23(e){return Q(e,23)}static bytes24(e){return Q(e,24)}static bytes25(e){return Q(e,25)}static bytes26(e){return Q(e,26)}static bytes27(e){return Q(e,27)}static bytes28(e){return Q(e,28)}static bytes29(e){return Q(e,29)}static bytes30(e){return Q(e,30)}static bytes31(e){return Q(e,31)}static bytes32(e){return Q(e,32)}static address(e){return new tt(et,"address",e)}static bool(e){return new tt(et,"bool",!!e)}static bytes(e){return new tt(et,"bytes",e)}static string(e){return new tt(et,"string",e)}static array(e,t){throw new Error("not implemented yet")}static tuple(e,t){throw new Error("not implemented yet")}static overrides(e){return new tt(et,"overrides",Object.assign({},e))}static isTyped(e){return e&&typeof e=="object"&&"_typedSymbol"in e&&e._typedSymbol===Ka}static dereference(e,t){if(tt.isTyped(e)){if(e.type!==t)throw new Error(`invalid type: expecetd ${t}, got ${e.type}`);return e.value}return e}};Wt=new WeakMap;let pe=tt;class nd extends dt{constructor(e){super("address","address",e,!1)}defaultValue(){return"0x0000000000000000000000000000000000000000"}encode(e,t){let r=pe.dereference(t,"string");try{r=Ne(r)}catch(s){return this._throwError(s.message,t)}return e.writeValue(r)}decode(e){return Ne(Kn(e.readValue(),20))}}class sd extends dt{constructor(t){super(t.name,t.type,"_",t.dynamic);w(this,"coder");this.coder=t}defaultValue(){return this.coder.defaultValue()}encode(t,r){return this.coder.encode(t,r)}decode(t){return this.coder.decode(t)}}function So(n,e,t){let r=[];if(Array.isArray(t))r=t;else if(t&&typeof t=="object"){let c={};r=e.map(d=>{const u=d.localName;return U(u,"cannot encode object for signature with missing names","INVALID_ARGUMENT",{argument:"values",info:{coder:d},value:t}),U(!c[u],"cannot encode object for signature with duplicate names","INVALID_ARGUMENT",{argument:"values",info:{coder:d},value:t}),c[u]=!0,t[u]})}else v(!1,"invalid tuple value","tuple",t);v(e.length===r.length,"types/value length mismatch","tuple",t);let s=new Es,a=new Es,i=[];e.forEach((c,d)=>{let u=r[d];if(c.dynamic){let f=a.length;c.encode(a,u);let h=s.writeUpdatableValue();i.push(b=>{h(b+f)})}else c.encode(s,u)}),i.forEach(c=>{c(s.length)});let o=n.appendWriter(s);return o+=n.appendWriter(a),o}function Oo(n,e){let t=[],r=[],s=n.subReader(0);return e.forEach(a=>{let i=null;if(a.dynamic){let o=n.readIndex(),c=s.subReader(o);try{i=a.decode(c)}catch(d){if(Tr(d,"BUFFER_OVERRUN"))throw d;i=d,i.baseType=a.name,i.name=a.localName,i.type=a.type}}else try{i=a.decode(n)}catch(o){if(Tr(o,"BUFFER_OVERRUN"))throw o;i=o,i.baseType=a.name,i.name=a.localName,i.type=a.type}if(i==null)throw new Error("investigate");t.push(i),r.push(a.localName||null)}),Sr.fromItems(t,r)}class ad extends dt{constructor(t,r,s){const a=t.type+"["+(r>=0?r:"")+"]",i=r===-1||t.dynamic;super("array",a,s,i);w(this,"coder");w(this,"length");K(this,{coder:t,length:r})}defaultValue(){const t=this.coder.defaultValue(),r=[];for(let s=0;s<this.length;s++)r.push(t);return r}encode(t,r){const s=pe.dereference(r,"array");Array.isArray(s)||this._throwError("expected array value",s);let a=this.length;a===-1&&(a=s.length,t.writeValue(s.length)),yi(s.length,a,"coder array"+(this.localName?" "+this.localName:""));let i=[];for(let o=0;o<s.length;o++)i.push(this.coder);return So(t,i,s)}decode(t){let r=this.length;r===-1&&(r=t.readIndex(),U(r*be<=t.dataLength,"insufficient data length","BUFFER_OVERRUN",{buffer:t.bytes,offset:r*be,length:t.dataLength}));let s=[];for(let a=0;a<r;a++)s.push(new sd(this.coder));return Oo(t,s)}}class id extends dt{constructor(e){super("bool","bool",e,!1)}defaultValue(){return!1}encode(e,t){const r=pe.dereference(t,"bool");return e.writeValue(r?1:0)}decode(e){return!!e.readValue()}}class Bo extends dt{constructor(e,t){super(e,e,t,!0)}defaultValue(){return"0x"}encode(e,t){t=qe(t);let r=e.writeValue(t.length);return r+=e.writeBytes(t),r}decode(e){return e.readBytes(e.readIndex(),!0)}}class od extends Bo{constructor(e){super("bytes",e)}decode(e){return V(super.decode(e))}}class cd extends dt{constructor(t,r){let s="bytes"+String(t);super(s,s,r,!1);w(this,"size");K(this,{size:t},{size:"number"})}defaultValue(){return"0x0000000000000000000000000000000000000000000000000000000000000000".substring(0,2+this.size*2)}encode(t,r){let s=qe(pe.dereference(r,this.type));return s.length!==this.size&&this._throwError("incorrect data length",r),t.writeBytes(s)}decode(t){return V(t.readBytes(this.size))}}const ld=new Uint8Array([]);class dd extends dt{constructor(e){super("null","",e,!1)}defaultValue(){return null}encode(e,t){return t!=null&&this._throwError("not null",t),e.writeBytes(ld)}decode(e){return e.readBytes(0),null}}const ud=BigInt(0),fd=BigInt(1),hd=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");class xd extends dt{constructor(t,r,s){const a=(r?"int":"uint")+t*8;super(a,a,s,!1);w(this,"size");w(this,"signed");K(this,{size:t,signed:r},{size:"number",signed:"boolean"})}defaultValue(){return 0}encode(t,r){let s=ee(pe.dereference(r,this.type)),a=pn(hd,be*8);if(this.signed){let i=pn(a,this.size*8-1);(s>i||s<-(i+fd))&&this._throwError("value out-of-bounds",r),s=Yc(s,8*be)}else(s<ud||s>pn(a,this.size*8))&&this._throwError("value out-of-bounds",r);return t.writeValue(s)}decode(t){let r=pn(t.readValue(),this.size*8);return this.signed&&(r=Zc(r,this.size*8)),r}}class pd extends Bo{constructor(e){super("string",e)}defaultValue(){return""}encode(e,t){return super.encode(e,xr(pe.dereference(t,"string")))}decode(e){return ys(super.decode(e))}}class Nn extends dt{constructor(t,r){let s=!1;const a=[];t.forEach(o=>{o.dynamic&&(s=!0),a.push(o.type)});const i="tuple("+a.join(",")+")";super("tuple",i,r,s);w(this,"coders");K(this,{coders:Object.freeze(t.slice())})}defaultValue(){const t=[];this.coders.forEach(s=>{t.push(s.defaultValue())});const r=this.coders.reduce((s,a)=>{const i=a.localName;return i&&(s[i]||(s[i]=0),s[i]++),s},{});return this.coders.forEach((s,a)=>{let i=s.localName;!i||r[i]!==1||(i==="length"&&(i="_length"),t[i]==null&&(t[i]=t[a]))}),Object.freeze(t)}encode(t,r){const s=pe.dereference(r,"tuple");return So(t,this.coders,s)}decode(t){return Oo(t,this.coders)}}function xs(n,e){return{address:Ne(n),storageKeys:e.map((t,r)=>(v(Ee(t,32),"invalid slot",`storageKeys[${r}]`,t),t.toLowerCase()))}}function bd(n){if(Array.isArray(n))return n.map((t,r)=>Array.isArray(t)?(v(t.length===2,"invalid slot set",`value[${r}]`,t),xs(t[0],t[1])):(v(t!=null&&typeof t=="object","invalid address-slot set","value",n),xs(t.address,t.storageKeys)));v(n!=null&&typeof n=="object","invalid access list","value",n);const e=Object.keys(n).map(t=>{const r=n[t].reduce((s,a)=>(s[a]=!0,s),{});return xs(t,Object.keys(r).sort())});return e.sort((t,r)=>t.address.localeCompare(r.address)),e}const ff=BigInt(0),hf=BigInt(2),xf=BigInt(27),pf=BigInt(28),bf=BigInt(35),gf=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),mf=4096*32;function tn(n){return Tt(xr(n))}const gd=44032,md=4352,yd=4449,wd=4519,Ro=19,Uo=21,Fo=28,Ad=Uo*Fo,Ed=Ro*Ad,yf=gd+Ed,wf=md+Ro,Af=yd+Uo,Ef=wd+Fo;const Nd=new Uint8Array(32);Nd.fill(0);const vd=new Uint8Array(32);vd.fill(0);const Nf=BigInt(-1),Id=BigInt(0),Cd=BigInt(1),vf=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");const If=Kn(Cd,32),Cf=Kn(Id,32);function Va(n){return function(e){return v(typeof e=="string",`invalid domain value for ${JSON.stringify(n)}`,`domain.${n}`,e),e}}const Pf={name:Va("name"),version:Va("version"),chainId:function(n){const e=ee(n,"domain.chainId");return v(e>=0,"invalid chain ID","domain.chainId",n),Number.isSafeInteger(e)?Number(e):Xc(e)},verifyingContract:function(n){try{return Ne(n).toLowerCase()}catch{}v(!1,'invalid domain value "verifyingContract"',"domain.verifyingContract",n)},salt:function(n){const e=X(n,"domain.salt");return v(e.length===32,'invalid domain value "salt"',"domain.salt",n),V(e)}};function ge(n){const e=new Set;return n.forEach(t=>e.add(t)),Object.freeze(e)}const Pd="external public payable override",kd=ge(Pd.split(" ")),Do="constant external internal payable private public pure view override",Td=ge(Do.split(" ")),Lo="constructor error event fallback function receive struct",Mo=ge(Lo.split(" ")),jo="calldata memory storage payable indexed",Sd=ge(jo.split(" ")),Od="tuple returns",Bd=[Lo,jo,Od,Do].join(" "),Rd=ge(Bd.split(" ")),Ud={"(":"OPEN_PAREN",")":"CLOSE_PAREN","[":"OPEN_BRACKET","]":"CLOSE_BRACKET",",":"COMMA","@":"AT"},Fd=new RegExp("^(\\s*)"),Dd=new RegExp("^([0-9]+)"),Ld=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)"),Go=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)$"),_o=new RegExp("^(address|bool|bytes([0-9]*)|string|u?int([0-9]*))$");var ue,je,cn,Ss;const Mn=class Mn{constructor(e){L(this,cn);L(this,ue);L(this,je);k(this,ue,0),k(this,je,e.slice())}get offset(){return g(this,ue)}get length(){return g(this,je).length-g(this,ue)}clone(){return new Mn(g(this,je))}reset(){k(this,ue,0)}popKeyword(e){const t=this.peek();if(t.type!=="KEYWORD"||!e.has(t.text))throw new Error(`expected keyword ${t.text}`);return this.pop().text}popType(e){if(this.peek().type!==e){const t=this.peek();throw new Error(`expected ${e}; got ${t.type} ${JSON.stringify(t.text)}`)}return this.pop().text}popParen(){const e=this.peek();if(e.type!=="OPEN_PAREN")throw new Error("bad start");const t=q(this,cn,Ss).call(this,g(this,ue)+1,e.match+1);return k(this,ue,e.match+1),t}popParams(){const e=this.peek();if(e.type!=="OPEN_PAREN")throw new Error("bad start");const t=[];for(;g(this,ue)<e.match-1;){const r=this.peek().linkNext;t.push(q(this,cn,Ss).call(this,g(this,ue)+1,r)),k(this,ue,r)}return k(this,ue,e.match+1),t}peek(){if(g(this,ue)>=g(this,je).length)throw new Error("out-of-bounds");return g(this,je)[g(this,ue)]}peekKeyword(e){const t=this.peekType("KEYWORD");return t!=null&&e.has(t)?t:null}peekType(e){if(this.length===0)return null;const t=this.peek();return t.type===e?t.text:null}pop(){const e=this.peek();return oa(this,ue)._++,e}toString(){const e=[];for(let t=g(this,ue);t<g(this,je).length;t++){const r=g(this,je)[t];e.push(`${r.type}:${r.text}`)}return`<TokenString ${e.join(" ")}>`}};ue=new WeakMap,je=new WeakMap,cn=new WeakSet,Ss=function(e=0,t=0){return new Mn(g(this,je).slice(e,t).map(r=>Object.freeze(Object.assign({},r,{match:r.match-e,linkBack:r.linkBack-e,linkNext:r.linkNext-e}))))};let _e=Mn;function Ot(n){const e=[],t=i=>{const o=a<n.length?JSON.stringify(n[a]):"$EOI";throw new Error(`invalid token ${o} at ${a}: ${i}`)};let r=[],s=[],a=0;for(;a<n.length;){let i=n.substring(a),o=i.match(Fd);o&&(a+=o[1].length,i=n.substring(a));const c={depth:r.length,linkBack:-1,linkNext:-1,match:-1,type:"",text:"",offset:a,value:-1};e.push(c);let d=Ud[i[0]]||"";if(d){if(c.type=d,c.text=i[0],a++,d==="OPEN_PAREN")r.push(e.length-1),s.push(e.length-1);else if(d=="CLOSE_PAREN")r.length===0&&t("no matching open bracket"),c.match=r.pop(),e[c.match].match=e.length-1,c.depth--,c.linkBack=s.pop(),e[c.linkBack].linkNext=e.length-1;else if(d==="COMMA")c.linkBack=s.pop(),e[c.linkBack].linkNext=e.length-1,s.push(e.length-1);else if(d==="OPEN_BRACKET")c.type="BRACKET";else if(d==="CLOSE_BRACKET"){let u=e.pop().text;if(e.length>0&&e[e.length-1].type==="NUMBER"){const f=e.pop().text;u=f+u,e[e.length-1].value=te(f)}if(e.length===0||e[e.length-1].type!=="BRACKET")throw new Error("missing opening bracket");e[e.length-1].text+=u}continue}if(o=i.match(Ld),o){if(c.text=o[1],a+=c.text.length,Rd.has(c.text)){c.type="KEYWORD";continue}if(c.text.match(_o)){c.type="TYPE";continue}c.type="ID";continue}if(o=i.match(Dd),o){c.text=o[1],c.type="NUMBER",a+=c.text.length;continue}throw new Error(`unexpected token ${JSON.stringify(i[0])} at position ${a}`)}return new _e(e.map(i=>Object.freeze(i)))}function za(n,e){let t=[];for(const r in e.keys())n.has(r)&&t.push(r);if(t.length>1)throw new Error(`conflicting types: ${t.join(", ")}`)}function es(n,e){if(e.peekKeyword(Mo)){const t=e.pop().text;if(t!==n)throw new Error(`expected ${n}, got ${t}`)}return e.popType("ID")}function lt(n,e){const t=new Set;for(;;){const r=n.peekType("KEYWORD");if(r==null||e&&!e.has(r))break;if(n.pop(),t.has(r))throw new Error(`duplicate keywords: ${JSON.stringify(r)}`);t.add(r)}return Object.freeze(t)}function Ho(n){let e=lt(n,Td);return za(e,ge("constant payable nonpayable".split(" "))),za(e,ge("pure view payable nonpayable".split(" "))),e.has("view")?"view":e.has("pure")?"pure":e.has("payable")?"payable":e.has("nonpayable")?"nonpayable":e.has("constant")?"view":"nonpayable"}function ct(n,e){return n.popParams().map(t=>fe.from(t,e))}function Ko(n){if(n.peekType("AT")){if(n.pop(),n.peekType("NUMBER"))return ee(n.pop().text);throw new Error("invalid gas")}return null}function er(n){if(n.length)throw new Error(`unexpected tokens at offset ${n.offset}: ${n.toString()}`)}const Md=new RegExp(/^(.*)\[([0-9]*)\]$/);function Qa(n){const e=n.match(_o);if(v(e,"invalid type","type",n),n==="uint")return"uint256";if(n==="int")return"int256";if(e[2]){const t=parseInt(e[2]);v(t!==0&&t<=32,"invalid bytes length","type",n)}else if(e[3]){const t=parseInt(e[3]);v(t!==0&&t<=256&&t%8===0,"invalid numeric width","type",n)}return n}const re={},ve=Symbol.for("_ethers_internal"),$a="_ParamTypeInternal",Ja="_ErrorInternal",Wa="_EventInternal",Za="_ConstructorInternal",Ya="_FallbackInternal",qa="_FunctionInternal",Xa="_StructInternal";var Pr,Sn;const Oe=class Oe{constructor(e,t,r,s,a,i,o,c){L(this,Pr);w(this,"name");w(this,"type");w(this,"baseType");w(this,"indexed");w(this,"components");w(this,"arrayLength");w(this,"arrayChildren");if(Gn(e,re,"ParamType"),Object.defineProperty(this,ve,{value:$a}),i&&(i=Object.freeze(i.slice())),s==="array"){if(o==null||c==null)throw new Error("")}else if(o!=null||c!=null)throw new Error("");if(s==="tuple"){if(i==null)throw new Error("")}else if(i!=null)throw new Error("");K(this,{name:t,type:r,baseType:s,indexed:a,components:i,arrayLength:o,arrayChildren:c})}format(e){if(e==null&&(e="sighash"),e==="json"){const r=this.name||"";if(this.isArray()){const a=JSON.parse(this.arrayChildren.format("json"));return a.name=r,a.type+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`,JSON.stringify(a)}const s={type:this.baseType==="tuple"?"tuple":this.type,name:r};return typeof this.indexed=="boolean"&&(s.indexed=this.indexed),this.isTuple()&&(s.components=this.components.map(a=>JSON.parse(a.format(e)))),JSON.stringify(s)}let t="";return this.isArray()?(t+=this.arrayChildren.format(e),t+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`):this.isTuple()?t+="("+this.components.map(r=>r.format(e)).join(e==="full"?", ":",")+")":t+=this.type,e!=="sighash"&&(this.indexed===!0&&(t+=" indexed"),e==="full"&&this.name&&(t+=" "+this.name)),t}isArray(){return this.baseType==="array"}isTuple(){return this.baseType==="tuple"}isIndexable(){return this.indexed!=null}walk(e,t){if(this.isArray()){if(!Array.isArray(e))throw new Error("invalid array value");if(this.arrayLength!==-1&&e.length!==this.arrayLength)throw new Error("array is wrong length");const r=this;return e.map(s=>r.arrayChildren.walk(s,t))}if(this.isTuple()){if(!Array.isArray(e))throw new Error("invalid tuple value");if(e.length!==this.components.length)throw new Error("array is wrong length");const r=this;return e.map((s,a)=>r.components[a].walk(s,t))}return t(this.type,e)}async walkAsync(e,t){const r=[],s=[e];return q(this,Pr,Sn).call(this,r,e,t,a=>{s[0]=a}),r.length&&await Promise.all(r),s[0]}static from(e,t){if(Oe.isParamType(e))return e;if(typeof e=="string")try{return Oe.from(Ot(e),t)}catch{v(!1,"invalid param type","obj",e)}else if(e instanceof _e){let o="",c="",d=null;lt(e,ge(["tuple"])).has("tuple")||e.peekType("OPEN_PAREN")?(c="tuple",d=e.popParams().map(p=>Oe.from(p)),o=`tuple(${d.map(p=>p.format()).join(",")})`):(o=Qa(e.popType("TYPE")),c=o);let u=null,f=null;for(;e.length&&e.peekType("BRACKET");){const p=e.pop();u=new Oe(re,"",o,c,null,d,f,u),f=p.value,o+=p.text,c="array",d=null}let h=null;if(lt(e,Sd).has("indexed")){if(!t)throw new Error("");h=!0}const x=e.peekType("ID")?e.pop().text:"";if(e.length)throw new Error("leftover tokens");return new Oe(re,x,o,c,h,d,f,u)}const r=e.name;v(!r||typeof r=="string"&&r.match(Go),"invalid name","obj.name",r);let s=e.indexed;s!=null&&(v(t,"parameter cannot be indexed","obj.indexed",e.indexed),s=!!s);let a=e.type,i=a.match(Md);if(i){const o=parseInt(i[2]||"-1"),c=Oe.from({type:i[1],components:e.components});return new Oe(re,r||"",a,"array",s,null,o,c)}if(a==="tuple"||a.startsWith("tuple(")||a.startsWith("(")){const o=e.components!=null?e.components.map(d=>Oe.from(d)):null;return new Oe(re,r||"",a,"tuple",s,o,null,null)}return a=Qa(e.type),new Oe(re,r||"",a,a,s,null,null,null)}static isParamType(e){return e&&e[ve]===$a}};Pr=new WeakSet,Sn=function(e,t,r,s){if(this.isArray()){if(!Array.isArray(t))throw new Error("invalid array value");if(this.arrayLength!==-1&&t.length!==this.arrayLength)throw new Error("array is wrong length");const i=this.arrayChildren,o=t.slice();o.forEach((c,d)=>{var u;q(u=i,Pr,Sn).call(u,e,c,r,f=>{o[d]=f})}),s(o);return}if(this.isTuple()){const i=this.components;let o;if(Array.isArray(t))o=t.slice();else{if(t==null||typeof t!="object")throw new Error("invalid tuple value");o=i.map(c=>{if(!c.name)throw new Error("cannot use object value with unnamed components");if(!(c.name in t))throw new Error(`missing value for component ${c.name}`);return t[c.name]})}if(o.length!==this.components.length)throw new Error("array is wrong length");o.forEach((c,d)=>{var u;q(u=i[d],Pr,Sn).call(u,e,c,r,f=>{o[d]=f})}),s(o);return}const a=r(this.type,t);a.then?e.push(async function(){s(await a)}()):s(a)};let fe=Oe;class tr{constructor(e,t,r){w(this,"type");w(this,"inputs");Gn(e,re,"Fragment"),r=Object.freeze(r.slice()),K(this,{type:t,inputs:r})}static from(e){if(typeof e=="string"){try{tr.from(JSON.parse(e))}catch{}return tr.from(Ot(e))}if(e instanceof _e)switch(e.peekKeyword(Mo)){case"constructor":return ot.from(e);case"error":return we.from(e);case"event":return Ze.from(e);case"fallback":case"receive":return rt.from(e);case"function":return Ye.from(e);case"struct":return Yt.from(e)}else if(typeof e=="object"){switch(e.type){case"constructor":return ot.from(e);case"error":return we.from(e);case"event":return Ze.from(e);case"fallback":case"receive":return rt.from(e);case"function":return Ye.from(e);case"struct":return Yt.from(e)}U(!1,`unsupported type: ${e.type}`,"UNSUPPORTED_OPERATION",{operation:"Fragment.from"})}v(!1,"unsupported frgament object","obj",e)}static isConstructor(e){return ot.isFragment(e)}static isError(e){return we.isFragment(e)}static isEvent(e){return Ze.isFragment(e)}static isFunction(e){return Ye.isFragment(e)}static isStruct(e){return Yt.isFragment(e)}}class ts extends tr{constructor(t,r,s,a){super(t,r,a);w(this,"name");v(typeof s=="string"&&s.match(Go),"invalid identifier","name",s),a=Object.freeze(a.slice()),K(this,{name:s})}}function rn(n,e){return"("+e.map(t=>t.format(n)).join(n==="full"?", ":",")+")"}class we extends ts{constructor(e,t,r){super(e,"error",t,r),Object.defineProperty(this,ve,{value:Ja})}get selector(){return tn(this.format("sighash")).substring(0,10)}format(e){if(e==null&&(e="sighash"),e==="json")return JSON.stringify({type:"error",name:this.name,inputs:this.inputs.map(r=>JSON.parse(r.format(e)))});const t=[];return e!=="sighash"&&t.push("error"),t.push(this.name+rn(e,this.inputs)),t.join(" ")}static from(e){if(we.isFragment(e))return e;if(typeof e=="string")return we.from(Ot(e));if(e instanceof _e){const t=es("error",e),r=ct(e);return er(e),new we(re,t,r)}return new we(re,e.name,e.inputs?e.inputs.map(fe.from):[])}static isFragment(e){return e&&e[ve]===Ja}}class Ze extends ts{constructor(t,r,s,a){super(t,"event",r,s);w(this,"anonymous");Object.defineProperty(this,ve,{value:Wa}),K(this,{anonymous:a})}get topicHash(){return tn(this.format("sighash"))}format(t){if(t==null&&(t="sighash"),t==="json")return JSON.stringify({type:"event",anonymous:this.anonymous,name:this.name,inputs:this.inputs.map(s=>JSON.parse(s.format(t)))});const r=[];return t!=="sighash"&&r.push("event"),r.push(this.name+rn(t,this.inputs)),t!=="sighash"&&this.anonymous&&r.push("anonymous"),r.join(" ")}static getTopicHash(t,r){return r=(r||[]).map(a=>fe.from(a)),new Ze(re,t,r,!1).topicHash}static from(t){if(Ze.isFragment(t))return t;if(typeof t=="string")try{return Ze.from(Ot(t))}catch{v(!1,"invalid event fragment","obj",t)}else if(t instanceof _e){const r=es("event",t),s=ct(t,!0),a=!!lt(t,ge(["anonymous"])).has("anonymous");return er(t),new Ze(re,r,s,a)}return new Ze(re,t.name,t.inputs?t.inputs.map(r=>fe.from(r,!0)):[],!!t.anonymous)}static isFragment(t){return t&&t[ve]===Wa}}class ot extends tr{constructor(t,r,s,a,i){super(t,r,s);w(this,"payable");w(this,"gas");Object.defineProperty(this,ve,{value:Za}),K(this,{payable:a,gas:i})}format(t){if(U(t!=null&&t!=="sighash","cannot format a constructor for sighash","UNSUPPORTED_OPERATION",{operation:"format(sighash)"}),t==="json")return JSON.stringify({type:"constructor",stateMutability:this.payable?"payable":"undefined",payable:this.payable,gas:this.gas!=null?this.gas:void 0,inputs:this.inputs.map(s=>JSON.parse(s.format(t)))});const r=[`constructor${rn(t,this.inputs)}`];return this.payable&&r.push("payable"),this.gas!=null&&r.push(`@${this.gas.toString()}`),r.join(" ")}static from(t){if(ot.isFragment(t))return t;if(typeof t=="string")try{return ot.from(Ot(t))}catch{v(!1,"invalid constuctor fragment","obj",t)}else if(t instanceof _e){lt(t,ge(["constructor"]));const r=ct(t),s=!!lt(t,kd).has("payable"),a=Ko(t);return er(t),new ot(re,"constructor",r,s,a)}return new ot(re,"constructor",t.inputs?t.inputs.map(fe.from):[],!!t.payable,t.gas!=null?t.gas:null)}static isFragment(t){return t&&t[ve]===Za}}class rt extends tr{constructor(t,r,s){super(t,"fallback",r);w(this,"payable");Object.defineProperty(this,ve,{value:Ya}),K(this,{payable:s})}format(t){const r=this.inputs.length===0?"receive":"fallback";if(t==="json"){const s=this.payable?"payable":"nonpayable";return JSON.stringify({type:r,stateMutability:s})}return`${r}()${this.payable?" payable":""}`}static from(t){if(rt.isFragment(t))return t;if(typeof t=="string")try{return rt.from(Ot(t))}catch{v(!1,"invalid fallback fragment","obj",t)}else if(t instanceof _e){const r=t.toString(),s=t.peekKeyword(ge(["fallback","receive"]));if(v(s,"type must be fallback or receive","obj",r),t.popKeyword(ge(["fallback","receive"]))==="receive"){const c=ct(t);return v(c.length===0,"receive cannot have arguments","obj.inputs",c),lt(t,ge(["payable"])),er(t),new rt(re,[],!0)}let i=ct(t);i.length?v(i.length===1&&i[0].type==="bytes","invalid fallback inputs","obj.inputs",i.map(c=>c.format("minimal")).join(", ")):i=[fe.from("bytes")];const o=Ho(t);if(v(o==="nonpayable"||o==="payable","fallback cannot be constants","obj.stateMutability",o),lt(t,ge(["returns"])).has("returns")){const c=ct(t);v(c.length===1&&c[0].type==="bytes","invalid fallback outputs","obj.outputs",c.map(d=>d.format("minimal")).join(", "))}return er(t),new rt(re,i,o==="payable")}if(t.type==="receive")return new rt(re,[],!0);if(t.type==="fallback"){const r=[fe.from("bytes")],s=t.stateMutability==="payable";return new rt(re,r,s)}v(!1,"invalid fallback description","obj",t)}static isFragment(t){return t&&t[ve]===Ya}}class Ye extends ts{constructor(t,r,s,a,i,o){super(t,"function",r,a);w(this,"constant");w(this,"outputs");w(this,"stateMutability");w(this,"payable");w(this,"gas");Object.defineProperty(this,ve,{value:qa}),i=Object.freeze(i.slice()),K(this,{constant:s==="view"||s==="pure",gas:o,outputs:i,payable:s==="payable",stateMutability:s})}get selector(){return tn(this.format("sighash")).substring(0,10)}format(t){if(t==null&&(t="sighash"),t==="json")return JSON.stringify({type:"function",name:this.name,constant:this.constant,stateMutability:this.stateMutability!=="nonpayable"?this.stateMutability:void 0,payable:this.payable,gas:this.gas!=null?this.gas:void 0,inputs:this.inputs.map(s=>JSON.parse(s.format(t))),outputs:this.outputs.map(s=>JSON.parse(s.format(t)))});const r=[];return t!=="sighash"&&r.push("function"),r.push(this.name+rn(t,this.inputs)),t!=="sighash"&&(this.stateMutability!=="nonpayable"&&r.push(this.stateMutability),this.outputs&&this.outputs.length&&(r.push("returns"),r.push(rn(t,this.outputs))),this.gas!=null&&r.push(`@${this.gas.toString()}`)),r.join(" ")}static getSelector(t,r){return r=(r||[]).map(a=>fe.from(a)),new Ye(re,t,"view",r,[],null).selector}static from(t){if(Ye.isFragment(t))return t;if(typeof t=="string")try{return Ye.from(Ot(t))}catch{v(!1,"invalid function fragment","obj",t)}else if(t instanceof _e){const s=es("function",t),a=ct(t),i=Ho(t);let o=[];lt(t,ge(["returns"])).has("returns")&&(o=ct(t));const c=Ko(t);return er(t),new Ye(re,s,i,a,o,c)}let r=t.stateMutability;return r==null&&(r="payable",typeof t.constant=="boolean"?(r="view",t.constant||(r="payable",typeof t.payable=="boolean"&&!t.payable&&(r="nonpayable"))):typeof t.payable=="boolean"&&!t.payable&&(r="nonpayable")),new Ye(re,t.name,r,t.inputs?t.inputs.map(fe.from):[],t.outputs?t.outputs.map(fe.from):[],t.gas!=null?t.gas:null)}static isFragment(t){return t&&t[ve]===qa}}class Yt extends ts{constructor(e,t,r){super(e,"struct",t,r),Object.defineProperty(this,ve,{value:Xa})}format(){throw new Error("@TODO")}static from(e){if(typeof e=="string")try{return Yt.from(Ot(e))}catch{v(!1,"invalid struct fragment","obj",e)}else if(e instanceof _e){const t=es("struct",e),r=ct(e);return er(e),new Yt(re,t,r)}return new Yt(re,e.name,e.inputs?e.inputs.map(fe.from):[])}static isFragment(e){return e&&e[ve]===Xa}}const He=new Map;He.set(0,"GENERIC_PANIC");He.set(1,"ASSERT_FALSE");He.set(17,"OVERFLOW");He.set(18,"DIVIDE_BY_ZERO");He.set(33,"ENUM_RANGE_ERROR");He.set(34,"BAD_STORAGE_DATA");He.set(49,"STACK_UNDERFLOW");He.set(50,"ARRAY_RANGE_ERROR");He.set(65,"OUT_OF_MEMORY");He.set(81,"UNINITIALIZED_FUNCTION_CALL");const jd=new RegExp(/^bytes([0-9]*)$/),Gd=new RegExp(/^(u?int)([0-9]*)$/);let ps=null,ei=1024;function _d(n,e,t,r){let s="missing revert data",a=null;const i=null;let o=null;if(t){s="execution reverted";const d=X(t);if(t=V(t),d.length===0)s+=" (no data present; likely require(false) occurred",a="require(false)";else if(d.length%32!==4)s+=" (could not decode reason; invalid data length)";else if(V(d.slice(0,4))==="0x08c379a0")try{a=r.decode(["string"],d.slice(4))[0],o={signature:"Error(string)",name:"Error",args:[a]},s+=`: ${JSON.stringify(a)}`}catch{s+=" (could not decode reason; invalid string data)"}else if(V(d.slice(0,4))==="0x4e487b71")try{const u=Number(r.decode(["uint256"],d.slice(4))[0]);o={signature:"Panic(uint256)",name:"Panic",args:[u]},a=`Panic due to ${He.get(u)||"UNKNOWN"}(${u})`,s+=`: ${a}`}catch{s+=" (could not decode panic code)"}else s+=" (unknown custom error)"}const c={to:e.to?Ne(e.to):null,data:e.data||"0x"};return e.from&&(c.from=Ne(e.from)),Xt(s,"CALL_EXCEPTION",{action:n,data:t,reason:a,transaction:c,invocation:i,revert:o})}var vt,dr;const jn=class jn{constructor(){L(this,vt)}getDefaultValue(e){const t=e.map(s=>q(this,vt,dr).call(this,fe.from(s)));return new Nn(t,"_").defaultValue()}encode(e,t){yi(t.length,e.length,"types/values length mismatch");const r=e.map(i=>q(this,vt,dr).call(this,fe.from(i))),s=new Nn(r,"_"),a=new Es;return s.encode(a,t),a.data}decode(e,t,r){const s=e.map(i=>q(this,vt,dr).call(this,fe.from(i)));return new Nn(s,"_").decode(new Ns(t,r,ei))}static _setDefaultMaxInflation(e){v(typeof e=="number"&&Number.isInteger(e),"invalid defaultMaxInflation factor","value",e),ei=e}static defaultAbiCoder(){return ps==null&&(ps=new jn),ps}static getBuiltinCallException(e,t,r){return _d(e,t,r,jn.defaultAbiCoder())}};vt=new WeakSet,dr=function(e){if(e.isArray())return new ad(q(this,vt,dr).call(this,e.arrayChildren),e.arrayLength,e.name);if(e.isTuple())return new Nn(e.components.map(r=>q(this,vt,dr).call(this,r)),e.name);switch(e.baseType){case"address":return new nd(e.name);case"bool":return new id(e.name);case"string":return new pd(e.name);case"bytes":return new od(e.name);case"":return new dd(e.name)}let t=e.type.match(Gd);if(t){let r=parseInt(t[2]||"256");return v(r!==0&&r<=256&&r%8===0,"invalid "+t[1]+" bit length","param",e),new xd(r/8,t[1]==="int",e.name)}if(t=e.type.match(jd),t){let r=parseInt(t[1]);return v(r!==0&&r<=32,"invalid bytes length","param",e),new cd(r,e.name)}v(!1,"invalid type","type",e.type)};let Fn=jn;class Hd{constructor(e,t,r){w(this,"fragment");w(this,"name");w(this,"signature");w(this,"topic");w(this,"args");const s=e.name,a=e.format();K(this,{fragment:e,name:s,signature:a,topic:t,args:r})}}class Kd{constructor(e,t,r,s){w(this,"fragment");w(this,"name");w(this,"args");w(this,"signature");w(this,"selector");w(this,"value");const a=e.name,i=e.format();K(this,{fragment:e,name:a,args:r,signature:i,selector:t,value:s})}}class Vd{constructor(e,t,r){w(this,"fragment");w(this,"name");w(this,"args");w(this,"signature");w(this,"selector");const s=e.name,a=e.format();K(this,{fragment:e,name:s,args:r,signature:a,selector:t})}}class ti{constructor(e){w(this,"hash");w(this,"_isIndexed");K(this,{hash:e,_isIndexed:!0})}static isIndexed(e){return!!(e&&e._isIndexed)}}const ri={0:"generic panic",1:"assert(false)",17:"arithmetic overflow",18:"division or modulo by zero",33:"enum overflow",34:"invalid encoded storage byte array accessed",49:"out-of-bounds array access; popping on an empty array",50:"out-of-bounds access of an array or bytesN",65:"out of memory",81:"uninitialized function"},ni={"0x08c379a0":{signature:"Error(string)",name:"Error",inputs:["string"],reason:n=>`reverted with reason string ${JSON.stringify(n)}`},"0x4e487b71":{signature:"Panic(uint256)",name:"Panic",inputs:["uint256"],reason:n=>{let e="unknown panic code";return n>=0&&n<=255&&ri[n.toString()]&&(e=ri[n.toString()]),`reverted with panic code 0x${n.toString(16)} (${e})`}}};var Qe,$e,Je,xe,Xe,On,Bn;const Dt=class Dt{constructor(e){L(this,Xe);w(this,"fragments");w(this,"deploy");w(this,"fallback");w(this,"receive");L(this,Qe);L(this,$e);L(this,Je);L(this,xe);let t=[];typeof e=="string"?t=JSON.parse(e):t=e,k(this,Je,new Map),k(this,Qe,new Map),k(this,$e,new Map);const r=[];for(const i of t)try{r.push(tr.from(i))}catch(o){console.log(`[Warning] Invalid Fragment ${JSON.stringify(i)}:`,o.message)}K(this,{fragments:Object.freeze(r)});let s=null,a=!1;k(this,xe,this.getAbiCoder()),this.fragments.forEach((i,o)=>{let c;switch(i.type){case"constructor":if(this.deploy){console.log("duplicate definition - constructor");return}K(this,{deploy:i});return;case"fallback":i.inputs.length===0?a=!0:(v(!s||i.payable!==s.payable,"conflicting fallback fragments",`fragments[${o}]`,i),s=i,a=s.payable);return;case"function":c=g(this,Je);break;case"event":c=g(this,$e);break;case"error":c=g(this,Qe);break;default:return}const d=i.format();c.has(d)||c.set(d,i)}),this.deploy||K(this,{deploy:ot.from("constructor()")}),K(this,{fallback:s,receive:a})}format(e){const t=e?"minimal":"full";return this.fragments.map(s=>s.format(t))}formatJson(){const e=this.fragments.map(t=>t.format("json"));return JSON.stringify(e.map(t=>JSON.parse(t)))}getAbiCoder(){return Fn.defaultAbiCoder()}getFunctionName(e){const t=q(this,Xe,On).call(this,e,null,!1);return v(t,"no matching function","key",e),t.name}hasFunction(e){return!!q(this,Xe,On).call(this,e,null,!1)}getFunction(e,t){return q(this,Xe,On).call(this,e,t||null,!0)}forEachFunction(e){const t=Array.from(g(this,Je).keys());t.sort((r,s)=>r.localeCompare(s));for(let r=0;r<t.length;r++){const s=t[r];e(g(this,Je).get(s),r)}}getEventName(e){const t=q(this,Xe,Bn).call(this,e,null,!1);return v(t,"no matching event","key",e),t.name}hasEvent(e){return!!q(this,Xe,Bn).call(this,e,null,!1)}getEvent(e,t){return q(this,Xe,Bn).call(this,e,t||null,!0)}forEachEvent(e){const t=Array.from(g(this,$e).keys());t.sort((r,s)=>r.localeCompare(s));for(let r=0;r<t.length;r++){const s=t[r];e(g(this,$e).get(s),r)}}getError(e,t){if(Ee(e)){const s=e.toLowerCase();if(ni[s])return we.from(ni[s].signature);for(const a of g(this,Qe).values())if(s===a.selector)return a;return null}if(e.indexOf("(")===-1){const s=[];for(const[a,i]of g(this,Qe))a.split("(")[0]===e&&s.push(i);if(s.length===0)return e==="Error"?we.from("error Error(string)"):e==="Panic"?we.from("error Panic(uint256)"):null;if(s.length>1){const a=s.map(i=>JSON.stringify(i.format())).join(", ");v(!1,`ambiguous error description (i.e. ${a})`,"name",e)}return s[0]}if(e=we.from(e).format(),e==="Error(string)")return we.from("error Error(string)");if(e==="Panic(uint256)")return we.from("error Panic(uint256)");const r=g(this,Qe).get(e);return r||null}forEachError(e){const t=Array.from(g(this,Qe).keys());t.sort((r,s)=>r.localeCompare(s));for(let r=0;r<t.length;r++){const s=t[r];e(g(this,Qe).get(s),r)}}_decodeParams(e,t){return g(this,xe).decode(e,t)}_encodeParams(e,t){return g(this,xe).encode(e,t)}encodeDeploy(e){return this._encodeParams(this.deploy.inputs,e||[])}decodeErrorResult(e,t){if(typeof e=="string"){const r=this.getError(e);v(r,"unknown error","fragment",e),e=r}return v(cr(t,0,4)===e.selector,`data signature does not match error ${e.name}.`,"data",t),this._decodeParams(e.inputs,cr(t,4))}encodeErrorResult(e,t){if(typeof e=="string"){const r=this.getError(e);v(r,"unknown error","fragment",e),e=r}return Ct([e.selector,this._encodeParams(e.inputs,t||[])])}decodeFunctionData(e,t){if(typeof e=="string"){const r=this.getFunction(e);v(r,"unknown function","fragment",e),e=r}return v(cr(t,0,4)===e.selector,`data signature does not match function ${e.name}.`,"data",t),this._decodeParams(e.inputs,cr(t,4))}encodeFunctionData(e,t){if(typeof e=="string"){const r=this.getFunction(e);v(r,"unknown function","fragment",e),e=r}return Ct([e.selector,this._encodeParams(e.inputs,t||[])])}decodeFunctionResult(e,t){if(typeof e=="string"){const a=this.getFunction(e);v(a,"unknown function","fragment",e),e=a}let r="invalid length for result data";const s=qe(t);if(s.length%32===0)try{return g(this,xe).decode(e.outputs,s)}catch{r="could not decode result data"}U(!1,r,"BAD_DATA",{value:V(s),info:{method:e.name,signature:e.format()}})}makeError(e,t){const r=X(e,"data"),s=Fn.getBuiltinCallException("call",t,r);if(s.message.startsWith("execution reverted (unknown custom error)")){const o=V(r.slice(0,4)),c=this.getError(o);if(c)try{const d=g(this,xe).decode(c.inputs,r.slice(4));s.revert={name:c.name,signature:c.format(),args:d},s.reason=s.revert.signature,s.message=`execution reverted: ${s.reason}`}catch{s.message="execution reverted (coult not decode custom error)"}}const i=this.parseTransaction(t);return i&&(s.invocation={method:i.name,signature:i.signature,args:i.args}),s}encodeFunctionResult(e,t){if(typeof e=="string"){const r=this.getFunction(e);v(r,"unknown function","fragment",e),e=r}return V(g(this,xe).encode(e.outputs,t||[]))}encodeFilterTopics(e,t){if(typeof e=="string"){const a=this.getEvent(e);v(a,"unknown event","eventFragment",e),e=a}U(t.length<=e.inputs.length,`too many arguments for ${e.format()}`,"UNEXPECTED_ARGUMENT",{count:t.length,expectedCount:e.inputs.length});const r=[];e.anonymous||r.push(e.topicHash);const s=(a,i)=>a.type==="string"?tn(i):a.type==="bytes"?Tt(V(i)):(a.type==="bool"&&typeof i=="boolean"?i=i?"0x01":"0x00":a.type.match(/^u?int/)?i=Kn(i):a.type.match(/^bytes/)?i=Wc(i,32):a.type==="address"&&g(this,xe).encode(["address"],[i]),Ni(V(i),32));for(t.forEach((a,i)=>{const o=e.inputs[i];if(!o.indexed){v(a==null,"cannot filter non-indexed parameters; must be null","contract."+o.name,a);return}a==null?r.push(null):o.baseType==="array"||o.baseType==="tuple"?v(!1,"filtering with tuples or arrays not supported","contract."+o.name,a):Array.isArray(a)?r.push(a.map(c=>s(o,c))):r.push(s(o,a))});r.length&&r[r.length-1]===null;)r.pop();return r}encodeEventLog(e,t){if(typeof e=="string"){const i=this.getEvent(e);v(i,"unknown event","eventFragment",e),e=i}const r=[],s=[],a=[];return e.anonymous||r.push(e.topicHash),v(t.length===e.inputs.length,"event arguments/values mismatch","values",t),e.inputs.forEach((i,o)=>{const c=t[o];if(i.indexed)if(i.type==="string")r.push(tn(c));else if(i.type==="bytes")r.push(Tt(c));else{if(i.baseType==="tuple"||i.baseType==="array")throw new Error("not implemented");r.push(g(this,xe).encode([i.type],[c]))}else s.push(i),a.push(c)}),{data:g(this,xe).encode(s,a),topics:r}}decodeEventLog(e,t,r){if(typeof e=="string"){const b=this.getEvent(e);v(b,"unknown event","eventFragment",e),e=b}if(r!=null&&!e.anonymous){const b=e.topicHash;v(Ee(r[0],32)&&r[0].toLowerCase()===b,"fragment/topic mismatch","topics[0]",r[0]),r=r.slice(1)}const s=[],a=[],i=[];e.inputs.forEach((b,x)=>{b.indexed?b.type==="string"||b.type==="bytes"||b.baseType==="tuple"||b.baseType==="array"?(s.push(fe.from({type:"bytes32",name:b.name})),i.push(!0)):(s.push(b),i.push(!1)):(a.push(b),i.push(!1))});const o=r!=null?g(this,xe).decode(s,Ct(r)):null,c=g(this,xe).decode(a,t,!0),d=[],u=[];let f=0,h=0;return e.inputs.forEach((b,x)=>{let p=null;if(b.indexed)if(o==null)p=new ti(null);else if(i[x])p=new ti(o[h++]);else try{p=o[h++]}catch(m){p=m}else try{p=c[f++]}catch(m){p=m}d.push(p),u.push(b.name||null)}),Sr.fromItems(d,u)}parseTransaction(e){const t=X(e.data,"tx.data"),r=ee(e.value!=null?e.value:0,"tx.value"),s=this.getFunction(V(t.slice(0,4)));if(!s)return null;const a=g(this,xe).decode(s.inputs,t.slice(4));return new Kd(s,s.selector,a,r)}parseCallResult(e){throw new Error("@TODO")}parseLog(e){const t=this.getEvent(e.topics[0]);return!t||t.anonymous?null:new Hd(t,t.topicHash,this.decodeEventLog(t,e.data,e.topics))}parseError(e){const t=V(e),r=this.getError(cr(t,0,4));if(!r)return null;const s=g(this,xe).decode(r.inputs,cr(t,4));return new Vd(r,r.selector,s)}static from(e){return e instanceof Dt?e:typeof e=="string"?new Dt(JSON.parse(e)):typeof e.formatJson=="function"?new Dt(e.formatJson()):typeof e.format=="function"?new Dt(e.format("json")):new Dt(e)}};Qe=new WeakMap,$e=new WeakMap,Je=new WeakMap,xe=new WeakMap,Xe=new WeakSet,On=function(e,t,r){if(Ee(e)){const a=e.toLowerCase();for(const i of g(this,Je).values())if(a===i.selector)return i;return null}if(e.indexOf("(")===-1){const a=[];for(const[i,o]of g(this,Je))i.split("(")[0]===e&&a.push(o);if(t){const i=t.length>0?t[t.length-1]:null;let o=t.length,c=!0;pe.isTyped(i)&&i.type==="overrides"&&(c=!1,o--);for(let d=a.length-1;d>=0;d--){const u=a[d].inputs.length;u!==o&&(!c||u!==o-1)&&a.splice(d,1)}for(let d=a.length-1;d>=0;d--){const u=a[d].inputs;for(let f=0;f<t.length;f++)if(pe.isTyped(t[f])){if(f>=u.length){if(t[f].type==="overrides")continue;a.splice(d,1);break}if(t[f].type!==u[f].baseType){a.splice(d,1);break}}}}if(a.length===1&&t&&t.length!==a[0].inputs.length){const i=t[t.length-1];(i==null||Array.isArray(i)||typeof i!="object")&&a.splice(0,1)}if(a.length===0)return null;if(a.length>1&&r){const i=a.map(o=>JSON.stringify(o.format())).join(", ");v(!1,`ambiguous function description (i.e. matches ${i})`,"key",e)}return a[0]}const s=g(this,Je).get(Ye.from(e).format());return s||null},Bn=function(e,t,r){if(Ee(e)){const a=e.toLowerCase();for(const i of g(this,$e).values())if(a===i.topicHash)return i;return null}if(e.indexOf("(")===-1){const a=[];for(const[i,o]of g(this,$e))i.split("(")[0]===e&&a.push(o);if(t){for(let i=a.length-1;i>=0;i--)a[i].inputs.length<t.length&&a.splice(i,1);for(let i=a.length-1;i>=0;i--){const o=a[i].inputs;for(let c=0;c<t.length;c++)if(pe.isTyped(t[c])&&t[c].type!==o[c].baseType){a.splice(i,1);break}}}if(a.length===0)return null;if(a.length>1&&r){const i=a.map(o=>JSON.stringify(o.format())).join(", ");v(!1,`ambiguous event description (i.e. matches ${i})`,"key",e)}return a[0]}const s=g(this,$e).get(Ze.from(e).format());return s||null};let Os=Dt;const Vo=BigInt(0);function Re(n){return n==null?null:n.toString()}function zd(n){const e={};n.to&&(e.to=n.to),n.from&&(e.from=n.from),n.data&&(e.data=V(n.data));const t="chainId,gasLimit,gasPrice,maxFeePerBlobGas,maxFeePerGas,maxPriorityFeePerGas,value".split(/,/);for(const s of t)!(s in n)||n[s]==null||(e[s]=ee(n[s],`request.${s}`));const r="type,nonce".split(/,/);for(const s of r)!(s in n)||n[s]==null||(e[s]=te(n[s],`request.${s}`));return n.accessList&&(e.accessList=bd(n.accessList)),n.authorizationList&&(e.authorizationList=n.authorizationList.slice()),"blockTag"in n&&(e.blockTag=n.blockTag),"enableCcipRead"in n&&(e.enableCcipRead=!!n.enableCcipRead),"customData"in n&&(e.customData=n.customData),"blobVersionedHashes"in n&&n.blobVersionedHashes&&(e.blobVersionedHashes=n.blobVersionedHashes.slice()),"kzg"in n&&(e.kzg=n.kzg),"blobs"in n&&n.blobs&&(e.blobs=n.blobs.map(s=>Ai(s)?V(s):Object.assign({},s))),e}class rs{constructor(e,t){w(this,"provider");w(this,"transactionHash");w(this,"blockHash");w(this,"blockNumber");w(this,"removed");w(this,"address");w(this,"data");w(this,"topics");w(this,"index");w(this,"transactionIndex");this.provider=t;const r=Object.freeze(e.topics.slice());K(this,{transactionHash:e.transactionHash,blockHash:e.blockHash,blockNumber:e.blockNumber,removed:e.removed,address:e.address,data:e.data,topics:r,index:e.index,transactionIndex:e.transactionIndex})}toJSON(){const{address:e,blockHash:t,blockNumber:r,data:s,index:a,removed:i,topics:o,transactionHash:c,transactionIndex:d}=this;return{_type:"log",address:e,blockHash:t,blockNumber:r,data:s,index:a,removed:i,topics:o,transactionHash:c,transactionIndex:d}}async getBlock(){const e=await this.provider.getBlock(this.blockHash);return U(!!e,"failed to find transaction","UNKNOWN_ERROR",{}),e}async getTransaction(){const e=await this.provider.getTransaction(this.transactionHash);return U(!!e,"failed to find transaction","UNKNOWN_ERROR",{}),e}async getTransactionReceipt(){const e=await this.provider.getTransactionReceipt(this.transactionHash);return U(!!e,"failed to find transaction receipt","UNKNOWN_ERROR",{}),e}removedEvent(){return $d(this)}}var ln;class Qd{constructor(e,t){w(this,"provider");w(this,"to");w(this,"from");w(this,"contractAddress");w(this,"hash");w(this,"index");w(this,"blockHash");w(this,"blockNumber");w(this,"logsBloom");w(this,"gasUsed");w(this,"blobGasUsed");w(this,"cumulativeGasUsed");w(this,"gasPrice");w(this,"blobGasPrice");w(this,"type");w(this,"status");w(this,"root");L(this,ln);k(this,ln,Object.freeze(e.logs.map(s=>new rs(s,t))));let r=Vo;e.effectiveGasPrice!=null?r=e.effectiveGasPrice:e.gasPrice!=null&&(r=e.gasPrice),K(this,{provider:t,to:e.to,from:e.from,contractAddress:e.contractAddress,hash:e.hash,index:e.index,blockHash:e.blockHash,blockNumber:e.blockNumber,logsBloom:e.logsBloom,gasUsed:e.gasUsed,cumulativeGasUsed:e.cumulativeGasUsed,blobGasUsed:e.blobGasUsed,gasPrice:r,blobGasPrice:e.blobGasPrice,type:e.type,status:e.status,root:e.root})}get logs(){return g(this,ln)}toJSON(){const{to:e,from:t,contractAddress:r,hash:s,index:a,blockHash:i,blockNumber:o,logsBloom:c,logs:d,status:u,root:f}=this;return{_type:"TransactionReceipt",blockHash:i,blockNumber:o,contractAddress:r,cumulativeGasUsed:Re(this.cumulativeGasUsed),from:t,gasPrice:Re(this.gasPrice),blobGasUsed:Re(this.blobGasUsed),blobGasPrice:Re(this.blobGasPrice),gasUsed:Re(this.gasUsed),hash:s,index:a,logs:d,logsBloom:c,root:f,status:u,to:e}}get length(){return this.logs.length}[Symbol.iterator](){let e=0;return{next:()=>e<this.length?{value:this.logs[e++],done:!1}:{value:void 0,done:!0}}}get fee(){return this.gasUsed*this.gasPrice}async getBlock(){const e=await this.provider.getBlock(this.blockHash);if(e==null)throw new Error("TODO");return e}async getTransaction(){const e=await this.provider.getTransaction(this.hash);if(e==null)throw new Error("TODO");return e}async getResult(){return await this.provider.getTransactionResult(this.hash)}async confirmations(){return await this.provider.getBlockNumber()-this.blockNumber+1}removedEvent(){return Qo(this)}reorderedEvent(e){return U(!e||e.isMined(),"unmined 'other' transction cannot be orphaned","UNSUPPORTED_OPERATION",{operation:"reorderedEvent(other)"}),zo(this,e)}}ln=new WeakMap;var It;const ra=class ra{constructor(e,t){w(this,"provider");w(this,"blockNumber");w(this,"blockHash");w(this,"index");w(this,"hash");w(this,"type");w(this,"to");w(this,"from");w(this,"nonce");w(this,"gasLimit");w(this,"gasPrice");w(this,"maxPriorityFeePerGas");w(this,"maxFeePerGas");w(this,"maxFeePerBlobGas");w(this,"data");w(this,"value");w(this,"chainId");w(this,"signature");w(this,"accessList");w(this,"blobVersionedHashes");w(this,"authorizationList");L(this,It);this.provider=t,this.blockNumber=e.blockNumber!=null?e.blockNumber:null,this.blockHash=e.blockHash!=null?e.blockHash:null,this.hash=e.hash,this.index=e.index,this.type=e.type,this.from=e.from,this.to=e.to||null,this.gasLimit=e.gasLimit,this.nonce=e.nonce,this.data=e.data,this.value=e.value,this.gasPrice=e.gasPrice,this.maxPriorityFeePerGas=e.maxPriorityFeePerGas!=null?e.maxPriorityFeePerGas:null,this.maxFeePerGas=e.maxFeePerGas!=null?e.maxFeePerGas:null,this.maxFeePerBlobGas=e.maxFeePerBlobGas!=null?e.maxFeePerBlobGas:null,this.chainId=e.chainId,this.signature=e.signature,this.accessList=e.accessList!=null?e.accessList:null,this.blobVersionedHashes=e.blobVersionedHashes!=null?e.blobVersionedHashes:null,this.authorizationList=e.authorizationList!=null?e.authorizationList:null,k(this,It,-1)}toJSON(){const{blockNumber:e,blockHash:t,index:r,hash:s,type:a,to:i,from:o,nonce:c,data:d,signature:u,accessList:f,blobVersionedHashes:h}=this;return{_type:"TransactionResponse",accessList:f,blockNumber:e,blockHash:t,blobVersionedHashes:h,chainId:Re(this.chainId),data:d,from:o,gasLimit:Re(this.gasLimit),gasPrice:Re(this.gasPrice),hash:s,maxFeePerGas:Re(this.maxFeePerGas),maxPriorityFeePerGas:Re(this.maxPriorityFeePerGas),maxFeePerBlobGas:Re(this.maxFeePerBlobGas),nonce:c,signature:u,to:i,index:r,type:a,value:Re(this.value)}}async getBlock(){let e=this.blockNumber;if(e==null){const r=await this.getTransaction();r&&(e=r.blockNumber)}if(e==null)return null;const t=this.provider.getBlock(e);if(t==null)throw new Error("TODO");return t}async getTransaction(){return this.provider.getTransaction(this.hash)}async confirmations(){if(this.blockNumber==null){const{tx:t,blockNumber:r}=await ms({tx:this.getTransaction(),blockNumber:this.provider.getBlockNumber()});return t==null||t.blockNumber==null?0:r-t.blockNumber+1}return await this.provider.getBlockNumber()-this.blockNumber+1}async wait(e,t){const r=e??1,s=t??0;let a=g(this,It),i=-1,o=a===-1;const c=async()=>{if(o)return null;const{blockNumber:h,nonce:b}=await ms({blockNumber:this.provider.getBlockNumber(),nonce:this.provider.getTransactionCount(this.from)});if(b<this.nonce){a=h;return}if(o)return null;const x=await this.getTransaction();if(!(x&&x.blockNumber!=null))for(i===-1&&(i=a-3,i<g(this,It)&&(i=g(this,It)));i<=h;){if(o)return null;const p=await this.provider.getBlock(i,!0);if(p==null)return;for(const m of p)if(m===this.hash)return;for(let m=0;m<p.length;m++){const y=await p.getTransaction(m);if(y.from===this.from&&y.nonce===this.nonce){if(o)return null;const A=await this.provider.getTransactionReceipt(y.hash);if(A==null||h-A.blockNumber+1<r)return;let N="replaced";y.data===this.data&&y.to===this.to&&y.value===this.value?N="repriced":y.data==="0x"&&y.from===y.to&&y.value===Vo&&(N="cancelled"),U(!1,"transaction was replaced","TRANSACTION_REPLACED",{cancelled:N==="replaced"||N==="cancelled",reason:N,replacement:y.replaceableTransaction(a),hash:y.hash,receipt:A})}}i++}},d=h=>{if(h==null||h.status!==0)return h;U(!1,"transaction execution reverted","CALL_EXCEPTION",{action:"sendTransaction",data:null,reason:null,invocation:null,revert:null,transaction:{to:h.to,from:h.from,data:""},receipt:h})},u=await this.provider.getTransactionReceipt(this.hash);if(r===0)return d(u);if(u){if(r===1||await u.confirmations()>=r)return d(u)}else if(await c(),r===0)return null;return await new Promise((h,b)=>{const x=[],p=()=>{x.forEach(y=>y())};if(x.push(()=>{o=!0}),s>0){const y=setTimeout(()=>{p(),b(Xt("wait for transaction timeout","TIMEOUT"))},s);x.push(()=>{clearTimeout(y)})}const m=async y=>{if(await y.confirmations()>=r){p();try{h(d(y))}catch(A){b(A)}}};if(x.push(()=>{this.provider.off(this.hash,m)}),this.provider.on(this.hash,m),a>=0){const y=async()=>{try{await c()}catch(A){if(Tr(A,"TRANSACTION_REPLACED")){p(),b(A);return}}o||this.provider.once("block",y)};x.push(()=>{this.provider.off("block",y)}),this.provider.once("block",y)}})}isMined(){return this.blockHash!=null}isLegacy(){return this.type===0}isBerlin(){return this.type===1}isLondon(){return this.type===2}isCancun(){return this.type===3}removedEvent(){return U(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),Qo(this)}reorderedEvent(e){return U(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),U(!e||e.isMined(),"unmined 'other' transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),zo(this,e)}replaceableTransaction(e){v(Number.isInteger(e)&&e>=0,"invalid startBlock","startBlock",e);const t=new ra(this,this.provider);return k(t,It,e),t}};It=new WeakMap;let Bs=ra;function zo(n,e){return{orphan:"reorder-transaction",tx:n,other:e}}function Qo(n){return{orphan:"drop-transaction",tx:n}}function $d(n){return{orphan:"drop-log",log:{transactionHash:n.transactionHash,blockHash:n.blockHash,blockNumber:n.blockNumber,address:n.address,data:n.data,topics:Object.freeze(n.topics.slice()),index:n.index}}}class Zs extends rs{constructor(t,r,s){super(t,t.provider);w(this,"interface");w(this,"fragment");w(this,"args");const a=r.decodeEventLog(s,t.data,t.topics);K(this,{args:a,fragment:s,interface:r})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}class $o extends rs{constructor(t,r){super(t,t.provider);w(this,"error");K(this,{error:r})}}var kr;class Jd extends Qd{constructor(t,r,s){super(s,r);L(this,kr);k(this,kr,t)}get logs(){return super.logs.map(t=>{const r=t.topics.length?g(this,kr).getEvent(t.topics[0]):null;if(r)try{return new Zs(t,g(this,kr),r)}catch(s){return new $o(t,s)}return t})}}kr=new WeakMap;var dn;class Ys extends Bs{constructor(t,r,s){super(s,r);L(this,dn);k(this,dn,t)}async wait(t,r){const s=await super.wait(t,r);return s==null?null:new Jd(g(this,dn),this.provider,s)}}dn=new WeakMap;class Jo extends rl{constructor(t,r,s,a){super(t,r,s);w(this,"log");K(this,{log:a})}async getBlock(){return await this.log.getBlock()}async getTransaction(){return await this.log.getTransaction()}async getTransactionReceipt(){return await this.log.getTransactionReceipt()}}class Wd extends Jo{constructor(e,t,r,s,a){super(e,t,r,new Zs(a,e.interface,s));const i=e.interface.decodeEventLog(s,this.log.data,this.log.topics);K(this,{args:i,fragment:s})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}const si=BigInt(0);function Wo(n){return n&&typeof n.call=="function"}function Zo(n){return n&&typeof n.estimateGas=="function"}function ns(n){return n&&typeof n.resolveName=="function"}function Yo(n){return n&&typeof n.sendTransaction=="function"}function qo(n){if(n!=null){if(ns(n))return n;if(n.provider)return n.provider}}var un;class Zd{constructor(e,t,r){L(this,un);w(this,"fragment");if(K(this,{fragment:t}),t.inputs.length<r.length)throw new Error("too many arguments");const s=rr(e.runner,"resolveName"),a=ns(s)?s:null;k(this,un,async function(){const i=await Promise.all(t.inputs.map((o,c)=>r[c]==null?null:o.walkAsync(r[c],(u,f)=>u==="address"?Array.isArray(f)?Promise.all(f.map(h=>en(h,a))):en(f,a):f)));return e.interface.encodeFilterTopics(t,i)}())}getTopicFilter(){return g(this,un)}}un=new WeakMap;function rr(n,e){return n==null?null:typeof n[e]=="function"?n:n.provider&&typeof n.provider[e]=="function"?n.provider:null}function Mt(n){return n==null?null:n.provider||null}async function Xo(n,e){const t=pe.dereference(n,"overrides");v(typeof t=="object","invalid overrides parameter","overrides",n);const r=zd(t);return v(r.to==null||(e||[]).indexOf("to")>=0,"cannot override to","overrides.to",r.to),v(r.data==null||(e||[]).indexOf("data")>=0,"cannot override data","overrides.data",r.data),r.from&&(r.from=r.from),r}async function Yd(n,e,t){const r=rr(n,"resolveName"),s=ns(r)?r:null;return await Promise.all(e.map((a,i)=>a.walkAsync(t[i],(o,c)=>(c=pe.dereference(c,o),o==="address"?en(c,s):c))))}function qd(n){const e=async function(i){const o=await Xo(i,["data"]);o.to=await n.getAddress(),o.from&&(o.from=await en(o.from,qo(n.runner)));const c=n.interface,d=ee(o.value||si,"overrides.value")===si,u=(o.data||"0x")==="0x";c.fallback&&!c.fallback.payable&&c.receive&&!u&&!d&&v(!1,"cannot send data to receive or send value to non-payable fallback","overrides",i),v(c.fallback||u,"cannot send data to receive-only contract","overrides.data",o.data);const f=c.receive||c.fallback&&c.fallback.payable;return v(f||d,"cannot send value to non-payable fallback","overrides.value",o.value),v(c.fallback||u,"cannot send data to receive-only contract","overrides.data",o.data),o},t=async function(i){const o=rr(n.runner,"call");U(Wo(o),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const c=await e(i);try{return await o.call(c)}catch(d){throw mi(d)&&d.data?n.interface.makeError(d.data,c):d}},r=async function(i){const o=n.runner;U(Yo(o),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const c=await o.sendTransaction(await e(i)),d=Mt(n.runner);return new Ys(n.interface,d,c)},s=async function(i){const o=rr(n.runner,"estimateGas");return U(Zo(o),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await o.estimateGas(await e(i))},a=async i=>await r(i);return K(a,{_contract:n,estimateGas:s,populateTransaction:e,send:r,staticCall:t}),a}function Xd(n,e){const t=function(...d){const u=n.interface.getFunction(e,d);return U(u,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e,args:d}}),u},r=async function(...d){const u=t(...d);let f={};if(u.inputs.length+1===d.length&&(f=await Xo(d.pop()),f.from&&(f.from=await en(f.from,qo(n.runner)))),u.inputs.length!==d.length)throw new Error("internal error: fragment inputs doesn't match arguments; should not happen");const h=await Yd(n.runner,u.inputs,d);return Object.assign({},f,await ms({to:n.getAddress(),data:n.interface.encodeFunctionData(u,h)}))},s=async function(...d){const u=await o(...d);return u.length===1?u[0]:u},a=async function(...d){const u=n.runner;U(Yo(u),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const f=await u.sendTransaction(await r(...d)),h=Mt(n.runner);return new Ys(n.interface,h,f)},i=async function(...d){const u=rr(n.runner,"estimateGas");return U(Zo(u),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await u.estimateGas(await r(...d))},o=async function(...d){const u=rr(n.runner,"call");U(Wo(u),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const f=await r(...d);let h="0x";try{h=await u.call(f)}catch(x){throw mi(x)&&x.data?n.interface.makeError(x.data,f):x}const b=t(...d);return n.interface.decodeFunctionResult(b,h)},c=async(...d)=>t(...d).constant?await s(...d):await a(...d);return K(c,{name:n.interface.getFunctionName(e),_contract:n,_key:e,getFragment:t,estimateGas:i,populateTransaction:r,send:a,staticCall:s,staticCallResult:o}),Object.defineProperty(c,"fragment",{configurable:!1,enumerable:!0,get:()=>{const d=n.interface.getFunction(e);return U(d,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e}}),d}}),c}function eu(n,e){const t=function(...s){const a=n.interface.getEvent(e,s);return U(a,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e,args:s}}),a},r=function(...s){return new Zd(n,t(...s),s)};return K(r,{name:n.interface.getEventName(e),_contract:n,_key:e,getFragment:t}),Object.defineProperty(r,"fragment",{configurable:!1,enumerable:!0,get:()=>{const s=n.interface.getEvent(e);return U(s,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e}}),s}}),r}const Dn=Symbol.for("_ethersInternal_contract"),ec=new WeakMap;function tu(n,e){ec.set(n[Dn],e)}function Ie(n){return ec.get(n[Dn])}function ru(n){return n&&typeof n=="object"&&"getTopicFilter"in n&&typeof n.getTopicFilter=="function"&&n.fragment}async function qs(n,e){let t,r=null;if(Array.isArray(e)){const a=function(i){if(Ee(i,32))return i;const o=n.interface.getEvent(i);return v(o,"unknown fragment","name",i),o.topicHash};t=e.map(i=>i==null?null:Array.isArray(i)?i.map(a):a(i))}else e==="*"?t=[null]:typeof e=="string"?Ee(e,32)?t=[e]:(r=n.interface.getEvent(e),v(r,"unknown fragment","event",e),t=[r.topicHash]):ru(e)?t=await e.getTopicFilter():"fragment"in e?(r=e.fragment,t=[r.topicHash]):v(!1,"unknown event name","event",e);t=t.map(a=>{if(a==null)return null;if(Array.isArray(a)){const i=Array.from(new Set(a.map(o=>o.toLowerCase())).values());return i.length===1?i[0]:(i.sort(),i)}return a.toLowerCase()});const s=t.map(a=>a==null?"null":Array.isArray(a)?a.join("|"):a).join("&");return{fragment:r,tag:s,topics:t}}async function Vr(n,e){const{subs:t}=Ie(n);return t.get((await qs(n,e)).tag)||null}async function ai(n,e,t){const r=Mt(n.runner);U(r,"contract runner does not support subscribing","UNSUPPORTED_OPERATION",{operation:e});const{fragment:s,tag:a,topics:i}=await qs(n,t),{addr:o,subs:c}=Ie(n);let d=c.get(a);if(!d){const f={address:o||n,topics:i},h=m=>{let y=s;if(y==null)try{y=n.interface.getEvent(m.topics[0])}catch{}if(y){const A=y,N=s?n.interface.decodeEventLog(s,m.data,m.topics):[];Us(n,t,N,T=>new Wd(n,T,t,A,m))}else Us(n,t,[],A=>new Jo(n,A,t,m))};let b=[];d={tag:a,listeners:[],start:()=>{b.length||b.push(r.on(f,h))},stop:async()=>{if(b.length==0)return;let m=b;b=[],await Promise.all(m),r.off(f,h)}},c.set(a,d)}return d}let Rs=Promise.resolve();async function nu(n,e,t,r){await Rs;const s=await Vr(n,e);if(!s)return!1;const a=s.listeners.length;return s.listeners=s.listeners.filter(({listener:i,once:o})=>{const c=Array.from(t);r&&c.push(r(o?null:i));try{i.call(n,...c)}catch{}return!o}),s.listeners.length===0&&(s.stop(),Ie(n).subs.delete(s.tag)),a>0}async function Us(n,e,t,r){try{await Rs}catch{}const s=nu(n,e,t,r);return Rs=s,await s}const vn=["then"];var li;li=Dn;const Zr=class Zr{constructor(e,t,r,s){w(this,"target");w(this,"interface");w(this,"runner");w(this,"filters");w(this,li);w(this,"fallback");v(typeof e=="string"||To(e),"invalid value for Contract target","target",e),r==null&&(r=null);const a=Os.from(t);K(this,{target:e,runner:r,interface:a}),Object.defineProperty(this,Dn,{value:{}});let i,o=null,c=null;if(s){const f=Mt(r);c=new Ys(this.interface,f,s)}let d=new Map;if(typeof e=="string")if(Ee(e))o=e,i=Promise.resolve(e);else{const f=rr(r,"resolveName");if(!ns(f))throw Xt("contract runner does not support name resolution","UNSUPPORTED_OPERATION",{operation:"resolveName"});i=f.resolveName(e).then(h=>{if(h==null)throw Xt("an ENS name used for a contract target must be correctly configured","UNCONFIGURED_NAME",{value:e});return Ie(this).addr=h,h})}else i=e.getAddress().then(f=>{if(f==null)throw new Error("TODO");return Ie(this).addr=f,f});tu(this,{addrPromise:i,addr:o,deployTx:c,subs:d});const u=new Proxy({},{get:(f,h,b)=>{if(typeof h=="symbol"||vn.indexOf(h)>=0)return Reflect.get(f,h,b);try{return this.getEvent(h)}catch(x){if(!Tr(x,"INVALID_ARGUMENT")||x.argument!=="key")throw x}},has:(f,h)=>vn.indexOf(h)>=0?Reflect.has(f,h):Reflect.has(f,h)||this.interface.hasEvent(String(h))});return K(this,{filters:u}),K(this,{fallback:a.receive||a.fallback?qd(this):null}),new Proxy(this,{get:(f,h,b)=>{if(typeof h=="symbol"||h in f||vn.indexOf(h)>=0)return Reflect.get(f,h,b);try{return f.getFunction(h)}catch(x){if(!Tr(x,"INVALID_ARGUMENT")||x.argument!=="key")throw x}},has:(f,h)=>typeof h=="symbol"||h in f||vn.indexOf(h)>=0?Reflect.has(f,h):f.interface.hasFunction(h)})}connect(e){return new Zr(this.target,this.interface,e)}attach(e){return new Zr(e,this.interface,this.runner)}async getAddress(){return await Ie(this).addrPromise}async getDeployedCode(){const e=Mt(this.runner);U(e,"runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"getDeployedCode"});const t=await e.getCode(await this.getAddress());return t==="0x"?null:t}async waitForDeployment(){const e=this.deploymentTransaction();if(e)return await e.wait(),this;if(await this.getDeployedCode()!=null)return this;const r=Mt(this.runner);return U(r!=null,"contract runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"waitForDeployment"}),new Promise((s,a)=>{const i=async()=>{try{if(await this.getDeployedCode()!=null)return s(this);r.once("block",i)}catch(o){a(o)}};i()})}deploymentTransaction(){return Ie(this).deployTx}getFunction(e){return typeof e!="string"&&(e=e.format()),Xd(this,e)}getEvent(e){return typeof e!="string"&&(e=e.format()),eu(this,e)}async queryTransaction(e){throw new Error("@TODO")}async queryFilter(e,t,r){t==null&&(t=0),r==null&&(r="latest");const{addr:s,addrPromise:a}=Ie(this),i=s||await a,{fragment:o,topics:c}=await qs(this,e),d={address:i,topics:c,fromBlock:t,toBlock:r},u=Mt(this.runner);return U(u,"contract runner does not have a provider","UNSUPPORTED_OPERATION",{operation:"queryFilter"}),(await u.getLogs(d)).map(f=>{let h=o;if(h==null)try{h=this.interface.getEvent(f.topics[0])}catch{}if(h)try{return new Zs(f,this.interface,h)}catch(b){return new $o(f,b)}return new rs(f,u)})}async on(e,t){const r=await ai(this,"on",e);return r.listeners.push({listener:t,once:!1}),r.start(),this}async once(e,t){const r=await ai(this,"once",e);return r.listeners.push({listener:t,once:!0}),r.start(),this}async emit(e,...t){return await Us(this,e,t,null)}async listenerCount(e){if(e){const s=await Vr(this,e);return s?s.listeners.length:0}const{subs:t}=Ie(this);let r=0;for(const{listeners:s}of t.values())r+=s.length;return r}async listeners(e){if(e){const s=await Vr(this,e);return s?s.listeners.map(({listener:a})=>a):[]}const{subs:t}=Ie(this);let r=[];for(const{listeners:s}of t.values())r=r.concat(s.map(({listener:a})=>a));return r}async off(e,t){const r=await Vr(this,e);if(!r)return this;if(t){const s=r.listeners.map(({listener:a})=>a).indexOf(t);s>=0&&r.listeners.splice(s,1)}return(t==null||r.listeners.length===0)&&(r.stop(),Ie(this).subs.delete(r.tag)),this}async removeAllListeners(e){if(e){const t=await Vr(this,e);if(!t)return this;t.stop(),Ie(this).subs.delete(t.tag)}else{const{subs:t}=Ie(this);for(const{tag:r,stop:s}of t.values())s(),t.delete(r)}return this}async addListener(e,t){return await this.on(e,t)}async removeListener(e,t){return await this.off(e,t)}static buildClass(e){class t extends Zr{constructor(s,a=null){super(s,e,a)}}return t}static from(e,t,r){return r==null&&(r=null),new this(e,t,r)}};let Fs=Zr;function su(){return Fs}class kf extends su(){}const au=new RegExp("^(ipfs)://(.*)$","i"),Tf=[new RegExp("^(https)://(.*)$","i"),new RegExp("^(data):(.*)$","i"),au,new RegExp("^eip155:[0-9]+/(erc[0-9]+):(.*)$","i")];const Sf=BigInt(0);function ae(n,e){return function(t){return t==null?e:n(t)}}function Xs(n,e){return t=>{if(e&&t==null)return null;if(!Array.isArray(t))throw new Error("not an array");return t.map(r=>n(r))}}function ss(n,e){return t=>{const r={};for(const s in n){let a=s;if(e&&s in e&&!(a in t)){for(const i of e[s])if(i in t){a=i;break}}try{const i=n[s](t[a]);i!==void 0&&(r[s]=i)}catch(i){const o=i instanceof Error?i.message:"not-an-error";U(!1,`invalid value for value.${s} (${o})`,"BAD_DATA",{value:t})}}return r}}function iu(n){switch(n){case!0:case"true":return!0;case!1:case"false":return!1}v(!1,`invalid boolean; ${JSON.stringify(n)}`,"value",n)}function nn(n){return v(Ee(n,!0),"invalid data","value",n),n}function Ae(n){return v(Ee(n,32),"invalid hash","value",n),n}const Of=ss({address:Ne,blockHash:Ae,blockNumber:te,data:nn,index:te,removed:ae(iu,!1),topics:Xs(Ae),transactionHash:Ae,transactionIndex:te},{index:["logIndex"]});const Bf=ss({hash:ae(Ae),parentHash:Ae,parentBeaconBlockRoot:ae(Ae,null),number:te,timestamp:te,nonce:ae(nn),difficulty:ee,gasLimit:ee,gasUsed:ee,stateRoot:ae(Ae,null),receiptsRoot:ae(Ae,null),blobGasUsed:ae(ee,null),excessBlobGas:ae(ee,null),miner:ae(Ne),prevRandao:ae(Ae,null),extraData:nn,baseFeePerGas:ae(ee)},{prevRandao:["mixHash"]});const ou=ss({transactionIndex:te,blockNumber:te,transactionHash:Ae,address:Ne,topics:Xs(Ae),data:nn,index:te,blockHash:Ae},{index:["logIndex"]});function cu(n){return ou(n)}const Rf=ss({to:ae(Ne,null),from:ae(Ne,null),contractAddress:ae(Ne,null),index:te,root:ae(V),gasUsed:ee,blobGasUsed:ae(ee,null),logsBloom:ae(nn),blockHash:Ae,hash:Ae,logs:Xs(cu),blockNumber:te,cumulativeGasUsed:ee,effectiveGasPrice:ae(ee),blobGasPrice:ae(ee,null),status:ae(te),type:ae(te,0)},{effectiveGasPrice:["gasPrice"],hash:["transactionHash"],index:["transactionIndex"]});const Uf=BigInt(2);const Ff=new Uint8Array([]);const Df="bigint,boolean,function,number,string,symbol".split(/,/g);const Lf={polling:!1,staticNetwork:null,batchStallTime:10,batchMaxSize:1<<20,batchMaxCount:100,cacheTimeout:250,pollingInterval:4e3};/*! MIT License. Copyright 2015-2022 Richard Moore <me@ricmoo.com>. See LICENSE.txt. */var lu,du,uu;lu=new WeakMap,du=new WeakMap,uu=new WeakMap;var fu,hu;fu=new WeakMap,hu=new WeakMap;var xu,pu,bu;xu=new WeakMap,pu=new WeakMap,bu=new WeakMap;const Mf=new Uint8Array([66,105,116,99,111,105,110,32,115,101,101,100]);const jf=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141");class gu{constructor(){w(this,"userId",null);w(this,"coldWallets",new Map);this.getDefaultWallets().forEach(e=>{this.coldWallets.set(e.id,e)})}getDefaultWallets(){const e=[];return e.push({id:"cw_btc_1",address:oe.coldWallets.btc,chain:"bitcoin",currency:"BTC",minAmount:1e-5,enabled:!0,label:"Primary BTC Cold Wallet"}),e.push({id:"cw_eth_1",address:oe.coldWallets.eth,chain:"ethereum",currency:"ETH",minAmount:1e-4,enabled:!0,label:"Primary ETH Cold Wallet"}),e.push({id:"cw_bsc_1",address:oe.coldWallets.bsc,chain:"binance-smart-chain",currency:"BNB",minAmount:.001,enabled:!0,label:"Primary BSC Cold Wallet"}),e.push({id:"cw_polygon_1",address:oe.coldWallets.polygon,chain:"polygon",currency:"MATIC",minAmount:.01,enabled:!0,label:"Primary Polygon Cold Wallet"}),e.push({id:"cw_solana_1",address:oe.coldWallets.solana,chain:"solana",currency:"SOL",minAmount:.001,enabled:!0,label:"Primary Solana Cold Wallet"}),e.push({id:"cw_tron_1",address:oe.coldWallets.tron,chain:"tron",currency:"TRX",minAmount:1,enabled:!0,label:"Primary Tron Cold Wallet"}),e}async initialize(e){this.userId=e,await this.loadUserWallets()}async loadUserWallets(){if(this.userId)try{const{data:e,error:t}=await Z.from("cold_wallets").select("*").eq("user_id",this.userId).eq("enabled",!0);if(t)throw t;e&&e.length>0&&e.forEach(r=>{this.coldWallets.set(r.id,{id:r.id,address:r.address,chain:r.chain,currency:r.currency,minAmount:r.min_amount,enabled:r.enabled,label:r.label})})}catch(e){console.error("Failed to load user wallets:",e)}}getColdWallets(){return Array.from(this.coldWallets.values()).filter(e=>e.enabled)}getWalletByChain(e){return Array.from(this.coldWallets.values()).find(t=>t.chain===e&&t.enabled)}async addCustomWallet(e){if(!this.userId)throw new Error("User not initialized");const t=`cw_custom_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,{error:r}=await Z.from("cold_wallets").insert({id:t,user_id:this.userId,address:e.address,chain:e.chain,currency:e.currency,min_amount:e.minAmount,enabled:e.enabled,label:e.label,created_at:new Date().toISOString()});if(r)throw r;this.coldWallets.set(t,{id:t,...e})}async processMicroPayment(e,t,r,s){if(!this.userId)throw new Error("User not initialized");const a=this.getWalletByChain(s);if(!a)throw new Error(`No cold wallet configured for chain: ${s}`);if(t<a.minAmount)throw new Error(`Amount below minimum threshold: ${a.minAmount} ${r}`);const o=t*.001,d=t*5e-4,u={id:`mp_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,userId:this.userId,orderId:e,walletAddress:a.address,amount:t,currency:r,chain:s,status:"pending",timestamp:new Date,feeAmount:o,exchangeFee:d};try{const{error:f}=await Z.from("micro_payments").insert({id:u.id,user_id:u.userId,order_id:u.orderId,wallet_address:u.walletAddress,amount:u.amount,currency:u.currency,chain:u.chain,status:u.status,created_at:u.timestamp.toISOString(),fee_amount:u.feeAmount,exchange_fee:u.exchangeFee});if(f)throw f;return this.queuePaymentProcessing(u.id),u}catch(f){throw console.error("Failed to process micro payment:",f),f}}async queuePaymentProcessing(e){setTimeout(async()=>{try{await Z.from("micro_payments").update({status:"processing"}).eq("id",e),setTimeout(async()=>{const r="",s="";let a=null;a||(a=`0x${Math.random().toString(16).slice(2,66)}`),await Z.from("micro_payments").update({status:"completed",tx_hash:a,completed_at:new Date().toISOString()}).eq("id",e)},3e3)}catch(t){console.error("Payment processing failed:",t),await Z.from("micro_payments").update({status:"failed"}).eq("id",e)}},1e3)}async getPaymentHistory(e=50){if(!this.userId)throw new Error("User not initialized");const{data:t,error:r}=await Z.from("micro_payments").select("*").eq("user_id",this.userId).order("created_at",{ascending:!1}).limit(e);if(r)throw r;return(t||[]).map(s=>({id:s.id,userId:s.user_id,orderId:s.order_id,walletAddress:s.wallet_address,amount:s.amount,currency:s.currency,chain:s.chain,txHash:s.tx_hash,status:s.status,timestamp:new Date(s.created_at),feeAmount:s.fee_amount,exchangeFee:s.exchange_fee}))}async getTotalPayments(){if(!this.userId)throw new Error("User not initialized");const{data:e,error:t}=await Z.from("micro_payments").select("status, amount").eq("user_id",this.userId);if(t)throw t;return(e||[]).reduce((s,a)=>(s.total+=a.amount,a.status==="completed"&&(s.completed+=a.amount),(a.status==="pending"||a.status==="processing")&&(s.pending+=a.amount),s),{total:0,completed:0,pending:0})}async automatePaymentOnTrade(e,t,r,s){const i=t*2e-4;let o="ethereum";r.includes("BNB")?o="binance-smart-chain":r.includes("MATIC")?o="polygon":r.includes("BTC")&&(o="bitcoin");try{await this.processMicroPayment(e,i,r,o)}catch(c){console.error("Automated payment failed:",c)}}}new gu;class mu{constructor(){w(this,"baseUrl");w(this,"wsBaseUrl","wss://stream.binance.com:9443/ws");w(this,"apiKey");w(this,"secretKey");w(this,"rateLimits",{weight:1200,orders:10,rawRequests:6100});w(this,"defaultPairs",["BTCUSDT","ETHUSDT","BNBUSDT","SOLUSDT","ADAUSDT","XRPUSDT","DOGEUSDT","DOTUSDT","MATICUSDT","AVAXUSDT"]);this.apiKey=oe.binance.apiKey,this.secretKey=oe.binance.secretKey,this.baseUrl="https://api.binance.com/api/v3"}getKlinesUrl(e,t,r=500){return`${this.baseUrl}/klines?symbol=${e.toUpperCase()}&interval=${t}&limit=${r}`}getDepthUrl(e,t=100){return`${this.baseUrl}/depth?symbol=${e.toUpperCase()}&limit=${t}`}getTickerUrl(e){return`${this.baseUrl}/ticker/price?symbol=${e.toUpperCase()}`}get24hrTickerUrl(e){return`${this.baseUrl}/ticker/24hr?symbol=${e.toUpperCase()}`}getTradeWebSocketUrl(e){return`${this.wsBaseUrl}/${e.toLowerCase()}@trade`}getDepthWebSocketUrl(e){return`${this.wsBaseUrl}/${e.toLowerCase()}@depth`}getKlineWebSocketUrl(e,t){return`${this.wsBaseUrl}/${e.toLowerCase()}@kline_${t}`}formatKlinesToCandles(e){return e.map(t=>({x:t[0],y:[parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3]),parseFloat(t[4])]}))}formatDepthResponse(e){return{bids:e.bids.map(([t,r])=>({price:parseFloat(t),volume:parseFloat(r)})),asks:e.asks.map(([t,r])=>({price:parseFloat(t),volume:parseFloat(r)}))}}formatTradeMessage(e){return{price:parseFloat(e.p),volume:parseFloat(e.q),timestamp:e.T,side:e.m?"sell":"buy"}}convertTimeframe(e){return{"1m":"1m","5m":"5m","15m":"15m","1h":"1h","4h":"4h","1d":"1d","1w":"1w"}[e]||"1m"}formatSymbol(e,t){return`${e.toUpperCase()}${t.toUpperCase()}`}parseSymbol(e){const t=["USDT","USDC","BUSD","BTC","ETH","BNB"];for(const r of t)if(e.endsWith(r))return{base:e.slice(0,-r.length),quote:r};return{base:e.slice(0,-4),quote:e.slice(-4)}}validateSymbol(e){return/^[A-Z]{3,10}$/.test(e.toUpperCase())}createSignature(e){return Oc.HmacSHA256(e,this.secretKey).toString()}createAuthHeaders(){return{"X-MBX-APIKEY":this.apiKey,"Content-Type":"application/json"}}createSignedParams(e){const t=Date.now(),r=new URLSearchParams({...e,timestamp:t.toString()}).toString(),s=this.createSignature(r);return`${r}&signature=${s}`}async getAccountInfo(){if(!this.apiKey||!this.secretKey)throw new Error("Binance API credentials not configured");const e=this.createSignedParams({}),t=`${this.baseUrl}/account?${e}`,r=await fetch(t,{method:"GET",headers:this.createAuthHeaders()});if(!r.ok){const s=await r.json();throw new Error(`Binance API Error: ${s.msg||"Unknown error"}`)}return r.json()}async getBalance(e){const r=(await this.getAccountInfo()).balances.find(s=>s.asset===e.toUpperCase());return{free:parseFloat((r==null?void 0:r.free)||"0"),locked:parseFloat((r==null?void 0:r.locked)||"0")}}async placeBuyOrder(e,t,r,s="MARKET"){throw!this.apiKey||!this.secretKey?new Error("Binance API credentials not configured"):new Error("Real trading is disabled. Enable in configuration.")}async placeSellOrder(e,t,r,s="MARKET"){throw!this.apiKey||!this.secretKey?new Error("Binance API credentials not configured"):new Error("Real trading is disabled. Enable in configuration.")}async cancelOrder(e,t){if(!this.apiKey||!this.secretKey)throw new Error("Binance API credentials not configured");const r=this.createSignedParams({symbol:e.toUpperCase(),orderId:t.toString()}),s=`${this.baseUrl}/order`,a=await fetch(s,{method:"DELETE",headers:this.createAuthHeaders(),body:r});if(!a.ok){const i=await a.json();throw new Error(`Binance Cancel Error: ${i.msg||"Unknown error"}`)}return a.json()}async getOpenOrders(e){if(!this.apiKey||!this.secretKey)throw new Error("Binance API credentials not configured");const t={};e&&(t.symbol=e.toUpperCase());const r=this.createSignedParams(t),s=`${this.baseUrl}/openOrders?${r}`,a=await fetch(s,{method:"GET",headers:this.createAuthHeaders()});if(!a.ok){const i=await a.json();throw new Error(`Binance API Error: ${i.msg||"Unknown error"}`)}return a.json()}async fetchKlines(e,t,r=500){try{const s=this.getKlinesUrl(e,t,r),a=await fetch(s);if(!a.ok)throw new Error(`HTTP ${a.status}: ${a.statusText}`);const i=await a.json();return this.formatKlinesToCandles(i)}catch(s){throw console.error("Binance fetchKlines error:",s),s}}async fetchOrderBook(e,t=100){try{const r=this.getDepthUrl(e,t),s=await fetch(r);if(!s.ok)throw new Error(`HTTP ${s.status}: ${s.statusText}`);const a=await s.json();return this.formatDepthResponse(a)}catch(r){throw console.error("Binance fetchOrderBook error:",r),r}}async fetchTicker(e){try{const[t,r]=await Promise.all([fetch(this.getTickerUrl(e)),fetch(this.get24hrTickerUrl(e))]);if(!t.ok||!r.ok)throw new Error("Failed to fetch ticker data");const s=await t.json(),a=await r.json();return{price:parseFloat(s.price),change24h:parseFloat(a.priceChangePercent)}}catch(t){throw console.error("Binance fetchTicker error:",t),t}}createAuthenticatedWebSocket(){return!this.apiKey||!this.secretKey?(console.warn("Binance API credentials not configured for WebSocket"),null):new WebSocket(this.wsBaseUrl)}isConfigured(){return!!(this.apiKey&&this.secretKey)}getConfiguration(){return{hasCredentials:this.isConfigured(),testnet:!1,tradingEnabled:oe.trading.enableRealTrading}}handleError(e){var t,r;return(r=(t=e.response)==null?void 0:t.data)!=null&&r.msg?`Binance Error: ${e.response.data.msg}`:e.message?`Binance Error: ${e.message}`:"Binance: Unknown error occurred"}}const yt=new mu;class yu{constructor(){w(this,"baseUrl","https://www.alphavantage.co/query");w(this,"apiKey");this.apiKey=oe.alphaVantage.apiKey}async getQuote(e){if(!this.apiKey)throw new Error("Alpha Vantage API key not configured");const t=`${this.baseUrl}?function=GLOBAL_QUOTE&symbol=${e}&apikey=${this.apiKey}`,r=await fetch(t);if(!r.ok)throw new Error(`Alpha Vantage API error: ${r.statusText}`);const a=(await r.json())["Global Quote"];if(!a)throw new Error("Invalid symbol or API limit reached");return{symbol:a["01. symbol"],price:parseFloat(a["05. price"]),change:parseFloat(a["09. change"]),changePercent:parseFloat(a["10. change percent"].replace("%","")),volume:parseInt(a["06. volume"])}}async getIntradayData(e,t="5min"){if(!this.apiKey)throw new Error("Alpha Vantage API key not configured");const r=`${this.baseUrl}?function=TIME_SERIES_INTRADAY&symbol=${e}&interval=${t}&apikey=${this.apiKey}`,s=await fetch(r);if(!s.ok)throw new Error(`Alpha Vantage API error: ${s.statusText}`);const i=(await s.json())[`Time Series (${t})`];if(!i)throw new Error("No data available or API limit reached");return Object.entries(i).map(([o,c])=>({x:new Date(o).getTime(),y:[parseFloat(c["1. open"]),parseFloat(c["2. high"]),parseFloat(c["3. low"]),parseFloat(c["4. close"])]})).reverse()}async getDailyData(e){if(!this.apiKey)throw new Error("Alpha Vantage API key not configured");const t=`${this.baseUrl}?function=TIME_SERIES_DAILY&symbol=${e}&apikey=${this.apiKey}`,r=await fetch(t);if(!r.ok)throw new Error(`Alpha Vantage API error: ${r.statusText}`);const a=(await r.json())["Time Series (Daily)"];if(!a)throw new Error("No data available or API limit reached");return Object.entries(a).slice(0,100).map(([i,o])=>({x:new Date(i).getTime(),y:[parseFloat(o["1. open"]),parseFloat(o["2. high"]),parseFloat(o["3. low"]),parseFloat(o["4. close"])]})).reverse()}}class wu{constructor(){w(this,"baseUrl","https://api.polygon.io");w(this,"apiKey");this.apiKey=oe.polygon.apiKey}async getQuote(e){var i,o,c;if(!this.apiKey)throw new Error("Polygon API key not configured");const t=`${this.baseUrl}/v2/snapshot/locale/us/markets/stocks/tickers/${e}?apikey=${this.apiKey}`,r=await fetch(t);if(!r.ok)throw new Error(`Polygon API error: ${r.statusText}`);const a=(await r.json()).results;if(!a)throw new Error("Invalid symbol or no data available");return{symbol:a.ticker,price:((i=a.lastQuote)==null?void 0:i.price)||((o=a.prevDay)==null?void 0:o.c)||0,change:a.todaysChange||0,changePercent:a.todaysChangePerc||0,volume:((c=a.day)==null?void 0:c.v)||0}}async getAggregates(e,t=1,r="minute",s,a){if(!this.apiKey)throw new Error("Polygon API key not configured");const i=`${this.baseUrl}/v2/aggs/ticker/${e}/range/${t}/${r}/${s}/${a}?adjusted=true&sort=asc&limit=5000&apikey=${this.apiKey}`,o=await fetch(i);if(!o.ok)throw new Error(`Polygon API error: ${o.statusText}`);const c=await o.json();if(!c.results)throw new Error("No data available");return c.results.map(d=>({x:d.t,y:[d.o,d.h,d.l,d.c]}))}}class Au{constructor(){w(this,"baseUrl","https://finnhub.io/api/v1");w(this,"apiKey");this.apiKey=oe.finnhub.apiKey}async getQuote(e){if(!this.apiKey)throw new Error("Finnhub API key not configured");const t=`${this.baseUrl}/quote?symbol=${e}&token=${this.apiKey}`,r=await fetch(t);if(!r.ok)throw new Error(`Finnhub API error: ${r.statusText}`);const s=await r.json();if(s.error)throw new Error(`Finnhub error: ${s.error}`);return{symbol:e,price:s.c||0,change:s.d||0,changePercent:s.dp||0,volume:0}}async getCandles(e,t="5",r,s){if(!this.apiKey)throw new Error("Finnhub API key not configured");const a=`${this.baseUrl}/stock/candle?symbol=${e}&resolution=${t}&from=${r}&to=${s}&token=${this.apiKey}`,i=await fetch(a);if(!i.ok)throw new Error(`Finnhub API error: ${i.statusText}`);const o=await i.json();if(o.s!=="ok")throw new Error("No data available");return o.t.map((c,d)=>({x:c*1e3,y:[o.o[d],o.h[d],o.l[d],o.c[d]]}))}async getCompanyProfile(e){if(!this.apiKey)throw new Error("Finnhub API key not configured");const t=`${this.baseUrl}/stock/profile2?symbol=${e}&token=${this.apiKey}`,r=await fetch(t);if(!r.ok)throw new Error(`Finnhub API error: ${r.statusText}`);return r.json()}}class Eu{constructor(){w(this,"alphaVantage");w(this,"polygon");w(this,"finnhub");this.alphaVantage=new yu,this.polygon=new wu,this.finnhub=new Au}async getQuote(e,t="finnhub"){switch(t){case"alphavantage":return this.alphaVantage.getQuote(e);case"polygon":return this.polygon.getQuote(e);case"finnhub":return this.finnhub.getQuote(e);default:throw new Error("Invalid provider")}}async getCandles(e,t="5m",r="finnhub"){const s=Date.now(),a=s-24*60*60*1e3;switch(r){case"alphavantage":if(t.includes("m")){const f=t.replace("m","min");return this.alphaVantage.getIntradayData(e,f)}else return this.alphaVantage.getDailyData(e);case"polygon":const i=parseInt(t.replace(/[a-zA-Z]/g,"")),o=t.includes("m")?"minute":t.includes("h")?"hour":"day",c=new Date(a).toISOString().split("T")[0],d=new Date(s).toISOString().split("T")[0];return this.polygon.getAggregates(e,i,o,c,d);case"finnhub":let u="5";return t==="1m"?u="1":t==="5m"?u="5":t==="15m"?u="15":t==="30m"?u="30":t==="1h"?u="60":t==="1d"&&(u="D"),this.finnhub.getCandles(e,u,Math.floor(a/1e3),Math.floor(s/1e3));default:throw new Error("Invalid provider")}}getAvailableProviders(){const e=[];return e.push("alphavantage"),e.push("polygon"),e.push("finnhub"),e}isConfigured(){return this.getAvailableProviders().length>0}}const br=new Eu;class Nu{constructor(){w(this,"baseUrl");w(this,"apiKey");w(this,"accountId");this.apiKey=oe.oanda.apiKey,this.accountId=oe.oanda.accountId,this.baseUrl="https://api-fxpractice.oanda.com"}getHeaders(){return{Authorization:`Bearer ${this.apiKey}`,"Content-Type":"application/json"}}async getQuote(e){if(!this.apiKey)throw new Error("OANDA API key not configured");const t=`${this.baseUrl}/v3/accounts/${this.accountId}/pricing?instruments=${e}`,r=await fetch(t,{headers:this.getHeaders()});if(!r.ok)throw new Error(`OANDA API error: ${r.statusText}`);const a=(await r.json()).prices[0];if(!a)throw new Error("No pricing data available");return{instrument:a.instrument,bid:parseFloat(a.bids[0].price),ask:parseFloat(a.asks[0].price),spread:parseFloat(a.asks[0].price)-parseFloat(a.bids[0].price),timestamp:new Date(a.time).getTime()}}async getCandles(e,t="M5",r=500){if(!this.apiKey)throw new Error("OANDA API key not configured");const s=`${this.baseUrl}/v3/instruments/${e}/candles?granularity=${t}&count=${r}`,a=await fetch(s,{headers:this.getHeaders()});if(!a.ok)throw new Error(`OANDA API error: ${a.statusText}`);return(await a.json()).candles.map(o=>({x:new Date(o.time).getTime(),y:[parseFloat(o.mid.o),parseFloat(o.mid.h),parseFloat(o.mid.l),parseFloat(o.mid.c)]}))}async getAccountInfo(){if(!this.apiKey||!this.accountId)throw new Error("OANDA credentials not configured");const e=`${this.baseUrl}/v3/accounts/${this.accountId}`,t=await fetch(e,{headers:this.getHeaders()});if(!t.ok)throw new Error(`OANDA API error: ${t.statusText}`);return t.json()}async placeOrder(e,t,r="MARKET",s){throw!this.apiKey||!this.accountId?new Error("OANDA credentials not configured"):new Error("Real trading is disabled. Enable in configuration.")}async getPositions(){if(!this.apiKey||!this.accountId)throw new Error("OANDA credentials not configured");const e=`${this.baseUrl}/v3/accounts/${this.accountId}/positions`,t=await fetch(e,{headers:this.getHeaders()});if(!t.ok)throw new Error(`OANDA API error: ${t.statusText}`);return t.json()}}class vu{constructor(){w(this,"oanda");this.oanda=new Nu}async getQuote(e){return this.oanda.getQuote(e)}async getCandles(e,t="5m"){let r="M5";switch(t){case"1m":r="M1";break;case"5m":r="M5";break;case"15m":r="M15";break;case"30m":r="M30";break;case"1h":r="H1";break;case"4h":r="H4";break;case"1d":r="D";break}return this.oanda.getCandles(e,r)}async getAccountInfo(){return this.oanda.getAccountInfo()}async placeBuyOrder(e,t,r){return this.oanda.placeOrder(e,Math.abs(t),r?"LIMIT":"MARKET",r)}async placeSellOrder(e,t,r){return this.oanda.placeOrder(e,-Math.abs(t),r?"LIMIT":"MARKET",r)}async getPositions(){return this.oanda.getPositions()}isConfigured(){return!!oe.oanda.accountId}getConfiguration(){return{hasCredentials:this.isConfigured(),environment:oe.oanda.environment,tradingEnabled:oe.trading.enableRealTrading}}}const wt=new vu;class Iu{constructor(){w(this,"userId",null);w(this,"tradingEnabled",!0)}async initialize(e){this.userId=e,this.tradingEnabled=!0}async saveCredentials(e,t,r,s=!1){if(!this.userId)throw new Error("User not initialized");const{error:a}=await Z.from("exchange_credentials").upsert({user_id:this.userId,exchange:e,api_key:t,api_secret:r,testnet,updated_at:new Date().toISOString()},{onConflict:"user_id,exchange"});if(a)throw a}async getCredentials(e){if(!this.userId)throw new Error("User not initialized");const{data:t,error:r}=await Z.from("exchange_credentials").select("*").eq("user_id",this.userId).eq("exchange",e).maybeSingle();if(r)throw r;return t}async executeCryptoOrder(e,t,r,s,a,i){throw this.userId?new Error("Real trading is disabled. Enable in configuration."):new Error("User not initialized")}async executeForexOrder(e,t,r,s){throw this.userId?new Error("Real trading is disabled. Enable in configuration."):new Error("User not initialized")}async executeOrder(e,t,r,s,a,i){return e.toLowerCase()==="oanda"||t.includes("_")?this.executeForexOrder(t,r,a,i):this.executeCryptoOrder(e,t,r,s,a,i)}async getOrders(e){if(!this.userId)throw new Error("User not initialized");let t=Z.from("orders").select("*").eq("user_id",this.userId);e!=null&&e.exchange&&(t=t.eq("exchange",e.exchange)),e!=null&&e.symbol&&(t=t.eq("symbol",e.symbol)),e!=null&&e.status&&(t=t.eq("status",e.status));const{data:r,error:s}=await t.order("created_at",{ascending:!1});if(s)throw s;return(r||[]).map(a=>({id:a.id,userId:a.user_id,exchange:a.exchange,symbol:a.symbol,side:a.side,type:a.type,price:a.price,amount:a.amount,filled:a.filled,status:a.status,timestamp:new Date(a.created_at),externalOrderId:a.external_order_id}))}async cancelOrder(e){if(!this.userId)throw new Error("User not initialized");const{error:t}=await Z.from("orders").update({status:"cancelled"}).eq("id",e).eq("user_id",this.userId);return!t}async getRealBalance(e){if(!this.userId)throw new Error("User not initialized");try{switch(e.toLowerCase()){case"binance":if(!yt.isConfigured())throw new Error("Binance API credentials not configured");const t=await yt.getAccountInfo(),r={};return t.balances.forEach(a=>{const i=parseFloat(a.free),o=parseFloat(a.locked);(i>0||o>0)&&(r[a.asset]={free:i,locked:o})}),r;case"oanda":if(!wt.isConfigured())throw new Error("OANDA credentials not configured");const s=await wt.getAccountInfo();return{USD:{free:parseFloat(s.account.balance),locked:parseFloat(s.account.marginUsed||"0")}};default:throw new Error(`Exchange ${e} not supported for real balance fetching`)}}catch(t){throw console.error(`Failed to fetch real balance from ${e}:`,t),t}}async getBalance(e){if(!this.userId)throw new Error("User not initialized");try{const t=await this.getRealBalance(e),r={};return Object.entries(t).forEach(([s,a])=>{r[s]=a.free+a.locked}),r}catch{const{data:r,error:s}=await Z.from("balances").select("*").eq("user_id",this.userId).eq("exchange",e);if(s)throw s;const a={};return(r||[]).forEach(i=>{a[i.asset]=i.amount}),a}}async syncBalances(e){if(!this.userId)throw new Error("User not initialized");try{const t=await this.getRealBalance(e);for(const[r,s]of Object.entries(t)){const a=s.free+s.locked;await Z.from("balances").upsert({user_id:this.userId,exchange:e,asset:r,amount:a,free:s.free,locked:s.locked,updated_at:new Date().toISOString()},{onConflict:"user_id,exchange,asset"})}}catch(t){throw console.error(`Failed to sync balances for ${e}:`,t),t}}async getAccountSummary(){if(!this.userId)throw new Error("User not initialized");const e=[];let t=0;yt.isConfigured()&&e.push("Binance"),wt.isConfigured()&&e.push("OANDA"),br.isConfigured()&&e.push("Stocks");const{data:r}=await Z.from("orders").select("id").eq("user_id",this.userId).in("status",["pending","partial"]),s=(r==null?void 0:r.length)||0;return{exchanges:e,totalValue:t,activeOrders:s,tradingEnabled:oe.trading.enableRealTrading}}async getAvailableAssets(e){switch(e){case"crypto":return yt.defaultPairs;case"forex":return[...wt.constructor.prototype.MAJOR_FOREX_PAIRS||[]];case"stocks":return br.constructor.prototype.POPULAR_STOCKS||[];default:return[]}}isRealTradingEnabled(){return oe.trading.enableRealTrading}getConfiguredExchanges(){return[{exchange:"Binance",assetType:"crypto",configured:yt.isConfigured()},{exchange:"OANDA",assetType:"forex",configured:wt.isConfigured()},{exchange:"Stocks",assetType:"stocks",configured:br.isConfigured()}]}}const _r=new Iu;class Rt{constructor(e){w(this,"config");w(this,"sandboxMode",!1);this.config=e,console.warn("CCXT cannot run in browser environment. Please implement a backend service to proxy exchange API calls. See documentation: https://docs.ccxt.com/en/latest/manual.html#proxy")}setSandboxMode(e){this.sandboxMode=e}throwNotImplemented(e){throw new Error(`${e} is not available in browser mode. Implement a backend service to handle exchange operations.`)}async fetchBalance(){this.throwNotImplemented("fetchBalance")}async createOrder(e,t,r,s,a){this.throwNotImplemented("createOrder")}async cancelOrder(e,t){this.throwNotImplemented("cancelOrder")}async fetchOrders(e){this.throwNotImplemented("fetchOrders")}async fetchOpenOrders(e){this.throwNotImplemented("fetchOpenOrders")}async fetchTicker(e){this.throwNotImplemented("fetchTicker")}async fetchOHLCV(e,t,r,s){this.throwNotImplemented("fetchOHLCV")}async withdraw(e,t,r,s){this.throwNotImplemented("withdraw")}async fetchDeposits(e){this.throwNotImplemented("fetchDeposits")}async fetchWithdrawals(e){this.throwNotImplemented("fetchWithdrawals")}async fetchDepositAddress(e){this.throwNotImplemented("fetchDepositAddress")}}const Cu={binance:Rt,coinbasepro:Rt,okx:Rt,kucoin:Rt,kraken:Rt,bybit:Rt,bitfinex:Rt},Pu={BINANCE:{id:"BINANCE",name:"Binance",type:"crypto",ccxtId:"binance",requiresCredentials:!0,isActive:!0,supportedFeatures:{spot:!0,margin:!0,futures:!0,options:!0,swap:!0}},COINBASE:{id:"COINBASE",name:"Coinbase Pro",type:"crypto",ccxtId:"coinbasepro",requiresCredentials:!0,supportedFeatures:{spot:!0,margin:!1,futures:!1,options:!1,swap:!1}},OKX:{id:"OKX",name:"OKX",type:"crypto",ccxtId:"okx",requiresCredentials:!0,supportedFeatures:{spot:!0,margin:!0,futures:!0,options:!0,swap:!0}},KUCOIN:{id:"KUCOIN",name:"KuCoin",type:"crypto",ccxtId:"kucoin",requiresCredentials:!0,supportedFeatures:{spot:!0,margin:!0,futures:!0,options:!1,swap:!1}},KRAKEN:{id:"KRAKEN",name:"Kraken",type:"crypto",ccxtId:"kraken",requiresCredentials:!0,supportedFeatures:{spot:!0,margin:!0,futures:!0,options:!1,swap:!1}},BYBIT:{id:"BYBIT",name:"Bybit",type:"crypto",ccxtId:"bybit",requiresCredentials:!0,supportedFeatures:{spot:!0,margin:!1,futures:!0,options:!0,swap:!0}},BITFINEX:{id:"BITFINEX",name:"Bitfinex",type:"crypto",ccxtId:"bitfinex",requiresCredentials:!0,supportedFeatures:{spot:!0,margin:!0,futures:!1,options:!1,swap:!1}},NASDAQ:{id:"NASDAQ",name:"NASDAQ",type:"stock",requiresCredentials:!0,supportedFeatures:{spot:!0,margin:!0,futures:!1,options:!0,swap:!1}},NYSE:{id:"NYSE",name:"New York Stock Exchange",type:"stock",requiresCredentials:!0,supportedFeatures:{spot:!0,margin:!0,futures:!1,options:!0,swap:!1}},FOREX:{id:"FOREX",name:"Forex Market",type:"forex",requiresCredentials:!0,supportedFeatures:{spot:!0,margin:!0,futures:!1,options:!1,swap:!0}},CME:{id:"CME",name:"Chicago Mercantile Exchange",type:"commodity",requiresCredentials:!0,supportedFeatures:{spot:!1,margin:!1,futures:!0,options:!0,swap:!1}}};class ku{constructor(){w(this,"exchanges",new Map)}createExchange(e,t,r,s=!0){const a=Pu[e];if(!a||!a.ccxtId)throw new Error(`Exchange ${e} not supported for real trading`);const i=Cu[a.ccxtId];if(!i)throw new Error(`CCXT exchange ${a.ccxtId} not found`);const o=new i({apiKey:t,secret:r,enableRateLimit:!0,options:{defaultType:"spot",adjustForTimeDifference:!0}});return s&&o.setSandboxMode(!0),this.exchanges.set(e,o),o}getExchange(e){return this.exchanges.get(e)}async fetchBalance(e){const t=this.getExchange(e);if(!t)throw new Error(`Exchange ${e} not connected`);return await t.fetchBalance()}async createOrder(e,t,r,s,a,i){const o=this.getExchange(e);if(!o)throw new Error(`Exchange ${e} not connected`);return await o.createOrder(t,r,s,a,i)}async cancelOrder(e,t,r){const s=this.getExchange(e);if(!s)throw new Error(`Exchange ${e} not connected`);return await s.cancelOrder(t,r)}async fetchOrders(e,t){const r=this.getExchange(e);if(!r)throw new Error(`Exchange ${e} not connected`);return await r.fetchOrders(t)}async fetchOpenOrders(e,t){const r=this.getExchange(e);if(!r)throw new Error(`Exchange ${e} not connected`);return await r.fetchOpenOrders(t)}async fetchTicker(e,t){const r=this.getExchange(e);if(!r)throw new Error(`Exchange ${e} not connected`);return await r.fetchTicker(t)}async fetchOHLCV(e,t,r,s=100){const a=this.getExchange(e);if(!a)throw new Error(`Exchange ${e} not connected`);return await a.fetchOHLCV(t,r,void 0,s)}async withdraw(e,t,r,s,a){const i=this.getExchange(e);if(!i)throw new Error(`Exchange ${e} not connected`);return await i.withdraw(t,r,s,a)}async fetchDeposits(e,t){const r=this.getExchange(e);if(!r)throw new Error(`Exchange ${e} not connected`);return await r.fetchDeposits(t)}async fetchWithdrawals(e,t){const r=this.getExchange(e);if(!r)throw new Error(`Exchange ${e} not connected`);return await r.fetchWithdrawals(t)}async fetchDepositAddress(e,t){const r=this.getExchange(e);if(!r)throw new Error(`Exchange ${e} not connected`);return await r.fetchDepositAddress(t)}disconnectExchange(e){this.exchanges.delete(e)}disconnectAll(){this.exchanges.clear()}}const Hr=new ku,Tu=()=>{const[n,e]=C.useState([]),[t,r]=C.useState([]),[s,a]=C.useState([]),[i,o]=C.useState({}),[c,d]=C.useState(!1),[u,f]=C.useState(!1);C.useEffect(()=>{(async()=>{const{data:{session:E}}=await Z.auth.getSession();E!=null&&E.user&&(await _r.initialize(E.user.id),f(!0),await y(),await x())})()},[]);const h=C.useCallback(async(T,E,P,S=!0)=>{try{await _r.saveCredentials(T,E,P,S),Hr.createExchange(T,E,P,S),$.success(`Connected to ${T}`),await x()}catch(I){console.error("Failed to connect exchange:",I),$.error(`Failed to connect to ${T}: ${I.message}`)}},[]),b=C.useCallback(T=>{Hr.disconnectExchange(T),$.success(`Disconnected from ${T}`)},[]),x=C.useCallback(async()=>{if(u)try{const{data:T}=await Z.from("exchange_credentials").select("exchange");if(!T)return;const E={};for(const P of T)try{const S=await Hr.fetchBalance(P.exchange);E[P.exchange]=S.free||{}}catch(S){console.error(`Failed to fetch balance for ${P.exchange}:`,S)}o(E)}catch(T){console.error("Failed to refresh balances:",T)}},[u]),p=C.useCallback(async(T,E,P,S,I,D)=>{if(!u)return $.error("Trading engine not initialized"),null;d(!0);try{const _=await Hr.createOrder(T,E,S,P,I,D),G=await _r.executeOrder(T,E,P,S,I,D||_.price);return e(W=>[G,...W]),$.success(`Order executed: ${P.toUpperCase()} ${I} ${E} @ $${(D||_.price).toFixed(2)}`),await x(),await y(),G}catch(_){return console.error("Order execution error:",_),$.error(`Failed to execute order: ${_.message}`),null}finally{d(!1)}},[u]),m=C.useCallback(async(T,E,P)=>{try{await Hr.cancelOrder(T,E,P),await _r.cancelOrder(E),e(S=>S.map(I=>I.id===E?{...I,status:"cancelled"}:I)),$.success("Order cancelled"),await y()}catch(S){console.error("Failed to cancel order:",S),$.error(`Failed to cancel order: ${S.message}`)}},[]),y=C.useCallback(async()=>{if(u)try{const T=await _r.getOrders();e(T)}catch(T){console.error("Failed to refresh orders:",T)}},[u]),A=C.useCallback((T,E="USDT")=>{var P;return((P=i[T])==null?void 0:P[E])||0},[i]),N=C.useCallback((T="USDT")=>{let E=0;return Object.values(i).forEach(P=>{E+=P[T]||0}),E},[i]);return{orders:n,positions:t,trades:s,balances:i,isExecuting:c,isInitialized:u,connectExchange:h,disconnectExchange:b,executeOrder:p,cancelOrder:m,refreshOrders:y,refreshBalances:x,getBalance:A,getTotalBalance:N}},Su=({exchange:n,symbol:e,currentPrice:t})=>{const{executeOrder:r,isExecuting:s,getBalance:a}=Tu(),[i,o]=C.useState("market"),[c,d]=C.useState("buy"),[u,f]=C.useState(""),[h,b]=C.useState(t.toString()),[x,p]=C.useState(!1),[m,y]=C.useState("25"),A=a(n,"USDT"),N=()=>{if(x){const E=parseFloat(m)/100;return A*E/(i==="market"?t:parseFloat(h))}return parseFloat(u)},T=async()=>{const E=N();if(isNaN(E)||E<=0){$.error("Invalid amount");return}const P=i==="market"?void 0:parseFloat(h);if(i!=="market"&&(!P||isNaN(P))){$.error("Invalid price");return}const S=E*(P||t);if(c==="buy"&&S>A){$.error(`Insufficient balance. Required: ${S.toFixed(2)} USDT, Available: ${A.toFixed(2)} USDT`);return}try{await r(n,e,c,i,E,P),$.success(`${c.toUpperCase()} order executed successfully`),f(""),y("25")}catch(I){$.error(`Order execution failed: ${I instanceof Error?I.message:"Unknown error"}`)}};return l.jsxs(wc,{className:"p-4 bg-gradient-to-br from-background to-primary/5 border-primary/20",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Rn,{className:"w-5 h-5 text-primary"}),l.jsx("h3",{className:"text-lg font-bold",children:"Place Order"})]}),l.jsxs(gs,{variant:"outline",className:"text-xs",children:[l.jsx(fi,{className:"w-3 h-3 mr-1"}),A.toFixed(2)," USDT"]})]}),l.jsx(xi,{value:i,onValueChange:E=>o(E),className:"mb-4",children:l.jsxs(pi,{className:"grid w-full grid-cols-3",children:[l.jsx(Wr,{value:"market",children:"Market"}),l.jsx(Wr,{value:"limit",children:"Limit"}),l.jsx(Wr,{value:"stop",children:"Stop"})]})}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[l.jsxs(le,{variant:c==="buy"?"default":"outline",onClick:()=>d("buy"),className:c==="buy"?"bg-success hover:bg-success/90":"",children:[l.jsx(kt,{className:"w-4 h-4 mr-1"}),"Buy"]}),l.jsxs(le,{variant:c==="sell"?"default":"outline",onClick:()=>d("sell"),className:c==="sell"?"bg-destructive hover:bg-destructive/90":"",children:[l.jsx(qt,{className:"w-4 h-4 mr-1"}),"Sell"]})]}),i!=="market"&&l.jsxs("div",{className:"space-y-2",children:[l.jsx(xn,{htmlFor:"price",className:"text-xs",children:"Price (USDT)"}),l.jsx(Cn,{id:"price",type:"number",step:"0.01",value:h,onChange:E=>b(E.target.value),className:"h-9 text-sm"})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx(xn,{htmlFor:"usePercentage",className:"text-xs",children:"Use % of Balance"}),l.jsx(Cc,{id:"usePercentage",checked:x,onCheckedChange:p})]}),x?l.jsxs("div",{className:"space-y-2",children:[l.jsx(xn,{htmlFor:"percentage",className:"text-xs",children:"Percentage (%)"}),l.jsx(Cn,{id:"percentage",type:"number",min:"1",max:"100",value:m,onChange:E=>y(E.target.value),className:"h-9 text-sm"}),l.jsx("div",{className:"flex gap-2",children:["25","50","75","100"].map(E=>l.jsxs(le,{variant:"outline",size:"sm",onClick:()=>y(E),className:"flex-1 h-7 text-xs",children:[E,"%"]},E))})]}):l.jsxs("div",{className:"space-y-2",children:[l.jsxs(xn,{htmlFor:"amount",className:"text-xs",children:["Amount (",e.replace("USDT",""),")"]}),l.jsx(Cn,{id:"amount",type:"number",step:"0.00001",value:u,onChange:E=>f(E.target.value),placeholder:"0.00",className:"h-9 text-sm"})]}),l.jsxs("div",{className:"p-3 bg-muted/50 rounded-lg space-y-1 text-xs",children:[l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-muted-foreground",children:"Order Type:"}),l.jsx("span",{className:"font-semibold uppercase",children:i})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-muted-foreground",children:"Est. Cost:"}),l.jsxs("span",{className:"font-semibold",children:[(N()*(i==="market"?t:parseFloat(h)||0)).toFixed(2)," USDT"]})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-muted-foreground",children:"Fee (0.1%):"}),l.jsxs("span",{className:"font-semibold",children:[(N()*(i==="market"?t:parseFloat(h)||0)*.001).toFixed(2)," USDT"]})]})]}),l.jsx(le,{onClick:T,disabled:s,className:`w-full ${c==="buy"?"bg-success hover:bg-success/90":"bg-destructive hover:bg-destructive/90"}`,children:s?"Executing...":l.jsxs(l.Fragment,{children:[l.jsx(Yr,{className:"w-4 h-4 mr-1"}),c==="buy"?"Buy":"Sell"," ",e]})}),l.jsxs("div",{className:"text-xs text-muted-foreground text-center",children:[l.jsx(hc,{className:"w-3 h-3 inline mr-1"}),"Real trades executed on ",n]})]})]})},Ou=()=>{const[n,e]=C.useState([{id:"1",symbol:"BTCUSDT",condition:"above",price:7e4,active:!0},{id:"2",symbol:"ETHUSDT",condition:"below",price:3e3,active:!0}]),[t,r]=C.useState("BTCUSDT"),[s,a]=C.useState("above"),[i,o]=C.useState(""),c=()=>{if(!i||parseFloat(i)<=0){$.error("Please enter a valid price");return}const u={id:Date.now().toString(),symbol:t,condition:s,price:parseFloat(i),active:!0};e([u,...n]),o(""),$.success("Alert created!")},d=u=>{e(n.filter(f=>f.id!==u)),$.info("Alert deleted")};return l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(xc,{className:"w-4 h-4 text-chart-4"}),l.jsx("h3",{className:"text-sm font-semibold text-foreground uppercase tracking-wide",children:"Price Alerts"})]}),l.jsxs("div",{className:"space-y-2 p-3 rounded-lg bg-muted/20 border border-border",children:[l.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[l.jsxs(zr,{value:t,onValueChange:r,children:[l.jsx(Qr,{className:"h-9",children:l.jsx($r,{})}),l.jsxs(Jr,{children:[l.jsx(We,{value:"BTCUSDT",children:"BTC"}),l.jsx(We,{value:"ETHUSDT",children:"ETH"}),l.jsx(We,{value:"BNBUSDT",children:"BNB"}),l.jsx(We,{value:"SOLUSDT",children:"SOL"})]})]}),l.jsxs(zr,{value:s,onValueChange:u=>a(u),children:[l.jsx(Qr,{className:"h-9",children:l.jsx($r,{})}),l.jsxs(Jr,{children:[l.jsx(We,{value:"above",children:"Above"}),l.jsx(We,{value:"below",children:"Below"})]})]})]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx(Cn,{type:"number",placeholder:"Price...",value:i,onChange:u=>o(u.target.value),className:"h-9"}),l.jsxs(le,{onClick:c,size:"sm",className:"gap-1",children:[l.jsx(pc,{className:"w-3 h-3"}),"Add"]})]})]}),l.jsx("div",{className:"space-y-2",children:n.length===0?l.jsx("div",{className:"text-sm text-muted-foreground text-center py-4",children:"No alerts set"}):n.map(u=>l.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-muted/30 border border-border hover:border-primary/30 transition-colors group",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[u.condition==="above"?l.jsx(kt,{className:"w-4 h-4 text-success"}):l.jsx(qt,{className:"w-4 h-4 text-destructive"}),l.jsxs("div",{children:[l.jsx("div",{className:"text-sm font-medium text-foreground",children:u.symbol.replace("USDT","")}),l.jsxs("div",{className:"text-xs text-muted-foreground",children:[u.condition," $",u.price.toLocaleString()]})]})]}),l.jsx(le,{variant:"ghost",size:"sm",onClick:()=>d(u.id),className:"h-7 w-7 p-0 opacity-0 group-hover:opacity-100 transition-opacity",children:l.jsx(bc,{className:"w-3 h-3 text-destructive"})})]},u.id))})]})},Bu=()=>{const[n]=C.useState([{price:7e4,volume:125e4,type:"resistance",strength:"strong"},{price:68500,volume:85e4,type:"resistance",strength:"medium"},{price:66e3,volume:21e5,type:"support",strength:"strong"},{price:64500,volume:65e4,type:"support",strength:"weak"},{price:62e3,volume:18e5,type:"support",strength:"strong"}]),e=r=>{switch(r){case"strong":return"bg-primary/30 border-primary/50";case"medium":return"bg-chart-2/30 border-chart-2/50";case"weak":return"bg-muted/30 border-muted-foreground/30";default:return"bg-muted/30 border-border"}},t=r=>{switch(r){case"strong":return"w-full";case"medium":return"w-2/3";case"weak":return"w-1/3";default:return"w-1/2"}};return l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(gc,{className:"w-4 h-4 text-chart-4"}),l.jsx("h3",{className:"text-sm font-semibold text-foreground uppercase tracking-wide",children:"Liquidity Zones"})]}),l.jsxs("div",{className:"flex items-center justify-between text-xs",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-2 h-2 rounded-full bg-success"}),l.jsx("span",{className:"text-muted-foreground",children:"Support"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-2 h-2 rounded-full bg-destructive"}),l.jsx("span",{className:"text-muted-foreground",children:"Resistance"})]})]}),l.jsx("div",{className:"space-y-2",children:n.map((r,s)=>l.jsxs("div",{className:`p-3 rounded-lg border transition-all hover:scale-[1.02] ${e(r.strength)}`,children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[r.type==="support"?l.jsx(kt,{className:"w-3 h-3 text-success"}):l.jsx(qt,{className:"w-3 h-3 text-destructive"}),l.jsxs("span",{className:"text-sm font-bold text-foreground",children:["$",r.price.toLocaleString()]})]}),l.jsx("span",{className:`text-[10px] px-2 py-0.5 rounded uppercase font-medium ${r.type==="support"?"bg-success/20 text-success":"bg-destructive/20 text-destructive"}`,children:r.type})]}),l.jsxs("div",{className:"space-y-1",children:[l.jsxs("div",{className:"flex items-center justify-between text-xs",children:[l.jsx("span",{className:"text-muted-foreground",children:"Volume"}),l.jsxs("span",{className:"text-foreground font-medium",children:["$",(r.volume/1e6).toFixed(2),"M"]})]}),l.jsxs("div",{className:"space-y-1",children:[l.jsxs("div",{className:"flex items-center justify-between text-[10px]",children:[l.jsx("span",{className:"text-muted-foreground",children:"Strength"}),l.jsx("span",{className:"text-foreground capitalize",children:r.strength})]}),l.jsx("div",{className:"h-1.5 w-full bg-muted/50 rounded-full overflow-hidden",children:l.jsx("div",{className:`h-full bg-gradient-to-r ${r.type==="support"?"from-success to-success/50":"from-destructive to-destructive/50"} ${t(r.strength)} transition-all`})})]})]})]},s))}),l.jsx("div",{className:"p-3 rounded-lg bg-muted/20 border border-border text-xs text-muted-foreground",children:"💡 Zones are calculated based on volume profile and historical price action"})]})},Ru=()=>{const[n]=C.useState([{key:"B",description:"Quick Buy Order",category:"trading"},{key:"S",description:"Quick Sell Order",category:"trading"},{key:"Esc",description:"Cancel All Orders",category:"trading"},{key:"Space",description:"Toggle Chart Type",category:"chart"},{key:"1-7",description:"Switch Timeframes",category:"chart"},{key:"I",description:"Toggle Indicators",category:"chart"},{key:"H",description:"Toggle Heatmap",category:"navigation"},{key:"P",description:"Open Portfolio",category:"navigation"},{key:"W",description:"Open Watchlist",category:"navigation"},{key:"T",description:"Toggle Terminal",category:"navigation"},{key:"/",description:"Search Symbols",category:"navigation"},{key:"F",description:"Fullscreen Chart",category:"chart"}]),e=r=>{switch(r){case"trading":return"text-success";case"chart":return"text-chart-4";case"navigation":return"text-primary";default:return"text-muted-foreground"}},t=Array.from(new Set(n.map(r=>r.category)));return l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(mc,{className:"w-4 h-4 text-chart-4"}),l.jsx("h3",{className:"text-sm font-semibold text-foreground uppercase tracking-wide",children:"Keyboard Shortcuts"})]}),l.jsx(Yr,{className:"w-4 h-4 text-chart-4 animate-pulse"})]}),t.map(r=>l.jsxs("div",{className:"space-y-2",children:[l.jsx("div",{className:`text-xs font-semibold uppercase tracking-wide ${e(r)}`,children:r}),l.jsx("div",{className:"space-y-1",children:n.filter(s=>s.category===r).map((s,a)=>l.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg bg-muted/30 border border-border hover:border-primary/30 transition-colors",children:[l.jsx("span",{className:"text-xs text-muted-foreground",children:s.description}),l.jsx("kbd",{className:"px-2 py-1 text-xs font-semibold text-foreground bg-background border border-border rounded",children:s.key})]},a))})]},r)),l.jsxs(le,{variant:"outline",size:"sm",className:"w-full gap-2",children:[l.jsx(yc,{className:"w-3 h-3"}),"Customize Hotkeys"]})]})},Uu=C.lazy(()=>St(()=>import("./PortfolioTracker.1762523887030.4G10t9ZY.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10])).then(n=>({default:n.PortfolioTracker}))),Fu=C.lazy(()=>St(()=>import("./AutoTradingSignals.1762523887030.DKccxYMh.js"),__vite__mapDeps([11,1,2,3,4,5,8,9])).then(n=>({default:n.AutoTradingSignals}))),Du=C.lazy(()=>St(()=>import("./SocialTrading.1762523887030.CSPjgEnq.js"),__vite__mapDeps([12,1,2,3,4,5])).then(n=>({default:n.SocialTrading}))),Lu=C.lazy(()=>St(()=>import("./MarketScanner.1762523887030.D1-oI2Xh.js"),__vite__mapDeps([13,1,2,3,4,5])).then(n=>({default:n.MarketScanner}))),Mu=C.lazy(()=>St(()=>import("./MarketSentiment.1762523887030.B-_Xd836.js"),__vite__mapDeps([14,1,2,6,3,4,5])).then(n=>({default:n.MarketSentiment}))),ju=C.lazy(()=>St(()=>import("./EconomicCalendar.1762523887030.3qAKzGEg.js"),__vite__mapDeps([15,1,2,3,4,5])).then(n=>({default:n.EconomicCalendar}))),Gu=C.lazy(()=>St(()=>import("./TradeJournal.1762523887030.-XCE7d2Z.js"),__vite__mapDeps([16,1,2,3,4,5])).then(n=>({default:n.TradeJournal}))),tc=C.memo(({symbol:n,exchange:e,currentPrice:t,assetType:r,onSelectSymbol:s})=>l.jsxs("aside",{className:"glass-panel space-y-4 rounded-2xl p-5 shadow-2xl transition-all duration-300 hover:shadow-primary/10 animate-slide-in-right",children:[l.jsxs(xi,{defaultValue:"trading",className:"w-full",children:[l.jsxs(pi,{className:"grid w-full grid-cols-2",children:[l.jsx(Wr,{value:"trading",children:"Trading"}),l.jsx(Wr,{value:"settings",children:"Settings"})]}),l.jsxs(Ac,{value:"trading",className:"space-y-4 mt-4",children:[l.jsx(Ec,{onSelectSymbol:s,selectedSymbol:n}),l.jsx(Su,{exchange:e,symbol:n,currentPrice:t}),l.jsx(Bc,{}),l.jsx(C.Suspense,{fallback:l.jsx(mt,{className:"h-48 w-full rounded-lg"}),children:l.jsx(Uu,{})}),l.jsx(Ou,{}),l.jsx(Rc,{}),l.jsx(Bu,{}),l.jsx(Ru,{}),l.jsx(Nc,{exchange:e,symbol:n})]})]}),l.jsx(C.Suspense,{fallback:l.jsx(mt,{className:"h-48 w-full rounded-lg"}),children:l.jsx(Fu,{})}),l.jsx(C.Suspense,{fallback:l.jsx(mt,{className:"h-48 w-full rounded-lg"}),children:l.jsx(Du,{})}),l.jsx(C.Suspense,{fallback:l.jsx(mt,{className:"h-48 w-full rounded-lg"}),children:l.jsx(Lu,{})}),l.jsx(C.Suspense,{fallback:l.jsx(mt,{className:"h-48 w-full rounded-lg"}),children:l.jsx(Mu,{})}),l.jsx(C.Suspense,{fallback:l.jsx(mt,{className:"h-48 w-full rounded-lg"}),children:l.jsx(ju,{})}),l.jsx(C.Suspense,{fallback:l.jsx(mt,{className:"h-48 w-full rounded-lg"}),children:l.jsx(Gu,{})}),l.jsx(Sc,{})]}));tc.displayName="RightSidebar";const ii={"1m":500,"5m":500,"15m":500,"1h":500,"4h":400,"1d":365,"1w":200},oi={"1m":"1m","5m":"5m","15m":"15m","1h":"1h","4h":"4h","1d":"1d","1w":"1w"};function _u(n,e,t,r="15m"){const[s,a]=C.useState([]),[i,o]=C.useState(null),[c,d]=C.useState([]),[u,f]=C.useState(!1),h=C.useRef(null),b=C.useRef(null),x=C.useCallback(async()=>{try{f(!0);let y=[];if(n==="BINANCE"&&yt.isConfigured()){const A=oi[r],N=ii[r];y=await yt.fetchKlines(e,A,N);const T=await yt.fetchTicker(e);T&&T.price!==void 0&&o(Number(T.price))}else if(n==="STOCKS"&&br.isConfigured()){y=await br.getCandles(e,r);const A=await br.getQuote(e);A&&A.price!==void 0&&o(Number(A.price))}else if(n==="FOREX"&&wt.isConfigured()){y=await wt.getCandles(e,r);const A=await wt.getQuote(e);A&&A.bid!==void 0&&A.ask!==void 0&&o((Number(A.bid)+Number(A.ask))/2)}else{const A=Un[n],N=ii[r],T=oi[r];let E=A.restKlines(e,N);n==="BINANCE"&&(E=E.replace(/interval=[^&]*/,`interval=${T}`));const P=await fetch(E);if(!P.ok)throw new Error(`HTTP ${P.status}`);const S=await P.json();if(n==="BINANCE"?y=S.map(I=>({x:I[0],y:[parseFloat(I[1]),parseFloat(I[2]),parseFloat(I[3]),parseFloat(I[4])]})):n==="OKX"?y=(S.data||S||[]).map(D=>({x:parseInt(D[0]),y:[parseFloat(D[1]),parseFloat(D[2]),parseFloat(D[3]),parseFloat(D[4])]})):n==="KUCOIN"?y=(S.data||S||[]).map(D=>({x:D[0]>1e12?D[0]:D[0]*1e3,y:[parseFloat(D[1]),parseFloat(D[2]),parseFloat(D[3]),parseFloat(D[4])]})):n==="COINBASE"&&(y=S.map(I=>({x:I[0]*1e3,y:[parseFloat(I[3]),parseFloat(I[2]),parseFloat(I[1]),parseFloat(I[4])]}))),y=y.map(I=>({x:I.x>1e12?I.x:I.x*1e3,y:I.y.map(D=>parseFloat(D.toString()))})),y.length>0){const I=y[y.length-1];I&&I.y&&I.y[3]!==void 0&&o(Number(I.y[3]))}}a(y),$.success(`Loaded ${y.length} candles from real API`)}catch(y){console.error("Failed to fetch candles:",y),$.error("Failed to load chart data")}finally{f(!1)}},[n,e,r]),p=C.useCallback(()=>{h.current&&h.current.close();try{if(n==="BINANCE"){const y=new WebSocket(Un.BINANCE.wsTrade(e));h.current=y,y.onopen=()=>{$.success("WebSocket connected")},y.onmessage=A=>{try{const N=JSON.parse(A.data),T=parseFloat(N.p||N.price),E=parseFloat(N.q||N.qty||0),P=N.T?Math.floor(N.T/1e3):Math.floor(Date.now()/1e3);T&&(o(T),d(S=>[{price:T,volume:E,timestamp:P*1e3,side:"buy"},...S.slice(0,99)]))}catch(N){console.error("WebSocket message error:",N)}},y.onerror=()=>{$.error("WebSocket error")},y.onclose=()=>{h.current=null}}}catch(y){console.error("WebSocket connection error:",y),$.error("Failed to connect WebSocket")}},[n,e]),m=C.useCallback(()=>{x(),b.current&&clearInterval(b.current),b.current=setInterval(()=>{x()},15e3)},[x]);return C.useEffect(()=>(x(),t==="ws"?p():m(),()=>{h.current&&h.current.close(),b.current&&clearInterval(b.current)}),[n,e,t,x,p,m]),{candles:s,lastPrice:i,trades:c,loading:u,refetch:x}}const Hu=C.lazy(()=>St(()=>import("./admin-dashboard.1762523887030.Dco3yzit.js"),__vite__mapDeps([17,1,2,3,4,5])).then(n=>({default:n.AdminPanel}))),ci=C.memo(bi),Ku=C.memo(Uc),Vu=C.memo(gi),zu=C.memo(tc),Qu=C.memo(kc),$u=()=>{const n=hi(),[e,t]=C.useState(!1),[r,s]=C.useState(!1);C.useEffect(()=>{(async()=>{try{const{data:{session:j}}=await Z.auth.getSession();if(j){const{data:J}=await Z.from("user_roles").select("role").eq("user_id",j.user.id).eq("role","admin").maybeSingle();t(!!J),J&&$.success("Admin Panel Erişimi Aktif",{description:"Yönetici özellikleri kullanıma hazır"})}}catch{console.log("Auth check failed, continuing without auth")}})()},[n]);const[a,i]=C.useState(localStorage.getItem("omni_exchange")||"BINANCE"),[o,c]=C.useState(localStorage.getItem("omni_symbol")||os("BINANCE")[0].toLowerCase()),[d,u]=C.useState(localStorage.getItem("omni_source")||"ws"),[f,h]=C.useState(localStorage.getItem("omni_timeframe")||"15m"),[b,x]=C.useState(null),[p,m]=C.useState([]),[y,A]=C.useState("crypto"),[N,T]=C.useState({showSMA:!0,showEMA:!0,showRSI:!0,showMACD:!1,showBB:!1,showFib:!1,showPatterns:!0,smaPeriod:parseInt(localStorage.getItem("omni_sma")||"20"),emaPeriod:parseInt(localStorage.getItem("omni_ema")||"20"),rsiPeriod:parseInt(localStorage.getItem("omni_rsi")||"14")}),[E,P]=C.useState([]),S=C.useCallback((F,j="info")=>{P(J=>[{message:F,level:j,timestamp:new Date},...J.slice(0,199)])},[]),{candles:I,lastPrice:D,trades:_,refetch:G}=_u(a,o,d,f),W=C.useMemo(()=>!N.showPatterns||I.length<10?[]:Pc(I),[I,N.showPatterns]);C.useEffect(()=>{const F=os(a).map(j=>j.toLowerCase());m(F),F.includes(o)||c(F[0])},[a]),C.useEffect(()=>{localStorage.setItem("omni_exchange",a),localStorage.setItem("omni_symbol",o),localStorage.setItem("omni_source",d),localStorage.setItem("omni_timeframe",f)},[a,o,d,f]),C.useEffect(()=>{D!=null&&b!==null&&S(`Price updated: $${Number(D).toFixed(6)}`,"info"),x(D)},[D]),C.useEffect(()=>{o&&a&&S(`Trading terminal initialized - ${a} / ${o.toUpperCase()}`,"info")},[]);const Y=F=>{i(F);const j=os(F);c(j[0].toLowerCase()),S(`Switched to ${F}`,"info"),$.success(`Switched to ${F}`)},ne=F=>{F&&(c(F),S(`Symbol changed to ${F.toUpperCase()}`,"info"))},O=F=>{u(F),S(`Data source changed to ${F.toUpperCase()}`,"info"),$.info(`Using ${F.toUpperCase()} data source`)},B=()=>{G(),S("Manual refresh triggered","info"),$.success("Data refreshed")},M=F=>{T(F),localStorage.setItem("omni_sma",F.smaPeriod.toString()),localStorage.setItem("omni_ema",F.emaPeriod.toString()),localStorage.setItem("omni_rsi",F.rsiPeriod.toString()),S("Indicators updated","info"),$.success("Indicators applied")};return r&&e?l.jsxs(l.Fragment,{children:[l.jsx(ci,{onAdminClick:()=>s(!1),isAdmin:e}),l.jsxs("div",{className:"relative min-h-screen pt-24 p-4 animate-fade-in",children:[l.jsx(fa,{}),l.jsx("div",{className:"relative z-10 mx-auto max-w-[1800px] space-y-4",children:l.jsx("div",{className:"glass-panel-strong rounded-2xl p-6 animate-scale-in",children:l.jsx(C.Suspense,{fallback:l.jsx(mt,{className:"w-full h-screen"}),children:l.jsx(Hu,{})})})})]})]}):l.jsxs(l.Fragment,{children:[l.jsx(ci,{onAdminClick:()=>s(!0),isAdmin:e}),l.jsxs("div",{className:"relative min-h-screen pt-24 p-4 animate-fade-in",children:[l.jsx(fa,{}),l.jsxs("div",{className:"relative z-10 mx-auto max-w-[1800px] space-y-4",children:[l.jsx("div",{className:"glass-panel-strong rounded-2xl p-4 neon-border-strong animate-slide-fade-down",children:l.jsx(Ku,{exchange:a,symbol:o,source:d,symbols:p,onExchangeChange:Y,onSymbolChange:ne,onSourceChange:O,onRefresh:B})}),l.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-[380px_1fr_380px]",children:[l.jsx(Vu,{symbols:p,activeSymbol:o,timeframe:f,indicatorSettings:N,detectedPatterns:W,candles:I,lastPrice:D,logs:E,onSymbolClick:ne,onTimeframeChange:h,onApplyIndicators:M}),l.jsx(Qu,{symbol:o,exchange:a,source:d,candles:I,trades:_,lastPrice:D,previousPrice:b,indicatorSettings:N}),l.jsx(zu,{symbol:o,exchange:a,currentPrice:D,assetType:y,onSelectSymbol:(F,j)=>{c(F.toLowerCase()),A(j)}})]})]})]})]})},Gf=Object.freeze(Object.defineProperty({__proto__:null,default:$u},Symbol.toStringTag,{value:"Module"}));export{Gf as I,Lc as u};
