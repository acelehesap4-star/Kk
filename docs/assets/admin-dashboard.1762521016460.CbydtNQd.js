import{j as e}from"./vendor-features.1762521016460.BFhW2fTx.js";import{r as x}from"./vendor-core.1762521016460.DgXDOTlK.js";import{s as d,C as l,B as u,e as o,T as U,a as R,b as j,d as E,u as h}from"./trading-core.1762521016460.BQO1iWNA.js";import{o as P,R as F,s as V,t as O,T as _,A as S,u as f,v as I,D as $,Z as q,j as b,X as v}from"./trading-orders-wrapper.1762521016460.BsA7Xssy.js";import"./vendor-ui.1762521016460.CMvOdVlo.js";const H=()=>{const[g,k]=x.useState([]),[r,C]=x.useState({totalUsers:0,totalPayments:0,pendingPayments:0,totalOmni99Issued:0,approvedPayments:0,rejectedPayments:0,totalVolumeUSD:0,avgPaymentSize:0}),[T,N]=x.useState(!0),c=async()=>{try{N(!0);const{data:s,error:t}=await d.from("crypto_payments").select("*").order("created_at",{ascending:!1});if(t)throw t;k(s||[]);const{data:a}=await d.from("omni99_balances").select("balance, total_purchased"),n=(a==null?void 0:a.reduce((i,p)=>i+parseFloat(String(p.total_purchased)),0))||0,m=(a==null?void 0:a.length)||0,w=(s==null?void 0:s.reduce((i,p)=>i+parseFloat(String(p.amount_usd)),0))||0,A=s!=null&&s.length?w/s.length:0;C({totalUsers:m,totalPayments:(s==null?void 0:s.length)||0,pendingPayments:(s==null?void 0:s.filter(i=>i.status==="pending").length)||0,approvedPayments:(s==null?void 0:s.filter(i=>i.status==="approved").length)||0,rejectedPayments:(s==null?void 0:s.filter(i=>i.status==="rejected").length)||0,totalOmni99Issued:n,totalVolumeUSD:w,avgPaymentSize:A})}catch(s){console.error("Error fetching admin data:",s),h.error("Failed to load admin data")}finally{N(!1)}};x.useEffect(()=>{c();const s=d.channel("admin_payments").on("postgres_changes",{event:"*",schema:"public",table:"crypto_payments"},()=>c()).subscribe();return()=>{d.removeChannel(s)}},[]);const y=async(s,t)=>{try{const a=g.find(n=>n.id===s);if(!a)return;if(t){const{error:n}=await d.from("crypto_payments").update({status:"approved",verified_at:new Date().toISOString()}).eq("id",s);if(n)throw n;const{error:m}=await d.rpc("update_omni99_balance",{p_user_id:a.user_id,p_amount:a.omni99_amount,p_transaction_type:"purchase",p_description:`Purchase via ${a.blockchain} - ${a.tx_hash||"N/A"}`,p_reference_id:s});if(m)throw m;h.success("Payment approved and tokens distributed")}else{const{error:n}=await d.from("crypto_payments").update({status:"rejected",verified_at:new Date().toISOString()}).eq("id",s);if(n)throw n;h.success("Payment rejected")}c()}catch(a){console.error("Error verifying payment:",a),h.error("Failed to verify payment")}},z=s=>{switch(s){case"approved":return e.jsx(b,{className:"w-4 h-4 text-success"});case"rejected":return e.jsx(v,{className:"w-4 h-4 text-destructive"});default:return e.jsx(f,{className:"w-4 h-4 text-warning"})}};return T?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx(P,{className:"w-6 h-6 text-primary animate-pulse"}),e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Admin Panel"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:Array.from({length:4}).map((s,t)=>e.jsx(l,{className:"p-4 animate-pulse",children:e.jsx("div",{className:"h-20 bg-muted/30 rounded"})},t))})]}):e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"relative overflow-hidden rounded-2xl bg-gradient-to-r from-primary/20 via-cyan-500/20 to-primary/20 border border-primary/30 p-6",children:[e.jsx("div",{className:"absolute inset-0 bg-grid-pattern opacity-5"}),e.jsxs("div",{className:"relative z-10 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 rounded-xl bg-primary/20 backdrop-blur-sm border border-primary/30",children:e.jsx(P,{className:"w-8 h-8 text-primary animate-pulse"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-foreground mb-1",children:"Elite Admin Console"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Real-time system monitoring & management"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(u,{variant:"outline",size:"sm",onClick:c,children:[e.jsx(F,{className:"w-4 h-4 mr-2"}),"Refresh"]}),e.jsxs(u,{variant:"outline",size:"sm",children:[e.jsx(V,{className:"w-4 h-4 mr-2"}),"Export"]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(l,{className:"group relative overflow-hidden bg-gradient-to-br from-primary/10 via-primary/5 to-transparent border-primary/30 p-5 hover:shadow-lg hover:shadow-primary/20 transition-all duration-300",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-primary/10 rounded-full blur-3xl"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-primary/20 backdrop-blur-sm",children:e.jsx(O,{className:"w-5 h-5 text-primary"})}),e.jsx(o,{variant:"outline",className:"text-xs",children:"Live"})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Total Users"}),e.jsx("p",{className:"text-3xl font-bold text-foreground mb-2",children:r.totalUsers}),e.jsxs("div",{className:"flex items-center gap-1 text-xs text-success",children:[e.jsx(_,{className:"w-3 h-3"}),e.jsx("span",{children:"+12% vs last month"})]})]})]}),e.jsxs(l,{className:"group relative overflow-hidden bg-gradient-to-br from-cyan-500/10 via-cyan-500/5 to-transparent border-cyan-500/30 p-5 hover:shadow-lg hover:shadow-cyan-500/20 transition-all duration-300",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-cyan-500/10 rounded-full blur-3xl"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-cyan-500/20 backdrop-blur-sm",children:e.jsx(S,{className:"w-5 h-5 text-cyan-400"})}),e.jsx(o,{variant:"outline",className:"text-xs",children:"Total"})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Total Payments"}),e.jsx("p",{className:"text-3xl font-bold text-foreground mb-2",children:r.totalPayments}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Approved: ",r.approvedPayments," | Rejected: ",r.rejectedPayments]})]})]}),e.jsxs(l,{className:"group relative overflow-hidden bg-gradient-to-br from-warning/10 via-warning/5 to-transparent border-warning/30 p-5 hover:shadow-lg hover:shadow-warning/20 transition-all duration-300",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-warning/10 rounded-full blur-3xl"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-warning/20 backdrop-blur-sm",children:e.jsx(f,{className:"w-5 h-5 text-warning animate-pulse"})}),e.jsx(o,{variant:"outline",className:"text-xs bg-warning/20",children:"Action Required"})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Pending Verification"}),e.jsx("p",{className:"text-3xl font-bold text-foreground mb-2",children:r.pendingPayments}),e.jsxs("div",{className:"flex items-center gap-1 text-xs text-warning",children:[e.jsx(I,{className:"w-3 h-3"}),e.jsx("span",{children:"Requires immediate attention"})]})]})]}),e.jsxs(l,{className:"group relative overflow-hidden bg-gradient-to-br from-success/10 via-success/5 to-transparent border-success/30 p-5 hover:shadow-lg hover:shadow-success/20 transition-all duration-300",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-success/10 rounded-full blur-3xl"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-success/20 backdrop-blur-sm",children:e.jsx($,{className:"w-5 h-5 text-success"})}),e.jsx(o,{variant:"outline",className:"text-xs",children:"Issued"})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"OMNI99 Tokens"}),e.jsx("p",{className:"text-3xl font-bold text-foreground mb-2",children:r.totalOmni99Issued.toFixed(2)}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["$",r.totalVolumeUSD.toFixed(2)," USD Volume"]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(l,{className:"p-5 bg-gradient-to-br from-card/50 to-card/30 border-border/50",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:e.jsx(q,{className:"w-4 h-4 text-primary"})}),e.jsx("h3",{className:"font-semibold text-foreground",children:"Avg Payment Size"})]}),e.jsxs("p",{className:"text-2xl font-bold text-foreground",children:["$",r.avgPaymentSize.toFixed(2)]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Per transaction"})]}),e.jsxs(l,{className:"p-5 bg-gradient-to-br from-card/50 to-card/30 border-border/50",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-cyan-500/10",children:e.jsx(S,{className:"w-4 h-4 text-cyan-400"})}),e.jsx("h3",{className:"font-semibold text-foreground",children:"Success Rate"})]}),e.jsxs("p",{className:"text-2xl font-bold text-foreground",children:[r.totalPayments>0?(r.approvedPayments/r.totalPayments*100).toFixed(1):0,"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Approval ratio"})]}),e.jsxs(l,{className:"p-5 bg-gradient-to-br from-card/50 to-card/30 border-border/50",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-success/10",children:e.jsx(_,{className:"w-4 h-4 text-success"})}),e.jsx("h3",{className:"font-semibold text-foreground",children:"Total Volume"})]}),e.jsxs("p",{className:"text-2xl font-bold text-foreground",children:["$",(r.totalVolumeUSD/1e3).toFixed(1),"K"]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"USD equivalent"})]})]}),e.jsx(l,{className:"p-6 bg-gradient-to-br from-card/50 to-card/30 border-border/50",children:e.jsxs(U,{defaultValue:"pending",className:"w-full",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("h3",{className:"text-lg font-bold text-foreground",children:"Payment Verification Center"})}),e.jsxs(R,{className:"grid w-full grid-cols-3 bg-muted/30",children:[e.jsxs(j,{value:"pending",className:"data-[state=active]:bg-warning/20",children:[e.jsx(f,{className:"w-4 h-4 mr-2"}),"Pending (",r.pendingPayments,")"]}),e.jsxs(j,{value:"approved",className:"data-[state=active]:bg-success/20",children:[e.jsx(b,{className:"w-4 h-4 mr-2"}),"Approved (",r.approvedPayments,")"]}),e.jsxs(j,{value:"rejected",className:"data-[state=active]:bg-destructive/20",children:[e.jsx(v,{className:"w-4 h-4 mr-2"}),"Rejected (",r.rejectedPayments,")"]})]}),["pending","approved","rejected"].map(s=>e.jsx(E,{value:s,className:"space-y-4 mt-4",children:g.filter(t=>t.status===s).length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:["No ",s," payments"]}):g.filter(t=>t.status===s).map(t=>e.jsxs(l,{className:"group relative overflow-hidden bg-gradient-to-r from-card/50 to-card/30 border-border/50 p-5 hover:shadow-lg transition-all duration-300",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-primary/5 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),e.jsxs("div",{className:"relative z-10 flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex items-start gap-4 flex-1",children:[e.jsx("div",{className:"p-2 rounded-lg bg-muted/30",children:z(t.status)}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(o,{variant:"outline",className:"font-mono text-xs",children:t.blockchain}),e.jsx("span",{className:"text-xs text-muted-foreground",children:new Date(t.created_at).toLocaleString("tr-TR",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Crypto Amount"}),e.jsx("p",{className:"font-semibold text-foreground",children:t.amount_crypto})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"USD Value"}),e.jsxs("p",{className:"font-semibold text-foreground",children:["$",parseFloat(String(t.amount_usd)).toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"OMNI99 Tokens"}),e.jsx("p",{className:"font-semibold text-success",children:t.omni99_amount})]})]}),t.tx_hash&&e.jsxs("div",{className:"p-2 rounded-lg bg-muted/20 border border-border/30",children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Transaction Hash"}),e.jsx("p",{className:"text-xs font-mono text-foreground break-all",children:t.tx_hash})]})]})]}),t.status==="pending"&&e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs(u,{size:"sm",className:"bg-success hover:bg-success/90",onClick:()=>y(t.id,!0),children:[e.jsx(b,{className:"w-4 h-4 mr-2"}),"Approve"]}),e.jsxs(u,{size:"sm",variant:"destructive",onClick:()=>y(t.id,!1),children:[e.jsx(v,{className:"w-4 h-4 mr-2"}),"Reject"]})]})]})]},t.id))},s))]})})]})};export{H as AdminPanel};
