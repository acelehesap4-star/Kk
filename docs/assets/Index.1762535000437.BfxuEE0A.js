const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/PortfolioTracker.1762535000437.CJH3Vvp2.js","assets/vendor-features.1762535000437.BCqdaw5i.js","assets/vendor-core.1762535000437.Bgda-OdR.js","assets/trading-core.1762535000437.DnzyQB8l.js","assets/trading-orders-wrapper.1762535000437.DPkFLRPe.js","assets/vendor-ui.1762535000437.P2HgmScb.js","assets/trading-advanced-orders.1762535000437.bFHsgY-2.js","assets/chart-features.1762535000437.DOiEfRjp.js","assets/trading-feeds.1762535000437.BWHCg6Pu.js","assets/vendor-crypto.1762535000437.DsYnvCMO.js","assets/AutoTradingSignals.1762535000437.BhYq4dUW.js","assets/SocialTrading.1762535000437.1MWJWSky.js","assets/MarketScanner.1762535000437.ClU16pVo.js","assets/MarketSentiment.1762535000437.DlFAJ5OK.js","assets/EconomicCalendar.1762535000437.B_H-ztPa.js","assets/TradeJournal.1762535000437.BkeoCVHW.js"])))=>i.map(i=>d[i]);
var tc=Object.defineProperty;var oa=r=>{throw TypeError(r)};var rc=(r,e,t)=>e in r?tc(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var w=(r,e,t)=>rc(r,typeof e!="symbol"?e+"":e,t),os=(r,e,t)=>e.has(r)||oa("Cannot "+t);var b=(r,e,t)=>(os(r,e,"read from private field"),t?t.call(r):e.get(r)),F=(r,e,t)=>e.has(r)?oa("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),P=(r,e,t,n)=>(os(r,e,"write to private field"),n?n.call(r,t):e.set(r,t),t),Z=(r,e,t)=>(os(r,e,"access private method"),t);var ca=(r,e,t,n)=>({set _(s){P(r,e,s,t)},get _(){return b(r,e,n)}});import{j as c}from"./vendor-features.1762535000437.BCqdaw5i.js";import{r as T,L as fi}from"./vendor-core.1762535000437.Bgda-OdR.js";import{B as ee,s as te,E as fr,i as Xr,j as Qr,k as $r,l as Jr,m as Wr,n as Ze,c as Mr,u as W,C as nc,T as ui,a as hi,b as Zr,L as gn,I as Pn,d as sc,M as ac,o as ic,p as cs}from"./trading-core.1762535000437.DnzyQB8l.js";import{v as Ds,G as la,T as _e,W as da,K as gs,t as fa,N as ua,X as oc,O as cc,A as qr,D as Fn,H as lc,R as dc,Q as fc,S as uc,d as Yt,F as xi,V as hc,Y as xc,$ as ha,a0 as pc,a1 as xa,M as bc,Z as en,r as gc,z as mc,c as yc,a2 as wc,m as Ac,a3 as Ec,a4 as Nc,_ as nr}from"./trading-orders-wrapper.1762535000437.DPkFLRPe.js";import{D as vc,I as Ic,S as Cc,b as Ot,d as kc,M as Pc}from"./chart-features.1762535000437.DOiEfRjp.js";import{a as Tc,N as Sc}from"./trading-feeds.1762535000437.BWHCg6Pu.js";import{C as Oc}from"./vendor-crypto.1762535000437.DsYnvCMO.js";import{A as Bc,R as Rc}from"./trading-advanced-orders.1762535000437.bFHsgY-2.js";const pi=T.memo(()=>{const[r,e]=T.useState(!1),[t,n]=T.useState(!1);return T.useEffect(()=>{const s=()=>{n(window.scrollY>20)};return window.addEventListener("scroll",s),()=>window.removeEventListener("scroll",s)},[]),c.jsx("nav",{className:`fixed top-0 left-0 right-0 z-50 transition-all duration-500 ${t?"bg-black/90 backdrop-blur-3xl border-b border-cyan-500/20 shadow-2xl shadow-cyan-500/10":"bg-black/70 backdrop-blur-xl border-b border-cyan-500/10"}`,children:c.jsxs("div",{className:"mx-auto max-w-[2000px] px-4 sm:px-6 lg:px-8",children:[c.jsxs("div",{className:"flex h-16 items-center justify-between",children:[c.jsxs(fi,{to:"/",className:"flex items-center gap-3 group",children:[c.jsxs("div",{className:"relative flex h-10 w-10 items-center justify-center rounded-xl bg-gradient-to-br from-cyan-500/30 to-blue-600/30 shadow-2xl shadow-cyan-500/30 ring-1 ring-cyan-500/40 backdrop-blur-xl transition-all duration-300 group-hover:ring-cyan-400/60 group-hover:shadow-cyan-400/40",children:[c.jsx(Ds,{className:"h-5 w-5 text-cyan-400"}),c.jsx("div",{className:"absolute inset-0 rounded-xl bg-gradient-to-br from-cyan-400/0 to-cyan-400/20 opacity-0 transition-opacity duration-300 group-hover:opacity-100"})]}),c.jsxs("div",{children:[c.jsx("h1",{className:"bg-gradient-to-r from-cyan-400 via-blue-400 to-purple-400 bg-clip-text text-xl font-black tracking-tight text-transparent",children:"NEXUS TRADE"}),c.jsx("p",{className:"text-[9px] font-semibold text-cyan-400/60 uppercase tracking-widest",children:"Pro Trading Suite"})]})]}),c.jsxs("div",{className:"hidden md:flex items-center gap-6",children:[c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsxs(ee,{variant:"ghost",size:"sm",className:"text-cyan-400/80 hover:text-cyan-400 hover:bg-cyan-500/10 transition-all duration-300",children:[c.jsx(la,{className:"h-4 w-4 mr-2"}),"Markets"]}),c.jsxs(ee,{variant:"ghost",size:"sm",className:"text-cyan-400/80 hover:text-cyan-400 hover:bg-cyan-500/10 transition-all duration-300",children:[c.jsx(_e,{className:"h-4 w-4 mr-2"}),"Analytics"]}),c.jsxs(ee,{variant:"ghost",size:"sm",className:"text-cyan-400/80 hover:text-cyan-400 hover:bg-cyan-500/10 transition-all duration-300",children:[c.jsx(da,{className:"h-4 w-4 mr-2"}),"Portfolio"]})]}),c.jsxs("div",{className:"flex items-center gap-3 pl-4 border-l border-cyan-500/20",children:[c.jsxs(ee,{variant:"ghost",size:"sm",className:"relative text-cyan-400/80 hover:text-cyan-400 hover:bg-cyan-500/10 transition-all duration-300",children:[c.jsx(gs,{className:"h-4 w-4"}),c.jsx("div",{className:"absolute -top-1 -right-1 h-2 w-2 bg-red-500 rounded-full animate-pulse"})]}),c.jsx(ee,{variant:"ghost",size:"sm",className:"text-cyan-400/80 hover:text-cyan-400 hover:bg-cyan-500/10 transition-all duration-300",children:c.jsx(fa,{className:"h-4 w-4"})}),c.jsx(ee,{variant:"ghost",size:"sm",className:"text-cyan-400/80 hover:text-cyan-400 hover:bg-cyan-500/10 transition-all duration-300",children:c.jsx(ua,{className:"h-4 w-4"})})]})]}),c.jsx("button",{onClick:()=>e(!r),className:"md:hidden p-2 rounded-lg bg-cyan-500/10 border border-cyan-500/30 hover:bg-cyan-500/20 transition-all duration-300",children:r?c.jsx(oc,{className:"h-5 w-5 text-cyan-400"}):c.jsx(cc,{className:"h-5 w-5 text-cyan-400"})})]}),r&&c.jsxs("div",{className:"md:hidden py-4 space-y-3 animate-fade-in border-t border-cyan-500/20",children:[c.jsxs(ee,{variant:"ghost",className:"w-full justify-start text-cyan-400/80 hover:text-cyan-400 hover:bg-cyan-500/10",children:[c.jsx(la,{className:"h-4 w-4 mr-3"}),"Markets"]}),c.jsxs(ee,{variant:"ghost",className:"w-full justify-start text-cyan-400/80 hover:text-cyan-400 hover:bg-cyan-500/10",children:[c.jsx(_e,{className:"h-4 w-4 mr-3"}),"Analytics"]}),c.jsxs(ee,{variant:"ghost",className:"w-full justify-start text-cyan-400/80 hover:text-cyan-400 hover:bg-cyan-500/10",children:[c.jsx(da,{className:"h-4 w-4 mr-3"}),"Portfolio"]}),c.jsxs("div",{className:"border-t border-cyan-500/20 pt-3",children:[c.jsxs(ee,{variant:"ghost",className:"w-full justify-start text-cyan-400/80 hover:text-cyan-400 hover:bg-cyan-500/10",children:[c.jsx(gs,{className:"h-4 w-4 mr-3"}),"Notifications"]}),c.jsxs(ee,{variant:"ghost",className:"w-full justify-start text-cyan-400/80 hover:text-cyan-400 hover:bg-cyan-500/10",children:[c.jsx(fa,{className:"h-4 w-4 mr-3"}),"Settings"]}),c.jsxs(ee,{variant:"ghost",className:"w-full justify-start text-cyan-400/80 hover:text-cyan-400 hover:bg-cyan-500/10",children:[c.jsx(ua,{className:"h-4 w-4 mr-3"}),"Profile"]})]})]})]})})});pi.displayName="Navbar";function Uc({exchange:r,symbol:e,source:t,symbols:n,onExchangeChange:s,onSymbolChange:a,onSourceChange:i,onRefresh:o}){const[l,d]=T.useState(null);T.useEffect(()=>{te.auth.getSession().then(({data:{session:h}})=>{d((h==null?void 0:h.user)??null)});const{data:{subscription:u}}=te.auth.onAuthStateChange((h,g)=>{d((g==null?void 0:g.user)??null)});return()=>u.unsubscribe()},[]);const f=fr[r];return c.jsxs("header",{className:"group relative overflow-hidden",children:[c.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4 p-4",children:[c.jsxs("div",{className:"flex items-center gap-6",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-gradient-to-br from-cyan-500/30 to-blue-600/30 shadow-lg shadow-cyan-500/30 ring-1 ring-cyan-500/40",children:c.jsx(qr,{className:"h-5 w-5 text-cyan-400"})}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-lg font-bold text-cyan-400",children:f.name}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-cyan-400/60",children:[c.jsx(Xr,{variant:"secondary",className:"bg-cyan-500/10 text-cyan-400 border-cyan-500/20",children:f.type}),c.jsx("span",{children:"•"}),c.jsx("span",{children:f.region})]})]})]}),c.jsxs("div",{className:"hidden md:flex items-center gap-4 text-xs",children:[c.jsxs("div",{className:"flex items-center gap-1 text-cyan-400/80",children:[c.jsx(Fn,{className:"h-3 w-3"}),c.jsxs("span",{children:["Vol: ",f.volume24h]})]}),c.jsxs("div",{className:"flex items-center gap-1 text-cyan-400/80",children:[c.jsx(_e,{className:"h-3 w-3"}),c.jsxs("span",{children:[f.pairs," pairs"]})]}),c.jsxs("div",{className:"flex items-center gap-1 text-cyan-400/80",children:[c.jsx(lc,{className:"h-3 w-3"}),c.jsxs("span",{children:["Fee: ",f.fees]})]})]})]}),c.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[c.jsx("div",{className:"flex items-center gap-2",children:c.jsxs(Qr,{value:r,onValueChange:u=>s(u),children:[c.jsx($r,{className:"w-[160px] bg-black/40 border-cyan-500/20 text-cyan-400",children:c.jsx(Jr,{})}),c.jsx(Wr,{className:"bg-black/90 border-cyan-500/20",children:Object.keys(fr).map(u=>c.jsx(Ze,{value:u,className:"text-cyan-400 focus:bg-cyan-500/10",children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Xr,{variant:"outline",className:"text-xs border-cyan-500/30 text-cyan-400/80",children:fr[u].type}),fr[u].name]})},u))})]})}),c.jsx("div",{className:"flex items-center gap-2",children:c.jsxs(Qr,{value:e,onValueChange:a,children:[c.jsx($r,{className:"w-[120px] bg-black/40 border-cyan-500/20 text-cyan-400",children:c.jsx(Jr,{})}),c.jsx(Wr,{className:"bg-black/90 border-cyan-500/20",children:n.map(u=>c.jsx(Ze,{value:u,className:"text-cyan-400 focus:bg-cyan-500/10",children:u.toUpperCase()},u))})]})}),c.jsx("div",{className:"flex items-center gap-2",children:c.jsxs(Qr,{value:t,onValueChange:u=>i(u),children:[c.jsx($r,{className:"w-[100px] bg-black/40 border-cyan-500/20 text-cyan-400",children:c.jsx(Jr,{})}),c.jsxs(Wr,{className:"bg-black/90 border-cyan-500/20",children:[c.jsx(Ze,{value:"ws",className:"text-cyan-400 focus:bg-cyan-500/10",children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"h-2 w-2 bg-green-500 rounded-full animate-pulse"}),"WebSocket"]})}),c.jsx(Ze,{value:"rest",className:"text-cyan-400 focus:bg-cyan-500/10",children:"REST"})]})]})}),c.jsx(ee,{onClick:o,size:"sm",variant:"outline",className:"bg-black/40 border-cyan-500/20 text-cyan-400 hover:bg-cyan-500/10 hover:border-cyan-400/40",children:c.jsx(dc,{className:"h-4 w-4"})}),!l&&c.jsx(fi,{to:"/auth",children:c.jsxs(ee,{size:"sm",className:"bg-gradient-to-r from-cyan-500 to-blue-600 hover:from-cyan-400 hover:to-blue-500 text-black font-semibold",children:[c.jsx(fc,{className:"mr-2 h-4 w-4"}),"Sign In"]})})]})]}),c.jsx("div",{className:"md:hidden border-t border-cyan-500/20 p-3",children:c.jsxs("div",{className:"flex items-center justify-between text-xs",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsxs("div",{className:"flex items-center gap-1 text-cyan-400/80",children:[c.jsx(Fn,{className:"h-3 w-3"}),c.jsx("span",{children:f.volume24h})]}),c.jsxs("div",{className:"flex items-center gap-1 text-cyan-400/80",children:[c.jsx(_e,{className:"h-3 w-3"}),c.jsxs("span",{children:[f.pairs," pairs"]})]})]}),c.jsxs("div",{className:"text-cyan-400/60",children:["Fee: ",f.fees]})]})})]})}const Fc="wss://stream.binance.com:9443/ws",Dc="https://api.binance.com/api/v3",Lc=r=>{const[e,t]=T.useState(new Map),[n,s]=T.useState(!0),a=T.useCallback(async()=>{try{s(!0);const o=r.map(async f=>{const u=f.replace("/","").toUpperCase(),h=await fetch(`${Dc}/ticker/24hr?symbol=${u}USDT`);if(!h.ok)return{symbol:f,price:Math.random()*7e4+1e4,change24h:(Math.random()-.5)*10,volume:Math.random()*1e9,high24h:Math.random()*75e3+15e3,low24h:Math.random()*65e3+5e3};const g=await h.json();return{symbol:f,price:parseFloat(g.lastPrice),change24h:parseFloat(g.priceChangePercent),volume:parseFloat(g.volume),high24h:parseFloat(g.highPrice),low24h:parseFloat(g.lowPrice)}}),l=await Promise.all(o),d=new Map(l.map(f=>[f.symbol,f]));t(d)}catch(o){console.error("Error fetching initial prices:",o);const l=new Map(r.map(d=>[d,{symbol:d,price:Math.random()*7e4+1e4,change24h:(Math.random()-.5)*10,volume:Math.random()*1e9,high24h:Math.random()*75e3+15e3,low24h:Math.random()*65e3+5e3}]));t(l)}finally{s(!1)}},[r]);T.useEffect(()=>{a();const o=r.map(u=>`${u.replace("/","").toLowerCase()}usdt@ticker`),l=`${Fc}/${o.join("/")}`;let d;try{d=new WebSocket(l),d.onmessage=u=>{try{const h=JSON.parse(u.data);(Array.isArray(h)?h:[h]).forEach(x=>{if(x.s){const p=x.s.replace("USDT","").toUpperCase();t(m=>{const y=new Map(m);return y.set(p,{symbol:p,price:parseFloat(x.c),change24h:parseFloat(x.P),volume:parseFloat(x.v),high24h:parseFloat(x.h),low24h:parseFloat(x.l)}),y})}})}catch(h){console.error("WebSocket message error:",h)}},d.onerror=()=>{console.error("WebSocket error, using polling fallback")}}catch(u){console.error("WebSocket connection error:",u)}const f=setInterval(()=>{a()},1e4);return()=>{d&&d.close(),clearInterval(f)}},[r,a]);const i=T.useCallback(o=>e.get(o),[e]);return{prices:e,loading:n,getPrice:i}};function jc({symbols:r,activeSymbol:e,onSymbolClick:t}){const[n,s]=T.useState([]),[a,i]=T.useState(!1),[o,l]=T.useState(new Set),{prices:d,getPrice:f}=Lc(r);T.useEffect(()=>{u()},[]);const u=async()=>{try{const{data:{user:x}}=await te.auth.getUser();if(!x)return;const{data:p,error:m}=await te.from("user_watchlist").select("symbol, is_favorite").eq("user_id",x.id);if(m)throw m;const y=new Set((p==null?void 0:p.filter(A=>A.is_favorite).map(A=>A.symbol))||[]);l(y)}catch(x){console.error("Error fetching watchlist:",x)}};T.useEffect(()=>{const x=r.map(p=>{const m=f(p);return{symbol:p,price:(m==null?void 0:m.price)||0,change24h:(m==null?void 0:m.change24h)||0,volume:(m==null?void 0:m.volume)||0,isFavorite:o.has(p)}});s(x)},[r,d,o,f]);const h=async(x,p)=>{p.stopPropagation();try{const{data:{user:m}}=await te.auth.getUser();if(!m){W.error("Please login to add favorites");return}if(o.has(x)){const{error:A}=await te.from("user_watchlist").delete().eq("user_id",m.id).eq("symbol",x);if(A)throw A;l(N=>{const I=new Set(N);return I.delete(x),I}),W.success(`${x} removed from favorites`)}else{const{error:A}=await te.from("user_watchlist").insert({user_id:m.id,symbol:x,is_favorite:!0});if(A)throw A;l(N=>new Set(N).add(x)),W.success(`${x} added to favorites`)}}catch(m){console.error("Error toggling favorite:",m),W.error("Failed to update favorites")}},g=a?n:n.slice(0,6);return c.jsxs("div",{className:"space-y-3 animate-fade-in",children:[c.jsxs("div",{className:"relative overflow-hidden rounded-xl bg-gradient-to-r from-primary/10 via-cyan-500/10 to-primary/10 border border-primary/20 p-3",children:[c.jsx("div",{className:"absolute inset-0 bg-grid-pattern opacity-5"}),c.jsxs("div",{className:"relative z-10 flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"p-1.5 rounded-lg bg-primary/20 backdrop-blur-sm",children:c.jsx(qr,{className:"w-4 h-4 text-primary animate-pulse"})}),c.jsx("h3",{className:"text-sm font-bold tracking-wide text-foreground",children:"Elite Watchlist"})]}),c.jsx(ee,{variant:"ghost",size:"sm",className:"h-7 gap-1 text-xs hover:bg-primary/20",onClick:()=>i(!a),children:a?"Show Less":`+${n.length-6}`})]})]}),c.jsx("div",{className:"grid grid-cols-1 gap-2",children:g.map(x=>{const p=x.symbol===e,m=x.change24h>=0;return c.jsxs("div",{onClick:()=>t(x.symbol),className:Mr("relative overflow-hidden rounded-xl border p-4 transition-all duration-300 cursor-pointer group",p?"bg-gradient-to-r from-primary/20 via-cyan-500/20 to-primary/20 border-primary/50 shadow-xl shadow-primary/30 scale-[1.02]":"border-border/40 bg-card/20 hover:border-primary/40 hover:bg-card/40 hover:scale-[1.01]"),children:[p&&c.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-white/10 via-transparent to-white/5 animate-shimmer"}),c.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-gradient-to-br from-primary/10 to-transparent rounded-full blur-2xl"}),c.jsxs("div",{className:"relative z-10 space-y-2",children:[c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"p-1 rounded bg-primary/10",children:c.jsx("span",{className:"font-mono text-xs font-bold text-foreground",children:x.symbol.toUpperCase()})}),c.jsx(uc,{className:Mr("w-3.5 h-3.5 cursor-pointer transition-all duration-300",x.isFavorite?"fill-yellow-500 text-yellow-500 scale-110":"text-muted-foreground hover:text-yellow-500 hover:scale-110"),onClick:y=>h(x.symbol,y)})]}),c.jsxs(Xr,{variant:m?"default":"destructive",className:Mr("text-[10px] font-bold flex items-center gap-1",m?"bg-success/20 text-success border-success/30":"bg-destructive/20 text-destructive border-destructive/30"),children:[m?c.jsx(_e,{className:"w-3 h-3"}):c.jsx(Yt,{className:"w-3 h-3"}),m?"+":"",x.change24h.toFixed(2),"%"]})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("div",{className:"flex items-baseline gap-2",children:c.jsxs("span",{className:"text-2xl font-bold text-foreground tracking-tight",children:["$",x.price.toFixed(2)]})}),c.jsxs("div",{className:"flex items-center justify-between text-xs",children:[c.jsxs("span",{className:"text-muted-foreground flex items-center gap-1",children:[c.jsx(qr,{className:"w-3 h-3"}),"Vol: $",(x.volume/1e6).toFixed(1),"M"]}),x.isFavorite&&c.jsx(Xr,{variant:"outline",className:"text-[9px] bg-yellow-500/10 text-yellow-500 border-yellow-500/30",children:"Favorite"})]})]}),c.jsx("div",{className:"h-10 opacity-0 group-hover:opacity-100 transition-all duration-300 mt-2",children:c.jsx("div",{className:Mr("h-full rounded-lg bg-gradient-to-r relative overflow-hidden",m?"from-success/10 via-success/20 to-success/10":"from-destructive/10 via-destructive/20 to-destructive/10"),children:c.jsx("div",{className:"absolute inset-0 flex items-end justify-around p-1",children:[...Array(12)].map((y,A)=>c.jsx("div",{className:Mr("w-1 rounded-full",m?"bg-success/40":"bg-destructive/40"),style:{height:`${Math.random()*100}%`}},A))})})})]})]},x.symbol)})})]})}const Mc=["1m","5m","15m","1h","4h","1d","1w"],Gc=({selected:r,onChange:e})=>c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(xi,{className:"w-4 h-4 text-primary"}),c.jsx("h3",{className:"text-sm font-semibold text-foreground uppercase tracking-wide",children:"Timeframe"})]}),c.jsx("div",{className:"grid grid-cols-4 gap-2",children:Mc.map(t=>c.jsx(ee,{variant:r===t?"default":"outline",size:"sm",onClick:()=>e(t),className:`h-8 transition-all ${r===t?"shadow-lg shadow-primary/20":"hover:border-primary/30"}`,children:t},t))})]}),_c=()=>{const[r,e]=T.useState("single"),t=[{id:"single",icon:xc,label:"Single",cols:1},{id:"dual-vertical",icon:ha,label:"Dual V",cols:2},{id:"dual-horizontal",icon:ha,label:"Dual H",cols:1,rotate:!0},{id:"quad",icon:pc,label:"Quad",cols:2}],n=s=>{var a;e(s),W.success("Layout changed",{description:(a=t.find(i=>i.id===s))==null?void 0:a.label})};return c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(hc,{className:"w-4 h-4 text-chart-4"}),c.jsx("h3",{className:"text-sm font-semibold text-foreground uppercase tracking-wide",children:"Chart Layout"})]}),c.jsx("div",{className:"grid grid-cols-4 gap-2",children:t.map(s=>c.jsxs(ee,{variant:r===s.id?"default":"outline",size:"sm",onClick:()=>n(s.id),className:`flex-col h-auto py-3 gap-1 transition-all ${r===s.id?"ring-2 ring-primary":""}`,children:[c.jsx(s.icon,{className:`w-4 h-4 ${s.rotate?"rotate-90":""} ${r===s.id?"text-primary-foreground":"text-chart-4"}`}),c.jsx("span",{className:"text-[10px]",children:s.label})]},s.id))}),c.jsxs("div",{className:"p-4 rounded-lg bg-muted/20 border border-border",children:[c.jsx("div",{className:"text-xs text-muted-foreground mb-3 text-center",children:"Preview"}),r==="single"&&c.jsx("div",{className:"aspect-video rounded border-2 border-dashed border-primary/30 bg-primary/5 flex items-center justify-center",children:c.jsx("span",{className:"text-xs text-muted-foreground",children:"Main Chart"})}),r==="dual-vertical"&&c.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[c.jsx("div",{className:"aspect-video rounded border-2 border-dashed border-primary/30 bg-primary/5 flex items-center justify-center",children:c.jsx("span",{className:"text-xs text-muted-foreground",children:"Chart 1"})}),c.jsx("div",{className:"aspect-video rounded border-2 border-dashed border-chart-4/30 bg-chart-4/5 flex items-center justify-center",children:c.jsx("span",{className:"text-xs text-muted-foreground",children:"Chart 2"})})]}),r==="dual-horizontal"&&c.jsxs("div",{className:"grid grid-rows-2 gap-2",children:[c.jsx("div",{className:"aspect-video rounded border-2 border-dashed border-primary/30 bg-primary/5 flex items-center justify-center",children:c.jsx("span",{className:"text-xs text-muted-foreground",children:"Chart 1"})}),c.jsx("div",{className:"aspect-video rounded border-2 border-dashed border-chart-4/30 bg-chart-4/5 flex items-center justify-center",children:c.jsx("span",{className:"text-xs text-muted-foreground",children:"Chart 2"})})]}),r==="quad"&&c.jsx("div",{className:"grid grid-cols-2 grid-rows-2 gap-2",children:[1,2,3,4].map(s=>c.jsx("div",{className:`aspect-video rounded border-2 border-dashed ${s===1?"border-primary/30 bg-primary/5":s===2?"border-chart-4/30 bg-chart-4/5":s===3?"border-chart-2/30 bg-chart-2/5":"border-chart-3/30 bg-chart-3/5"} flex items-center justify-center`,children:c.jsxs("span",{className:"text-[10px] text-muted-foreground",children:["Chart ",s]})},s))})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("div",{className:"text-xs font-semibold text-muted-foreground uppercase tracking-wide",children:"Chart Assignments"}),r!=="single"&&c.jsx("div",{className:"space-y-1",children:Array.from({length:r==="quad"?4:2}).map((s,a)=>c.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg bg-muted/30 border border-border text-xs",children:[c.jsxs("span",{className:"text-muted-foreground",children:["Chart ",a+1]}),c.jsxs("select",{className:"bg-background border border-border rounded px-2 py-1 text-foreground",children:[c.jsx("option",{children:"BTC/USDT"}),c.jsx("option",{children:"ETH/USDT"}),c.jsx("option",{children:"BNB/USDT"})]})]},a))})]})]})},Hc=({patterns:r})=>{if(r.length===0)return c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(xa,{className:"w-4 h-4 text-chart-2"}),c.jsx("h3",{className:"text-sm font-semibold text-foreground uppercase tracking-wide",children:"Patterns"})]}),c.jsx("div",{className:"text-sm text-muted-foreground p-3 rounded-lg bg-muted/20",children:"No patterns detected"})]});const e=n=>n==="bullish"?_e:n==="bearish"?Yt:bc,t=n=>n==="bullish"?"text-success bg-success/10 border-success/20":n==="bearish"?"text-destructive bg-destructive/10 border-destructive/20":"text-muted-foreground bg-muted/20 border-muted/20";return c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(xa,{className:"w-4 h-4 text-chart-2"}),c.jsx("h3",{className:"text-sm font-semibold text-foreground uppercase tracking-wide",children:"Patterns"})]}),c.jsx("div",{className:"space-y-2",children:r.slice(0,5).map((n,s)=>{const a=e(n.signal);return c.jsx("div",{className:`p-3 rounded-lg border ${t(n.signal)} transition-all hover:scale-105`,children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(a,{className:"w-4 h-4 flex-shrink-0"}),c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"text-sm font-medium",children:n.name}),c.jsxs("span",{className:"text-[10px] px-2 py-0.5 rounded-full bg-background/50 uppercase",children:[(n.strength*100).toFixed(0),"%"]})]}),c.jsxs("div",{className:"text-xs text-muted-foreground mt-1 capitalize",children:[n.signal," signal"]})]})]})},s)})})]})};function Kc({candles:r,currentPrice:e,symbol:t}){var x,p;if(r.length===0)return c.jsx("div",{className:"grid grid-cols-2 gap-3",children:[1,2,3,4].map(m=>c.jsxs("div",{className:"glass-panel animate-pulse rounded-xl p-4",children:[c.jsx("div",{className:"h-4 w-20 rounded bg-muted/20"}),c.jsx("div",{className:"mt-2 h-6 w-16 rounded bg-muted/20"})]},m))});const n=r.slice(-1440),s=Math.max(...n.map(m=>m.y[1])),a=Math.min(...n.map(m=>m.y[2])),i=((x=n[0])==null?void 0:x.y[0])||e||0,o=e||((p=n[n.length-1])==null?void 0:p.y[3])||0,l=o-i,d=l/i*100,u=n.map(m=>(m.y[1]-m.y[2])*1e3).reduce((m,y)=>m+y,0),h=(s-a)/a*100,g=[{label:"24h Change",value:`${d>=0?"+":""}${d.toFixed(2)}%`,subValue:`${l>=0?"+":""}$${Math.abs(l).toFixed(2)}`,icon:d>=0?_e:Yt,color:d>=0?"text-success":"text-destructive",bgColor:d>=0?"bg-success/10":"bg-destructive/10"},{label:"24h High",value:`$${s.toFixed(2)}`,subValue:`+${((s-o)/o*100).toFixed(2)}%`,icon:_e,color:"text-primary",bgColor:"bg-primary/10"},{label:"24h Low",value:`$${a.toFixed(2)}`,subValue:`${((a-o)/o*100).toFixed(2)}%`,icon:Yt,color:"text-chart-4",bgColor:"bg-chart-4/10"},{label:"24h Volume",value:`${(u/1e6).toFixed(2)}M`,subValue:`${t.toUpperCase()}`,icon:Ds,color:"text-chart-2",bgColor:"bg-chart-2/10"},{label:"Volatility",value:`${h.toFixed(2)}%`,subValue:"Price range",icon:en,color:"text-chart-5",bgColor:"bg-chart-5/10"},{label:"Market Cap",value:"—",subValue:"N/A",icon:Fn,color:"text-muted-foreground",bgColor:"bg-muted/10"}];return c.jsxs("div",{className:"space-y-5",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"flex h-9 w-9 items-center justify-center rounded-xl bg-primary/15 ring-2 ring-primary/35 shadow-lg shadow-primary/20",children:c.jsx(qr,{className:"h-5 w-5 text-primary animate-pulse"})}),c.jsxs("div",{children:[c.jsx("h4",{className:"text-sm font-black text-foreground uppercase tracking-wide",children:"Performance Matrix"}),c.jsx("p",{className:"text-[9px] text-muted-foreground font-mono",children:"Advanced market analytics"})]})]}),c.jsx("div",{className:"grid grid-cols-2 gap-4",children:g.map((m,y)=>{const A=m.icon;return c.jsxs("div",{className:"group relative overflow-hidden rounded-xl border-2 border-border/40 bg-gradient-to-br from-card to-card/70 p-4 backdrop-blur-xl transition-all duration-500 hover:scale-[1.03] hover:border-primary/40 hover:shadow-2xl hover:shadow-primary/10 animate-fade-in-up",style:{animationDelay:`${y*50}ms`},children:[c.jsx("div",{className:"absolute top-0 left-0 right-0 h-[1px] bg-gradient-to-r from-transparent via-primary/30 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),c.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-primary/3 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),c.jsxs("div",{className:"relative z-10 flex items-start justify-between",children:[c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("div",{className:"text-[10px] font-black text-muted-foreground uppercase tracking-wider mb-2",children:m.label}),c.jsx("div",{className:`font-mono text-xl font-black ${m.color} drop-shadow-[0_0_8px_rgba(56,189,248,0.3)] mb-1`,children:m.value}),c.jsx("div",{className:"text-[10px] text-muted-foreground font-mono font-bold",children:m.subValue})]}),c.jsx("div",{className:`flex h-11 w-11 items-center justify-center rounded-xl ${m.bgColor} ring-2 ring-${m.color.replace("text-","")}/30 shadow-lg`,children:c.jsx(A,{className:`h-5 w-5 ${m.color}`})})]})]},y)})})]})}const Vc=({symbol:r,price:e})=>{const t=[{label:"Avg Trade",value:"$1,234.56",icon:Ds,change:"+2.5%",positive:!0},{label:"Trades/min",value:"48",icon:xi,change:"+12%",positive:!0},{label:"Buy Pressure",value:"65%",icon:gc,change:"+5%",positive:!0},{label:"Activity",value:"High",icon:en,change:"Trending",positive:!0}];return c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"flex h-9 w-9 items-center justify-center rounded-xl bg-primary/15 ring-2 ring-primary/35 shadow-lg shadow-primary/20",children:c.jsx(en,{className:"w-5 h-5 text-primary animate-pulse"})}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-sm font-black text-foreground uppercase tracking-wide",children:"Quick Analytics"}),c.jsx("p",{className:"text-[9px] text-muted-foreground font-mono",children:"Real-time market metrics"})]})]}),c.jsx("div",{className:"grid grid-cols-2 gap-3",children:t.map((n,s)=>c.jsxs("div",{className:"relative overflow-hidden rounded-xl border-2 border-border/40 bg-gradient-to-br from-card to-card/70 p-4 backdrop-blur-xl transition-all duration-300 hover:scale-[1.05] hover:border-primary/40 hover:shadow-xl hover:shadow-primary/10 animate-fade-in",style:{animationDelay:`${s*50}ms`},children:[c.jsx("div",{className:"absolute top-0 left-0 right-0 h-[1px] bg-gradient-to-r from-transparent via-primary/30 to-transparent"}),c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-lg bg-primary/15 ring-2 ring-primary/30",children:c.jsx(n.icon,{className:"w-4 h-4 text-primary"})}),c.jsx("span",{className:`px-2 py-0.5 rounded-lg text-[9px] font-black uppercase tracking-wider ${n.positive?"bg-success/20 text-success ring-1 ring-success/40":"bg-destructive/20 text-destructive ring-1 ring-destructive/40"}`,children:n.change})]}),c.jsx("div",{className:"text-[10px] text-muted-foreground font-bold uppercase tracking-wider mb-1.5",children:n.label}),c.jsx("div",{className:"text-lg font-black text-foreground",children:n.value})]},s))})]})},bi=T.memo(({symbols:r,activeSymbol:e,timeframe:t,indicatorSettings:n,detectedPatterns:s,candles:a,lastPrice:i,logs:o,onSymbolClick:l,onTimeframeChange:d,onApplyIndicators:f})=>c.jsxs("aside",{className:"glass-panel space-y-4 rounded-2xl p-5 shadow-2xl transition-all duration-300 hover:shadow-primary/10 animate-fade-in-up",children:[c.jsx(jc,{symbols:r,activeSymbol:e,onSymbolClick:l}),c.jsx(Gc,{selected:t,onChange:d}),c.jsx(_c,{}),c.jsx(vc,{}),c.jsx(Ic,{settings:n,onApply:f}),n.showPatterns&&c.jsx(Hc,{patterns:s}),c.jsx(Kc,{candles:a,currentPrice:i,symbol:e}),c.jsx(Vc,{symbol:e,price:i}),c.jsx(Tc,{candles:a,symbol:e})]}));bi.displayName="LeftSidebar";const ce={binance:{apiKey:"your_binance_api_key",secretKey:"your_binance_secret_key"},alphaVantage:{apiKey:"your_alpha_vantage_key"},polygon:{apiKey:"your_polygon_api_key"},finnhub:{apiKey:"your_finnhub_api_key"},oanda:{apiKey:"your_oanda_api_key",accountId:"your_oanda_account_id",environment:"practice"},coldWallets:{btc:"your_btc_cold_wallet_address",eth:"your_eth_cold_wallet_address",bsc:"your_bsc_cold_wallet_address",polygon:"your_polygon_cold_wallet_address",solana:"your_solana_cold_wallet_address",tron:"your_tron_cold_wallet_address"},trading:{enableRealTrading:!1}},zc="6.15.0";function Qc(r,e,t){const n=e.split("|").map(a=>a.trim());for(let a=0;a<n.length;a++)switch(e){case"any":return;case"bigint":case"boolean":case"number":case"string":if(typeof r===e)return}const s=new Error(`invalid value for type ${e}`);throw s.code="INVALID_ARGUMENT",s.argument=`value.${t}`,s.value=r,s}async function ms(r){const e=Object.keys(r);return(await Promise.all(e.map(n=>Promise.resolve(r[n])))).reduce((n,s,a)=>(n[e[a]]=s,n),{})}function H(r,e,t){for(let n in e){let s=e[n];const a=t?t[n]:null;a&&Qc(s,a,n),Object.defineProperty(r,n,{enumerable:!0,value:s,writable:!1})}}function ur(r,e){if(r==null)return"null";if(e==null&&(e=new Set),typeof r=="object"){if(e.has(r))return"[Circular]";e.add(r)}if(Array.isArray(r))return"[ "+r.map(t=>ur(t,e)).join(", ")+" ]";if(r instanceof Uint8Array){const t="0123456789abcdef";let n="0x";for(let s=0;s<r.length;s++)n+=t[r[s]>>4],n+=t[r[s]&15];return n}if(typeof r=="object"&&typeof r.toJSON=="function")return ur(r.toJSON(),e);switch(typeof r){case"boolean":case"number":case"symbol":return r.toString();case"bigint":return BigInt(r).toString();case"string":return JSON.stringify(r);case"object":{const t=Object.keys(r);return t.sort(),"{ "+t.map(n=>`${ur(n,e)}: ${ur(r[n],e)}`).join(", ")+" }"}}return"[ COULD NOT SERIALIZE ]"}function Sr(r,e){return r&&r.code===e}function gi(r){return Sr(r,"CALL_EXCEPTION")}function Xt(r,e,t){let n=r;{const a=[];if(t){if("message"in t||"code"in t||"name"in t)throw new Error(`value will overwrite populated values: ${ur(t)}`);for(const i in t){if(i==="shortMessage")continue;const o=t[i];a.push(i+"="+ur(o))}}a.push(`code=${e}`),a.push(`version=${zc}`),a.length&&(r+=" ("+a.join(", ")+")")}let s;switch(e){case"INVALID_ARGUMENT":s=new TypeError(r);break;case"NUMERIC_FAULT":case"BUFFER_OVERRUN":s=new RangeError(r);break;default:s=new Error(r)}return H(s,{code:e}),t&&Object.assign(s,t),s.shortMessage==null&&H(s,{shortMessage:n}),s}function U(r,e,t,n){if(!r)throw Xt(e,t,n)}function v(r,e,t,n){U(r,e,"INVALID_ARGUMENT",{argument:t,value:n})}function mi(r,e,t){t==null&&(t=""),t&&(t=": "+t),U(r>=e,"missing argument"+t,"MISSING_ARGUMENT",{count:r,expectedCount:e}),U(r<=e,"too many arguments"+t,"UNEXPECTED_ARGUMENT",{count:r,expectedCount:e})}const $c=["NFD","NFC","NFKD","NFKC"].reduce((r,e)=>{try{if("test".normalize(e)!=="test")throw new Error("bad");if(e==="NFD"&&"é".normalize("NFD")!=="é")throw new Error("broken");r.push(e)}catch{}return r},[]);function Jc(r){U($c.indexOf(r)>=0,"platform missing String.prototype.normalize","UNSUPPORTED_OPERATION",{operation:"String.prototype.normalize",info:{form:r}})}function _n(r,e,t){if(t==null&&(t=""),r!==e){let n=t,s="new";t&&(n+=".",s+=" "+t),U(!1,`private constructor; use ${n}from* methods`,"UNSUPPORTED_OPERATION",{operation:s})}}function yi(r,e,t){if(r instanceof Uint8Array)return t?new Uint8Array(r):r;if(typeof r=="string"&&r.match(/^0x(?:[0-9a-f][0-9a-f])*$/i)){const n=new Uint8Array((r.length-2)/2);let s=2;for(let a=0;a<n.length;a++)n[a]=parseInt(r.substring(s,s+2),16),s+=2;return n}v(!1,"invalid BytesLike value",e||"value",r)}function Y(r,e){return yi(r,e,!1)}function qe(r,e){return yi(r,e,!0)}function Ee(r,e){return!(typeof r!="string"||!r.match(/^0x[0-9A-Fa-f]*$/)||typeof e=="number"&&r.length!==2+2*e||e===!0&&r.length%2!==0)}function wi(r){return Ee(r,!0)||r instanceof Uint8Array}const pa="0123456789abcdef";function K(r){const e=Y(r);let t="0x";for(let n=0;n<e.length;n++){const s=e[n];t+=pa[(s&240)>>4]+pa[s&15]}return t}function Ct(r){return"0x"+r.map(e=>K(e).substring(2)).join("")}function ba(r){return Ee(r,!0)?(r.length-2)/2:Y(r).length}function cr(r,e,t){const n=Y(r);return t!=null&&t>n.length&&U(!1,"cannot slice beyond data bounds","BUFFER_OVERRUN",{buffer:n,length:n.length,offset:t}),K(n.slice(e??0,t??n.length))}function Ai(r,e,t){const n=Y(r);U(e>=n.length,"padding exceeds data length","BUFFER_OVERRUN",{buffer:new Uint8Array(n),length:e,offset:e+1});const s=new Uint8Array(e);return s.fill(0),t?s.set(n,e-n.length):s.set(n,0),K(s)}function Ei(r,e){return Ai(r,e,!0)}function Wc(r,e){return Ai(r,e,!1)}const Hn=BigInt(0),Ge=BigInt(1),hr=9007199254740991;function Zc(r,e){const t=Kn(r,"value"),n=BigInt(ne(e,"width"));if(U(t>>n===Hn,"overflow","NUMERIC_FAULT",{operation:"fromTwos",fault:"overflow",value:r}),t>>n-Ge){const s=(Ge<<n)-Ge;return-((~t&s)+Ge)}return t}function Yc(r,e){let t=re(r,"value");const n=BigInt(ne(e,"width")),s=Ge<<n-Ge;if(t<Hn){t=-t,U(t<=s,"too low","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:r});const a=(Ge<<n)-Ge;return(~t&a)+Ge}else U(t<s,"too high","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:r});return t}function mn(r,e){const t=Kn(r,"value"),n=BigInt(ne(e,"bits"));return t&(Ge<<n)-Ge}function re(r,e){switch(typeof r){case"bigint":return r;case"number":return v(Number.isInteger(r),"underflow",e||"value",r),v(r>=-hr&&r<=hr,"overflow",e||"value",r),BigInt(r);case"string":try{if(r==="")throw new Error("empty string");return r[0]==="-"&&r[1]!=="-"?-BigInt(r.substring(1)):BigInt(r)}catch(t){v(!1,`invalid BigNumberish string: ${t.message}`,e||"value",r)}}v(!1,"invalid BigNumberish value",e||"value",r)}function Kn(r,e){const t=re(r,e);return U(t>=Hn,"unsigned value cannot be negative","NUMERIC_FAULT",{fault:"overflow",operation:"getUint",value:r}),t}const ga="0123456789abcdef";function Ni(r){if(r instanceof Uint8Array){let e="0x0";for(const t of r)e+=ga[t>>4],e+=ga[t&15];return BigInt(e)}return re(r)}function ne(r,e){switch(typeof r){case"bigint":return v(r>=-hr&&r<=hr,"overflow",e||"value",r),Number(r);case"number":return v(Number.isInteger(r),"underflow",e||"value",r),v(r>=-hr&&r<=hr,"overflow",e||"value",r),r;case"string":try{if(r==="")throw new Error("empty string");return ne(BigInt(r),e)}catch(t){v(!1,`invalid numeric string: ${t.message}`,e||"value",r)}}v(!1,"invalid numeric value",e||"value",r)}function Xc(r){return ne(Ni(r))}function Vn(r,e){let n=Kn(r,"value").toString(16);if(e==null)n.length%2&&(n="0"+n);else{const s=ne(e,"width");for(U(s*2>=n.length,`value exceeds width (${s} bytes)`,"NUMERIC_FAULT",{operation:"toBeHex",fault:"overflow",value:r});n.length<s*2;)n="0"+n}return"0x"+n}function Ls(r){const e=Kn(r,"value");if(e===Hn)return new Uint8Array([]);let t=e.toString(16);t.length%2&&(t="0"+t);const n=new Uint8Array(t.length/2);for(let s=0;s<n.length;s++){const a=s*2;n[s]=parseInt(t.substring(a,a+2),16)}return n}function qc(r){let e=K(wi(r)?r:Ls(r)).substring(2);for(;e.startsWith("0");)e=e.substring(1);return e===""&&(e="0"),"0x"+e}const su=BigInt(0),au=BigInt(58);function el(r){r=atob(r);const e=new Uint8Array(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return Y(e)}function tl(r){const e=Y(r);let t="";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return btoa(t)}var mr;class rl{constructor(e,t,n){w(this,"filter");w(this,"emitter");F(this,mr);P(this,mr,t),H(this,{emitter:e,filter:n})}async removeListener(){b(this,mr)!=null&&await this.emitter.off(this.filter,b(this,mr))}}mr=new WeakMap;function nl(r,e,t,n,s){v(!1,`invalid codepoint at offset ${e}; ${r}`,"bytes",t)}function vi(r,e,t,n,s){if(r==="BAD_PREFIX"||r==="UNEXPECTED_CONTINUE"){let a=0;for(let i=e+1;i<t.length&&t[i]>>6===2;i++)a++;return a}return r==="OVERRUN"?t.length-e-1:0}function sl(r,e,t,n,s){return r==="OVERLONG"?(v(typeof s=="number","invalid bad code point for replacement","badCodepoint",s),n.push(s),0):(n.push(65533),vi(r,e,t))}const al=Object.freeze({error:nl,ignore:vi,replace:sl});function il(r,e){e==null&&(e=al.error);const t=Y(r,"bytes"),n=[];let s=0;for(;s<t.length;){const a=t[s++];if(!(a>>7)){n.push(a);continue}let i=null,o=null;if((a&224)===192)i=1,o=127;else if((a&240)===224)i=2,o=2047;else if((a&248)===240)i=3,o=65535;else{(a&192)===128?s+=e("UNEXPECTED_CONTINUE",s-1,t,n):s+=e("BAD_PREFIX",s-1,t,n);continue}if(s-1+i>=t.length){s+=e("OVERRUN",s-1,t,n);continue}let l=a&(1<<8-i-1)-1;for(let d=0;d<i;d++){let f=t[s];if((f&192)!=128){s+=e("MISSING_CONTINUE",s,t,n),l=null;break}l=l<<6|f&63,s++}if(l!==null){if(l>1114111){s+=e("OUT_OF_RANGE",s-1-i,t,n,l);continue}if(l>=55296&&l<=57343){s+=e("UTF16_SURROGATE",s-1-i,t,n,l);continue}if(l<=o){s+=e("OVERLONG",s-1-i,t,n,l);continue}n.push(l)}}return n}function pr(r,e){v(typeof r=="string","invalid string value","str",r),e!=null&&(Jc(e),r=r.normalize(e));let t=[];for(let n=0;n<r.length;n++){const s=r.charCodeAt(n);if(s<128)t.push(s);else if(s<2048)t.push(s>>6|192),t.push(s&63|128);else if((s&64512)==55296){n++;const a=r.charCodeAt(n);v(n<r.length&&(a&64512)===56320,"invalid surrogate pair","str",r);const i=65536+((s&1023)<<10)+(a&1023);t.push(i>>18|240),t.push(i>>12&63|128),t.push(i>>6&63|128),t.push(i&63|128)}else t.push(s>>12|224),t.push(s>>6&63|128),t.push(s&63|128)}return new Uint8Array(t)}function ol(r){return r.map(e=>e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode((e>>10&1023)+55296,(e&1023)+56320))).join("")}function ys(r,e){return ol(il(r,e))}function Ii(r){async function e(t,n){U(n==null||!n.cancelled,"request cancelled before sending","CANCELLED");const s=t.url.split(":")[0].toLowerCase();U(s==="http"||s==="https",`unsupported protocol ${s}`,"UNSUPPORTED_OPERATION",{info:{protocol:s},operation:"request"}),U(s==="https"||!t.credentials||t.allowInsecureAuthentication,"insecure authorized connections unsupported","UNSUPPORTED_OPERATION",{operation:"request"});let a=null;const i=new AbortController,o=setTimeout(()=>{a=Xt("request timeout","TIMEOUT"),i.abort()},t.timeout);n&&n.addListener(()=>{a=Xt("request cancelled","CANCELLED"),i.abort()});const l=Object.assign({},r,{method:t.method,headers:new Headers(Array.from(t)),body:t.body||void 0,signal:i.signal});let d;try{d=await fetch(t.url,l)}catch(g){throw clearTimeout(o),a||g}clearTimeout(o);const f={};d.headers.forEach((g,x)=>{f[x.toLowerCase()]=g});const u=await d.arrayBuffer(),h=u==null?null:new Uint8Array(u);return{statusCode:d.status,statusMessage:d.statusText,headers:f,body:h}}return e}const cl=12,ll=250;let ma=Ii();const dl=new RegExp("^data:([^;:]*)?(;base64)?,(.*)$","i"),fl=new RegExp("^ipfs://(ipfs/)?(.*)$","i");let ls=!1;async function Ci(r,e){try{const t=r.match(dl);if(!t)throw new Error("invalid data");return new kt(200,"OK",{"content-type":t[1]||"text/plain"},t[2]?el(t[3]):hl(t[3]))}catch{return new kt(599,"BAD REQUEST (invalid data: URI)",{},null,new tn(r))}}function ki(r){async function e(t,n){try{const s=t.match(fl);if(!s)throw new Error("invalid link");return new tn(`${r}${s[2]}`)}catch{return new kt(599,"BAD REQUEST (invalid IPFS URI)",{},null,new tn(t))}}return e}const yn={data:Ci,ipfs:ki("https://gateway.ipfs.io/ipfs/")},Pi=new WeakMap;var jt,At;class ul{constructor(e){F(this,jt);F(this,At);P(this,jt,[]),P(this,At,!1),Pi.set(e,()=>{if(!b(this,At)){P(this,At,!0);for(const t of b(this,jt))setTimeout(()=>{t()},0);P(this,jt,[])}})}addListener(e){U(!b(this,At),"singal already cancelled","UNSUPPORTED_OPERATION",{operation:"fetchCancelSignal.addCancelListener"}),b(this,jt).push(e)}get cancelled(){return b(this,At)}checkSignal(){U(!this.cancelled,"cancelled","CANCELLED",{})}}jt=new WeakMap,At=new WeakMap;function wn(r){if(r==null)throw new Error("missing signal; should not happen");return r.checkSignal(),r}var yr,wr,Le,st,Ar,Er,le,Ce,at,Mt,Gt,_t,ze,je,Et,Ht,Vr;const jn=class jn{constructor(e){F(this,Ht);F(this,yr);F(this,wr);F(this,Le);F(this,st);F(this,Ar);F(this,Er);F(this,le);F(this,Ce);F(this,at);F(this,Mt);F(this,Gt);F(this,_t);F(this,ze);F(this,je);F(this,Et);P(this,Er,String(e)),P(this,yr,!1),P(this,wr,!0),P(this,Le,{}),P(this,st,""),P(this,Ar,3e5),P(this,je,{slotInterval:ll,maxAttempts:cl}),P(this,Et,null)}get url(){return b(this,Er)}set url(e){P(this,Er,String(e))}get body(){return b(this,le)==null?null:new Uint8Array(b(this,le))}set body(e){if(e==null)P(this,le,void 0),P(this,Ce,void 0);else if(typeof e=="string")P(this,le,pr(e)),P(this,Ce,"text/plain");else if(e instanceof Uint8Array)P(this,le,e),P(this,Ce,"application/octet-stream");else if(typeof e=="object")P(this,le,pr(JSON.stringify(e))),P(this,Ce,"application/json");else throw new Error("invalid body")}hasBody(){return b(this,le)!=null}get method(){return b(this,st)?b(this,st):this.hasBody()?"POST":"GET"}set method(e){e==null&&(e=""),P(this,st,String(e).toUpperCase())}get headers(){const e=Object.assign({},b(this,Le));return b(this,at)&&(e.authorization=`Basic ${tl(pr(b(this,at)))}`),this.allowGzip&&(e["accept-encoding"]="gzip"),e["content-type"]==null&&b(this,Ce)&&(e["content-type"]=b(this,Ce)),this.body&&(e["content-length"]=String(this.body.length)),e}getHeader(e){return this.headers[e.toLowerCase()]}setHeader(e,t){b(this,Le)[String(e).toLowerCase()]=String(t)}clearHeaders(){P(this,Le,{})}[Symbol.iterator](){const e=this.headers,t=Object.keys(e);let n=0;return{next:()=>{if(n<t.length){const s=t[n++];return{value:[s,e[s]],done:!1}}return{value:void 0,done:!0}}}}get credentials(){return b(this,at)||null}setCredentials(e,t){v(!e.match(/:/),"invalid basic authentication username","username","[REDACTED]"),P(this,at,`${e}:${t}`)}get allowGzip(){return b(this,wr)}set allowGzip(e){P(this,wr,!!e)}get allowInsecureAuthentication(){return!!b(this,yr)}set allowInsecureAuthentication(e){P(this,yr,!!e)}get timeout(){return b(this,Ar)}set timeout(e){v(e>=0,"timeout must be non-zero","timeout",e),P(this,Ar,e)}get preflightFunc(){return b(this,Mt)||null}set preflightFunc(e){P(this,Mt,e)}get processFunc(){return b(this,Gt)||null}set processFunc(e){P(this,Gt,e)}get retryFunc(){return b(this,_t)||null}set retryFunc(e){P(this,_t,e)}get getUrlFunc(){return b(this,Et)||ma}set getUrlFunc(e){P(this,Et,e)}toString(){return`<FetchRequest method=${JSON.stringify(this.method)} url=${JSON.stringify(this.url)} headers=${JSON.stringify(this.headers)} body=${b(this,le)?K(b(this,le)):"null"}>`}setThrottleParams(e){e.slotInterval!=null&&(b(this,je).slotInterval=e.slotInterval),e.maxAttempts!=null&&(b(this,je).maxAttempts=e.maxAttempts)}send(){return U(b(this,ze)==null,"request already sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.send"}),P(this,ze,new ul(this)),Z(this,Ht,Vr).call(this,0,ya()+this.timeout,0,this,new kt(0,"",{},null,this))}cancel(){U(b(this,ze)!=null,"request has not been sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.cancel"});const e=Pi.get(this);if(!e)throw new Error("missing signal; should not happen");e()}redirect(e){const t=this.url.split(":")[0].toLowerCase(),n=e.split(":")[0].toLowerCase();U(this.method==="GET"&&(t!=="https"||n!=="http")&&e.match(/^https?:/),"unsupported redirect","UNSUPPORTED_OPERATION",{operation:`redirect(${this.method} ${JSON.stringify(this.url)} => ${JSON.stringify(e)})`});const s=new jn(e);return s.method="GET",s.allowGzip=this.allowGzip,s.timeout=this.timeout,P(s,Le,Object.assign({},b(this,Le))),b(this,le)&&P(s,le,new Uint8Array(b(this,le))),P(s,Ce,b(this,Ce)),s}clone(){const e=new jn(this.url);return P(e,st,b(this,st)),b(this,le)&&P(e,le,b(this,le)),P(e,Ce,b(this,Ce)),P(e,Le,Object.assign({},b(this,Le))),P(e,at,b(this,at)),this.allowGzip&&(e.allowGzip=!0),e.timeout=this.timeout,this.allowInsecureAuthentication&&(e.allowInsecureAuthentication=!0),P(e,Mt,b(this,Mt)),P(e,Gt,b(this,Gt)),P(e,_t,b(this,_t)),P(e,je,Object.assign({},b(this,je))),P(e,Et,b(this,Et)),e}static lockConfig(){ls=!0}static getGateway(e){return yn[e.toLowerCase()]||null}static registerGateway(e,t){if(e=e.toLowerCase(),e==="http"||e==="https")throw new Error(`cannot intercept ${e}; use registerGetUrl`);if(ls)throw new Error("gateways locked");yn[e]=t}static registerGetUrl(e){if(ls)throw new Error("gateways locked");ma=e}static createGetUrlFunc(e){return Ii(e)}static createDataGateway(){return Ci}static createIpfsGatewayFunc(e){return ki(e)}};yr=new WeakMap,wr=new WeakMap,Le=new WeakMap,st=new WeakMap,Ar=new WeakMap,Er=new WeakMap,le=new WeakMap,Ce=new WeakMap,at=new WeakMap,Mt=new WeakMap,Gt=new WeakMap,_t=new WeakMap,ze=new WeakMap,je=new WeakMap,Et=new WeakMap,Ht=new WeakSet,Vr=async function(e,t,n,s,a){var f,u,h;if(e>=b(this,je).maxAttempts)return a.makeServerError("exceeded maximum retry limit");U(ya()<=t,"timeout","TIMEOUT",{operation:"request.send",reason:"timeout",request:s}),n>0&&await xl(n);let i=this.clone();const o=(i.url.split(":")[0]||"").toLowerCase();if(o in yn){const g=await yn[o](i.url,wn(b(s,ze)));if(g instanceof kt){let x=g;if(this.processFunc){wn(b(s,ze));try{x=await this.processFunc(i,x)}catch(p){(p.throttle==null||typeof p.stall!="number")&&x.makeServerError("error in post-processing function",p).assertOk()}}return x}i=g}this.preflightFunc&&(i=await this.preflightFunc(i));const l=await this.getUrlFunc(i,wn(b(s,ze)));let d=new kt(l.statusCode,l.statusMessage,l.headers,l.body,s);if(d.statusCode===301||d.statusCode===302){try{const g=d.headers.location||"";return Z(f=i.redirect(g),Ht,Vr).call(f,e+1,t,0,s,d)}catch{}return d}else if(d.statusCode===429&&(this.retryFunc==null||await this.retryFunc(i,d,e))){const g=d.headers["retry-after"];let x=b(this,je).slotInterval*Math.trunc(Math.random()*Math.pow(2,e));return typeof g=="string"&&g.match(/^[1-9][0-9]*$/)&&(x=parseInt(g)),Z(u=i.clone(),Ht,Vr).call(u,e+1,t,x,s,d)}if(this.processFunc){wn(b(s,ze));try{d=await this.processFunc(i,d)}catch(g){(g.throttle==null||typeof g.stall!="number")&&d.makeServerError("error in post-processing function",g).assertOk();let x=b(this,je).slotInterval*Math.trunc(Math.random()*Math.pow(2,e));return g.stall>=0&&(x=g.stall),Z(h=i.clone(),Ht,Vr).call(h,e+1,t,x,s,d)}}return d};let tn=jn;var cn,ln,dn,ke,Nr,Kt;const ta=class ta{constructor(e,t,n,s,a){F(this,cn);F(this,ln);F(this,dn);F(this,ke);F(this,Nr);F(this,Kt);P(this,cn,e),P(this,ln,t),P(this,dn,Object.keys(n).reduce((i,o)=>(i[o.toLowerCase()]=String(n[o]),i),{})),P(this,ke,s==null?null:new Uint8Array(s)),P(this,Nr,a||null),P(this,Kt,{message:""})}toString(){return`<FetchResponse status=${this.statusCode} body=${b(this,ke)?K(b(this,ke)):"null"}>`}get statusCode(){return b(this,cn)}get statusMessage(){return b(this,ln)}get headers(){return Object.assign({},b(this,dn))}get body(){return b(this,ke)==null?null:new Uint8Array(b(this,ke))}get bodyText(){try{return b(this,ke)==null?"":ys(b(this,ke))}catch{U(!1,"response body is not valid UTF-8 data","UNSUPPORTED_OPERATION",{operation:"bodyText",info:{response:this}})}}get bodyJson(){try{return JSON.parse(this.bodyText)}catch{U(!1,"response body is not valid JSON","UNSUPPORTED_OPERATION",{operation:"bodyJson",info:{response:this}})}}[Symbol.iterator](){const e=this.headers,t=Object.keys(e);let n=0;return{next:()=>{if(n<t.length){const s=t[n++];return{value:[s,e[s]],done:!1}}return{value:void 0,done:!0}}}}makeServerError(e,t){let n;e?n=`CLIENT ESCALATED SERVER ERROR (${this.statusCode} ${this.statusMessage}; ${e})`:(e=`${this.statusCode} ${this.statusMessage}`,n=`CLIENT ESCALATED SERVER ERROR (${e})`);const s=new ta(599,n,this.headers,this.body,b(this,Nr)||void 0);return P(s,Kt,{message:e,error:t}),s}throwThrottleError(e,t){t==null?t=-1:v(Number.isInteger(t)&&t>=0,"invalid stall timeout","stall",t);const n=new Error(e||"throttling requests");throw H(n,{stall:t,throttle:!0}),n}getHeader(e){return this.headers[e.toLowerCase()]}hasBody(){return b(this,ke)!=null}get request(){return b(this,Nr)}ok(){return b(this,Kt).message===""&&this.statusCode>=200&&this.statusCode<300}assertOk(){if(this.ok())return;let{message:e,error:t}=b(this,Kt);e===""&&(e=`server response ${this.statusCode} ${this.statusMessage}`);let n=null;this.request&&(n=this.request.url);let s=null;try{b(this,ke)&&(s=ys(b(this,ke)))}catch{}U(!1,e,"SERVER_ERROR",{request:this.request||"unknown request",response:this,error:t,info:{requestUrl:n,responseBody:s,responseStatus:`${this.statusCode} ${this.statusMessage}`}})}};cn=new WeakMap,ln=new WeakMap,dn=new WeakMap,ke=new WeakMap,Nr=new WeakMap,Kt=new WeakMap;let kt=ta;function ya(){return new Date().getTime()}function hl(r){return pr(r.replace(/%([0-9a-f][0-9a-f])/gi,(e,t)=>String.fromCharCode(parseInt(t,16))))}function xl(r){return new Promise(e=>setTimeout(e,r))}const iu=BigInt(-1),ou=BigInt(0),cu=BigInt(1),lu=BigInt(5);let ds="0000";for(;ds.length<80;)ds+=ds;const be=32,ws=new Uint8Array(be),pl=["then"],An={},Ti=new WeakMap;function Rt(r){return Ti.get(r)}function wa(r,e){Ti.set(r,e)}function Gr(r,e){const t=new Error(`deferred error during ABI decoding triggered accessing ${r}`);throw t.error=e,t}function As(r,e,t){return r.indexOf(null)>=0?e.map((n,s)=>n instanceof Or?As(Rt(n),n,t):n):r.reduce((n,s,a)=>{let i=e.getValue(s);return s in n||(t&&i instanceof Or&&(i=As(Rt(i),i,t)),n[s]=i),n},{})}var vr;const xr=class xr extends Array{constructor(...t){const n=t[0];let s=t[1],a=(t[2]||[]).slice(),i=!0;n!==An&&(s=t,a=[],i=!1);super(s.length);F(this,vr);s.forEach((d,f)=>{this[f]=d});const o=a.reduce((d,f)=>(typeof f=="string"&&d.set(f,(d.get(f)||0)+1),d),new Map);if(wa(this,Object.freeze(s.map((d,f)=>{const u=a[f];return u!=null&&o.get(u)===1?u:null}))),P(this,vr,[]),b(this,vr)==null&&b(this,vr),!i)return;Object.freeze(this);const l=new Proxy(this,{get:(d,f,u)=>{if(typeof f=="string"){if(f.match(/^[0-9]+$/)){const g=ne(f,"%index");if(g<0||g>=this.length)throw new RangeError("out of result range");const x=d[g];return x instanceof Error&&Gr(`index ${g}`,x),x}if(pl.indexOf(f)>=0)return Reflect.get(d,f,u);const h=d[f];if(h instanceof Function)return function(...g){return h.apply(this===u?d:this,g)};if(!(f in d))return d.getValue.apply(this===u?d:this,[f])}return Reflect.get(d,f,u)}});return wa(l,Rt(this)),l}toArray(t){const n=[];return this.forEach((s,a)=>{s instanceof Error&&Gr(`index ${a}`,s),t&&s instanceof xr&&(s=s.toArray(t)),n.push(s)}),n}toObject(t){const n=Rt(this);return n.reduce((s,a,i)=>(U(a!=null,`value at index ${i} unnamed`,"UNSUPPORTED_OPERATION",{operation:"toObject()"}),As(n,this,t)),{})}slice(t,n){t==null&&(t=0),t<0&&(t+=this.length,t<0&&(t=0)),n==null&&(n=this.length),n<0&&(n+=this.length,n<0&&(n=0)),n>this.length&&(n=this.length);const s=Rt(this),a=[],i=[];for(let o=t;o<n;o++)a.push(this[o]),i.push(s[o]);return new xr(An,a,i)}filter(t,n){const s=Rt(this),a=[],i=[];for(let o=0;o<this.length;o++){const l=this[o];l instanceof Error&&Gr(`index ${o}`,l),t.call(n,l,o,this)&&(a.push(l),i.push(s[o]))}return new xr(An,a,i)}map(t,n){const s=[];for(let a=0;a<this.length;a++){const i=this[a];i instanceof Error&&Gr(`index ${a}`,i),s.push(t.call(n,i,a,this))}return s}getValue(t){const n=Rt(this).indexOf(t);if(n===-1)return;const s=this[n];return s instanceof Error&&Gr(`property ${JSON.stringify(t)}`,s.error),s}static fromItems(t,n){return new xr(An,t,n)}};vr=new WeakMap;let Or=xr;function Aa(r){let e=Ls(r);return U(e.length<=be,"value out-of-bounds","BUFFER_OVERRUN",{buffer:e,length:be,offset:e.length}),e.length!==be&&(e=qe(Ct([ws.slice(e.length%be),e]))),e}class ft{constructor(e,t,n,s){w(this,"name");w(this,"type");w(this,"localName");w(this,"dynamic");H(this,{name:e,type:t,localName:n,dynamic:s},{name:"string",type:"string",localName:"string",dynamic:"boolean"})}_throwError(e,t){v(!1,e,this.localName,t)}}var it,Vt,Ir,Tn;class Es{constructor(){F(this,Ir);F(this,it);F(this,Vt);P(this,it,[]),P(this,Vt,0)}get data(){return Ct(b(this,it))}get length(){return b(this,Vt)}appendWriter(e){return Z(this,Ir,Tn).call(this,qe(e.data))}writeBytes(e){let t=qe(e);const n=t.length%be;return n&&(t=qe(Ct([t,ws.slice(n)]))),Z(this,Ir,Tn).call(this,t)}writeValue(e){return Z(this,Ir,Tn).call(this,Aa(e))}writeUpdatableValue(){const e=b(this,it).length;return b(this,it).push(ws),P(this,Vt,b(this,Vt)+be),t=>{b(this,it)[e]=Aa(t)}}}it=new WeakMap,Vt=new WeakMap,Ir=new WeakSet,Tn=function(e){return b(this,it).push(e),P(this,Vt,b(this,Vt)+e.length),e.length};var me,Pe,zt,Qt,Nt,rr,vs,Si;const ra=class ra{constructor(e,t,n){F(this,rr);w(this,"allowLoose");F(this,me);F(this,Pe);F(this,zt);F(this,Qt);F(this,Nt);H(this,{allowLoose:!!t}),P(this,me,qe(e)),P(this,zt,0),P(this,Qt,null),P(this,Nt,n??1024),P(this,Pe,0)}get data(){return K(b(this,me))}get dataLength(){return b(this,me).length}get consumed(){return b(this,Pe)}get bytes(){return new Uint8Array(b(this,me))}subReader(e){const t=new ra(b(this,me).slice(b(this,Pe)+e),this.allowLoose,b(this,Nt));return P(t,Qt,this),t}readBytes(e,t){let n=Z(this,rr,Si).call(this,0,e,!!t);return Z(this,rr,vs).call(this,e),P(this,Pe,b(this,Pe)+n.length),n.slice(0,e)}readValue(){return Ni(this.readBytes(be))}readIndex(){return Xc(this.readBytes(be))}};me=new WeakMap,Pe=new WeakMap,zt=new WeakMap,Qt=new WeakMap,Nt=new WeakMap,rr=new WeakSet,vs=function(e){var t;if(b(this,Qt))return Z(t=b(this,Qt),rr,vs).call(t,e);P(this,zt,b(this,zt)+e),U(b(this,Nt)<1||b(this,zt)<=b(this,Nt)*this.dataLength,`compressed ABI data exceeds inflation ratio of ${b(this,Nt)} ( see: https://github.com/ethers-io/ethers.js/issues/4537 )`,"BUFFER_OVERRUN",{buffer:qe(b(this,me)),offset:b(this,Pe),length:e,info:{bytesRead:b(this,zt),dataLength:this.dataLength}})},Si=function(e,t,n){let s=Math.ceil(t/be)*be;return b(this,Pe)+s>b(this,me).length&&(this.allowLoose&&n&&b(this,Pe)+t<=b(this,me).length?s=t:U(!1,"data out-of-bounds","BUFFER_OVERRUN",{buffer:qe(b(this,me)),length:b(this,me).length,offset:b(this,Pe)+s})),b(this,me).slice(b(this,Pe),b(this,Pe)+s)};let Ns=ra;function Te(r){if(!Number.isSafeInteger(r)||r<0)throw new Error(`Wrong positive integer: ${r}`)}function js(r,...e){if(!(r instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(r.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${r.length}`)}function Oi(r){if(typeof r!="function"||typeof r.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Te(r.outputLen),Te(r.blockLen)}function Br(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function Bi(r,e){js(r);const t=e.outputLen;if(r.length<t)throw new Error(`digestInto() expects output buffer of length at least ${t}`)}const fs=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Ri=r=>r instanceof Uint8Array,Sn=r=>new Uint32Array(r.buffer,r.byteOffset,Math.floor(r.byteLength/4)),On=r=>new DataView(r.buffer,r.byteOffset,r.byteLength),Ve=(r,e)=>r<<32-e|r>>>e,bl=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!bl)throw new Error("Non little-endian hardware is not supported");const gl=async()=>{};async function Ea(r,e,t){let n=Date.now();for(let s=0;s<r;s++){t(s);const a=Date.now()-n;a>=0&&a<e||(await gl(),n+=a)}}function ml(r){if(typeof r!="string")throw new Error(`utf8ToBytes expected string, got ${typeof r}`);return new Uint8Array(new TextEncoder().encode(r))}function Rr(r){if(typeof r=="string"&&(r=ml(r)),!Ri(r))throw new Error(`expected Uint8Array, got ${typeof r}`);return r}function yl(...r){const e=new Uint8Array(r.reduce((n,s)=>n+s.length,0));let t=0;return r.forEach(n=>{if(!Ri(n))throw new Error("Uint8Array expected");e.set(n,t),t+=n.length}),e}class Ms{clone(){return this._cloneInto()}}const wl={}.toString;function Ui(r,e){if(e!==void 0&&wl.call(e)!=="[object Object]")throw new Error("Options should be object or undefined");return Object.assign(r,e)}function zn(r){const e=n=>r().update(Rr(n)).digest(),t=r();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>r(),e}function Al(r=32){if(fs&&typeof fs.getRandomValues=="function")return fs.getRandomValues(new Uint8Array(r));throw new Error("crypto.getRandomValues must be defined")}class Fi extends Ms{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,Oi(e);const n=Rr(t);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,a=new Uint8Array(s);a.set(n.length>s?e.create().update(n).digest():n);for(let i=0;i<a.length;i++)a[i]^=54;this.iHash.update(a),this.oHash=e.create();for(let i=0;i<a.length;i++)a[i]^=106;this.oHash.update(a),a.fill(0)}update(e){return Br(this),this.iHash.update(e),this}digestInto(e){Br(this),js(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:n,finished:s,destroyed:a,blockLen:i,outputLen:o}=this;return e=e,e.finished=s,e.destroyed=a,e.blockLen=i,e.outputLen=o,e.oHash=t._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const Qn=(r,e,t)=>new Fi(r,e).update(t).digest();Qn.create=(r,e)=>new Fi(r,e);function El(r,e,t,n){Oi(r);const s=Ui({dkLen:32,asyncTick:10},n),{c:a,dkLen:i,asyncTick:o}=s;if(Te(a),Te(i),Te(o),a<1)throw new Error("PBKDF2: iterations (c) should be >= 1");const l=Rr(e),d=Rr(t),f=new Uint8Array(i),u=Qn.create(r,l),h=u._cloneInto().update(d);return{c:a,dkLen:i,asyncTick:o,DK:f,PRF:u,PRFSalt:h}}function Nl(r,e,t,n,s){return r.destroy(),e.destroy(),n&&n.destroy(),s.fill(0),t}function Gs(r,e,t,n){const{c:s,dkLen:a,DK:i,PRF:o,PRFSalt:l}=El(r,e,t,n);let d;const f=new Uint8Array(4),u=On(f),h=new Uint8Array(o.outputLen);for(let g=1,x=0;x<a;g++,x+=o.outputLen){const p=i.subarray(x,x+o.outputLen);u.setInt32(0,g,!1),(d=l._cloneInto(d)).update(f).digestInto(h),p.set(h.subarray(0,p.length));for(let m=1;m<s;m++){o._cloneInto(d).update(h).digestInto(h);for(let y=0;y<p.length;y++)p[y]^=h[y]}}return Nl(o,l,i,d,h)}function vl(r,e,t,n){if(typeof r.setBigUint64=="function")return r.setBigUint64(e,t,n);const s=BigInt(32),a=BigInt(4294967295),i=Number(t>>s&a),o=Number(t&a),l=n?4:0,d=n?0:4;r.setUint32(e+l,i,n),r.setUint32(e+d,o,n)}class _s extends Ms{constructor(e,t,n,s){super(),this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=On(this.buffer)}update(e){Br(this);const{view:t,buffer:n,blockLen:s}=this;e=Rr(e);const a=e.length;for(let i=0;i<a;){const o=Math.min(s-this.pos,a-i);if(o===s){const l=On(e);for(;s<=a-i;i+=s)this.process(l,i);continue}n.set(e.subarray(i,i+o),this.pos),this.pos+=o,i+=o,this.pos===s&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Br(this),Bi(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:s,isLE:a}=this;let{pos:i}=this;t[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>s-i&&(this.process(n,0),i=0);for(let u=i;u<s;u++)t[u]=0;vl(n,s-8,BigInt(this.length*8),a),this.process(n,0);const o=On(e),l=this.outputLen;if(l%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const d=l/4,f=this.get();if(d>f.length)throw new Error("_sha2: outputLen bigger than state");for(let u=0;u<d;u++)o.setUint32(4*u,f[u],a)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:s,finished:a,destroyed:i,pos:o}=this;return e.length=s,e.pos=o,e.finished=a,e.destroyed=i,s%t&&e.buffer.set(n),e}}const Il=(r,e,t)=>r&e^~r&t,Cl=(r,e,t)=>r&e^r&t^e&t,kl=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),pt=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),bt=new Uint32Array(64);class Pl extends _s{constructor(){super(64,32,8,!1),this.A=pt[0]|0,this.B=pt[1]|0,this.C=pt[2]|0,this.D=pt[3]|0,this.E=pt[4]|0,this.F=pt[5]|0,this.G=pt[6]|0,this.H=pt[7]|0}get(){const{A:e,B:t,C:n,D:s,E:a,F:i,G:o,H:l}=this;return[e,t,n,s,a,i,o,l]}set(e,t,n,s,a,i,o,l){this.A=e|0,this.B=t|0,this.C=n|0,this.D=s|0,this.E=a|0,this.F=i|0,this.G=o|0,this.H=l|0}process(e,t){for(let u=0;u<16;u++,t+=4)bt[u]=e.getUint32(t,!1);for(let u=16;u<64;u++){const h=bt[u-15],g=bt[u-2],x=Ve(h,7)^Ve(h,18)^h>>>3,p=Ve(g,17)^Ve(g,19)^g>>>10;bt[u]=p+bt[u-7]+x+bt[u-16]|0}let{A:n,B:s,C:a,D:i,E:o,F:l,G:d,H:f}=this;for(let u=0;u<64;u++){const h=Ve(o,6)^Ve(o,11)^Ve(o,25),g=f+h+Il(o,l,d)+kl[u]+bt[u]|0,p=(Ve(n,2)^Ve(n,13)^Ve(n,22))+Cl(n,s,a)|0;f=d,d=l,l=o,o=i+g|0,i=a,a=s,s=n,n=g+p|0}n=n+this.A|0,s=s+this.B|0,a=a+this.C|0,i=i+this.D|0,o=o+this.E|0,l=l+this.F|0,d=d+this.G|0,f=f+this.H|0,this.set(n,s,a,i,o,l,d,f)}roundClean(){bt.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const Lr=zn(()=>new Pl),En=BigInt(2**32-1),Is=BigInt(32);function Di(r,e=!1){return e?{h:Number(r&En),l:Number(r>>Is&En)}:{h:Number(r>>Is&En)|0,l:Number(r&En)|0}}function Li(r,e=!1){let t=new Uint32Array(r.length),n=new Uint32Array(r.length);for(let s=0;s<r.length;s++){const{h:a,l:i}=Di(r[s],e);[t[s],n[s]]=[a,i]}return[t,n]}const Tl=(r,e)=>BigInt(r>>>0)<<Is|BigInt(e>>>0),Sl=(r,e,t)=>r>>>t,Ol=(r,e,t)=>r<<32-t|e>>>t,Bl=(r,e,t)=>r>>>t|e<<32-t,Rl=(r,e,t)=>r<<32-t|e>>>t,Ul=(r,e,t)=>r<<64-t|e>>>t-32,Fl=(r,e,t)=>r>>>t-32|e<<64-t,Dl=(r,e)=>e,Ll=(r,e)=>r,ji=(r,e,t)=>r<<t|e>>>32-t,Mi=(r,e,t)=>e<<t|r>>>32-t,Gi=(r,e,t)=>e<<t-32|r>>>64-t,_i=(r,e,t)=>r<<t-32|e>>>64-t;function jl(r,e,t,n){const s=(e>>>0)+(n>>>0);return{h:r+t+(s/2**32|0)|0,l:s|0}}const Ml=(r,e,t)=>(r>>>0)+(e>>>0)+(t>>>0),Gl=(r,e,t,n)=>e+t+n+(r/2**32|0)|0,_l=(r,e,t,n)=>(r>>>0)+(e>>>0)+(t>>>0)+(n>>>0),Hl=(r,e,t,n,s)=>e+t+n+s+(r/2**32|0)|0,Kl=(r,e,t,n,s)=>(r>>>0)+(e>>>0)+(t>>>0)+(n>>>0)+(s>>>0),Vl=(r,e,t,n,s,a)=>e+t+n+s+a+(r/2**32|0)|0,_={fromBig:Di,split:Li,toBig:Tl,shrSH:Sl,shrSL:Ol,rotrSH:Bl,rotrSL:Rl,rotrBH:Ul,rotrBL:Fl,rotr32H:Dl,rotr32L:Ll,rotlSH:ji,rotlSL:Mi,rotlBH:Gi,rotlBL:_i,add:jl,add3L:Ml,add3H:Gl,add4L:_l,add4H:Hl,add5H:Vl,add5L:Kl},[zl,Ql]=_.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(r=>BigInt(r))),gt=new Uint32Array(80),mt=new Uint32Array(80);class $l extends _s{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:t,Bh:n,Bl:s,Ch:a,Cl:i,Dh:o,Dl:l,Eh:d,El:f,Fh:u,Fl:h,Gh:g,Gl:x,Hh:p,Hl:m}=this;return[e,t,n,s,a,i,o,l,d,f,u,h,g,x,p,m]}set(e,t,n,s,a,i,o,l,d,f,u,h,g,x,p,m){this.Ah=e|0,this.Al=t|0,this.Bh=n|0,this.Bl=s|0,this.Ch=a|0,this.Cl=i|0,this.Dh=o|0,this.Dl=l|0,this.Eh=d|0,this.El=f|0,this.Fh=u|0,this.Fl=h|0,this.Gh=g|0,this.Gl=x|0,this.Hh=p|0,this.Hl=m|0}process(e,t){for(let N=0;N<16;N++,t+=4)gt[N]=e.getUint32(t),mt[N]=e.getUint32(t+=4);for(let N=16;N<80;N++){const I=gt[N-15]|0,E=mt[N-15]|0,C=_.rotrSH(I,E,1)^_.rotrSH(I,E,8)^_.shrSH(I,E,7),O=_.rotrSL(I,E,1)^_.rotrSL(I,E,8)^_.shrSL(I,E,7),k=gt[N-2]|0,D=mt[N-2]|0,M=_.rotrSH(k,D,19)^_.rotrBH(k,D,61)^_.shrSH(k,D,6),j=_.rotrSL(k,D,19)^_.rotrBL(k,D,61)^_.shrSL(k,D,6),J=_.add4L(O,j,mt[N-7],mt[N-16]),L=_.add4H(J,C,M,gt[N-7],gt[N-16]);gt[N]=L|0,mt[N]=J|0}let{Ah:n,Al:s,Bh:a,Bl:i,Ch:o,Cl:l,Dh:d,Dl:f,Eh:u,El:h,Fh:g,Fl:x,Gh:p,Gl:m,Hh:y,Hl:A}=this;for(let N=0;N<80;N++){const I=_.rotrSH(u,h,14)^_.rotrSH(u,h,18)^_.rotrBH(u,h,41),E=_.rotrSL(u,h,14)^_.rotrSL(u,h,18)^_.rotrBL(u,h,41),C=u&g^~u&p,O=h&x^~h&m,k=_.add5L(A,E,O,Ql[N],mt[N]),D=_.add5H(k,y,I,C,zl[N],gt[N]),M=k|0,j=_.rotrSH(n,s,28)^_.rotrBH(n,s,34)^_.rotrBH(n,s,39),J=_.rotrSL(n,s,28)^_.rotrBL(n,s,34)^_.rotrBL(n,s,39),L=n&a^n&o^a&o,X=s&i^s&l^i&l;y=p|0,A=m|0,p=g|0,m=x|0,g=u|0,x=h|0,{h:u,l:h}=_.add(d|0,f|0,D|0,M|0),d=o|0,f=l|0,o=a|0,l=i|0,a=n|0,i=s|0;const S=_.add3L(M,J,X);n=_.add3H(S,D,j,L),s=S|0}({h:n,l:s}=_.add(this.Ah|0,this.Al|0,n|0,s|0)),{h:a,l:i}=_.add(this.Bh|0,this.Bl|0,a|0,i|0),{h:o,l}=_.add(this.Ch|0,this.Cl|0,o|0,l|0),{h:d,l:f}=_.add(this.Dh|0,this.Dl|0,d|0,f|0),{h:u,l:h}=_.add(this.Eh|0,this.El|0,u|0,h|0),{h:g,l:x}=_.add(this.Fh|0,this.Fl|0,g|0,x|0),{h:p,l:m}=_.add(this.Gh|0,this.Gl|0,p|0,m|0),{h:y,l:A}=_.add(this.Hh|0,this.Hl|0,y|0,A|0),this.set(n,s,a,i,o,l,d,f,u,h,g,x,p,m,y,A)}roundClean(){gt.fill(0),mt.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const Hs=zn(()=>new $l);function Jl(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")}const Na=Jl(),va=Na.crypto||Na.msCrypto;function Wl(r){switch(r){case"sha256":return Lr.create();case"sha512":return Hs.create()}v(!1,"invalid hashing algorithm name","algorithm",r)}function Zl(r,e){const t={sha256:Lr,sha512:Hs}[r];return v(t!=null,"invalid hmac algorithm","algorithm",r),Qn.create(t,e)}function Yl(r,e,t,n,s){const a={sha256:Lr,sha512:Hs}[s];return v(a!=null,"invalid pbkdf2 algorithm","algorithm",s),Gs(a,r,e,{c:t,dkLen:n})}function Xl(r){U(va!=null,"platform does not support secure random numbers","UNSUPPORTED_OPERATION",{operation:"randomBytes"}),v(Number.isInteger(r)&&r>0&&r<=1024,"invalid length","length",r);const e=new Uint8Array(r);return va.getRandomValues(e),e}let Hi=!1;const Ki=function(r,e,t){return Zl(r,e).update(t).digest()};let Vi=Ki;function $n(r,e,t){const n=Y(e,"key"),s=Y(t,"data");return K(Vi(r,n,s))}$n._=Ki;$n.lock=function(){Hi=!0};$n.register=function(r){if(Hi)throw new Error("computeHmac is locked");Vi=r};Object.freeze($n);const[zi,Qi,$i]=[[],[],[]],ql=BigInt(0),_r=BigInt(1),e0=BigInt(2),t0=BigInt(7),r0=BigInt(256),n0=BigInt(113);for(let r=0,e=_r,t=1,n=0;r<24;r++){[t,n]=[n,(2*t+3*n)%5],zi.push(2*(5*n+t)),Qi.push((r+1)*(r+2)/2%64);let s=ql;for(let a=0;a<7;a++)e=(e<<_r^(e>>t0)*n0)%r0,e&e0&&(s^=_r<<(_r<<BigInt(a))-_r);$i.push(s)}const[s0,a0]=Li($i,!0),Ia=(r,e,t)=>t>32?Gi(r,e,t):ji(r,e,t),Ca=(r,e,t)=>t>32?_i(r,e,t):Mi(r,e,t);function i0(r,e=24){const t=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let i=0;i<10;i++)t[i]=r[i]^r[i+10]^r[i+20]^r[i+30]^r[i+40];for(let i=0;i<10;i+=2){const o=(i+8)%10,l=(i+2)%10,d=t[l],f=t[l+1],u=Ia(d,f,1)^t[o],h=Ca(d,f,1)^t[o+1];for(let g=0;g<50;g+=10)r[i+g]^=u,r[i+g+1]^=h}let s=r[2],a=r[3];for(let i=0;i<24;i++){const o=Qi[i],l=Ia(s,a,o),d=Ca(s,a,o),f=zi[i];s=r[f],a=r[f+1],r[f]=l,r[f+1]=d}for(let i=0;i<50;i+=10){for(let o=0;o<10;o++)t[o]=r[i+o];for(let o=0;o<10;o++)r[i+o]^=~t[(o+2)%10]&t[(o+4)%10]}r[0]^=s0[n],r[1]^=a0[n]}t.fill(0)}class Ks extends Ms{constructor(e,t,n,s=!1,a=24){if(super(),this.blockLen=e,this.suffix=t,this.outputLen=n,this.enableXOF=s,this.rounds=a,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,Te(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=Sn(this.state)}keccak(){i0(this.state32,this.rounds),this.posOut=0,this.pos=0}update(e){Br(this);const{blockLen:t,state:n}=this;e=Rr(e);const s=e.length;for(let a=0;a<s;){const i=Math.min(t-this.pos,s-a);for(let o=0;o<i;o++)n[this.pos++]^=e[a++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:n,blockLen:s}=this;e[n]^=t,t&128&&n===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){Br(this,!1),js(e),this.finish();const t=this.state,{blockLen:n}=this;for(let s=0,a=e.length;s<a;){this.posOut>=n&&this.keccak();const i=Math.min(n-this.posOut,a-s);e.set(t.subarray(this.posOut,this.posOut+i),s),this.posOut+=i,s+=i}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return Te(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(Bi(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:t,suffix:n,outputLen:s,rounds:a,enableXOF:i}=this;return e||(e=new Ks(t,n,s,i,a)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=a,e.suffix=n,e.outputLen=s,e.enableXOF=i,e.destroyed=this.destroyed,e}}const o0=(r,e,t)=>zn(()=>new Ks(e,r,t)),c0=o0(1,136,256/8);let Ji=!1;const Wi=function(r){return c0(r)};let Zi=Wi;function Pt(r){const e=Y(r,"data");return K(Zi(e))}Pt._=Wi;Pt.lock=function(){Ji=!0};Pt.register=function(r){if(Ji)throw new TypeError("keccak256 is locked");Zi=r};Object.freeze(Pt);const l0=new Uint8Array([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),Yi=Uint8Array.from({length:16},(r,e)=>e),d0=Yi.map(r=>(9*r+5)%16);let Vs=[Yi],zs=[d0];for(let r=0;r<4;r++)for(let e of[Vs,zs])e.push(e[r].map(t=>l0[t]));const Xi=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map(r=>new Uint8Array(r)),f0=Vs.map((r,e)=>r.map(t=>Xi[e][t])),u0=zs.map((r,e)=>r.map(t=>Xi[e][t])),h0=new Uint32Array([0,1518500249,1859775393,2400959708,2840853838]),x0=new Uint32Array([1352829926,1548603684,1836072691,2053994217,0]),Nn=(r,e)=>r<<e|r>>>32-e;function ka(r,e,t,n){return r===0?e^t^n:r===1?e&t|~e&n:r===2?(e|~t)^n:r===3?e&n|t&~n:e^(t|~n)}const vn=new Uint32Array(16);class p0 extends _s{constructor(){super(64,20,8,!0),this.h0=1732584193,this.h1=-271733879,this.h2=-1732584194,this.h3=271733878,this.h4=-1009589776}get(){const{h0:e,h1:t,h2:n,h3:s,h4:a}=this;return[e,t,n,s,a]}set(e,t,n,s,a){this.h0=e|0,this.h1=t|0,this.h2=n|0,this.h3=s|0,this.h4=a|0}process(e,t){for(let g=0;g<16;g++,t+=4)vn[g]=e.getUint32(t,!0);let n=this.h0|0,s=n,a=this.h1|0,i=a,o=this.h2|0,l=o,d=this.h3|0,f=d,u=this.h4|0,h=u;for(let g=0;g<5;g++){const x=4-g,p=h0[g],m=x0[g],y=Vs[g],A=zs[g],N=f0[g],I=u0[g];for(let E=0;E<16;E++){const C=Nn(n+ka(g,a,o,d)+vn[y[E]]+p,N[E])+u|0;n=u,u=d,d=Nn(o,10)|0,o=a,a=C}for(let E=0;E<16;E++){const C=Nn(s+ka(x,i,l,f)+vn[A[E]]+m,I[E])+h|0;s=h,h=f,f=Nn(l,10)|0,l=i,i=C}}this.set(this.h1+o+f|0,this.h2+d+h|0,this.h3+u+s|0,this.h4+n+i|0,this.h0+a+l|0)}roundClean(){vn.fill(0)}destroy(){this.destroyed=!0,this.buffer.fill(0),this.set(0,0,0,0,0)}}const b0=zn(()=>new p0);let qi=!1;const eo=function(r){return b0(r)};let to=eo;function Jn(r){const e=Y(r,"data");return K(to(e))}Jn._=eo;Jn.lock=function(){qi=!0};Jn.register=function(r){if(qi)throw new TypeError("ripemd160 is locked");to=r};Object.freeze(Jn);let ro=!1;const no=function(r,e,t,n,s){return Yl(r,e,t,n,s)};let so=no;function Wn(r,e,t,n,s){const a=Y(r,"password"),i=Y(e,"salt");return K(so(a,i,t,n,s))}Wn._=no;Wn.lock=function(){ro=!0};Wn.register=function(r){if(ro)throw new Error("pbkdf2 is locked");so=r};Object.freeze(Wn);let ao=!1;const io=function(r){return new Uint8Array(Xl(r))};let oo=io;function Zn(r){return oo(r)}Zn._=io;Zn.lock=function(){ao=!0};Zn.register=function(r){if(ao)throw new Error("randomBytes is locked");oo=r};Object.freeze(Zn);const Q=(r,e)=>r<<e|r>>>32-e;function Pa(r,e,t,n,s,a){let i=r[e++]^t[n++],o=r[e++]^t[n++],l=r[e++]^t[n++],d=r[e++]^t[n++],f=r[e++]^t[n++],u=r[e++]^t[n++],h=r[e++]^t[n++],g=r[e++]^t[n++],x=r[e++]^t[n++],p=r[e++]^t[n++],m=r[e++]^t[n++],y=r[e++]^t[n++],A=r[e++]^t[n++],N=r[e++]^t[n++],I=r[e++]^t[n++],E=r[e++]^t[n++],C=i,O=o,k=l,D=d,M=f,j=u,J=h,L=g,X=x,S=p,B=m,G=y,z=A,V=N,q=I,ae=E;for(let he=0;he<8;he+=2)M^=Q(C+z|0,7),X^=Q(M+C|0,9),z^=Q(X+M|0,13),C^=Q(z+X|0,18),S^=Q(j+O|0,7),V^=Q(S+j|0,9),O^=Q(V+S|0,13),j^=Q(O+V|0,18),q^=Q(B+J|0,7),k^=Q(q+B|0,9),J^=Q(k+q|0,13),B^=Q(J+k|0,18),D^=Q(ae+G|0,7),L^=Q(D+ae|0,9),G^=Q(L+D|0,13),ae^=Q(G+L|0,18),O^=Q(C+D|0,7),k^=Q(O+C|0,9),D^=Q(k+O|0,13),C^=Q(D+k|0,18),J^=Q(j+M|0,7),L^=Q(J+j|0,9),M^=Q(L+J|0,13),j^=Q(M+L|0,18),G^=Q(B+S|0,7),X^=Q(G+B|0,9),S^=Q(X+G|0,13),B^=Q(S+X|0,18),z^=Q(ae+q|0,7),V^=Q(z+ae|0,9),q^=Q(V+z|0,13),ae^=Q(q+V|0,18);s[a++]=i+C|0,s[a++]=o+O|0,s[a++]=l+k|0,s[a++]=d+D|0,s[a++]=f+M|0,s[a++]=u+j|0,s[a++]=h+J|0,s[a++]=g+L|0,s[a++]=x+X|0,s[a++]=p+S|0,s[a++]=m+B|0,s[a++]=y+G|0,s[a++]=A+z|0,s[a++]=N+V|0,s[a++]=I+q|0,s[a++]=E+ae|0}function br(r,e,t,n,s){let a=n+0,i=n+16*s;for(let o=0;o<16;o++)t[i+o]=r[e+(2*s-1)*16+o];for(let o=0;o<s;o++,a+=16,e+=16)Pa(t,i,r,e,t,a),o>0&&(i+=16),Pa(t,a,r,e+=16,t,i)}function co(r,e,t){const n=Ui({dkLen:32,asyncTick:10,maxmem:1073742848},t),{N:s,r:a,p:i,dkLen:o,asyncTick:l,maxmem:d,onProgress:f}=n;if(Te(s),Te(a),Te(i),Te(o),Te(l),Te(d),f!==void 0&&typeof f!="function")throw new Error("progressCb should be function");const u=128*a,h=u/4;if(s<=1||s&s-1||s>=2**(u/8)||s>2**32)throw new Error("Scrypt: N must be larger than 1, a power of 2, less than 2^(128 * r / 8) and less than 2^32");if(i<0||i>(2**32-1)*32/u)throw new Error("Scrypt: p must be a positive integer less than or equal to ((2^32 - 1) * 32) / (128 * r)");if(o<0||o>(2**32-1)*32)throw new Error("Scrypt: dkLen should be positive integer less than or equal to (2^32 - 1) * 32");const g=u*(s+i);if(g>d)throw new Error(`Scrypt: parameters too large, ${g} (128 * r * (N + p)) > ${d} (maxmem)`);const x=Gs(Lr,r,e,{c:1,dkLen:u*i}),p=Sn(x),m=Sn(new Uint8Array(u*s)),y=Sn(new Uint8Array(u));let A=()=>{};if(f){const N=2*s*i,I=Math.max(Math.floor(N/1e4),1);let E=0;A=()=>{E++,f&&(!(E%I)||E===N)&&f(E/N)}}return{N:s,r:a,p:i,dkLen:o,blockSize32:h,V:m,B32:p,B:x,tmp:y,blockMixCb:A,asyncTick:l}}function lo(r,e,t,n,s){const a=Gs(Lr,r,t,{c:1,dkLen:e});return t.fill(0),n.fill(0),s.fill(0),a}function g0(r,e,t){const{N:n,r:s,p:a,dkLen:i,blockSize32:o,V:l,B32:d,B:f,tmp:u,blockMixCb:h}=co(r,e,t);for(let g=0;g<a;g++){const x=o*g;for(let p=0;p<o;p++)l[p]=d[x+p];for(let p=0,m=0;p<n-1;p++)br(l,m,l,m+=o,s),h();br(l,(n-1)*o,d,x,s),h();for(let p=0;p<n;p++){const m=d[x+o-16]%n;for(let y=0;y<o;y++)u[y]=d[x+y]^l[m*o+y];br(u,0,d,x,s),h()}}return lo(r,i,f,l,u)}async function m0(r,e,t){const{N:n,r:s,p:a,dkLen:i,blockSize32:o,V:l,B32:d,B:f,tmp:u,blockMixCb:h,asyncTick:g}=co(r,e,t);for(let x=0;x<a;x++){const p=o*x;for(let y=0;y<o;y++)l[y]=d[p+y];let m=0;await Ea(n-1,g,()=>{br(l,m,l,m+=o,s),h()}),br(l,(n-1)*o,d,p,s),h(),await Ea(n,g,()=>{const y=d[p+o-16]%n;for(let A=0;A<o;A++)u[A]=d[p+A]^l[y*o+A];br(u,0,d,p,s),h()})}return lo(r,i,f,l,u)}let fo=!1,uo=!1;const ho=async function(r,e,t,n,s,a,i){return await m0(r,e,{N:t,r:n,p:s,dkLen:a,onProgress:i})},xo=function(r,e,t,n,s,a){return g0(r,e,{N:t,r:n,p:s,dkLen:a})};let po=ho,bo=xo;async function Yn(r,e,t,n,s,a,i){const o=Y(r,"passwd"),l=Y(e,"salt");return K(await po(o,l,t,n,s,a,i))}Yn._=ho;Yn.lock=function(){uo=!0};Yn.register=function(r){if(uo)throw new Error("scrypt is locked");po=r};Object.freeze(Yn);function Xn(r,e,t,n,s,a){const i=Y(r,"passwd"),o=Y(e,"salt");return K(bo(i,o,t,n,s,a))}Xn._=xo;Xn.lock=function(){fo=!0};Xn.register=function(r){if(fo)throw new Error("scryptSync is locked");bo=r};Object.freeze(Xn);const go=function(r){return Wl("sha256").update(r).digest()};let mo=go,yo=!1;function pn(r){const e=Y(r,"data");return K(mo(e))}pn._=go;pn.lock=function(){yo=!0};pn.register=function(r){if(yo)throw new Error("sha256 is locked");mo=r};Object.freeze(pn);Object.freeze(pn);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const wo=BigInt(0),qn=BigInt(1),y0=BigInt(2),es=r=>r instanceof Uint8Array,w0=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));function Ur(r){if(!es(r))throw new Error("Uint8Array expected");let e="";for(let t=0;t<r.length;t++)e+=w0[r[t]];return e}function Ao(r){const e=r.toString(16);return e.length&1?`0${e}`:e}function Qs(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);return BigInt(r===""?"0":`0x${r}`)}function Fr(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);const e=r.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const t=new Uint8Array(e/2);for(let n=0;n<t.length;n++){const s=n*2,a=r.slice(s,s+2),i=Number.parseInt(a,16);if(Number.isNaN(i)||i<0)throw new Error("Invalid byte sequence");t[n]=i}return t}function Wt(r){return Qs(Ur(r))}function $s(r){if(!es(r))throw new Error("Uint8Array expected");return Qs(Ur(Uint8Array.from(r).reverse()))}function Dr(r,e){return Fr(r.toString(16).padStart(e*2,"0"))}function Js(r,e){return Dr(r,e).reverse()}function A0(r){return Fr(Ao(r))}function De(r,e,t){let n;if(typeof e=="string")try{n=Fr(e)}catch(a){throw new Error(`${r} must be valid hex string, got "${e}". Cause: ${a}`)}else if(es(e))n=Uint8Array.from(e);else throw new Error(`${r} must be hex string or Uint8Array`);const s=n.length;if(typeof t=="number"&&s!==t)throw new Error(`${r} expected ${t} bytes, got ${s}`);return n}function rn(...r){const e=new Uint8Array(r.reduce((n,s)=>n+s.length,0));let t=0;return r.forEach(n=>{if(!es(n))throw new Error("Uint8Array expected");e.set(n,t),t+=n.length}),e}function E0(r,e){if(r.length!==e.length)return!1;for(let t=0;t<r.length;t++)if(r[t]!==e[t])return!1;return!0}function N0(r){if(typeof r!="string")throw new Error(`utf8ToBytes expected string, got ${typeof r}`);return new Uint8Array(new TextEncoder().encode(r))}function v0(r){let e;for(e=0;r>wo;r>>=qn,e+=1);return e}function I0(r,e){return r>>BigInt(e)&qn}const C0=(r,e,t)=>r|(t?qn:wo)<<BigInt(e),Ws=r=>(y0<<BigInt(r-1))-qn,us=r=>new Uint8Array(r),Ta=r=>Uint8Array.from(r);function Eo(r,e,t){if(typeof r!="number"||r<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof t!="function")throw new Error("hmacFn must be a function");let n=us(r),s=us(r),a=0;const i=()=>{n.fill(1),s.fill(0),a=0},o=(...u)=>t(s,n,...u),l=(u=us())=>{s=o(Ta([0]),u),n=o(),u.length!==0&&(s=o(Ta([1]),u),n=o())},d=()=>{if(a++>=1e3)throw new Error("drbg: tried 1000 values");let u=0;const h=[];for(;u<e;){n=o();const g=n.slice();h.push(g),u+=n.length}return rn(...h)};return(u,h)=>{i(),l(u);let g;for(;!(g=h(d()));)l();return i(),g}}const k0={bigint:r=>typeof r=="bigint",function:r=>typeof r=="function",boolean:r=>typeof r=="boolean",string:r=>typeof r=="string",stringOrUint8Array:r=>typeof r=="string"||r instanceof Uint8Array,isSafeInteger:r=>Number.isSafeInteger(r),array:r=>Array.isArray(r),field:(r,e)=>e.Fp.isValid(r),hash:r=>typeof r=="function"&&Number.isSafeInteger(r.outputLen)};function bn(r,e,t={}){const n=(s,a,i)=>{const o=k0[a];if(typeof o!="function")throw new Error(`Invalid validator "${a}", expected function`);const l=r[s];if(!(i&&l===void 0)&&!o(l,r))throw new Error(`Invalid param ${String(s)}=${l} (${typeof l}), expected ${a}`)};for(const[s,a]of Object.entries(e))n(s,a,!1);for(const[s,a]of Object.entries(t))n(s,a,!0);return r}const P0=Object.freeze(Object.defineProperty({__proto__:null,bitGet:I0,bitLen:v0,bitMask:Ws,bitSet:C0,bytesToHex:Ur,bytesToNumberBE:Wt,bytesToNumberLE:$s,concatBytes:rn,createHmacDrbg:Eo,ensureBytes:De,equalBytes:E0,hexToBytes:Fr,hexToNumber:Qs,numberToBytesBE:Dr,numberToBytesLE:Js,numberToHexUnpadded:Ao,numberToVarBytesBE:A0,utf8ToBytes:N0,validateObject:bn},Symbol.toStringTag,{value:"Module"}));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const de=BigInt(0),oe=BigInt(1),Ut=BigInt(2),T0=BigInt(3),Cs=BigInt(4),Sa=BigInt(5),Oa=BigInt(8);BigInt(9);BigInt(16);function ye(r,e){const t=r%e;return t>=de?t:e+t}function S0(r,e,t){if(t<=de||e<de)throw new Error("Expected power/modulo > 0");if(t===oe)return de;let n=oe;for(;e>de;)e&oe&&(n=n*r%t),r=r*r%t,e>>=oe;return n}function Se(r,e,t){let n=r;for(;e-- >de;)n*=n,n%=t;return n}function ks(r,e){if(r===de||e<=de)throw new Error(`invert: expected positive integers, got n=${r} mod=${e}`);let t=ye(r,e),n=e,s=de,a=oe;for(;t!==de;){const o=n/t,l=n%t,d=s-a*o;n=t,t=l,s=a,a=d}if(n!==oe)throw new Error("invert: does not exist");return ye(s,e)}function O0(r){const e=(r-oe)/Ut;let t,n,s;for(t=r-oe,n=0;t%Ut===de;t/=Ut,n++);for(s=Ut;s<r&&S0(s,e,r)!==r-oe;s++);if(n===1){const i=(r+oe)/Cs;return function(l,d){const f=l.pow(d,i);if(!l.eql(l.sqr(f),d))throw new Error("Cannot find square root");return f}}const a=(t+oe)/Ut;return function(o,l){if(o.pow(l,e)===o.neg(o.ONE))throw new Error("Cannot find square root");let d=n,f=o.pow(o.mul(o.ONE,s),t),u=o.pow(l,a),h=o.pow(l,t);for(;!o.eql(h,o.ONE);){if(o.eql(h,o.ZERO))return o.ZERO;let g=1;for(let p=o.sqr(h);g<d&&!o.eql(p,o.ONE);g++)p=o.sqr(p);const x=o.pow(f,oe<<BigInt(d-g-1));f=o.sqr(x),u=o.mul(u,x),h=o.mul(h,f),d=g}return u}}function B0(r){if(r%Cs===T0){const e=(r+oe)/Cs;return function(n,s){const a=n.pow(s,e);if(!n.eql(n.sqr(a),s))throw new Error("Cannot find square root");return a}}if(r%Oa===Sa){const e=(r-Sa)/Oa;return function(n,s){const a=n.mul(s,Ut),i=n.pow(a,e),o=n.mul(s,i),l=n.mul(n.mul(o,Ut),i),d=n.mul(o,n.sub(l,n.ONE));if(!n.eql(n.sqr(d),s))throw new Error("Cannot find square root");return d}}return O0(r)}const R0=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function U0(r){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},t=R0.reduce((n,s)=>(n[s]="function",n),e);return bn(r,t)}function F0(r,e,t){if(t<de)throw new Error("Expected power > 0");if(t===de)return r.ONE;if(t===oe)return e;let n=r.ONE,s=e;for(;t>de;)t&oe&&(n=r.mul(n,s)),s=r.sqr(s),t>>=oe;return n}function D0(r,e){const t=new Array(e.length),n=e.reduce((a,i,o)=>r.is0(i)?a:(t[o]=a,r.mul(a,i)),r.ONE),s=r.inv(n);return e.reduceRight((a,i,o)=>r.is0(i)?a:(t[o]=r.mul(a,t[o]),r.mul(a,i)),s),t}function No(r,e){const t=e!==void 0?e:r.toString(2).length,n=Math.ceil(t/8);return{nBitLength:t,nByteLength:n}}function L0(r,e,t=!1,n={}){if(r<=de)throw new Error(`Expected Field ORDER > 0, got ${r}`);const{nBitLength:s,nByteLength:a}=No(r,e);if(a>2048)throw new Error("Field lengths over 2048 bytes are not supported");const i=B0(r),o=Object.freeze({ORDER:r,BITS:s,BYTES:a,MASK:Ws(s),ZERO:de,ONE:oe,create:l=>ye(l,r),isValid:l=>{if(typeof l!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof l}`);return de<=l&&l<r},is0:l=>l===de,isOdd:l=>(l&oe)===oe,neg:l=>ye(-l,r),eql:(l,d)=>l===d,sqr:l=>ye(l*l,r),add:(l,d)=>ye(l+d,r),sub:(l,d)=>ye(l-d,r),mul:(l,d)=>ye(l*d,r),pow:(l,d)=>F0(o,l,d),div:(l,d)=>ye(l*ks(d,r),r),sqrN:l=>l*l,addN:(l,d)=>l+d,subN:(l,d)=>l-d,mulN:(l,d)=>l*d,inv:l=>ks(l,r),sqrt:n.sqrt||(l=>i(o,l)),invertBatch:l=>D0(o,l),cmov:(l,d,f)=>f?d:l,toBytes:l=>t?Js(l,a):Dr(l,a),fromBytes:l=>{if(l.length!==a)throw new Error(`Fp.fromBytes: expected ${a}, got ${l.length}`);return t?$s(l):Wt(l)}});return Object.freeze(o)}function vo(r){if(typeof r!="bigint")throw new Error("field order must be bigint");const e=r.toString(2).length;return Math.ceil(e/8)}function Io(r){const e=vo(r);return e+Math.ceil(e/2)}function j0(r,e,t=!1){const n=r.length,s=vo(e),a=Io(e);if(n<16||n<a||n>1024)throw new Error(`expected ${a}-1024 bytes of input, got ${n}`);const i=t?Wt(r):$s(r),o=ye(i,e-oe)+oe;return t?Js(o,s):Dr(o,s)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const M0=BigInt(0),hs=BigInt(1);function G0(r,e){const t=(s,a)=>{const i=a.negate();return s?i:a},n=s=>{const a=Math.ceil(e/s)+1,i=2**(s-1);return{windows:a,windowSize:i}};return{constTimeNegate:t,unsafeLadder(s,a){let i=r.ZERO,o=s;for(;a>M0;)a&hs&&(i=i.add(o)),o=o.double(),a>>=hs;return i},precomputeWindow(s,a){const{windows:i,windowSize:o}=n(a),l=[];let d=s,f=d;for(let u=0;u<i;u++){f=d,l.push(f);for(let h=1;h<o;h++)f=f.add(d),l.push(f);d=f.double()}return l},wNAF(s,a,i){const{windows:o,windowSize:l}=n(s);let d=r.ZERO,f=r.BASE;const u=BigInt(2**s-1),h=2**s,g=BigInt(s);for(let x=0;x<o;x++){const p=x*l;let m=Number(i&u);i>>=g,m>l&&(m-=h,i+=hs);const y=p,A=p+Math.abs(m)-1,N=x%2!==0,I=m<0;m===0?f=f.add(t(N,a[y])):d=d.add(t(I,a[A]))}return{p:d,f}},wNAFCached(s,a,i,o){const l=s._WINDOW_SIZE||1;let d=a.get(s);return d||(d=this.precomputeWindow(s,l),l!==1&&a.set(s,o(d))),this.wNAF(l,d,i)}}}function Co(r){return U0(r.Fp),bn(r,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...No(r.n,r.nBitLength),...r,p:r.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function _0(r){const e=Co(r);bn(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:t,Fp:n,a:s}=e;if(t){if(!n.eql(s,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof t!="object"||typeof t.beta!="bigint"||typeof t.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}const{bytesToNumberBE:H0,hexToBytes:K0}=P0,Dt={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(r){const{Err:e}=Dt;if(r.length<2||r[0]!==2)throw new e("Invalid signature integer tag");const t=r[1],n=r.subarray(2,t+2);if(!t||n.length!==t)throw new e("Invalid signature integer: wrong length");if(n[0]&128)throw new e("Invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new e("Invalid signature integer: unnecessary leading zero");return{d:H0(n),l:r.subarray(t+2)}},toSig(r){const{Err:e}=Dt,t=typeof r=="string"?K0(r):r;if(!(t instanceof Uint8Array))throw new Error("ui8a expected");let n=t.length;if(n<2||t[0]!=48)throw new e("Invalid signature tag");if(t[1]!==n-2)throw new e("Invalid signature: incorrect length");const{d:s,l:a}=Dt._parseInt(t.subarray(2)),{d:i,l:o}=Dt._parseInt(a);if(o.length)throw new e("Invalid signature: left bytes after parsing");return{r:s,s:i}},hexFromSig(r){const e=d=>Number.parseInt(d[0],16)&8?"00"+d:d,t=d=>{const f=d.toString(16);return f.length&1?`0${f}`:f},n=e(t(r.s)),s=e(t(r.r)),a=n.length/2,i=s.length/2,o=t(a),l=t(i);return`30${t(i+a+4)}02${l}${s}02${o}${n}`}},ot=BigInt(0),Be=BigInt(1);BigInt(2);const Ba=BigInt(3);BigInt(4);function V0(r){const e=_0(r),{Fp:t}=e,n=e.toBytes||((x,p,m)=>{const y=p.toAffine();return rn(Uint8Array.from([4]),t.toBytes(y.x),t.toBytes(y.y))}),s=e.fromBytes||(x=>{const p=x.subarray(1),m=t.fromBytes(p.subarray(0,t.BYTES)),y=t.fromBytes(p.subarray(t.BYTES,2*t.BYTES));return{x:m,y}});function a(x){const{a:p,b:m}=e,y=t.sqr(x),A=t.mul(y,x);return t.add(t.add(A,t.mul(x,p)),m)}if(!t.eql(t.sqr(e.Gy),a(e.Gx)))throw new Error("bad generator point: equation left != right");function i(x){return typeof x=="bigint"&&ot<x&&x<e.n}function o(x){if(!i(x))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function l(x){const{allowedPrivateKeyLengths:p,nByteLength:m,wrapPrivateKey:y,n:A}=e;if(p&&typeof x!="bigint"){if(x instanceof Uint8Array&&(x=Ur(x)),typeof x!="string"||!p.includes(x.length))throw new Error("Invalid key");x=x.padStart(m*2,"0")}let N;try{N=typeof x=="bigint"?x:Wt(De("private key",x,m))}catch{throw new Error(`private key must be ${m} bytes, hex or bigint, not ${typeof x}`)}return y&&(N=ye(N,A)),o(N),N}const d=new Map;function f(x){if(!(x instanceof u))throw new Error("ProjectivePoint expected")}class u{constructor(p,m,y){if(this.px=p,this.py=m,this.pz=y,p==null||!t.isValid(p))throw new Error("x required");if(m==null||!t.isValid(m))throw new Error("y required");if(y==null||!t.isValid(y))throw new Error("z required")}static fromAffine(p){const{x:m,y}=p||{};if(!p||!t.isValid(m)||!t.isValid(y))throw new Error("invalid affine point");if(p instanceof u)throw new Error("projective point not allowed");const A=N=>t.eql(N,t.ZERO);return A(m)&&A(y)?u.ZERO:new u(m,y,t.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(p){const m=t.invertBatch(p.map(y=>y.pz));return p.map((y,A)=>y.toAffine(m[A])).map(u.fromAffine)}static fromHex(p){const m=u.fromAffine(s(De("pointHex",p)));return m.assertValidity(),m}static fromPrivateKey(p){return u.BASE.multiply(l(p))}_setWindowSize(p){this._WINDOW_SIZE=p,d.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!t.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:p,y:m}=this.toAffine();if(!t.isValid(p)||!t.isValid(m))throw new Error("bad point: x or y not FE");const y=t.sqr(m),A=a(p);if(!t.eql(y,A))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:p}=this.toAffine();if(t.isOdd)return!t.isOdd(p);throw new Error("Field doesn't support isOdd")}equals(p){f(p);const{px:m,py:y,pz:A}=this,{px:N,py:I,pz:E}=p,C=t.eql(t.mul(m,E),t.mul(N,A)),O=t.eql(t.mul(y,E),t.mul(I,A));return C&&O}negate(){return new u(this.px,t.neg(this.py),this.pz)}double(){const{a:p,b:m}=e,y=t.mul(m,Ba),{px:A,py:N,pz:I}=this;let E=t.ZERO,C=t.ZERO,O=t.ZERO,k=t.mul(A,A),D=t.mul(N,N),M=t.mul(I,I),j=t.mul(A,N);return j=t.add(j,j),O=t.mul(A,I),O=t.add(O,O),E=t.mul(p,O),C=t.mul(y,M),C=t.add(E,C),E=t.sub(D,C),C=t.add(D,C),C=t.mul(E,C),E=t.mul(j,E),O=t.mul(y,O),M=t.mul(p,M),j=t.sub(k,M),j=t.mul(p,j),j=t.add(j,O),O=t.add(k,k),k=t.add(O,k),k=t.add(k,M),k=t.mul(k,j),C=t.add(C,k),M=t.mul(N,I),M=t.add(M,M),k=t.mul(M,j),E=t.sub(E,k),O=t.mul(M,D),O=t.add(O,O),O=t.add(O,O),new u(E,C,O)}add(p){f(p);const{px:m,py:y,pz:A}=this,{px:N,py:I,pz:E}=p;let C=t.ZERO,O=t.ZERO,k=t.ZERO;const D=e.a,M=t.mul(e.b,Ba);let j=t.mul(m,N),J=t.mul(y,I),L=t.mul(A,E),X=t.add(m,y),S=t.add(N,I);X=t.mul(X,S),S=t.add(j,J),X=t.sub(X,S),S=t.add(m,A);let B=t.add(N,E);return S=t.mul(S,B),B=t.add(j,L),S=t.sub(S,B),B=t.add(y,A),C=t.add(I,E),B=t.mul(B,C),C=t.add(J,L),B=t.sub(B,C),k=t.mul(D,S),C=t.mul(M,L),k=t.add(C,k),C=t.sub(J,k),k=t.add(J,k),O=t.mul(C,k),J=t.add(j,j),J=t.add(J,j),L=t.mul(D,L),S=t.mul(M,S),J=t.add(J,L),L=t.sub(j,L),L=t.mul(D,L),S=t.add(S,L),j=t.mul(J,S),O=t.add(O,j),j=t.mul(B,S),C=t.mul(X,C),C=t.sub(C,j),j=t.mul(X,J),k=t.mul(B,k),k=t.add(k,j),new u(C,O,k)}subtract(p){return this.add(p.negate())}is0(){return this.equals(u.ZERO)}wNAF(p){return g.wNAFCached(this,d,p,m=>{const y=t.invertBatch(m.map(A=>A.pz));return m.map((A,N)=>A.toAffine(y[N])).map(u.fromAffine)})}multiplyUnsafe(p){const m=u.ZERO;if(p===ot)return m;if(o(p),p===Be)return this;const{endo:y}=e;if(!y)return g.unsafeLadder(this,p);let{k1neg:A,k1:N,k2neg:I,k2:E}=y.splitScalar(p),C=m,O=m,k=this;for(;N>ot||E>ot;)N&Be&&(C=C.add(k)),E&Be&&(O=O.add(k)),k=k.double(),N>>=Be,E>>=Be;return A&&(C=C.negate()),I&&(O=O.negate()),O=new u(t.mul(O.px,y.beta),O.py,O.pz),C.add(O)}multiply(p){o(p);let m=p,y,A;const{endo:N}=e;if(N){const{k1neg:I,k1:E,k2neg:C,k2:O}=N.splitScalar(m);let{p:k,f:D}=this.wNAF(E),{p:M,f:j}=this.wNAF(O);k=g.constTimeNegate(I,k),M=g.constTimeNegate(C,M),M=new u(t.mul(M.px,N.beta),M.py,M.pz),y=k.add(M),A=D.add(j)}else{const{p:I,f:E}=this.wNAF(m);y=I,A=E}return u.normalizeZ([y,A])[0]}multiplyAndAddUnsafe(p,m,y){const A=u.BASE,N=(E,C)=>C===ot||C===Be||!E.equals(A)?E.multiplyUnsafe(C):E.multiply(C),I=N(this,m).add(N(p,y));return I.is0()?void 0:I}toAffine(p){const{px:m,py:y,pz:A}=this,N=this.is0();p==null&&(p=N?t.ONE:t.inv(A));const I=t.mul(m,p),E=t.mul(y,p),C=t.mul(A,p);if(N)return{x:t.ZERO,y:t.ZERO};if(!t.eql(C,t.ONE))throw new Error("invZ was invalid");return{x:I,y:E}}isTorsionFree(){const{h:p,isTorsionFree:m}=e;if(p===Be)return!0;if(m)return m(u,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:p,clearCofactor:m}=e;return p===Be?this:m?m(u,this):this.multiplyUnsafe(e.h)}toRawBytes(p=!0){return this.assertValidity(),n(u,this,p)}toHex(p=!0){return Ur(this.toRawBytes(p))}}u.BASE=new u(e.Gx,e.Gy,t.ONE),u.ZERO=new u(t.ZERO,t.ONE,t.ZERO);const h=e.nBitLength,g=G0(u,e.endo?Math.ceil(h/2):h);return{CURVE:e,ProjectivePoint:u,normPrivateKeyToScalar:l,weierstrassEquation:a,isWithinCurveOrder:i}}function z0(r){const e=Co(r);return bn(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function Q0(r){const e=z0(r),{Fp:t,n}=e,s=t.BYTES+1,a=2*t.BYTES+1;function i(S){return ot<S&&S<t.ORDER}function o(S){return ye(S,n)}function l(S){return ks(S,n)}const{ProjectivePoint:d,normPrivateKeyToScalar:f,weierstrassEquation:u,isWithinCurveOrder:h}=V0({...e,toBytes(S,B,G){const z=B.toAffine(),V=t.toBytes(z.x),q=rn;return G?q(Uint8Array.from([B.hasEvenY()?2:3]),V):q(Uint8Array.from([4]),V,t.toBytes(z.y))},fromBytes(S){const B=S.length,G=S[0],z=S.subarray(1);if(B===s&&(G===2||G===3)){const V=Wt(z);if(!i(V))throw new Error("Point is not on curve");const q=u(V);let ae=t.sqrt(q);const he=(ae&Be)===Be;return(G&1)===1!==he&&(ae=t.neg(ae)),{x:V,y:ae}}else if(B===a&&G===4){const V=t.fromBytes(z.subarray(0,t.BYTES)),q=t.fromBytes(z.subarray(t.BYTES,2*t.BYTES));return{x:V,y:q}}else throw new Error(`Point of length ${B} was invalid. Expected ${s} compressed bytes or ${a} uncompressed bytes`)}}),g=S=>Ur(Dr(S,e.nByteLength));function x(S){const B=n>>Be;return S>B}function p(S){return x(S)?o(-S):S}const m=(S,B,G)=>Wt(S.slice(B,G));class y{constructor(B,G,z){this.r=B,this.s=G,this.recovery=z,this.assertValidity()}static fromCompact(B){const G=e.nByteLength;return B=De("compactSignature",B,G*2),new y(m(B,0,G),m(B,G,2*G))}static fromDER(B){const{r:G,s:z}=Dt.toSig(De("DER",B));return new y(G,z)}assertValidity(){if(!h(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!h(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(B){return new y(this.r,this.s,B)}recoverPublicKey(B){const{r:G,s:z,recovery:V}=this,q=O(De("msgHash",B));if(V==null||![0,1,2,3].includes(V))throw new Error("recovery id invalid");const ae=V===2||V===3?G+e.n:G;if(ae>=t.ORDER)throw new Error("recovery id 2 or 3 invalid");const he=V&1?"03":"02",ut=d.fromHex(he+g(ae)),ht=l(ae),sr=o(-q*ht),jr=o(z*ht),xt=d.BASE.multiplyAndAddUnsafe(ut,sr,jr);if(!xt)throw new Error("point at infinify");return xt.assertValidity(),xt}hasHighS(){return x(this.s)}normalizeS(){return this.hasHighS()?new y(this.r,o(-this.s),this.recovery):this}toDERRawBytes(){return Fr(this.toDERHex())}toDERHex(){return Dt.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Fr(this.toCompactHex())}toCompactHex(){return g(this.r)+g(this.s)}}const A={isValidPrivateKey(S){try{return f(S),!0}catch{return!1}},normPrivateKeyToScalar:f,randomPrivateKey:()=>{const S=Io(e.n);return j0(e.randomBytes(S),e.n)},precompute(S=8,B=d.BASE){return B._setWindowSize(S),B.multiply(BigInt(3)),B}};function N(S,B=!0){return d.fromPrivateKey(S).toRawBytes(B)}function I(S){const B=S instanceof Uint8Array,G=typeof S=="string",z=(B||G)&&S.length;return B?z===s||z===a:G?z===2*s||z===2*a:S instanceof d}function E(S,B,G=!0){if(I(S))throw new Error("first arg must be private key");if(!I(B))throw new Error("second arg must be public key");return d.fromHex(B).multiply(f(S)).toRawBytes(G)}const C=e.bits2int||function(S){const B=Wt(S),G=S.length*8-e.nBitLength;return G>0?B>>BigInt(G):B},O=e.bits2int_modN||function(S){return o(C(S))},k=Ws(e.nBitLength);function D(S){if(typeof S!="bigint")throw new Error("bigint expected");if(!(ot<=S&&S<k))throw new Error(`bigint expected < 2^${e.nBitLength}`);return Dr(S,e.nByteLength)}function M(S,B,G=j){if(["recovered","canonical"].some(St=>St in G))throw new Error("sign() legacy options not supported");const{hash:z,randomBytes:V}=e;let{lowS:q,prehash:ae,extraEntropy:he}=G;q==null&&(q=!0),S=De("msgHash",S),ae&&(S=De("prehashed msgHash",z(S)));const ut=O(S),ht=f(B),sr=[D(ht),D(ut)];if(he!=null){const St=he===!0?V(t.BYTES):he;sr.push(De("extraEntropy",St))}const jr=rn(...sr),xt=ut;function is(St){const ar=C(St);if(!h(ar))return;const sa=l(ar),ir=d.BASE.multiply(ar).toAffine(),Ue=o(ir.x);if(Ue===ot)return;const or=o(sa*o(xt+Ue*ht));if(or===ot)return;let aa=(ir.x===Ue?0:2)|Number(ir.y&Be),ia=or;return q&&x(or)&&(ia=p(or),aa^=1),new y(Ue,ia,aa)}return{seed:jr,k2sig:is}}const j={lowS:e.lowS,prehash:!1},J={lowS:e.lowS,prehash:!1};function L(S,B,G=j){const{seed:z,k2sig:V}=M(S,B,G),q=e;return Eo(q.hash.outputLen,q.nByteLength,q.hmac)(z,V)}d.BASE._setWindowSize(8);function X(S,B,G,z=J){var ir;const V=S;if(B=De("msgHash",B),G=De("publicKey",G),"strict"in z)throw new Error("options.strict was renamed to lowS");const{lowS:q,prehash:ae}=z;let he,ut;try{if(typeof V=="string"||V instanceof Uint8Array)try{he=y.fromDER(V)}catch(Ue){if(!(Ue instanceof Dt.Err))throw Ue;he=y.fromCompact(V)}else if(typeof V=="object"&&typeof V.r=="bigint"&&typeof V.s=="bigint"){const{r:Ue,s:or}=V;he=new y(Ue,or)}else throw new Error("PARSE");ut=d.fromHex(G)}catch(Ue){if(Ue.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(q&&he.hasHighS())return!1;ae&&(B=e.hash(B));const{r:ht,s:sr}=he,jr=O(B),xt=l(sr),is=o(jr*xt),St=o(ht*xt),ar=(ir=d.BASE.multiplyAndAddUnsafe(ut,is,St))==null?void 0:ir.toAffine();return ar?o(ar.x)===ht:!1}return{CURVE:e,getPublicKey:N,getSharedSecret:E,sign:L,verify:X,ProjectivePoint:d,Signature:y,utils:A}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function $0(r){return{hash:r,hmac:(e,...t)=>Qn(r,e,yl(...t)),randomBytes:Al}}function J0(r,e){const t=n=>Q0({...r,...$0(n)});return Object.freeze({...t(e),create:t})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ko=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),Ra=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),W0=BigInt(1),Ps=BigInt(2),Ua=(r,e)=>(r+e/Ps)/e;function Z0(r){const e=ko,t=BigInt(3),n=BigInt(6),s=BigInt(11),a=BigInt(22),i=BigInt(23),o=BigInt(44),l=BigInt(88),d=r*r*r%e,f=d*d*r%e,u=Se(f,t,e)*f%e,h=Se(u,t,e)*f%e,g=Se(h,Ps,e)*d%e,x=Se(g,s,e)*g%e,p=Se(x,a,e)*x%e,m=Se(p,o,e)*p%e,y=Se(m,l,e)*m%e,A=Se(y,o,e)*p%e,N=Se(A,t,e)*f%e,I=Se(N,i,e)*x%e,E=Se(I,n,e)*d%e,C=Se(E,Ps,e);if(!Ts.eql(Ts.sqr(C),r))throw new Error("Cannot find square root");return C}const Ts=L0(ko,void 0,void 0,{sqrt:Z0}),Y0=J0({a:BigInt(0),b:BigInt(7),Fp:Ts,n:Ra,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:r=>{const e=Ra,t=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-W0*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),s=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),a=t,i=BigInt("0x100000000000000000000000000000000"),o=Ua(a*r,e),l=Ua(-n*r,e);let d=ye(r-o*t-l*s,e),f=ye(-o*n-l*a,e);const u=d>i,h=f>i;if(u&&(d=e-d),h&&(f=e-f),d>i||f>i)throw new Error("splitScalar: Endomorphism failed, k="+r);return{k1neg:u,k1:d,k2neg:h,k2:f}}}},Lr);BigInt(0);Y0.ProjectivePoint;const Fa="0x0000000000000000000000000000000000000000000000000000000000000000";const Da=BigInt(0),La=BigInt(1),ja=BigInt(2),Ma=BigInt(27),Ga=BigInt(28),In=BigInt(35),lr={};function _a(r){return Ei(Ls(r),32)}var Cr,Qe,kr,$t;const Fe=class Fe{constructor(e,t,n,s){F(this,Cr);F(this,Qe);F(this,kr);F(this,$t);_n(e,lr,"Signature"),P(this,Cr,t),P(this,Qe,n),P(this,kr,s),P(this,$t,null)}get r(){return b(this,Cr)}set r(e){v(ba(e)===32,"invalid r","value",e),P(this,Cr,K(e))}get s(){return v(parseInt(b(this,Qe).substring(0,3))<8,"non-canonical s; use ._s","s",b(this,Qe)),b(this,Qe)}set s(e){v(ba(e)===32,"invalid s","value",e),P(this,Qe,K(e))}get _s(){return b(this,Qe)}isValid(){return parseInt(b(this,Qe).substring(0,3))<8}get v(){return b(this,kr)}set v(e){const t=ne(e,"value");v(t===27||t===28,"invalid v","v",e),P(this,kr,t)}get networkV(){return b(this,$t)}get legacyChainId(){const e=this.networkV;return e==null?null:Fe.getChainId(e)}get yParity(){return this.v===27?0:1}get yParityAndS(){const e=Y(this.s);return this.yParity&&(e[0]|=128),K(e)}get compactSerialized(){return Ct([this.r,this.yParityAndS])}get serialized(){return Ct([this.r,this.s,this.yParity?"0x1c":"0x1b"])}[Symbol.for("nodejs.util.inspect.custom")](){return`Signature { r: "${this.r}", s: "${this._s}"${this.isValid()?"":', valid: "false"'}, yParity: ${this.yParity}, networkV: ${this.networkV} }`}clone(){const e=new Fe(lr,this.r,this._s,this.v);return this.networkV&&P(e,$t,this.networkV),e}toJSON(){const e=this.networkV;return{_type:"signature",networkV:e!=null?e.toString():null,r:this.r,s:this._s,v:this.v}}static getChainId(e){const t=re(e,"v");return t==Ma||t==Ga?Da:(v(t>=In,"invalid EIP-155 v","v",e),(t-In)/ja)}static getChainIdV(e,t){return re(e)*ja+BigInt(35+t-27)}static getNormalizedV(e){const t=re(e);return t===Da||t===Ma?27:t===La||t===Ga?28:(v(t>=In,"invalid v","v",e),t&La?27:28)}static from(e){function t(d,f){v(d,f,"signature",e)}if(e==null)return new Fe(lr,Fa,Fa,27);if(typeof e=="string"){const d=Y(e,"signature");if(d.length===64){const f=K(d.slice(0,32)),u=d.slice(32,64),h=u[0]&128?28:27;return u[0]&=127,new Fe(lr,f,K(u),h)}if(d.length===65){const f=K(d.slice(0,32)),u=K(d.slice(32,64)),h=Fe.getNormalizedV(d[64]);return new Fe(lr,f,u,h)}t(!1,"invalid raw signature length")}if(e instanceof Fe)return e.clone();const n=e.r;t(n!=null,"missing r");const s=_a(n),a=function(d,f){if(d!=null)return _a(d);if(f!=null){t(Ee(f,32),"invalid yParityAndS");const u=Y(f);return u[0]&=127,K(u)}t(!1,"missing s")}(e.s,e.yParityAndS),{networkV:i,v:o}=function(d,f,u){if(d!=null){const h=re(d);return{networkV:h>=In?h:void 0,v:Fe.getNormalizedV(h)}}if(f!=null)return t(Ee(f,32),"invalid yParityAndS"),{v:Y(f)[0]&128?28:27};if(u!=null){switch(ne(u,"sig.yParity")){case 0:return{v:27};case 1:return{v:28}}t(!1,"invalid yParity")}t(!1,"missing v")}(e.v,e.yParityAndS,e.yParity),l=new Fe(lr,s,a,o);return i&&P(l,$t,i),t(e.yParity==null||ne(e.yParity,"sig.yParity")===l.yParity,"yParity mismatch"),t(e.yParityAndS==null||e.yParityAndS===l.yParityAndS,"yParityAndS mismatch"),l}};Cr=new WeakMap,Qe=new WeakMap,kr=new WeakMap,$t=new WeakMap;let Ha=Fe;const X0=BigInt(0),q0=BigInt(36);function Ka(r){r=r.toLowerCase();const e=r.substring(2).split(""),t=new Uint8Array(40);for(let s=0;s<40;s++)t[s]=e[s].charCodeAt(0);const n=Y(Pt(t));for(let s=0;s<40;s+=2)n[s>>1]>>4>=8&&(e[s]=e[s].toUpperCase()),(n[s>>1]&15)>=8&&(e[s+1]=e[s+1].toUpperCase());return"0x"+e.join("")}const Zs={};for(let r=0;r<10;r++)Zs[String(r)]=String(r);for(let r=0;r<26;r++)Zs[String.fromCharCode(65+r)]=String(10+r);const Va=15;function ed(r){r=r.toUpperCase(),r=r.substring(4)+r.substring(0,2)+"00";let e=r.split("").map(n=>Zs[n]).join("");for(;e.length>=Va;){let n=e.substring(0,Va);e=parseInt(n,10)%97+e.substring(n.length)}let t=String(98-parseInt(e,10)%97);for(;t.length<2;)t="0"+t;return t}const td=function(){const r={};for(let e=0;e<36;e++){const t="0123456789abcdefghijklmnopqrstuvwxyz"[e];r[t]=BigInt(e)}return r}();function rd(r){r=r.toLowerCase();let e=X0;for(let t=0;t<r.length;t++)e=e*q0+td[r[t]];return e}function Ne(r){if(v(typeof r=="string","invalid address","address",r),r.match(/^(0x)?[0-9a-fA-F]{40}$/)){r.startsWith("0x")||(r="0x"+r);const e=Ka(r);return v(!r.match(/([A-F].*[a-f])|([a-f].*[A-F])/)||e===r,"bad address checksum","address",r),e}if(r.match(/^XE[0-9]{2}[0-9A-Za-z]{30,31}$/)){v(r.substring(2,4)===ed(r),"bad icap checksum","address",r);let e=rd(r.substring(4)).toString(16);for(;e.length<40;)e="0"+e;return Ka("0x"+e)}v(!1,"invalid address","address",r)}function Po(r){return r&&typeof r.getAddress=="function"}async function xs(r,e){const t=await e;return(t==null||t==="0x0000000000000000000000000000000000000000")&&(U(typeof r!="string","unconfigured name","UNCONFIGURED_NAME",{value:r}),v(!1,"invalid AddressLike value; did not resolve to a value address","target",r)),Ne(t)}function nn(r,e){if(typeof r=="string")return r.match(/^0x[0-9a-f]{40}$/i)?Ne(r):(U(e!=null,"ENS resolution requires a provider","UNSUPPORTED_OPERATION",{operation:"resolveName"}),xs(r,e.resolveName(r)));if(Po(r))return xs(r,r.getAddress());if(r&&typeof r.then=="function")return xs(r,r);v(!1,"unsupported addressable value","target",r)}const tt={};function R(r,e){let t=!1;return e<0&&(t=!0,e*=-1),new pe(tt,`${t?"":"u"}int${e}`,r,{signed:t,width:e})}function $(r,e){return new pe(tt,`bytes${e||""}`,r,{size:e})}const za=Symbol.for("_ethers_typed");var Jt;const rt=class rt{constructor(e,t,n,s){w(this,"type");w(this,"value");F(this,Jt);w(this,"_typedSymbol");s==null&&(s=null),_n(tt,e,"Typed"),H(this,{_typedSymbol:za,type:t,value:n}),P(this,Jt,s),this.format()}format(){if(this.type==="array")throw new Error("");if(this.type==="dynamicArray")throw new Error("");return this.type==="tuple"?`tuple(${this.value.map(e=>e.format()).join(",")})`:this.type}defaultValue(){return 0}minValue(){return 0}maxValue(){return 0}isBigInt(){return!!this.type.match(/^u?int[0-9]+$/)}isData(){return this.type.startsWith("bytes")}isString(){return this.type==="string"}get tupleName(){if(this.type!=="tuple")throw TypeError("not a tuple");return b(this,Jt)}get arrayLength(){if(this.type!=="array")throw TypeError("not an array");return b(this,Jt)===!0?-1:b(this,Jt)===!1?this.value.length:null}static from(e,t){return new rt(tt,e,t)}static uint8(e){return R(e,8)}static uint16(e){return R(e,16)}static uint24(e){return R(e,24)}static uint32(e){return R(e,32)}static uint40(e){return R(e,40)}static uint48(e){return R(e,48)}static uint56(e){return R(e,56)}static uint64(e){return R(e,64)}static uint72(e){return R(e,72)}static uint80(e){return R(e,80)}static uint88(e){return R(e,88)}static uint96(e){return R(e,96)}static uint104(e){return R(e,104)}static uint112(e){return R(e,112)}static uint120(e){return R(e,120)}static uint128(e){return R(e,128)}static uint136(e){return R(e,136)}static uint144(e){return R(e,144)}static uint152(e){return R(e,152)}static uint160(e){return R(e,160)}static uint168(e){return R(e,168)}static uint176(e){return R(e,176)}static uint184(e){return R(e,184)}static uint192(e){return R(e,192)}static uint200(e){return R(e,200)}static uint208(e){return R(e,208)}static uint216(e){return R(e,216)}static uint224(e){return R(e,224)}static uint232(e){return R(e,232)}static uint240(e){return R(e,240)}static uint248(e){return R(e,248)}static uint256(e){return R(e,256)}static uint(e){return R(e,256)}static int8(e){return R(e,-8)}static int16(e){return R(e,-16)}static int24(e){return R(e,-24)}static int32(e){return R(e,-32)}static int40(e){return R(e,-40)}static int48(e){return R(e,-48)}static int56(e){return R(e,-56)}static int64(e){return R(e,-64)}static int72(e){return R(e,-72)}static int80(e){return R(e,-80)}static int88(e){return R(e,-88)}static int96(e){return R(e,-96)}static int104(e){return R(e,-104)}static int112(e){return R(e,-112)}static int120(e){return R(e,-120)}static int128(e){return R(e,-128)}static int136(e){return R(e,-136)}static int144(e){return R(e,-144)}static int152(e){return R(e,-152)}static int160(e){return R(e,-160)}static int168(e){return R(e,-168)}static int176(e){return R(e,-176)}static int184(e){return R(e,-184)}static int192(e){return R(e,-192)}static int200(e){return R(e,-200)}static int208(e){return R(e,-208)}static int216(e){return R(e,-216)}static int224(e){return R(e,-224)}static int232(e){return R(e,-232)}static int240(e){return R(e,-240)}static int248(e){return R(e,-248)}static int256(e){return R(e,-256)}static int(e){return R(e,-256)}static bytes1(e){return $(e,1)}static bytes2(e){return $(e,2)}static bytes3(e){return $(e,3)}static bytes4(e){return $(e,4)}static bytes5(e){return $(e,5)}static bytes6(e){return $(e,6)}static bytes7(e){return $(e,7)}static bytes8(e){return $(e,8)}static bytes9(e){return $(e,9)}static bytes10(e){return $(e,10)}static bytes11(e){return $(e,11)}static bytes12(e){return $(e,12)}static bytes13(e){return $(e,13)}static bytes14(e){return $(e,14)}static bytes15(e){return $(e,15)}static bytes16(e){return $(e,16)}static bytes17(e){return $(e,17)}static bytes18(e){return $(e,18)}static bytes19(e){return $(e,19)}static bytes20(e){return $(e,20)}static bytes21(e){return $(e,21)}static bytes22(e){return $(e,22)}static bytes23(e){return $(e,23)}static bytes24(e){return $(e,24)}static bytes25(e){return $(e,25)}static bytes26(e){return $(e,26)}static bytes27(e){return $(e,27)}static bytes28(e){return $(e,28)}static bytes29(e){return $(e,29)}static bytes30(e){return $(e,30)}static bytes31(e){return $(e,31)}static bytes32(e){return $(e,32)}static address(e){return new rt(tt,"address",e)}static bool(e){return new rt(tt,"bool",!!e)}static bytes(e){return new rt(tt,"bytes",e)}static string(e){return new rt(tt,"string",e)}static array(e,t){throw new Error("not implemented yet")}static tuple(e,t){throw new Error("not implemented yet")}static overrides(e){return new rt(tt,"overrides",Object.assign({},e))}static isTyped(e){return e&&typeof e=="object"&&"_typedSymbol"in e&&e._typedSymbol===za}static dereference(e,t){if(rt.isTyped(e)){if(e.type!==t)throw new Error(`invalid type: expecetd ${t}, got ${e.type}`);return e.value}return e}};Jt=new WeakMap;let pe=rt;class nd extends ft{constructor(e){super("address","address",e,!1)}defaultValue(){return"0x0000000000000000000000000000000000000000"}encode(e,t){let n=pe.dereference(t,"string");try{n=Ne(n)}catch(s){return this._throwError(s.message,t)}return e.writeValue(n)}decode(e){return Ne(Vn(e.readValue(),20))}}class sd extends ft{constructor(t){super(t.name,t.type,"_",t.dynamic);w(this,"coder");this.coder=t}defaultValue(){return this.coder.defaultValue()}encode(t,n){return this.coder.encode(t,n)}decode(t){return this.coder.decode(t)}}function To(r,e,t){let n=[];if(Array.isArray(t))n=t;else if(t&&typeof t=="object"){let l={};n=e.map(d=>{const f=d.localName;return U(f,"cannot encode object for signature with missing names","INVALID_ARGUMENT",{argument:"values",info:{coder:d},value:t}),U(!l[f],"cannot encode object for signature with duplicate names","INVALID_ARGUMENT",{argument:"values",info:{coder:d},value:t}),l[f]=!0,t[f]})}else v(!1,"invalid tuple value","tuple",t);v(e.length===n.length,"types/value length mismatch","tuple",t);let s=new Es,a=new Es,i=[];e.forEach((l,d)=>{let f=n[d];if(l.dynamic){let u=a.length;l.encode(a,f);let h=s.writeUpdatableValue();i.push(g=>{h(g+u)})}else l.encode(s,f)}),i.forEach(l=>{l(s.length)});let o=r.appendWriter(s);return o+=r.appendWriter(a),o}function So(r,e){let t=[],n=[],s=r.subReader(0);return e.forEach(a=>{let i=null;if(a.dynamic){let o=r.readIndex(),l=s.subReader(o);try{i=a.decode(l)}catch(d){if(Sr(d,"BUFFER_OVERRUN"))throw d;i=d,i.baseType=a.name,i.name=a.localName,i.type=a.type}}else try{i=a.decode(r)}catch(o){if(Sr(o,"BUFFER_OVERRUN"))throw o;i=o,i.baseType=a.name,i.name=a.localName,i.type=a.type}if(i==null)throw new Error("investigate");t.push(i),n.push(a.localName||null)}),Or.fromItems(t,n)}class ad extends ft{constructor(t,n,s){const a=t.type+"["+(n>=0?n:"")+"]",i=n===-1||t.dynamic;super("array",a,s,i);w(this,"coder");w(this,"length");H(this,{coder:t,length:n})}defaultValue(){const t=this.coder.defaultValue(),n=[];for(let s=0;s<this.length;s++)n.push(t);return n}encode(t,n){const s=pe.dereference(n,"array");Array.isArray(s)||this._throwError("expected array value",s);let a=this.length;a===-1&&(a=s.length,t.writeValue(s.length)),mi(s.length,a,"coder array"+(this.localName?" "+this.localName:""));let i=[];for(let o=0;o<s.length;o++)i.push(this.coder);return To(t,i,s)}decode(t){let n=this.length;n===-1&&(n=t.readIndex(),U(n*be<=t.dataLength,"insufficient data length","BUFFER_OVERRUN",{buffer:t.bytes,offset:n*be,length:t.dataLength}));let s=[];for(let a=0;a<n;a++)s.push(new sd(this.coder));return So(t,s)}}class id extends ft{constructor(e){super("bool","bool",e,!1)}defaultValue(){return!1}encode(e,t){const n=pe.dereference(t,"bool");return e.writeValue(n?1:0)}decode(e){return!!e.readValue()}}class Oo extends ft{constructor(e,t){super(e,e,t,!0)}defaultValue(){return"0x"}encode(e,t){t=qe(t);let n=e.writeValue(t.length);return n+=e.writeBytes(t),n}decode(e){return e.readBytes(e.readIndex(),!0)}}class od extends Oo{constructor(e){super("bytes",e)}decode(e){return K(super.decode(e))}}class cd extends ft{constructor(t,n){let s="bytes"+String(t);super(s,s,n,!1);w(this,"size");H(this,{size:t},{size:"number"})}defaultValue(){return"0x0000000000000000000000000000000000000000000000000000000000000000".substring(0,2+this.size*2)}encode(t,n){let s=qe(pe.dereference(n,this.type));return s.length!==this.size&&this._throwError("incorrect data length",n),t.writeBytes(s)}decode(t){return K(t.readBytes(this.size))}}const ld=new Uint8Array([]);class dd extends ft{constructor(e){super("null","",e,!1)}defaultValue(){return null}encode(e,t){return t!=null&&this._throwError("not null",t),e.writeBytes(ld)}decode(e){return e.readBytes(0),null}}const fd=BigInt(0),ud=BigInt(1),hd=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");class xd extends ft{constructor(t,n,s){const a=(n?"int":"uint")+t*8;super(a,a,s,!1);w(this,"size");w(this,"signed");H(this,{size:t,signed:n},{size:"number",signed:"boolean"})}defaultValue(){return 0}encode(t,n){let s=re(pe.dereference(n,this.type)),a=mn(hd,be*8);if(this.signed){let i=mn(a,this.size*8-1);(s>i||s<-(i+ud))&&this._throwError("value out-of-bounds",n),s=Yc(s,8*be)}else(s<fd||s>mn(a,this.size*8))&&this._throwError("value out-of-bounds",n);return t.writeValue(s)}decode(t){let n=mn(t.readValue(),this.size*8);return this.signed&&(n=Zc(n,this.size*8)),n}}class pd extends Oo{constructor(e){super("string",e)}defaultValue(){return""}encode(e,t){return super.encode(e,pr(pe.dereference(t,"string")))}decode(e){return ys(super.decode(e))}}class Cn extends ft{constructor(t,n){let s=!1;const a=[];t.forEach(o=>{o.dynamic&&(s=!0),a.push(o.type)});const i="tuple("+a.join(",")+")";super("tuple",i,n,s);w(this,"coders");H(this,{coders:Object.freeze(t.slice())})}defaultValue(){const t=[];this.coders.forEach(s=>{t.push(s.defaultValue())});const n=this.coders.reduce((s,a)=>{const i=a.localName;return i&&(s[i]||(s[i]=0),s[i]++),s},{});return this.coders.forEach((s,a)=>{let i=s.localName;!i||n[i]!==1||(i==="length"&&(i="_length"),t[i]==null&&(t[i]=t[a]))}),Object.freeze(t)}encode(t,n){const s=pe.dereference(n,"tuple");return To(t,this.coders,s)}decode(t){return So(t,this.coders)}}function ps(r,e){return{address:Ne(r),storageKeys:e.map((t,n)=>(v(Ee(t,32),"invalid slot",`storageKeys[${n}]`,t),t.toLowerCase()))}}function bd(r){if(Array.isArray(r))return r.map((t,n)=>Array.isArray(t)?(v(t.length===2,"invalid slot set",`value[${n}]`,t),ps(t[0],t[1])):(v(t!=null&&typeof t=="object","invalid address-slot set","value",r),ps(t.address,t.storageKeys)));v(r!=null&&typeof r=="object","invalid access list","value",r);const e=Object.keys(r).map(t=>{const n=r[t].reduce((s,a)=>(s[a]=!0,s),{});return ps(t,Object.keys(n).sort())});return e.sort((t,n)=>t.address.localeCompare(n.address)),e}const fu=BigInt(0),uu=BigInt(2),hu=BigInt(27),xu=BigInt(28),pu=BigInt(35),bu=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),gu=4096*32;function sn(r){return Pt(pr(r))}const gd=44032,md=4352,yd=4449,wd=4519,Bo=19,Ro=21,Uo=28,Ad=Ro*Uo,Ed=Bo*Ad,mu=gd+Ed,yu=md+Bo,wu=yd+Ro,Au=wd+Uo;const Nd=new Uint8Array(32);Nd.fill(0);const vd=new Uint8Array(32);vd.fill(0);const Eu=BigInt(-1),Id=BigInt(0),Cd=BigInt(1),Nu=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");const vu=Vn(Cd,32),Iu=Vn(Id,32);function Qa(r){return function(e){return v(typeof e=="string",`invalid domain value for ${JSON.stringify(r)}`,`domain.${r}`,e),e}}const Cu={name:Qa("name"),version:Qa("version"),chainId:function(r){const e=re(r,"domain.chainId");return v(e>=0,"invalid chain ID","domain.chainId",r),Number.isSafeInteger(e)?Number(e):qc(e)},verifyingContract:function(r){try{return Ne(r).toLowerCase()}catch{}v(!1,'invalid domain value "verifyingContract"',"domain.verifyingContract",r)},salt:function(r){const e=Y(r,"domain.salt");return v(e.length===32,'invalid domain value "salt"',"domain.salt",r),K(e)}};function ge(r){const e=new Set;return r.forEach(t=>e.add(t)),Object.freeze(e)}const kd="external public payable override",Pd=ge(kd.split(" ")),Fo="constant external internal payable private public pure view override",Td=ge(Fo.split(" ")),Do="constructor error event fallback function receive struct",Lo=ge(Do.split(" ")),jo="calldata memory storage payable indexed",Sd=ge(jo.split(" ")),Od="tuple returns",Bd=[Do,jo,Od,Fo].join(" "),Rd=ge(Bd.split(" ")),Ud={"(":"OPEN_PAREN",")":"CLOSE_PAREN","[":"OPEN_BRACKET","]":"CLOSE_BRACKET",",":"COMMA","@":"AT"},Fd=new RegExp("^(\\s*)"),Dd=new RegExp("^([0-9]+)"),Ld=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)"),Mo=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)$"),Go=new RegExp("^(address|bool|bytes([0-9]*)|string|u?int([0-9]*))$");var fe,Me,fn,Ss;const Mn=class Mn{constructor(e){F(this,fn);F(this,fe);F(this,Me);P(this,fe,0),P(this,Me,e.slice())}get offset(){return b(this,fe)}get length(){return b(this,Me).length-b(this,fe)}clone(){return new Mn(b(this,Me))}reset(){P(this,fe,0)}popKeyword(e){const t=this.peek();if(t.type!=="KEYWORD"||!e.has(t.text))throw new Error(`expected keyword ${t.text}`);return this.pop().text}popType(e){if(this.peek().type!==e){const t=this.peek();throw new Error(`expected ${e}; got ${t.type} ${JSON.stringify(t.text)}`)}return this.pop().text}popParen(){const e=this.peek();if(e.type!=="OPEN_PAREN")throw new Error("bad start");const t=Z(this,fn,Ss).call(this,b(this,fe)+1,e.match+1);return P(this,fe,e.match+1),t}popParams(){const e=this.peek();if(e.type!=="OPEN_PAREN")throw new Error("bad start");const t=[];for(;b(this,fe)<e.match-1;){const n=this.peek().linkNext;t.push(Z(this,fn,Ss).call(this,b(this,fe)+1,n)),P(this,fe,n)}return P(this,fe,e.match+1),t}peek(){if(b(this,fe)>=b(this,Me).length)throw new Error("out-of-bounds");return b(this,Me)[b(this,fe)]}peekKeyword(e){const t=this.peekType("KEYWORD");return t!=null&&e.has(t)?t:null}peekType(e){if(this.length===0)return null;const t=this.peek();return t.type===e?t.text:null}pop(){const e=this.peek();return ca(this,fe)._++,e}toString(){const e=[];for(let t=b(this,fe);t<b(this,Me).length;t++){const n=b(this,Me)[t];e.push(`${n.type}:${n.text}`)}return`<TokenString ${e.join(" ")}>`}};fe=new WeakMap,Me=new WeakMap,fn=new WeakSet,Ss=function(e=0,t=0){return new Mn(b(this,Me).slice(e,t).map(n=>Object.freeze(Object.assign({},n,{match:n.match-e,linkBack:n.linkBack-e,linkNext:n.linkNext-e}))))};let He=Mn;function Tt(r){const e=[],t=i=>{const o=a<r.length?JSON.stringify(r[a]):"$EOI";throw new Error(`invalid token ${o} at ${a}: ${i}`)};let n=[],s=[],a=0;for(;a<r.length;){let i=r.substring(a),o=i.match(Fd);o&&(a+=o[1].length,i=r.substring(a));const l={depth:n.length,linkBack:-1,linkNext:-1,match:-1,type:"",text:"",offset:a,value:-1};e.push(l);let d=Ud[i[0]]||"";if(d){if(l.type=d,l.text=i[0],a++,d==="OPEN_PAREN")n.push(e.length-1),s.push(e.length-1);else if(d=="CLOSE_PAREN")n.length===0&&t("no matching open bracket"),l.match=n.pop(),e[l.match].match=e.length-1,l.depth--,l.linkBack=s.pop(),e[l.linkBack].linkNext=e.length-1;else if(d==="COMMA")l.linkBack=s.pop(),e[l.linkBack].linkNext=e.length-1,s.push(e.length-1);else if(d==="OPEN_BRACKET")l.type="BRACKET";else if(d==="CLOSE_BRACKET"){let f=e.pop().text;if(e.length>0&&e[e.length-1].type==="NUMBER"){const u=e.pop().text;f=u+f,e[e.length-1].value=ne(u)}if(e.length===0||e[e.length-1].type!=="BRACKET")throw new Error("missing opening bracket");e[e.length-1].text+=f}continue}if(o=i.match(Ld),o){if(l.text=o[1],a+=l.text.length,Rd.has(l.text)){l.type="KEYWORD";continue}if(l.text.match(Go)){l.type="TYPE";continue}l.type="ID";continue}if(o=i.match(Dd),o){l.text=o[1],l.type="NUMBER",a+=l.text.length;continue}throw new Error(`unexpected token ${JSON.stringify(i[0])} at position ${a}`)}return new He(e.map(i=>Object.freeze(i)))}function $a(r,e){let t=[];for(const n in e.keys())r.has(n)&&t.push(n);if(t.length>1)throw new Error(`conflicting types: ${t.join(", ")}`)}function ts(r,e){if(e.peekKeyword(Lo)){const t=e.pop().text;if(t!==r)throw new Error(`expected ${r}, got ${t}`)}return e.popType("ID")}function dt(r,e){const t=new Set;for(;;){const n=r.peekType("KEYWORD");if(n==null||e&&!e.has(n))break;if(r.pop(),t.has(n))throw new Error(`duplicate keywords: ${JSON.stringify(n)}`);t.add(n)}return Object.freeze(t)}function _o(r){let e=dt(r,Td);return $a(e,ge("constant payable nonpayable".split(" "))),$a(e,ge("pure view payable nonpayable".split(" "))),e.has("view")?"view":e.has("pure")?"pure":e.has("payable")?"payable":e.has("nonpayable")?"nonpayable":e.has("constant")?"view":"nonpayable"}function lt(r,e){return r.popParams().map(t=>ue.from(t,e))}function Ho(r){if(r.peekType("AT")){if(r.pop(),r.peekType("NUMBER"))return re(r.pop().text);throw new Error("invalid gas")}return null}function qt(r){if(r.length)throw new Error(`unexpected tokens at offset ${r.offset}: ${r.toString()}`)}const jd=new RegExp(/^(.*)\[([0-9]*)\]$/);function Ja(r){const e=r.match(Go);if(v(e,"invalid type","type",r),r==="uint")return"uint256";if(r==="int")return"int256";if(e[2]){const t=parseInt(e[2]);v(t!==0&&t<=32,"invalid bytes length","type",r)}else if(e[3]){const t=parseInt(e[3]);v(t!==0&&t<=256&&t%8===0,"invalid numeric width","type",r)}return r}const se={},ve=Symbol.for("_ethers_internal"),Wa="_ParamTypeInternal",Za="_ErrorInternal",Ya="_EventInternal",Xa="_ConstructorInternal",qa="_FallbackInternal",ei="_FunctionInternal",ti="_StructInternal";var Pr,Bn;const Oe=class Oe{constructor(e,t,n,s,a,i,o,l){F(this,Pr);w(this,"name");w(this,"type");w(this,"baseType");w(this,"indexed");w(this,"components");w(this,"arrayLength");w(this,"arrayChildren");if(_n(e,se,"ParamType"),Object.defineProperty(this,ve,{value:Wa}),i&&(i=Object.freeze(i.slice())),s==="array"){if(o==null||l==null)throw new Error("")}else if(o!=null||l!=null)throw new Error("");if(s==="tuple"){if(i==null)throw new Error("")}else if(i!=null)throw new Error("");H(this,{name:t,type:n,baseType:s,indexed:a,components:i,arrayLength:o,arrayChildren:l})}format(e){if(e==null&&(e="sighash"),e==="json"){const n=this.name||"";if(this.isArray()){const a=JSON.parse(this.arrayChildren.format("json"));return a.name=n,a.type+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`,JSON.stringify(a)}const s={type:this.baseType==="tuple"?"tuple":this.type,name:n};return typeof this.indexed=="boolean"&&(s.indexed=this.indexed),this.isTuple()&&(s.components=this.components.map(a=>JSON.parse(a.format(e)))),JSON.stringify(s)}let t="";return this.isArray()?(t+=this.arrayChildren.format(e),t+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`):this.isTuple()?t+="("+this.components.map(n=>n.format(e)).join(e==="full"?", ":",")+")":t+=this.type,e!=="sighash"&&(this.indexed===!0&&(t+=" indexed"),e==="full"&&this.name&&(t+=" "+this.name)),t}isArray(){return this.baseType==="array"}isTuple(){return this.baseType==="tuple"}isIndexable(){return this.indexed!=null}walk(e,t){if(this.isArray()){if(!Array.isArray(e))throw new Error("invalid array value");if(this.arrayLength!==-1&&e.length!==this.arrayLength)throw new Error("array is wrong length");const n=this;return e.map(s=>n.arrayChildren.walk(s,t))}if(this.isTuple()){if(!Array.isArray(e))throw new Error("invalid tuple value");if(e.length!==this.components.length)throw new Error("array is wrong length");const n=this;return e.map((s,a)=>n.components[a].walk(s,t))}return t(this.type,e)}async walkAsync(e,t){const n=[],s=[e];return Z(this,Pr,Bn).call(this,n,e,t,a=>{s[0]=a}),n.length&&await Promise.all(n),s[0]}static from(e,t){if(Oe.isParamType(e))return e;if(typeof e=="string")try{return Oe.from(Tt(e),t)}catch{v(!1,"invalid param type","obj",e)}else if(e instanceof He){let o="",l="",d=null;dt(e,ge(["tuple"])).has("tuple")||e.peekType("OPEN_PAREN")?(l="tuple",d=e.popParams().map(p=>Oe.from(p)),o=`tuple(${d.map(p=>p.format()).join(",")})`):(o=Ja(e.popType("TYPE")),l=o);let f=null,u=null;for(;e.length&&e.peekType("BRACKET");){const p=e.pop();f=new Oe(se,"",o,l,null,d,u,f),u=p.value,o+=p.text,l="array",d=null}let h=null;if(dt(e,Sd).has("indexed")){if(!t)throw new Error("");h=!0}const x=e.peekType("ID")?e.pop().text:"";if(e.length)throw new Error("leftover tokens");return new Oe(se,x,o,l,h,d,u,f)}const n=e.name;v(!n||typeof n=="string"&&n.match(Mo),"invalid name","obj.name",n);let s=e.indexed;s!=null&&(v(t,"parameter cannot be indexed","obj.indexed",e.indexed),s=!!s);let a=e.type,i=a.match(jd);if(i){const o=parseInt(i[2]||"-1"),l=Oe.from({type:i[1],components:e.components});return new Oe(se,n||"",a,"array",s,null,o,l)}if(a==="tuple"||a.startsWith("tuple(")||a.startsWith("(")){const o=e.components!=null?e.components.map(d=>Oe.from(d)):null;return new Oe(se,n||"",a,"tuple",s,o,null,null)}return a=Ja(e.type),new Oe(se,n||"",a,a,s,null,null,null)}static isParamType(e){return e&&e[ve]===Wa}};Pr=new WeakSet,Bn=function(e,t,n,s){if(this.isArray()){if(!Array.isArray(t))throw new Error("invalid array value");if(this.arrayLength!==-1&&t.length!==this.arrayLength)throw new Error("array is wrong length");const i=this.arrayChildren,o=t.slice();o.forEach((l,d)=>{var f;Z(f=i,Pr,Bn).call(f,e,l,n,u=>{o[d]=u})}),s(o);return}if(this.isTuple()){const i=this.components;let o;if(Array.isArray(t))o=t.slice();else{if(t==null||typeof t!="object")throw new Error("invalid tuple value");o=i.map(l=>{if(!l.name)throw new Error("cannot use object value with unnamed components");if(!(l.name in t))throw new Error(`missing value for component ${l.name}`);return t[l.name]})}if(o.length!==this.components.length)throw new Error("array is wrong length");o.forEach((l,d)=>{var f;Z(f=i[d],Pr,Bn).call(f,e,l,n,u=>{o[d]=u})}),s(o);return}const a=n(this.type,t);a.then?e.push(async function(){s(await a)}()):s(a)};let ue=Oe;class er{constructor(e,t,n){w(this,"type");w(this,"inputs");_n(e,se,"Fragment"),n=Object.freeze(n.slice()),H(this,{type:t,inputs:n})}static from(e){if(typeof e=="string"){try{er.from(JSON.parse(e))}catch{}return er.from(Tt(e))}if(e instanceof He)switch(e.peekKeyword(Lo)){case"constructor":return ct.from(e);case"error":return we.from(e);case"event":return Ye.from(e);case"fallback":case"receive":return nt.from(e);case"function":return Xe.from(e);case"struct":return Zt.from(e)}else if(typeof e=="object"){switch(e.type){case"constructor":return ct.from(e);case"error":return we.from(e);case"event":return Ye.from(e);case"fallback":case"receive":return nt.from(e);case"function":return Xe.from(e);case"struct":return Zt.from(e)}U(!1,`unsupported type: ${e.type}`,"UNSUPPORTED_OPERATION",{operation:"Fragment.from"})}v(!1,"unsupported frgament object","obj",e)}static isConstructor(e){return ct.isFragment(e)}static isError(e){return we.isFragment(e)}static isEvent(e){return Ye.isFragment(e)}static isFunction(e){return Xe.isFragment(e)}static isStruct(e){return Zt.isFragment(e)}}class rs extends er{constructor(t,n,s,a){super(t,n,a);w(this,"name");v(typeof s=="string"&&s.match(Mo),"invalid identifier","name",s),a=Object.freeze(a.slice()),H(this,{name:s})}}function an(r,e){return"("+e.map(t=>t.format(r)).join(r==="full"?", ":",")+")"}class we extends rs{constructor(e,t,n){super(e,"error",t,n),Object.defineProperty(this,ve,{value:Za})}get selector(){return sn(this.format("sighash")).substring(0,10)}format(e){if(e==null&&(e="sighash"),e==="json")return JSON.stringify({type:"error",name:this.name,inputs:this.inputs.map(n=>JSON.parse(n.format(e)))});const t=[];return e!=="sighash"&&t.push("error"),t.push(this.name+an(e,this.inputs)),t.join(" ")}static from(e){if(we.isFragment(e))return e;if(typeof e=="string")return we.from(Tt(e));if(e instanceof He){const t=ts("error",e),n=lt(e);return qt(e),new we(se,t,n)}return new we(se,e.name,e.inputs?e.inputs.map(ue.from):[])}static isFragment(e){return e&&e[ve]===Za}}class Ye extends rs{constructor(t,n,s,a){super(t,"event",n,s);w(this,"anonymous");Object.defineProperty(this,ve,{value:Ya}),H(this,{anonymous:a})}get topicHash(){return sn(this.format("sighash"))}format(t){if(t==null&&(t="sighash"),t==="json")return JSON.stringify({type:"event",anonymous:this.anonymous,name:this.name,inputs:this.inputs.map(s=>JSON.parse(s.format(t)))});const n=[];return t!=="sighash"&&n.push("event"),n.push(this.name+an(t,this.inputs)),t!=="sighash"&&this.anonymous&&n.push("anonymous"),n.join(" ")}static getTopicHash(t,n){return n=(n||[]).map(a=>ue.from(a)),new Ye(se,t,n,!1).topicHash}static from(t){if(Ye.isFragment(t))return t;if(typeof t=="string")try{return Ye.from(Tt(t))}catch{v(!1,"invalid event fragment","obj",t)}else if(t instanceof He){const n=ts("event",t),s=lt(t,!0),a=!!dt(t,ge(["anonymous"])).has("anonymous");return qt(t),new Ye(se,n,s,a)}return new Ye(se,t.name,t.inputs?t.inputs.map(n=>ue.from(n,!0)):[],!!t.anonymous)}static isFragment(t){return t&&t[ve]===Ya}}class ct extends er{constructor(t,n,s,a,i){super(t,n,s);w(this,"payable");w(this,"gas");Object.defineProperty(this,ve,{value:Xa}),H(this,{payable:a,gas:i})}format(t){if(U(t!=null&&t!=="sighash","cannot format a constructor for sighash","UNSUPPORTED_OPERATION",{operation:"format(sighash)"}),t==="json")return JSON.stringify({type:"constructor",stateMutability:this.payable?"payable":"undefined",payable:this.payable,gas:this.gas!=null?this.gas:void 0,inputs:this.inputs.map(s=>JSON.parse(s.format(t)))});const n=[`constructor${an(t,this.inputs)}`];return this.payable&&n.push("payable"),this.gas!=null&&n.push(`@${this.gas.toString()}`),n.join(" ")}static from(t){if(ct.isFragment(t))return t;if(typeof t=="string")try{return ct.from(Tt(t))}catch{v(!1,"invalid constuctor fragment","obj",t)}else if(t instanceof He){dt(t,ge(["constructor"]));const n=lt(t),s=!!dt(t,Pd).has("payable"),a=Ho(t);return qt(t),new ct(se,"constructor",n,s,a)}return new ct(se,"constructor",t.inputs?t.inputs.map(ue.from):[],!!t.payable,t.gas!=null?t.gas:null)}static isFragment(t){return t&&t[ve]===Xa}}class nt extends er{constructor(t,n,s){super(t,"fallback",n);w(this,"payable");Object.defineProperty(this,ve,{value:qa}),H(this,{payable:s})}format(t){const n=this.inputs.length===0?"receive":"fallback";if(t==="json"){const s=this.payable?"payable":"nonpayable";return JSON.stringify({type:n,stateMutability:s})}return`${n}()${this.payable?" payable":""}`}static from(t){if(nt.isFragment(t))return t;if(typeof t=="string")try{return nt.from(Tt(t))}catch{v(!1,"invalid fallback fragment","obj",t)}else if(t instanceof He){const n=t.toString(),s=t.peekKeyword(ge(["fallback","receive"]));if(v(s,"type must be fallback or receive","obj",n),t.popKeyword(ge(["fallback","receive"]))==="receive"){const l=lt(t);return v(l.length===0,"receive cannot have arguments","obj.inputs",l),dt(t,ge(["payable"])),qt(t),new nt(se,[],!0)}let i=lt(t);i.length?v(i.length===1&&i[0].type==="bytes","invalid fallback inputs","obj.inputs",i.map(l=>l.format("minimal")).join(", ")):i=[ue.from("bytes")];const o=_o(t);if(v(o==="nonpayable"||o==="payable","fallback cannot be constants","obj.stateMutability",o),dt(t,ge(["returns"])).has("returns")){const l=lt(t);v(l.length===1&&l[0].type==="bytes","invalid fallback outputs","obj.outputs",l.map(d=>d.format("minimal")).join(", "))}return qt(t),new nt(se,i,o==="payable")}if(t.type==="receive")return new nt(se,[],!0);if(t.type==="fallback"){const n=[ue.from("bytes")],s=t.stateMutability==="payable";return new nt(se,n,s)}v(!1,"invalid fallback description","obj",t)}static isFragment(t){return t&&t[ve]===qa}}class Xe extends rs{constructor(t,n,s,a,i,o){super(t,"function",n,a);w(this,"constant");w(this,"outputs");w(this,"stateMutability");w(this,"payable");w(this,"gas");Object.defineProperty(this,ve,{value:ei}),i=Object.freeze(i.slice()),H(this,{constant:s==="view"||s==="pure",gas:o,outputs:i,payable:s==="payable",stateMutability:s})}get selector(){return sn(this.format("sighash")).substring(0,10)}format(t){if(t==null&&(t="sighash"),t==="json")return JSON.stringify({type:"function",name:this.name,constant:this.constant,stateMutability:this.stateMutability!=="nonpayable"?this.stateMutability:void 0,payable:this.payable,gas:this.gas!=null?this.gas:void 0,inputs:this.inputs.map(s=>JSON.parse(s.format(t))),outputs:this.outputs.map(s=>JSON.parse(s.format(t)))});const n=[];return t!=="sighash"&&n.push("function"),n.push(this.name+an(t,this.inputs)),t!=="sighash"&&(this.stateMutability!=="nonpayable"&&n.push(this.stateMutability),this.outputs&&this.outputs.length&&(n.push("returns"),n.push(an(t,this.outputs))),this.gas!=null&&n.push(`@${this.gas.toString()}`)),n.join(" ")}static getSelector(t,n){return n=(n||[]).map(a=>ue.from(a)),new Xe(se,t,"view",n,[],null).selector}static from(t){if(Xe.isFragment(t))return t;if(typeof t=="string")try{return Xe.from(Tt(t))}catch{v(!1,"invalid function fragment","obj",t)}else if(t instanceof He){const s=ts("function",t),a=lt(t),i=_o(t);let o=[];dt(t,ge(["returns"])).has("returns")&&(o=lt(t));const l=Ho(t);return qt(t),new Xe(se,s,i,a,o,l)}let n=t.stateMutability;return n==null&&(n="payable",typeof t.constant=="boolean"?(n="view",t.constant||(n="payable",typeof t.payable=="boolean"&&!t.payable&&(n="nonpayable"))):typeof t.payable=="boolean"&&!t.payable&&(n="nonpayable")),new Xe(se,t.name,n,t.inputs?t.inputs.map(ue.from):[],t.outputs?t.outputs.map(ue.from):[],t.gas!=null?t.gas:null)}static isFragment(t){return t&&t[ve]===ei}}class Zt extends rs{constructor(e,t,n){super(e,"struct",t,n),Object.defineProperty(this,ve,{value:ti})}format(){throw new Error("@TODO")}static from(e){if(typeof e=="string")try{return Zt.from(Tt(e))}catch{v(!1,"invalid struct fragment","obj",e)}else if(e instanceof He){const t=ts("struct",e),n=lt(e);return qt(e),new Zt(se,t,n)}return new Zt(se,e.name,e.inputs?e.inputs.map(ue.from):[])}static isFragment(e){return e&&e[ve]===ti}}const Ke=new Map;Ke.set(0,"GENERIC_PANIC");Ke.set(1,"ASSERT_FALSE");Ke.set(17,"OVERFLOW");Ke.set(18,"DIVIDE_BY_ZERO");Ke.set(33,"ENUM_RANGE_ERROR");Ke.set(34,"BAD_STORAGE_DATA");Ke.set(49,"STACK_UNDERFLOW");Ke.set(50,"ARRAY_RANGE_ERROR");Ke.set(65,"OUT_OF_MEMORY");Ke.set(81,"UNINITIALIZED_FUNCTION_CALL");const Md=new RegExp(/^bytes([0-9]*)$/),Gd=new RegExp(/^(u?int)([0-9]*)$/);let bs=null,ri=1024;function _d(r,e,t,n){let s="missing revert data",a=null;const i=null;let o=null;if(t){s="execution reverted";const d=Y(t);if(t=K(t),d.length===0)s+=" (no data present; likely require(false) occurred",a="require(false)";else if(d.length%32!==4)s+=" (could not decode reason; invalid data length)";else if(K(d.slice(0,4))==="0x08c379a0")try{a=n.decode(["string"],d.slice(4))[0],o={signature:"Error(string)",name:"Error",args:[a]},s+=`: ${JSON.stringify(a)}`}catch{s+=" (could not decode reason; invalid string data)"}else if(K(d.slice(0,4))==="0x4e487b71")try{const f=Number(n.decode(["uint256"],d.slice(4))[0]);o={signature:"Panic(uint256)",name:"Panic",args:[f]},a=`Panic due to ${Ke.get(f)||"UNKNOWN"}(${f})`,s+=`: ${a}`}catch{s+=" (could not decode panic code)"}else s+=" (unknown custom error)"}const l={to:e.to?Ne(e.to):null,data:e.data||"0x"};return e.from&&(l.from=Ne(e.from)),Xt(s,"CALL_EXCEPTION",{action:r,data:t,reason:a,transaction:l,invocation:i,revert:o})}var vt,dr;const Gn=class Gn{constructor(){F(this,vt)}getDefaultValue(e){const t=e.map(s=>Z(this,vt,dr).call(this,ue.from(s)));return new Cn(t,"_").defaultValue()}encode(e,t){mi(t.length,e.length,"types/values length mismatch");const n=e.map(i=>Z(this,vt,dr).call(this,ue.from(i))),s=new Cn(n,"_"),a=new Es;return s.encode(a,t),a.data}decode(e,t,n){const s=e.map(i=>Z(this,vt,dr).call(this,ue.from(i)));return new Cn(s,"_").decode(new Ns(t,n,ri))}static _setDefaultMaxInflation(e){v(typeof e=="number"&&Number.isInteger(e),"invalid defaultMaxInflation factor","value",e),ri=e}static defaultAbiCoder(){return bs==null&&(bs=new Gn),bs}static getBuiltinCallException(e,t,n){return _d(e,t,n,Gn.defaultAbiCoder())}};vt=new WeakSet,dr=function(e){if(e.isArray())return new ad(Z(this,vt,dr).call(this,e.arrayChildren),e.arrayLength,e.name);if(e.isTuple())return new Cn(e.components.map(n=>Z(this,vt,dr).call(this,n)),e.name);switch(e.baseType){case"address":return new nd(e.name);case"bool":return new id(e.name);case"string":return new pd(e.name);case"bytes":return new od(e.name);case"":return new dd(e.name)}let t=e.type.match(Gd);if(t){let n=parseInt(t[2]||"256");return v(n!==0&&n<=256&&n%8===0,"invalid "+t[1]+" bit length","param",e),new xd(n/8,t[1]==="int",e.name)}if(t=e.type.match(Md),t){let n=parseInt(t[1]);return v(n!==0&&n<=32,"invalid bytes length","param",e),new cd(n,e.name)}v(!1,"invalid type","type",e.type)};let Dn=Gn;class Hd{constructor(e,t,n){w(this,"fragment");w(this,"name");w(this,"signature");w(this,"topic");w(this,"args");const s=e.name,a=e.format();H(this,{fragment:e,name:s,signature:a,topic:t,args:n})}}class Kd{constructor(e,t,n,s){w(this,"fragment");w(this,"name");w(this,"args");w(this,"signature");w(this,"selector");w(this,"value");const a=e.name,i=e.format();H(this,{fragment:e,name:a,args:n,signature:i,selector:t,value:s})}}class Vd{constructor(e,t,n){w(this,"fragment");w(this,"name");w(this,"args");w(this,"signature");w(this,"selector");const s=e.name,a=e.format();H(this,{fragment:e,name:s,args:n,signature:a,selector:t})}}class ni{constructor(e){w(this,"hash");w(this,"_isIndexed");H(this,{hash:e,_isIndexed:!0})}static isIndexed(e){return!!(e&&e._isIndexed)}}const si={0:"generic panic",1:"assert(false)",17:"arithmetic overflow",18:"division or modulo by zero",33:"enum overflow",34:"invalid encoded storage byte array accessed",49:"out-of-bounds array access; popping on an empty array",50:"out-of-bounds access of an array or bytesN",65:"out of memory",81:"uninitialized function"},ai={"0x08c379a0":{signature:"Error(string)",name:"Error",inputs:["string"],reason:r=>`reverted with reason string ${JSON.stringify(r)}`},"0x4e487b71":{signature:"Panic(uint256)",name:"Panic",inputs:["uint256"],reason:r=>{let e="unknown panic code";return r>=0&&r<=255&&si[r.toString()]&&(e=si[r.toString()]),`reverted with panic code 0x${r.toString(16)} (${e})`}}};var $e,Je,We,xe,et,Rn,Un;const Ft=class Ft{constructor(e){F(this,et);w(this,"fragments");w(this,"deploy");w(this,"fallback");w(this,"receive");F(this,$e);F(this,Je);F(this,We);F(this,xe);let t=[];typeof e=="string"?t=JSON.parse(e):t=e,P(this,We,new Map),P(this,$e,new Map),P(this,Je,new Map);const n=[];for(const i of t)try{n.push(er.from(i))}catch(o){console.log(`[Warning] Invalid Fragment ${JSON.stringify(i)}:`,o.message)}H(this,{fragments:Object.freeze(n)});let s=null,a=!1;P(this,xe,this.getAbiCoder()),this.fragments.forEach((i,o)=>{let l;switch(i.type){case"constructor":if(this.deploy){console.log("duplicate definition - constructor");return}H(this,{deploy:i});return;case"fallback":i.inputs.length===0?a=!0:(v(!s||i.payable!==s.payable,"conflicting fallback fragments",`fragments[${o}]`,i),s=i,a=s.payable);return;case"function":l=b(this,We);break;case"event":l=b(this,Je);break;case"error":l=b(this,$e);break;default:return}const d=i.format();l.has(d)||l.set(d,i)}),this.deploy||H(this,{deploy:ct.from("constructor()")}),H(this,{fallback:s,receive:a})}format(e){const t=e?"minimal":"full";return this.fragments.map(s=>s.format(t))}formatJson(){const e=this.fragments.map(t=>t.format("json"));return JSON.stringify(e.map(t=>JSON.parse(t)))}getAbiCoder(){return Dn.defaultAbiCoder()}getFunctionName(e){const t=Z(this,et,Rn).call(this,e,null,!1);return v(t,"no matching function","key",e),t.name}hasFunction(e){return!!Z(this,et,Rn).call(this,e,null,!1)}getFunction(e,t){return Z(this,et,Rn).call(this,e,t||null,!0)}forEachFunction(e){const t=Array.from(b(this,We).keys());t.sort((n,s)=>n.localeCompare(s));for(let n=0;n<t.length;n++){const s=t[n];e(b(this,We).get(s),n)}}getEventName(e){const t=Z(this,et,Un).call(this,e,null,!1);return v(t,"no matching event","key",e),t.name}hasEvent(e){return!!Z(this,et,Un).call(this,e,null,!1)}getEvent(e,t){return Z(this,et,Un).call(this,e,t||null,!0)}forEachEvent(e){const t=Array.from(b(this,Je).keys());t.sort((n,s)=>n.localeCompare(s));for(let n=0;n<t.length;n++){const s=t[n];e(b(this,Je).get(s),n)}}getError(e,t){if(Ee(e)){const s=e.toLowerCase();if(ai[s])return we.from(ai[s].signature);for(const a of b(this,$e).values())if(s===a.selector)return a;return null}if(e.indexOf("(")===-1){const s=[];for(const[a,i]of b(this,$e))a.split("(")[0]===e&&s.push(i);if(s.length===0)return e==="Error"?we.from("error Error(string)"):e==="Panic"?we.from("error Panic(uint256)"):null;if(s.length>1){const a=s.map(i=>JSON.stringify(i.format())).join(", ");v(!1,`ambiguous error description (i.e. ${a})`,"name",e)}return s[0]}if(e=we.from(e).format(),e==="Error(string)")return we.from("error Error(string)");if(e==="Panic(uint256)")return we.from("error Panic(uint256)");const n=b(this,$e).get(e);return n||null}forEachError(e){const t=Array.from(b(this,$e).keys());t.sort((n,s)=>n.localeCompare(s));for(let n=0;n<t.length;n++){const s=t[n];e(b(this,$e).get(s),n)}}_decodeParams(e,t){return b(this,xe).decode(e,t)}_encodeParams(e,t){return b(this,xe).encode(e,t)}encodeDeploy(e){return this._encodeParams(this.deploy.inputs,e||[])}decodeErrorResult(e,t){if(typeof e=="string"){const n=this.getError(e);v(n,"unknown error","fragment",e),e=n}return v(cr(t,0,4)===e.selector,`data signature does not match error ${e.name}.`,"data",t),this._decodeParams(e.inputs,cr(t,4))}encodeErrorResult(e,t){if(typeof e=="string"){const n=this.getError(e);v(n,"unknown error","fragment",e),e=n}return Ct([e.selector,this._encodeParams(e.inputs,t||[])])}decodeFunctionData(e,t){if(typeof e=="string"){const n=this.getFunction(e);v(n,"unknown function","fragment",e),e=n}return v(cr(t,0,4)===e.selector,`data signature does not match function ${e.name}.`,"data",t),this._decodeParams(e.inputs,cr(t,4))}encodeFunctionData(e,t){if(typeof e=="string"){const n=this.getFunction(e);v(n,"unknown function","fragment",e),e=n}return Ct([e.selector,this._encodeParams(e.inputs,t||[])])}decodeFunctionResult(e,t){if(typeof e=="string"){const a=this.getFunction(e);v(a,"unknown function","fragment",e),e=a}let n="invalid length for result data";const s=qe(t);if(s.length%32===0)try{return b(this,xe).decode(e.outputs,s)}catch{n="could not decode result data"}U(!1,n,"BAD_DATA",{value:K(s),info:{method:e.name,signature:e.format()}})}makeError(e,t){const n=Y(e,"data"),s=Dn.getBuiltinCallException("call",t,n);if(s.message.startsWith("execution reverted (unknown custom error)")){const o=K(n.slice(0,4)),l=this.getError(o);if(l)try{const d=b(this,xe).decode(l.inputs,n.slice(4));s.revert={name:l.name,signature:l.format(),args:d},s.reason=s.revert.signature,s.message=`execution reverted: ${s.reason}`}catch{s.message="execution reverted (coult not decode custom error)"}}const i=this.parseTransaction(t);return i&&(s.invocation={method:i.name,signature:i.signature,args:i.args}),s}encodeFunctionResult(e,t){if(typeof e=="string"){const n=this.getFunction(e);v(n,"unknown function","fragment",e),e=n}return K(b(this,xe).encode(e.outputs,t||[]))}encodeFilterTopics(e,t){if(typeof e=="string"){const a=this.getEvent(e);v(a,"unknown event","eventFragment",e),e=a}U(t.length<=e.inputs.length,`too many arguments for ${e.format()}`,"UNEXPECTED_ARGUMENT",{count:t.length,expectedCount:e.inputs.length});const n=[];e.anonymous||n.push(e.topicHash);const s=(a,i)=>a.type==="string"?sn(i):a.type==="bytes"?Pt(K(i)):(a.type==="bool"&&typeof i=="boolean"?i=i?"0x01":"0x00":a.type.match(/^u?int/)?i=Vn(i):a.type.match(/^bytes/)?i=Wc(i,32):a.type==="address"&&b(this,xe).encode(["address"],[i]),Ei(K(i),32));for(t.forEach((a,i)=>{const o=e.inputs[i];if(!o.indexed){v(a==null,"cannot filter non-indexed parameters; must be null","contract."+o.name,a);return}a==null?n.push(null):o.baseType==="array"||o.baseType==="tuple"?v(!1,"filtering with tuples or arrays not supported","contract."+o.name,a):Array.isArray(a)?n.push(a.map(l=>s(o,l))):n.push(s(o,a))});n.length&&n[n.length-1]===null;)n.pop();return n}encodeEventLog(e,t){if(typeof e=="string"){const i=this.getEvent(e);v(i,"unknown event","eventFragment",e),e=i}const n=[],s=[],a=[];return e.anonymous||n.push(e.topicHash),v(t.length===e.inputs.length,"event arguments/values mismatch","values",t),e.inputs.forEach((i,o)=>{const l=t[o];if(i.indexed)if(i.type==="string")n.push(sn(l));else if(i.type==="bytes")n.push(Pt(l));else{if(i.baseType==="tuple"||i.baseType==="array")throw new Error("not implemented");n.push(b(this,xe).encode([i.type],[l]))}else s.push(i),a.push(l)}),{data:b(this,xe).encode(s,a),topics:n}}decodeEventLog(e,t,n){if(typeof e=="string"){const g=this.getEvent(e);v(g,"unknown event","eventFragment",e),e=g}if(n!=null&&!e.anonymous){const g=e.topicHash;v(Ee(n[0],32)&&n[0].toLowerCase()===g,"fragment/topic mismatch","topics[0]",n[0]),n=n.slice(1)}const s=[],a=[],i=[];e.inputs.forEach((g,x)=>{g.indexed?g.type==="string"||g.type==="bytes"||g.baseType==="tuple"||g.baseType==="array"?(s.push(ue.from({type:"bytes32",name:g.name})),i.push(!0)):(s.push(g),i.push(!1)):(a.push(g),i.push(!1))});const o=n!=null?b(this,xe).decode(s,Ct(n)):null,l=b(this,xe).decode(a,t,!0),d=[],f=[];let u=0,h=0;return e.inputs.forEach((g,x)=>{let p=null;if(g.indexed)if(o==null)p=new ni(null);else if(i[x])p=new ni(o[h++]);else try{p=o[h++]}catch(m){p=m}else try{p=l[u++]}catch(m){p=m}d.push(p),f.push(g.name||null)}),Or.fromItems(d,f)}parseTransaction(e){const t=Y(e.data,"tx.data"),n=re(e.value!=null?e.value:0,"tx.value"),s=this.getFunction(K(t.slice(0,4)));if(!s)return null;const a=b(this,xe).decode(s.inputs,t.slice(4));return new Kd(s,s.selector,a,n)}parseCallResult(e){throw new Error("@TODO")}parseLog(e){const t=this.getEvent(e.topics[0]);return!t||t.anonymous?null:new Hd(t,t.topicHash,this.decodeEventLog(t,e.data,e.topics))}parseError(e){const t=K(e),n=this.getError(cr(t,0,4));if(!n)return null;const s=b(this,xe).decode(n.inputs,cr(t,4));return new Vd(n,n.selector,s)}static from(e){return e instanceof Ft?e:typeof e=="string"?new Ft(JSON.parse(e)):typeof e.formatJson=="function"?new Ft(e.formatJson()):typeof e.format=="function"?new Ft(e.format("json")):new Ft(e)}};$e=new WeakMap,Je=new WeakMap,We=new WeakMap,xe=new WeakMap,et=new WeakSet,Rn=function(e,t,n){if(Ee(e)){const a=e.toLowerCase();for(const i of b(this,We).values())if(a===i.selector)return i;return null}if(e.indexOf("(")===-1){const a=[];for(const[i,o]of b(this,We))i.split("(")[0]===e&&a.push(o);if(t){const i=t.length>0?t[t.length-1]:null;let o=t.length,l=!0;pe.isTyped(i)&&i.type==="overrides"&&(l=!1,o--);for(let d=a.length-1;d>=0;d--){const f=a[d].inputs.length;f!==o&&(!l||f!==o-1)&&a.splice(d,1)}for(let d=a.length-1;d>=0;d--){const f=a[d].inputs;for(let u=0;u<t.length;u++)if(pe.isTyped(t[u])){if(u>=f.length){if(t[u].type==="overrides")continue;a.splice(d,1);break}if(t[u].type!==f[u].baseType){a.splice(d,1);break}}}}if(a.length===1&&t&&t.length!==a[0].inputs.length){const i=t[t.length-1];(i==null||Array.isArray(i)||typeof i!="object")&&a.splice(0,1)}if(a.length===0)return null;if(a.length>1&&n){const i=a.map(o=>JSON.stringify(o.format())).join(", ");v(!1,`ambiguous function description (i.e. matches ${i})`,"key",e)}return a[0]}const s=b(this,We).get(Xe.from(e).format());return s||null},Un=function(e,t,n){if(Ee(e)){const a=e.toLowerCase();for(const i of b(this,Je).values())if(a===i.topicHash)return i;return null}if(e.indexOf("(")===-1){const a=[];for(const[i,o]of b(this,Je))i.split("(")[0]===e&&a.push(o);if(t){for(let i=a.length-1;i>=0;i--)a[i].inputs.length<t.length&&a.splice(i,1);for(let i=a.length-1;i>=0;i--){const o=a[i].inputs;for(let l=0;l<t.length;l++)if(pe.isTyped(t[l])&&t[l].type!==o[l].baseType){a.splice(i,1);break}}}if(a.length===0)return null;if(a.length>1&&n){const i=a.map(o=>JSON.stringify(o.format())).join(", ");v(!1,`ambiguous event description (i.e. matches ${i})`,"key",e)}return a[0]}const s=b(this,Je).get(Ye.from(e).format());return s||null};let Os=Ft;const Ko=BigInt(0);function Re(r){return r==null?null:r.toString()}function zd(r){const e={};r.to&&(e.to=r.to),r.from&&(e.from=r.from),r.data&&(e.data=K(r.data));const t="chainId,gasLimit,gasPrice,maxFeePerBlobGas,maxFeePerGas,maxPriorityFeePerGas,value".split(/,/);for(const s of t)!(s in r)||r[s]==null||(e[s]=re(r[s],`request.${s}`));const n="type,nonce".split(/,/);for(const s of n)!(s in r)||r[s]==null||(e[s]=ne(r[s],`request.${s}`));return r.accessList&&(e.accessList=bd(r.accessList)),r.authorizationList&&(e.authorizationList=r.authorizationList.slice()),"blockTag"in r&&(e.blockTag=r.blockTag),"enableCcipRead"in r&&(e.enableCcipRead=!!r.enableCcipRead),"customData"in r&&(e.customData=r.customData),"blobVersionedHashes"in r&&r.blobVersionedHashes&&(e.blobVersionedHashes=r.blobVersionedHashes.slice()),"kzg"in r&&(e.kzg=r.kzg),"blobs"in r&&r.blobs&&(e.blobs=r.blobs.map(s=>wi(s)?K(s):Object.assign({},s))),e}class ns{constructor(e,t){w(this,"provider");w(this,"transactionHash");w(this,"blockHash");w(this,"blockNumber");w(this,"removed");w(this,"address");w(this,"data");w(this,"topics");w(this,"index");w(this,"transactionIndex");this.provider=t;const n=Object.freeze(e.topics.slice());H(this,{transactionHash:e.transactionHash,blockHash:e.blockHash,blockNumber:e.blockNumber,removed:e.removed,address:e.address,data:e.data,topics:n,index:e.index,transactionIndex:e.transactionIndex})}toJSON(){const{address:e,blockHash:t,blockNumber:n,data:s,index:a,removed:i,topics:o,transactionHash:l,transactionIndex:d}=this;return{_type:"log",address:e,blockHash:t,blockNumber:n,data:s,index:a,removed:i,topics:o,transactionHash:l,transactionIndex:d}}async getBlock(){const e=await this.provider.getBlock(this.blockHash);return U(!!e,"failed to find transaction","UNKNOWN_ERROR",{}),e}async getTransaction(){const e=await this.provider.getTransaction(this.transactionHash);return U(!!e,"failed to find transaction","UNKNOWN_ERROR",{}),e}async getTransactionReceipt(){const e=await this.provider.getTransactionReceipt(this.transactionHash);return U(!!e,"failed to find transaction receipt","UNKNOWN_ERROR",{}),e}removedEvent(){return $d(this)}}var un;class Qd{constructor(e,t){w(this,"provider");w(this,"to");w(this,"from");w(this,"contractAddress");w(this,"hash");w(this,"index");w(this,"blockHash");w(this,"blockNumber");w(this,"logsBloom");w(this,"gasUsed");w(this,"blobGasUsed");w(this,"cumulativeGasUsed");w(this,"gasPrice");w(this,"blobGasPrice");w(this,"type");w(this,"status");w(this,"root");F(this,un);P(this,un,Object.freeze(e.logs.map(s=>new ns(s,t))));let n=Ko;e.effectiveGasPrice!=null?n=e.effectiveGasPrice:e.gasPrice!=null&&(n=e.gasPrice),H(this,{provider:t,to:e.to,from:e.from,contractAddress:e.contractAddress,hash:e.hash,index:e.index,blockHash:e.blockHash,blockNumber:e.blockNumber,logsBloom:e.logsBloom,gasUsed:e.gasUsed,cumulativeGasUsed:e.cumulativeGasUsed,blobGasUsed:e.blobGasUsed,gasPrice:n,blobGasPrice:e.blobGasPrice,type:e.type,status:e.status,root:e.root})}get logs(){return b(this,un)}toJSON(){const{to:e,from:t,contractAddress:n,hash:s,index:a,blockHash:i,blockNumber:o,logsBloom:l,logs:d,status:f,root:u}=this;return{_type:"TransactionReceipt",blockHash:i,blockNumber:o,contractAddress:n,cumulativeGasUsed:Re(this.cumulativeGasUsed),from:t,gasPrice:Re(this.gasPrice),blobGasUsed:Re(this.blobGasUsed),blobGasPrice:Re(this.blobGasPrice),gasUsed:Re(this.gasUsed),hash:s,index:a,logs:d,logsBloom:l,root:u,status:f,to:e}}get length(){return this.logs.length}[Symbol.iterator](){let e=0;return{next:()=>e<this.length?{value:this.logs[e++],done:!1}:{value:void 0,done:!0}}}get fee(){return this.gasUsed*this.gasPrice}async getBlock(){const e=await this.provider.getBlock(this.blockHash);if(e==null)throw new Error("TODO");return e}async getTransaction(){const e=await this.provider.getTransaction(this.hash);if(e==null)throw new Error("TODO");return e}async getResult(){return await this.provider.getTransactionResult(this.hash)}async confirmations(){return await this.provider.getBlockNumber()-this.blockNumber+1}removedEvent(){return zo(this)}reorderedEvent(e){return U(!e||e.isMined(),"unmined 'other' transction cannot be orphaned","UNSUPPORTED_OPERATION",{operation:"reorderedEvent(other)"}),Vo(this,e)}}un=new WeakMap;var It;const na=class na{constructor(e,t){w(this,"provider");w(this,"blockNumber");w(this,"blockHash");w(this,"index");w(this,"hash");w(this,"type");w(this,"to");w(this,"from");w(this,"nonce");w(this,"gasLimit");w(this,"gasPrice");w(this,"maxPriorityFeePerGas");w(this,"maxFeePerGas");w(this,"maxFeePerBlobGas");w(this,"data");w(this,"value");w(this,"chainId");w(this,"signature");w(this,"accessList");w(this,"blobVersionedHashes");w(this,"authorizationList");F(this,It);this.provider=t,this.blockNumber=e.blockNumber!=null?e.blockNumber:null,this.blockHash=e.blockHash!=null?e.blockHash:null,this.hash=e.hash,this.index=e.index,this.type=e.type,this.from=e.from,this.to=e.to||null,this.gasLimit=e.gasLimit,this.nonce=e.nonce,this.data=e.data,this.value=e.value,this.gasPrice=e.gasPrice,this.maxPriorityFeePerGas=e.maxPriorityFeePerGas!=null?e.maxPriorityFeePerGas:null,this.maxFeePerGas=e.maxFeePerGas!=null?e.maxFeePerGas:null,this.maxFeePerBlobGas=e.maxFeePerBlobGas!=null?e.maxFeePerBlobGas:null,this.chainId=e.chainId,this.signature=e.signature,this.accessList=e.accessList!=null?e.accessList:null,this.blobVersionedHashes=e.blobVersionedHashes!=null?e.blobVersionedHashes:null,this.authorizationList=e.authorizationList!=null?e.authorizationList:null,P(this,It,-1)}toJSON(){const{blockNumber:e,blockHash:t,index:n,hash:s,type:a,to:i,from:o,nonce:l,data:d,signature:f,accessList:u,blobVersionedHashes:h}=this;return{_type:"TransactionResponse",accessList:u,blockNumber:e,blockHash:t,blobVersionedHashes:h,chainId:Re(this.chainId),data:d,from:o,gasLimit:Re(this.gasLimit),gasPrice:Re(this.gasPrice),hash:s,maxFeePerGas:Re(this.maxFeePerGas),maxPriorityFeePerGas:Re(this.maxPriorityFeePerGas),maxFeePerBlobGas:Re(this.maxFeePerBlobGas),nonce:l,signature:f,to:i,index:n,type:a,value:Re(this.value)}}async getBlock(){let e=this.blockNumber;if(e==null){const n=await this.getTransaction();n&&(e=n.blockNumber)}if(e==null)return null;const t=this.provider.getBlock(e);if(t==null)throw new Error("TODO");return t}async getTransaction(){return this.provider.getTransaction(this.hash)}async confirmations(){if(this.blockNumber==null){const{tx:t,blockNumber:n}=await ms({tx:this.getTransaction(),blockNumber:this.provider.getBlockNumber()});return t==null||t.blockNumber==null?0:n-t.blockNumber+1}return await this.provider.getBlockNumber()-this.blockNumber+1}async wait(e,t){const n=e??1,s=t??0;let a=b(this,It),i=-1,o=a===-1;const l=async()=>{if(o)return null;const{blockNumber:h,nonce:g}=await ms({blockNumber:this.provider.getBlockNumber(),nonce:this.provider.getTransactionCount(this.from)});if(g<this.nonce){a=h;return}if(o)return null;const x=await this.getTransaction();if(!(x&&x.blockNumber!=null))for(i===-1&&(i=a-3,i<b(this,It)&&(i=b(this,It)));i<=h;){if(o)return null;const p=await this.provider.getBlock(i,!0);if(p==null)return;for(const m of p)if(m===this.hash)return;for(let m=0;m<p.length;m++){const y=await p.getTransaction(m);if(y.from===this.from&&y.nonce===this.nonce){if(o)return null;const A=await this.provider.getTransactionReceipt(y.hash);if(A==null||h-A.blockNumber+1<n)return;let N="replaced";y.data===this.data&&y.to===this.to&&y.value===this.value?N="repriced":y.data==="0x"&&y.from===y.to&&y.value===Ko&&(N="cancelled"),U(!1,"transaction was replaced","TRANSACTION_REPLACED",{cancelled:N==="replaced"||N==="cancelled",reason:N,replacement:y.replaceableTransaction(a),hash:y.hash,receipt:A})}}i++}},d=h=>{if(h==null||h.status!==0)return h;U(!1,"transaction execution reverted","CALL_EXCEPTION",{action:"sendTransaction",data:null,reason:null,invocation:null,revert:null,transaction:{to:h.to,from:h.from,data:""},receipt:h})},f=await this.provider.getTransactionReceipt(this.hash);if(n===0)return d(f);if(f){if(n===1||await f.confirmations()>=n)return d(f)}else if(await l(),n===0)return null;return await new Promise((h,g)=>{const x=[],p=()=>{x.forEach(y=>y())};if(x.push(()=>{o=!0}),s>0){const y=setTimeout(()=>{p(),g(Xt("wait for transaction timeout","TIMEOUT"))},s);x.push(()=>{clearTimeout(y)})}const m=async y=>{if(await y.confirmations()>=n){p();try{h(d(y))}catch(A){g(A)}}};if(x.push(()=>{this.provider.off(this.hash,m)}),this.provider.on(this.hash,m),a>=0){const y=async()=>{try{await l()}catch(A){if(Sr(A,"TRANSACTION_REPLACED")){p(),g(A);return}}o||this.provider.once("block",y)};x.push(()=>{this.provider.off("block",y)}),this.provider.once("block",y)}})}isMined(){return this.blockHash!=null}isLegacy(){return this.type===0}isBerlin(){return this.type===1}isLondon(){return this.type===2}isCancun(){return this.type===3}removedEvent(){return U(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),zo(this)}reorderedEvent(e){return U(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),U(!e||e.isMined(),"unmined 'other' transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),Vo(this,e)}replaceableTransaction(e){v(Number.isInteger(e)&&e>=0,"invalid startBlock","startBlock",e);const t=new na(this,this.provider);return P(t,It,e),t}};It=new WeakMap;let Bs=na;function Vo(r,e){return{orphan:"reorder-transaction",tx:r,other:e}}function zo(r){return{orphan:"drop-transaction",tx:r}}function $d(r){return{orphan:"drop-log",log:{transactionHash:r.transactionHash,blockHash:r.blockHash,blockNumber:r.blockNumber,address:r.address,data:r.data,topics:Object.freeze(r.topics.slice()),index:r.index}}}class Ys extends ns{constructor(t,n,s){super(t,t.provider);w(this,"interface");w(this,"fragment");w(this,"args");const a=n.decodeEventLog(s,t.data,t.topics);H(this,{args:a,fragment:s,interface:n})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}class Qo extends ns{constructor(t,n){super(t,t.provider);w(this,"error");H(this,{error:n})}}var Tr;class Jd extends Qd{constructor(t,n,s){super(s,n);F(this,Tr);P(this,Tr,t)}get logs(){return super.logs.map(t=>{const n=t.topics.length?b(this,Tr).getEvent(t.topics[0]):null;if(n)try{return new Ys(t,b(this,Tr),n)}catch(s){return new Qo(t,s)}return t})}}Tr=new WeakMap;var hn;class Xs extends Bs{constructor(t,n,s){super(s,n);F(this,hn);P(this,hn,t)}async wait(t,n){const s=await super.wait(t,n);return s==null?null:new Jd(b(this,hn),this.provider,s)}}hn=new WeakMap;class $o extends rl{constructor(t,n,s,a){super(t,n,s);w(this,"log");H(this,{log:a})}async getBlock(){return await this.log.getBlock()}async getTransaction(){return await this.log.getTransaction()}async getTransactionReceipt(){return await this.log.getTransactionReceipt()}}class Wd extends $o{constructor(e,t,n,s,a){super(e,t,n,new Ys(a,e.interface,s));const i=e.interface.decodeEventLog(s,this.log.data,this.log.topics);H(this,{args:i,fragment:s})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}const ii=BigInt(0);function Jo(r){return r&&typeof r.call=="function"}function Wo(r){return r&&typeof r.estimateGas=="function"}function ss(r){return r&&typeof r.resolveName=="function"}function Zo(r){return r&&typeof r.sendTransaction=="function"}function Yo(r){if(r!=null){if(ss(r))return r;if(r.provider)return r.provider}}var xn;class Zd{constructor(e,t,n){F(this,xn);w(this,"fragment");if(H(this,{fragment:t}),t.inputs.length<n.length)throw new Error("too many arguments");const s=tr(e.runner,"resolveName"),a=ss(s)?s:null;P(this,xn,async function(){const i=await Promise.all(t.inputs.map((o,l)=>n[l]==null?null:o.walkAsync(n[l],(f,u)=>f==="address"?Array.isArray(u)?Promise.all(u.map(h=>nn(h,a))):nn(u,a):u)));return e.interface.encodeFilterTopics(t,i)}())}getTopicFilter(){return b(this,xn)}}xn=new WeakMap;function tr(r,e){return r==null?null:typeof r[e]=="function"?r:r.provider&&typeof r.provider[e]=="function"?r.provider:null}function Lt(r){return r==null?null:r.provider||null}async function Xo(r,e){const t=pe.dereference(r,"overrides");v(typeof t=="object","invalid overrides parameter","overrides",r);const n=zd(t);return v(n.to==null||(e||[]).indexOf("to")>=0,"cannot override to","overrides.to",n.to),v(n.data==null||(e||[]).indexOf("data")>=0,"cannot override data","overrides.data",n.data),n.from&&(n.from=n.from),n}async function Yd(r,e,t){const n=tr(r,"resolveName"),s=ss(n)?n:null;return await Promise.all(e.map((a,i)=>a.walkAsync(t[i],(o,l)=>(l=pe.dereference(l,o),o==="address"?nn(l,s):l))))}function Xd(r){const e=async function(i){const o=await Xo(i,["data"]);o.to=await r.getAddress(),o.from&&(o.from=await nn(o.from,Yo(r.runner)));const l=r.interface,d=re(o.value||ii,"overrides.value")===ii,f=(o.data||"0x")==="0x";l.fallback&&!l.fallback.payable&&l.receive&&!f&&!d&&v(!1,"cannot send data to receive or send value to non-payable fallback","overrides",i),v(l.fallback||f,"cannot send data to receive-only contract","overrides.data",o.data);const u=l.receive||l.fallback&&l.fallback.payable;return v(u||d,"cannot send value to non-payable fallback","overrides.value",o.value),v(l.fallback||f,"cannot send data to receive-only contract","overrides.data",o.data),o},t=async function(i){const o=tr(r.runner,"call");U(Jo(o),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const l=await e(i);try{return await o.call(l)}catch(d){throw gi(d)&&d.data?r.interface.makeError(d.data,l):d}},n=async function(i){const o=r.runner;U(Zo(o),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const l=await o.sendTransaction(await e(i)),d=Lt(r.runner);return new Xs(r.interface,d,l)},s=async function(i){const o=tr(r.runner,"estimateGas");return U(Wo(o),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await o.estimateGas(await e(i))},a=async i=>await n(i);return H(a,{_contract:r,estimateGas:s,populateTransaction:e,send:n,staticCall:t}),a}function qd(r,e){const t=function(...d){const f=r.interface.getFunction(e,d);return U(f,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e,args:d}}),f},n=async function(...d){const f=t(...d);let u={};if(f.inputs.length+1===d.length&&(u=await Xo(d.pop()),u.from&&(u.from=await nn(u.from,Yo(r.runner)))),f.inputs.length!==d.length)throw new Error("internal error: fragment inputs doesn't match arguments; should not happen");const h=await Yd(r.runner,f.inputs,d);return Object.assign({},u,await ms({to:r.getAddress(),data:r.interface.encodeFunctionData(f,h)}))},s=async function(...d){const f=await o(...d);return f.length===1?f[0]:f},a=async function(...d){const f=r.runner;U(Zo(f),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const u=await f.sendTransaction(await n(...d)),h=Lt(r.runner);return new Xs(r.interface,h,u)},i=async function(...d){const f=tr(r.runner,"estimateGas");return U(Wo(f),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await f.estimateGas(await n(...d))},o=async function(...d){const f=tr(r.runner,"call");U(Jo(f),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const u=await n(...d);let h="0x";try{h=await f.call(u)}catch(x){throw gi(x)&&x.data?r.interface.makeError(x.data,u):x}const g=t(...d);return r.interface.decodeFunctionResult(g,h)},l=async(...d)=>t(...d).constant?await s(...d):await a(...d);return H(l,{name:r.interface.getFunctionName(e),_contract:r,_key:e,getFragment:t,estimateGas:i,populateTransaction:n,send:a,staticCall:s,staticCallResult:o}),Object.defineProperty(l,"fragment",{configurable:!1,enumerable:!0,get:()=>{const d=r.interface.getFunction(e);return U(d,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e}}),d}}),l}function ef(r,e){const t=function(...s){const a=r.interface.getEvent(e,s);return U(a,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e,args:s}}),a},n=function(...s){return new Zd(r,t(...s),s)};return H(n,{name:r.interface.getEventName(e),_contract:r,_key:e,getFragment:t}),Object.defineProperty(n,"fragment",{configurable:!1,enumerable:!0,get:()=>{const s=r.interface.getEvent(e);return U(s,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e}}),s}}),n}const Ln=Symbol.for("_ethersInternal_contract"),qo=new WeakMap;function tf(r,e){qo.set(r[Ln],e)}function Ie(r){return qo.get(r[Ln])}function rf(r){return r&&typeof r=="object"&&"getTopicFilter"in r&&typeof r.getTopicFilter=="function"&&r.fragment}async function qs(r,e){let t,n=null;if(Array.isArray(e)){const a=function(i){if(Ee(i,32))return i;const o=r.interface.getEvent(i);return v(o,"unknown fragment","name",i),o.topicHash};t=e.map(i=>i==null?null:Array.isArray(i)?i.map(a):a(i))}else e==="*"?t=[null]:typeof e=="string"?Ee(e,32)?t=[e]:(n=r.interface.getEvent(e),v(n,"unknown fragment","event",e),t=[n.topicHash]):rf(e)?t=await e.getTopicFilter():"fragment"in e?(n=e.fragment,t=[n.topicHash]):v(!1,"unknown event name","event",e);t=t.map(a=>{if(a==null)return null;if(Array.isArray(a)){const i=Array.from(new Set(a.map(o=>o.toLowerCase())).values());return i.length===1?i[0]:(i.sort(),i)}return a.toLowerCase()});const s=t.map(a=>a==null?"null":Array.isArray(a)?a.join("|"):a).join("&");return{fragment:n,tag:s,topics:t}}async function zr(r,e){const{subs:t}=Ie(r);return t.get((await qs(r,e)).tag)||null}async function oi(r,e,t){const n=Lt(r.runner);U(n,"contract runner does not support subscribing","UNSUPPORTED_OPERATION",{operation:e});const{fragment:s,tag:a,topics:i}=await qs(r,t),{addr:o,subs:l}=Ie(r);let d=l.get(a);if(!d){const u={address:o||r,topics:i},h=m=>{let y=s;if(y==null)try{y=r.interface.getEvent(m.topics[0])}catch{}if(y){const A=y,N=s?r.interface.decodeEventLog(s,m.data,m.topics):[];Us(r,t,N,I=>new Wd(r,I,t,A,m))}else Us(r,t,[],A=>new $o(r,A,t,m))};let g=[];d={tag:a,listeners:[],start:()=>{g.length||g.push(n.on(u,h))},stop:async()=>{if(g.length==0)return;let m=g;g=[],await Promise.all(m),n.off(u,h)}},l.set(a,d)}return d}let Rs=Promise.resolve();async function nf(r,e,t,n){await Rs;const s=await zr(r,e);if(!s)return!1;const a=s.listeners.length;return s.listeners=s.listeners.filter(({listener:i,once:o})=>{const l=Array.from(t);n&&l.push(n(o?null:i));try{i.call(r,...l)}catch{}return!o}),s.listeners.length===0&&(s.stop(),Ie(r).subs.delete(s.tag)),a>0}async function Us(r,e,t,n){try{await Rs}catch{}const s=nf(r,e,t,n);return Rs=s,await s}const kn=["then"];var di;di=Ln;const Yr=class Yr{constructor(e,t,n,s){w(this,"target");w(this,"interface");w(this,"runner");w(this,"filters");w(this,di);w(this,"fallback");v(typeof e=="string"||Po(e),"invalid value for Contract target","target",e),n==null&&(n=null);const a=Os.from(t);H(this,{target:e,runner:n,interface:a}),Object.defineProperty(this,Ln,{value:{}});let i,o=null,l=null;if(s){const u=Lt(n);l=new Xs(this.interface,u,s)}let d=new Map;if(typeof e=="string")if(Ee(e))o=e,i=Promise.resolve(e);else{const u=tr(n,"resolveName");if(!ss(u))throw Xt("contract runner does not support name resolution","UNSUPPORTED_OPERATION",{operation:"resolveName"});i=u.resolveName(e).then(h=>{if(h==null)throw Xt("an ENS name used for a contract target must be correctly configured","UNCONFIGURED_NAME",{value:e});return Ie(this).addr=h,h})}else i=e.getAddress().then(u=>{if(u==null)throw new Error("TODO");return Ie(this).addr=u,u});tf(this,{addrPromise:i,addr:o,deployTx:l,subs:d});const f=new Proxy({},{get:(u,h,g)=>{if(typeof h=="symbol"||kn.indexOf(h)>=0)return Reflect.get(u,h,g);try{return this.getEvent(h)}catch(x){if(!Sr(x,"INVALID_ARGUMENT")||x.argument!=="key")throw x}},has:(u,h)=>kn.indexOf(h)>=0?Reflect.has(u,h):Reflect.has(u,h)||this.interface.hasEvent(String(h))});return H(this,{filters:f}),H(this,{fallback:a.receive||a.fallback?Xd(this):null}),new Proxy(this,{get:(u,h,g)=>{if(typeof h=="symbol"||h in u||kn.indexOf(h)>=0)return Reflect.get(u,h,g);try{return u.getFunction(h)}catch(x){if(!Sr(x,"INVALID_ARGUMENT")||x.argument!=="key")throw x}},has:(u,h)=>typeof h=="symbol"||h in u||kn.indexOf(h)>=0?Reflect.has(u,h):u.interface.hasFunction(h)})}connect(e){return new Yr(this.target,this.interface,e)}attach(e){return new Yr(e,this.interface,this.runner)}async getAddress(){return await Ie(this).addrPromise}async getDeployedCode(){const e=Lt(this.runner);U(e,"runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"getDeployedCode"});const t=await e.getCode(await this.getAddress());return t==="0x"?null:t}async waitForDeployment(){const e=this.deploymentTransaction();if(e)return await e.wait(),this;if(await this.getDeployedCode()!=null)return this;const n=Lt(this.runner);return U(n!=null,"contract runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"waitForDeployment"}),new Promise((s,a)=>{const i=async()=>{try{if(await this.getDeployedCode()!=null)return s(this);n.once("block",i)}catch(o){a(o)}};i()})}deploymentTransaction(){return Ie(this).deployTx}getFunction(e){return typeof e!="string"&&(e=e.format()),qd(this,e)}getEvent(e){return typeof e!="string"&&(e=e.format()),ef(this,e)}async queryTransaction(e){throw new Error("@TODO")}async queryFilter(e,t,n){t==null&&(t=0),n==null&&(n="latest");const{addr:s,addrPromise:a}=Ie(this),i=s||await a,{fragment:o,topics:l}=await qs(this,e),d={address:i,topics:l,fromBlock:t,toBlock:n},f=Lt(this.runner);return U(f,"contract runner does not have a provider","UNSUPPORTED_OPERATION",{operation:"queryFilter"}),(await f.getLogs(d)).map(u=>{let h=o;if(h==null)try{h=this.interface.getEvent(u.topics[0])}catch{}if(h)try{return new Ys(u,this.interface,h)}catch(g){return new Qo(u,g)}return new ns(u,f)})}async on(e,t){const n=await oi(this,"on",e);return n.listeners.push({listener:t,once:!1}),n.start(),this}async once(e,t){const n=await oi(this,"once",e);return n.listeners.push({listener:t,once:!0}),n.start(),this}async emit(e,...t){return await Us(this,e,t,null)}async listenerCount(e){if(e){const s=await zr(this,e);return s?s.listeners.length:0}const{subs:t}=Ie(this);let n=0;for(const{listeners:s}of t.values())n+=s.length;return n}async listeners(e){if(e){const s=await zr(this,e);return s?s.listeners.map(({listener:a})=>a):[]}const{subs:t}=Ie(this);let n=[];for(const{listeners:s}of t.values())n=n.concat(s.map(({listener:a})=>a));return n}async off(e,t){const n=await zr(this,e);if(!n)return this;if(t){const s=n.listeners.map(({listener:a})=>a).indexOf(t);s>=0&&n.listeners.splice(s,1)}return(t==null||n.listeners.length===0)&&(n.stop(),Ie(this).subs.delete(n.tag)),this}async removeAllListeners(e){if(e){const t=await zr(this,e);if(!t)return this;t.stop(),Ie(this).subs.delete(t.tag)}else{const{subs:t}=Ie(this);for(const{tag:n,stop:s}of t.values())s(),t.delete(n)}return this}async addListener(e,t){return await this.on(e,t)}async removeListener(e,t){return await this.off(e,t)}static buildClass(e){class t extends Yr{constructor(s,a=null){super(s,e,a)}}return t}static from(e,t,n){return n==null&&(n=null),new this(e,t,n)}};let Fs=Yr;function sf(){return Fs}class ku extends sf(){}const af=new RegExp("^(ipfs)://(.*)$","i"),Pu=[new RegExp("^(https)://(.*)$","i"),new RegExp("^(data):(.*)$","i"),af,new RegExp("^eip155:[0-9]+/(erc[0-9]+):(.*)$","i")];const Tu=BigInt(0);function ie(r,e){return function(t){return t==null?e:r(t)}}function ea(r,e){return t=>{if(e&&t==null)return null;if(!Array.isArray(t))throw new Error("not an array");return t.map(n=>r(n))}}function as(r,e){return t=>{const n={};for(const s in r){let a=s;if(e&&s in e&&!(a in t)){for(const i of e[s])if(i in t){a=i;break}}try{const i=r[s](t[a]);i!==void 0&&(n[s]=i)}catch(i){const o=i instanceof Error?i.message:"not-an-error";U(!1,`invalid value for value.${s} (${o})`,"BAD_DATA",{value:t})}}return n}}function of(r){switch(r){case!0:case"true":return!0;case!1:case"false":return!1}v(!1,`invalid boolean; ${JSON.stringify(r)}`,"value",r)}function on(r){return v(Ee(r,!0),"invalid data","value",r),r}function Ae(r){return v(Ee(r,32),"invalid hash","value",r),r}const Su=as({address:Ne,blockHash:Ae,blockNumber:ne,data:on,index:ne,removed:ie(of,!1),topics:ea(Ae),transactionHash:Ae,transactionIndex:ne},{index:["logIndex"]});const Ou=as({hash:ie(Ae),parentHash:Ae,parentBeaconBlockRoot:ie(Ae,null),number:ne,timestamp:ne,nonce:ie(on),difficulty:re,gasLimit:re,gasUsed:re,stateRoot:ie(Ae,null),receiptsRoot:ie(Ae,null),blobGasUsed:ie(re,null),excessBlobGas:ie(re,null),miner:ie(Ne),prevRandao:ie(Ae,null),extraData:on,baseFeePerGas:ie(re)},{prevRandao:["mixHash"]});const cf=as({transactionIndex:ne,blockNumber:ne,transactionHash:Ae,address:Ne,topics:ea(Ae),data:on,index:ne,blockHash:Ae},{index:["logIndex"]});function lf(r){return cf(r)}const Bu=as({to:ie(Ne,null),from:ie(Ne,null),contractAddress:ie(Ne,null),index:ne,root:ie(K),gasUsed:re,blobGasUsed:ie(re,null),logsBloom:ie(on),blockHash:Ae,hash:Ae,logs:ea(lf),blockNumber:ne,cumulativeGasUsed:re,effectiveGasPrice:ie(re),blobGasPrice:ie(re,null),status:ie(ne),type:ie(ne,0)},{effectiveGasPrice:["gasPrice"],hash:["transactionHash"],index:["transactionIndex"]});const Ru=BigInt(2);const Uu=new Uint8Array([]);const Fu="bigint,boolean,function,number,string,symbol".split(/,/g);const Du={polling:!1,staticNetwork:null,batchStallTime:10,batchMaxSize:1<<20,batchMaxCount:100,cacheTimeout:250,pollingInterval:4e3};/*! MIT License. Copyright 2015-2022 Richard Moore <me@ricmoo.com>. See LICENSE.txt. */var df,ff,uf;df=new WeakMap,ff=new WeakMap,uf=new WeakMap;var hf,xf;hf=new WeakMap,xf=new WeakMap;var pf,bf,gf;pf=new WeakMap,bf=new WeakMap,gf=new WeakMap;const Lu=new Uint8Array([66,105,116,99,111,105,110,32,115,101,101,100]);const ju=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141");class mf{constructor(){w(this,"userId",null);w(this,"coldWallets",new Map);this.getDefaultWallets().forEach(e=>{this.coldWallets.set(e.id,e)})}getDefaultWallets(){const e=[];return e.push({id:"cw_btc_1",address:ce.coldWallets.btc,chain:"bitcoin",currency:"BTC",minAmount:1e-5,enabled:!0,label:"Primary BTC Cold Wallet"}),e.push({id:"cw_eth_1",address:ce.coldWallets.eth,chain:"ethereum",currency:"ETH",minAmount:1e-4,enabled:!0,label:"Primary ETH Cold Wallet"}),e.push({id:"cw_bsc_1",address:ce.coldWallets.bsc,chain:"binance-smart-chain",currency:"BNB",minAmount:.001,enabled:!0,label:"Primary BSC Cold Wallet"}),e.push({id:"cw_polygon_1",address:ce.coldWallets.polygon,chain:"polygon",currency:"MATIC",minAmount:.01,enabled:!0,label:"Primary Polygon Cold Wallet"}),e.push({id:"cw_solana_1",address:ce.coldWallets.solana,chain:"solana",currency:"SOL",minAmount:.001,enabled:!0,label:"Primary Solana Cold Wallet"}),e.push({id:"cw_tron_1",address:ce.coldWallets.tron,chain:"tron",currency:"TRX",minAmount:1,enabled:!0,label:"Primary Tron Cold Wallet"}),e}async initialize(e){this.userId=e,await this.loadUserWallets()}async loadUserWallets(){if(this.userId)try{const{data:e,error:t}=await te.from("cold_wallets").select("*").eq("user_id",this.userId).eq("enabled",!0);if(t)throw t;e&&e.length>0&&e.forEach(n=>{this.coldWallets.set(n.id,{id:n.id,address:n.address,chain:n.chain,currency:n.currency,minAmount:n.min_amount,enabled:n.enabled,label:n.label})})}catch(e){console.error("Failed to load user wallets:",e)}}getColdWallets(){return Array.from(this.coldWallets.values()).filter(e=>e.enabled)}getWalletByChain(e){return Array.from(this.coldWallets.values()).find(t=>t.chain===e&&t.enabled)}async addCustomWallet(e){if(!this.userId)throw new Error("User not initialized");const t=`cw_custom_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,{error:n}=await te.from("cold_wallets").insert({id:t,user_id:this.userId,address:e.address,chain:e.chain,currency:e.currency,min_amount:e.minAmount,enabled:e.enabled,label:e.label,created_at:new Date().toISOString()});if(n)throw n;this.coldWallets.set(t,{id:t,...e})}async processMicroPayment(e,t,n,s){if(!this.userId)throw new Error("User not initialized");const a=this.getWalletByChain(s);if(!a)throw new Error(`No cold wallet configured for chain: ${s}`);if(t<a.minAmount)throw new Error(`Amount below minimum threshold: ${a.minAmount} ${n}`);const o=t*.001,d=t*5e-4,f={id:`mp_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,userId:this.userId,orderId:e,walletAddress:a.address,amount:t,currency:n,chain:s,status:"pending",timestamp:new Date,feeAmount:o,exchangeFee:d};try{const{error:u}=await te.from("micro_payments").insert({id:f.id,user_id:f.userId,order_id:f.orderId,wallet_address:f.walletAddress,amount:f.amount,currency:f.currency,chain:f.chain,status:f.status,created_at:f.timestamp.toISOString(),fee_amount:f.feeAmount,exchange_fee:f.exchangeFee});if(u)throw u;return this.queuePaymentProcessing(f.id),f}catch(u){throw console.error("Failed to process micro payment:",u),u}}async queuePaymentProcessing(e){setTimeout(async()=>{try{await te.from("micro_payments").update({status:"processing"}).eq("id",e),setTimeout(async()=>{const n="",s="";let a=null;a||(a=`0x${Math.random().toString(16).slice(2,66)}`),await te.from("micro_payments").update({status:"completed",tx_hash:a,completed_at:new Date().toISOString()}).eq("id",e)},3e3)}catch(t){console.error("Payment processing failed:",t),await te.from("micro_payments").update({status:"failed"}).eq("id",e)}},1e3)}async getPaymentHistory(e=50){if(!this.userId)throw new Error("User not initialized");const{data:t,error:n}=await te.from("micro_payments").select("*").eq("user_id",this.userId).order("created_at",{ascending:!1}).limit(e);if(n)throw n;return(t||[]).map(s=>({id:s.id,userId:s.user_id,orderId:s.order_id,walletAddress:s.wallet_address,amount:s.amount,currency:s.currency,chain:s.chain,txHash:s.tx_hash,status:s.status,timestamp:new Date(s.created_at),feeAmount:s.fee_amount,exchangeFee:s.exchange_fee}))}async getTotalPayments(){if(!this.userId)throw new Error("User not initialized");const{data:e,error:t}=await te.from("micro_payments").select("status, amount").eq("user_id",this.userId);if(t)throw t;return(e||[]).reduce((s,a)=>(s.total+=a.amount,a.status==="completed"&&(s.completed+=a.amount),(a.status==="pending"||a.status==="processing")&&(s.pending+=a.amount),s),{total:0,completed:0,pending:0})}async automatePaymentOnTrade(e,t,n,s){const i=t*2e-4;let o="ethereum";n.includes("BNB")?o="binance-smart-chain":n.includes("MATIC")?o="polygon":n.includes("BTC")&&(o="bitcoin");try{await this.processMicroPayment(e,i,n,o)}catch(l){console.error("Automated payment failed:",l)}}}new mf;class yf{constructor(){w(this,"baseUrl");w(this,"wsBaseUrl","wss://stream.binance.com:9443/ws");w(this,"apiKey");w(this,"secretKey");w(this,"rateLimits",{weight:1200,orders:10,rawRequests:6100});w(this,"defaultPairs",["BTCUSDT","ETHUSDT","BNBUSDT","SOLUSDT","ADAUSDT","XRPUSDT","DOGEUSDT","DOTUSDT","MATICUSDT","AVAXUSDT"]);this.apiKey=ce.binance.apiKey,this.secretKey=ce.binance.secretKey,this.baseUrl="https://api.binance.com/api/v3"}getKlinesUrl(e,t,n=500){return`${this.baseUrl}/klines?symbol=${e.toUpperCase()}&interval=${t}&limit=${n}`}getDepthUrl(e,t=100){return`${this.baseUrl}/depth?symbol=${e.toUpperCase()}&limit=${t}`}getTickerUrl(e){return`${this.baseUrl}/ticker/price?symbol=${e.toUpperCase()}`}get24hrTickerUrl(e){return`${this.baseUrl}/ticker/24hr?symbol=${e.toUpperCase()}`}getTradeWebSocketUrl(e){return`${this.wsBaseUrl}/${e.toLowerCase()}@trade`}getDepthWebSocketUrl(e){return`${this.wsBaseUrl}/${e.toLowerCase()}@depth`}getKlineWebSocketUrl(e,t){return`${this.wsBaseUrl}/${e.toLowerCase()}@kline_${t}`}formatKlinesToCandles(e){return e.map(t=>({x:t[0],y:[parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3]),parseFloat(t[4])]}))}formatDepthResponse(e){return{bids:e.bids.map(([t,n])=>({price:parseFloat(t),volume:parseFloat(n)})),asks:e.asks.map(([t,n])=>({price:parseFloat(t),volume:parseFloat(n)}))}}formatTradeMessage(e){return{price:parseFloat(e.p),volume:parseFloat(e.q),timestamp:e.T,side:e.m?"sell":"buy"}}convertTimeframe(e){return{"1m":"1m","5m":"5m","15m":"15m","1h":"1h","4h":"4h","1d":"1d","1w":"1w"}[e]||"1m"}formatSymbol(e,t){return`${e.toUpperCase()}${t.toUpperCase()}`}parseSymbol(e){const t=["USDT","USDC","BUSD","BTC","ETH","BNB"];for(const n of t)if(e.endsWith(n))return{base:e.slice(0,-n.length),quote:n};return{base:e.slice(0,-4),quote:e.slice(-4)}}validateSymbol(e){return/^[A-Z]{3,10}$/.test(e.toUpperCase())}createSignature(e){return Oc.HmacSHA256(e,this.secretKey).toString()}createAuthHeaders(){return{"X-MBX-APIKEY":this.apiKey,"Content-Type":"application/json"}}createSignedParams(e){const t=Date.now(),n=new URLSearchParams({...e,timestamp:t.toString()}).toString(),s=this.createSignature(n);return`${n}&signature=${s}`}async getAccountInfo(){if(!this.apiKey||!this.secretKey)throw new Error("Binance API credentials not configured");const e=this.createSignedParams({}),t=`${this.baseUrl}/account?${e}`,n=await fetch(t,{method:"GET",headers:this.createAuthHeaders()});if(!n.ok){const s=await n.json();throw new Error(`Binance API Error: ${s.msg||"Unknown error"}`)}return n.json()}async getBalance(e){const n=(await this.getAccountInfo()).balances.find(s=>s.asset===e.toUpperCase());return{free:parseFloat((n==null?void 0:n.free)||"0"),locked:parseFloat((n==null?void 0:n.locked)||"0")}}async placeBuyOrder(e,t,n,s="MARKET"){throw!this.apiKey||!this.secretKey?new Error("Binance API credentials not configured"):new Error("Real trading is disabled. Enable in configuration.")}async placeSellOrder(e,t,n,s="MARKET"){throw!this.apiKey||!this.secretKey?new Error("Binance API credentials not configured"):new Error("Real trading is disabled. Enable in configuration.")}async cancelOrder(e,t){if(!this.apiKey||!this.secretKey)throw new Error("Binance API credentials not configured");const n=this.createSignedParams({symbol:e.toUpperCase(),orderId:t.toString()}),s=`${this.baseUrl}/order`,a=await fetch(s,{method:"DELETE",headers:this.createAuthHeaders(),body:n});if(!a.ok){const i=await a.json();throw new Error(`Binance Cancel Error: ${i.msg||"Unknown error"}`)}return a.json()}async getOpenOrders(e){if(!this.apiKey||!this.secretKey)throw new Error("Binance API credentials not configured");const t={};e&&(t.symbol=e.toUpperCase());const n=this.createSignedParams(t),s=`${this.baseUrl}/openOrders?${n}`,a=await fetch(s,{method:"GET",headers:this.createAuthHeaders()});if(!a.ok){const i=await a.json();throw new Error(`Binance API Error: ${i.msg||"Unknown error"}`)}return a.json()}async fetchKlines(e,t,n=500){try{const s=this.getKlinesUrl(e,t,n),a=await fetch(s);if(!a.ok)throw new Error(`HTTP ${a.status}: ${a.statusText}`);const i=await a.json();return this.formatKlinesToCandles(i)}catch(s){throw console.error("Binance fetchKlines error:",s),s}}async fetchOrderBook(e,t=100){try{const n=this.getDepthUrl(e,t),s=await fetch(n);if(!s.ok)throw new Error(`HTTP ${s.status}: ${s.statusText}`);const a=await s.json();return this.formatDepthResponse(a)}catch(n){throw console.error("Binance fetchOrderBook error:",n),n}}async fetchTicker(e){try{const[t,n]=await Promise.all([fetch(this.getTickerUrl(e)),fetch(this.get24hrTickerUrl(e))]);if(!t.ok||!n.ok)throw new Error("Failed to fetch ticker data");const s=await t.json(),a=await n.json();return{price:parseFloat(s.price),change24h:parseFloat(a.priceChangePercent)}}catch(t){throw console.error("Binance fetchTicker error:",t),t}}createAuthenticatedWebSocket(){return!this.apiKey||!this.secretKey?(console.warn("Binance API credentials not configured for WebSocket"),null):new WebSocket(this.wsBaseUrl)}isConfigured(){return!!(this.apiKey&&this.secretKey)}getConfiguration(){return{hasCredentials:this.isConfigured(),testnet:!1,tradingEnabled:ce.trading.enableRealTrading}}handleError(e){var t,n;return(n=(t=e.response)==null?void 0:t.data)!=null&&n.msg?`Binance Error: ${e.response.data.msg}`:e.message?`Binance Error: ${e.message}`:"Binance: Unknown error occurred"}}const yt=new yf;class wf{constructor(){w(this,"baseUrl","https://www.alphavantage.co/query");w(this,"apiKey");this.apiKey=ce.alphaVantage.apiKey}async getQuote(e){if(!this.apiKey)throw new Error("Alpha Vantage API key not configured");const t=`${this.baseUrl}?function=GLOBAL_QUOTE&symbol=${e}&apikey=${this.apiKey}`,n=await fetch(t);if(!n.ok)throw new Error(`Alpha Vantage API error: ${n.statusText}`);const a=(await n.json())["Global Quote"];if(!a)throw new Error("Invalid symbol or API limit reached");return{symbol:a["01. symbol"],price:parseFloat(a["05. price"]),change:parseFloat(a["09. change"]),changePercent:parseFloat(a["10. change percent"].replace("%","")),volume:parseInt(a["06. volume"])}}async getIntradayData(e,t="5min"){if(!this.apiKey)throw new Error("Alpha Vantage API key not configured");const n=`${this.baseUrl}?function=TIME_SERIES_INTRADAY&symbol=${e}&interval=${t}&apikey=${this.apiKey}`,s=await fetch(n);if(!s.ok)throw new Error(`Alpha Vantage API error: ${s.statusText}`);const i=(await s.json())[`Time Series (${t})`];if(!i)throw new Error("No data available or API limit reached");return Object.entries(i).map(([o,l])=>({x:new Date(o).getTime(),y:[parseFloat(l["1. open"]),parseFloat(l["2. high"]),parseFloat(l["3. low"]),parseFloat(l["4. close"])]})).reverse()}async getDailyData(e){if(!this.apiKey)throw new Error("Alpha Vantage API key not configured");const t=`${this.baseUrl}?function=TIME_SERIES_DAILY&symbol=${e}&apikey=${this.apiKey}`,n=await fetch(t);if(!n.ok)throw new Error(`Alpha Vantage API error: ${n.statusText}`);const a=(await n.json())["Time Series (Daily)"];if(!a)throw new Error("No data available or API limit reached");return Object.entries(a).slice(0,100).map(([i,o])=>({x:new Date(i).getTime(),y:[parseFloat(o["1. open"]),parseFloat(o["2. high"]),parseFloat(o["3. low"]),parseFloat(o["4. close"])]})).reverse()}}class Af{constructor(){w(this,"baseUrl","https://api.polygon.io");w(this,"apiKey");this.apiKey=ce.polygon.apiKey}async getQuote(e){var i,o,l;if(!this.apiKey)throw new Error("Polygon API key not configured");const t=`${this.baseUrl}/v2/snapshot/locale/us/markets/stocks/tickers/${e}?apikey=${this.apiKey}`,n=await fetch(t);if(!n.ok)throw new Error(`Polygon API error: ${n.statusText}`);const a=(await n.json()).results;if(!a)throw new Error("Invalid symbol or no data available");return{symbol:a.ticker,price:((i=a.lastQuote)==null?void 0:i.price)||((o=a.prevDay)==null?void 0:o.c)||0,change:a.todaysChange||0,changePercent:a.todaysChangePerc||0,volume:((l=a.day)==null?void 0:l.v)||0}}async getAggregates(e,t=1,n="minute",s,a){if(!this.apiKey)throw new Error("Polygon API key not configured");const i=`${this.baseUrl}/v2/aggs/ticker/${e}/range/${t}/${n}/${s}/${a}?adjusted=true&sort=asc&limit=5000&apikey=${this.apiKey}`,o=await fetch(i);if(!o.ok)throw new Error(`Polygon API error: ${o.statusText}`);const l=await o.json();if(!l.results)throw new Error("No data available");return l.results.map(d=>({x:d.t,y:[d.o,d.h,d.l,d.c]}))}}class Ef{constructor(){w(this,"baseUrl","https://finnhub.io/api/v1");w(this,"apiKey");this.apiKey=ce.finnhub.apiKey}async getQuote(e){if(!this.apiKey)throw new Error("Finnhub API key not configured");const t=`${this.baseUrl}/quote?symbol=${e}&token=${this.apiKey}`,n=await fetch(t);if(!n.ok)throw new Error(`Finnhub API error: ${n.statusText}`);const s=await n.json();if(s.error)throw new Error(`Finnhub error: ${s.error}`);return{symbol:e,price:s.c||0,change:s.d||0,changePercent:s.dp||0,volume:0}}async getCandles(e,t="5",n,s){if(!this.apiKey)throw new Error("Finnhub API key not configured");const a=`${this.baseUrl}/stock/candle?symbol=${e}&resolution=${t}&from=${n}&to=${s}&token=${this.apiKey}`,i=await fetch(a);if(!i.ok)throw new Error(`Finnhub API error: ${i.statusText}`);const o=await i.json();if(o.s!=="ok")throw new Error("No data available");return o.t.map((l,d)=>({x:l*1e3,y:[o.o[d],o.h[d],o.l[d],o.c[d]]}))}async getCompanyProfile(e){if(!this.apiKey)throw new Error("Finnhub API key not configured");const t=`${this.baseUrl}/stock/profile2?symbol=${e}&token=${this.apiKey}`,n=await fetch(t);if(!n.ok)throw new Error(`Finnhub API error: ${n.statusText}`);return n.json()}}class Nf{constructor(){w(this,"alphaVantage");w(this,"polygon");w(this,"finnhub");this.alphaVantage=new wf,this.polygon=new Af,this.finnhub=new Ef}async getQuote(e,t="finnhub"){switch(t){case"alphavantage":return this.alphaVantage.getQuote(e);case"polygon":return this.polygon.getQuote(e);case"finnhub":return this.finnhub.getQuote(e);default:throw new Error("Invalid provider")}}async getCandles(e,t="5m",n="finnhub"){const s=Date.now(),a=s-24*60*60*1e3;switch(n){case"alphavantage":if(t.includes("m")){const u=t.replace("m","min");return this.alphaVantage.getIntradayData(e,u)}else return this.alphaVantage.getDailyData(e);case"polygon":const i=parseInt(t.replace(/[a-zA-Z]/g,"")),o=t.includes("m")?"minute":t.includes("h")?"hour":"day",l=new Date(a).toISOString().split("T")[0],d=new Date(s).toISOString().split("T")[0];return this.polygon.getAggregates(e,i,o,l,d);case"finnhub":let f="5";return t==="1m"?f="1":t==="5m"?f="5":t==="15m"?f="15":t==="30m"?f="30":t==="1h"?f="60":t==="1d"&&(f="D"),this.finnhub.getCandles(e,f,Math.floor(a/1e3),Math.floor(s/1e3));default:throw new Error("Invalid provider")}}getAvailableProviders(){const e=[];return e.push("alphavantage"),e.push("polygon"),e.push("finnhub"),e}isConfigured(){return this.getAvailableProviders().length>0}}const gr=new Nf;class vf{constructor(){w(this,"baseUrl");w(this,"apiKey");w(this,"accountId");this.apiKey=ce.oanda.apiKey,this.accountId=ce.oanda.accountId,this.baseUrl="https://api-fxpractice.oanda.com"}getHeaders(){return{Authorization:`Bearer ${this.apiKey}`,"Content-Type":"application/json"}}async getQuote(e){if(!this.apiKey)throw new Error("OANDA API key not configured");const t=`${this.baseUrl}/v3/accounts/${this.accountId}/pricing?instruments=${e}`,n=await fetch(t,{headers:this.getHeaders()});if(!n.ok)throw new Error(`OANDA API error: ${n.statusText}`);const a=(await n.json()).prices[0];if(!a)throw new Error("No pricing data available");return{instrument:a.instrument,bid:parseFloat(a.bids[0].price),ask:parseFloat(a.asks[0].price),spread:parseFloat(a.asks[0].price)-parseFloat(a.bids[0].price),timestamp:new Date(a.time).getTime()}}async getCandles(e,t="M5",n=500){if(!this.apiKey)throw new Error("OANDA API key not configured");const s=`${this.baseUrl}/v3/instruments/${e}/candles?granularity=${t}&count=${n}`,a=await fetch(s,{headers:this.getHeaders()});if(!a.ok)throw new Error(`OANDA API error: ${a.statusText}`);return(await a.json()).candles.map(o=>({x:new Date(o.time).getTime(),y:[parseFloat(o.mid.o),parseFloat(o.mid.h),parseFloat(o.mid.l),parseFloat(o.mid.c)]}))}async getAccountInfo(){if(!this.apiKey||!this.accountId)throw new Error("OANDA credentials not configured");const e=`${this.baseUrl}/v3/accounts/${this.accountId}`,t=await fetch(e,{headers:this.getHeaders()});if(!t.ok)throw new Error(`OANDA API error: ${t.statusText}`);return t.json()}async placeOrder(e,t,n="MARKET",s){throw!this.apiKey||!this.accountId?new Error("OANDA credentials not configured"):new Error("Real trading is disabled. Enable in configuration.")}async getPositions(){if(!this.apiKey||!this.accountId)throw new Error("OANDA credentials not configured");const e=`${this.baseUrl}/v3/accounts/${this.accountId}/positions`,t=await fetch(e,{headers:this.getHeaders()});if(!t.ok)throw new Error(`OANDA API error: ${t.statusText}`);return t.json()}}class If{constructor(){w(this,"oanda");this.oanda=new vf}async getQuote(e){return this.oanda.getQuote(e)}async getCandles(e,t="5m"){let n="M5";switch(t){case"1m":n="M1";break;case"5m":n="M5";break;case"15m":n="M15";break;case"30m":n="M30";break;case"1h":n="H1";break;case"4h":n="H4";break;case"1d":n="D";break}return this.oanda.getCandles(e,n)}async getAccountInfo(){return this.oanda.getAccountInfo()}async placeBuyOrder(e,t,n){return this.oanda.placeOrder(e,Math.abs(t),n?"LIMIT":"MARKET",n)}async placeSellOrder(e,t,n){return this.oanda.placeOrder(e,-Math.abs(t),n?"LIMIT":"MARKET",n)}async getPositions(){return this.oanda.getPositions()}isConfigured(){return!!ce.oanda.accountId}getConfiguration(){return{hasCredentials:this.isConfigured(),environment:ce.oanda.environment,tradingEnabled:ce.trading.enableRealTrading}}}const wt=new If;class Cf{constructor(){w(this,"userId",null);w(this,"tradingEnabled",!0)}async initialize(e){this.userId=e,this.tradingEnabled=!0}async saveCredentials(e,t,n,s=!1){if(!this.userId)throw new Error("User not initialized");const{error:a}=await te.from("exchange_credentials").upsert({user_id:this.userId,exchange:e,api_key:t,api_secret:n,testnet,updated_at:new Date().toISOString()},{onConflict:"user_id,exchange"});if(a)throw a}async getCredentials(e){if(!this.userId)throw new Error("User not initialized");const{data:t,error:n}=await te.from("exchange_credentials").select("*").eq("user_id",this.userId).eq("exchange",e).maybeSingle();if(n)throw n;return t}async executeCryptoOrder(e,t,n,s,a,i){throw this.userId?new Error("Real trading is disabled. Enable in configuration."):new Error("User not initialized")}async executeForexOrder(e,t,n,s){throw this.userId?new Error("Real trading is disabled. Enable in configuration."):new Error("User not initialized")}async executeOrder(e,t,n,s,a,i){return e.toLowerCase()==="oanda"||t.includes("_")?this.executeForexOrder(t,n,a,i):this.executeCryptoOrder(e,t,n,s,a,i)}async getOrders(e){if(!this.userId)throw new Error("User not initialized");let t=te.from("orders").select("*").eq("user_id",this.userId);e!=null&&e.exchange&&(t=t.eq("exchange",e.exchange)),e!=null&&e.symbol&&(t=t.eq("symbol",e.symbol)),e!=null&&e.status&&(t=t.eq("status",e.status));const{data:n,error:s}=await t.order("created_at",{ascending:!1});if(s)throw s;return(n||[]).map(a=>({id:a.id,userId:a.user_id,exchange:a.exchange,symbol:a.symbol,side:a.side,type:a.type,price:a.price,amount:a.amount,filled:a.filled,status:a.status,timestamp:new Date(a.created_at),externalOrderId:a.external_order_id}))}async cancelOrder(e){if(!this.userId)throw new Error("User not initialized");const{error:t}=await te.from("orders").update({status:"cancelled"}).eq("id",e).eq("user_id",this.userId);return!t}async getRealBalance(e){if(!this.userId)throw new Error("User not initialized");try{switch(e.toLowerCase()){case"binance":if(!yt.isConfigured())throw new Error("Binance API credentials not configured");const t=await yt.getAccountInfo(),n={};return t.balances.forEach(a=>{const i=parseFloat(a.free),o=parseFloat(a.locked);(i>0||o>0)&&(n[a.asset]={free:i,locked:o})}),n;case"oanda":if(!wt.isConfigured())throw new Error("OANDA credentials not configured");const s=await wt.getAccountInfo();return{USD:{free:parseFloat(s.account.balance),locked:parseFloat(s.account.marginUsed||"0")}};default:throw new Error(`Exchange ${e} not supported for real balance fetching`)}}catch(t){throw console.error(`Failed to fetch real balance from ${e}:`,t),t}}async getBalance(e){if(!this.userId)throw new Error("User not initialized");try{const t=await this.getRealBalance(e),n={};return Object.entries(t).forEach(([s,a])=>{n[s]=a.free+a.locked}),n}catch{const{data:n,error:s}=await te.from("balances").select("*").eq("user_id",this.userId).eq("exchange",e);if(s)throw s;const a={};return(n||[]).forEach(i=>{a[i.asset]=i.amount}),a}}async syncBalances(e){if(!this.userId)throw new Error("User not initialized");try{const t=await this.getRealBalance(e);for(const[n,s]of Object.entries(t)){const a=s.free+s.locked;await te.from("balances").upsert({user_id:this.userId,exchange:e,asset:n,amount:a,free:s.free,locked:s.locked,updated_at:new Date().toISOString()},{onConflict:"user_id,exchange,asset"})}}catch(t){throw console.error(`Failed to sync balances for ${e}:`,t),t}}async getAccountSummary(){if(!this.userId)throw new Error("User not initialized");const e=[];let t=0;yt.isConfigured()&&e.push("Binance"),wt.isConfigured()&&e.push("OANDA"),gr.isConfigured()&&e.push("Stocks");const{data:n}=await te.from("orders").select("id").eq("user_id",this.userId).in("status",["pending","partial"]),s=(n==null?void 0:n.length)||0;return{exchanges:e,totalValue:t,activeOrders:s,tradingEnabled:ce.trading.enableRealTrading}}async getAvailableAssets(e){switch(e){case"crypto":return yt.defaultPairs;case"forex":return[...wt.constructor.prototype.MAJOR_FOREX_PAIRS||[]];case"stocks":return gr.constructor.prototype.POPULAR_STOCKS||[];default:return[]}}isRealTradingEnabled(){return ce.trading.enableRealTrading}getConfiguredExchanges(){return[{exchange:"Binance",assetType:"crypto",configured:yt.isConfigured()},{exchange:"OANDA",assetType:"forex",configured:wt.isConfigured()},{exchange:"Stocks",assetType:"stocks",configured:gr.isConfigured()}]}}const Hr=new Cf;class Bt{constructor(e){w(this,"config");w(this,"sandboxMode",!1);this.config=e,console.warn("CCXT cannot run in browser environment. Please implement a backend service to proxy exchange API calls. See documentation: https://docs.ccxt.com/en/latest/manual.html#proxy")}setSandboxMode(e){this.sandboxMode=e}throwNotImplemented(e){throw new Error(`${e} is not available in browser mode. Implement a backend service to handle exchange operations.`)}async fetchBalance(){this.throwNotImplemented("fetchBalance")}async createOrder(e,t,n,s,a){this.throwNotImplemented("createOrder")}async cancelOrder(e,t){this.throwNotImplemented("cancelOrder")}async fetchOrders(e){this.throwNotImplemented("fetchOrders")}async fetchOpenOrders(e){this.throwNotImplemented("fetchOpenOrders")}async fetchTicker(e){this.throwNotImplemented("fetchTicker")}async fetchOHLCV(e,t,n,s){this.throwNotImplemented("fetchOHLCV")}async withdraw(e,t,n,s){this.throwNotImplemented("withdraw")}async fetchDeposits(e){this.throwNotImplemented("fetchDeposits")}async fetchWithdrawals(e){this.throwNotImplemented("fetchWithdrawals")}async fetchDepositAddress(e){this.throwNotImplemented("fetchDepositAddress")}}const kf={binance:Bt,coinbasepro:Bt,okx:Bt,kucoin:Bt,kraken:Bt,bybit:Bt,bitfinex:Bt},Pf={BINANCE:{id:"BINANCE",name:"Binance",type:"crypto",ccxtId:"binance",requiresCredentials:!0,isActive:!0,supportedFeatures:{spot:!0,margin:!0,futures:!0,options:!0,swap:!0}},COINBASE:{id:"COINBASE",name:"Coinbase Pro",type:"crypto",ccxtId:"coinbasepro",requiresCredentials:!0,supportedFeatures:{spot:!0,margin:!1,futures:!1,options:!1,swap:!1}},OKX:{id:"OKX",name:"OKX",type:"crypto",ccxtId:"okx",requiresCredentials:!0,supportedFeatures:{spot:!0,margin:!0,futures:!0,options:!0,swap:!0}},KUCOIN:{id:"KUCOIN",name:"KuCoin",type:"crypto",ccxtId:"kucoin",requiresCredentials:!0,supportedFeatures:{spot:!0,margin:!0,futures:!0,options:!1,swap:!1}},KRAKEN:{id:"KRAKEN",name:"Kraken",type:"crypto",ccxtId:"kraken",requiresCredentials:!0,supportedFeatures:{spot:!0,margin:!0,futures:!0,options:!1,swap:!1}},BYBIT:{id:"BYBIT",name:"Bybit",type:"crypto",ccxtId:"bybit",requiresCredentials:!0,supportedFeatures:{spot:!0,margin:!1,futures:!0,options:!0,swap:!0}},BITFINEX:{id:"BITFINEX",name:"Bitfinex",type:"crypto",ccxtId:"bitfinex",requiresCredentials:!0,supportedFeatures:{spot:!0,margin:!0,futures:!1,options:!1,swap:!1}},NASDAQ:{id:"NASDAQ",name:"NASDAQ",type:"stock",requiresCredentials:!0,supportedFeatures:{spot:!0,margin:!0,futures:!1,options:!0,swap:!1}},NYSE:{id:"NYSE",name:"New York Stock Exchange",type:"stock",requiresCredentials:!0,supportedFeatures:{spot:!0,margin:!0,futures:!1,options:!0,swap:!1}},FOREX:{id:"FOREX",name:"Forex Market",type:"forex",requiresCredentials:!0,supportedFeatures:{spot:!0,margin:!0,futures:!1,options:!1,swap:!0}},CME:{id:"CME",name:"Chicago Mercantile Exchange",type:"commodity",requiresCredentials:!0,supportedFeatures:{spot:!1,margin:!1,futures:!0,options:!0,swap:!1}}};class Tf{constructor(){w(this,"exchanges",new Map)}createExchange(e,t,n,s=!0){const a=Pf[e];if(!a||!a.ccxtId)throw new Error(`Exchange ${e} not supported for real trading`);const i=kf[a.ccxtId];if(!i)throw new Error(`CCXT exchange ${a.ccxtId} not found`);const o=new i({apiKey:t,secret:n,enableRateLimit:!0,options:{defaultType:"spot",adjustForTimeDifference:!0}});return s&&o.setSandboxMode(!0),this.exchanges.set(e,o),o}getExchange(e){return this.exchanges.get(e)}async fetchBalance(e){const t=this.getExchange(e);if(!t)throw new Error(`Exchange ${e} not connected`);return await t.fetchBalance()}async createOrder(e,t,n,s,a,i){const o=this.getExchange(e);if(!o)throw new Error(`Exchange ${e} not connected`);return await o.createOrder(t,n,s,a,i)}async cancelOrder(e,t,n){const s=this.getExchange(e);if(!s)throw new Error(`Exchange ${e} not connected`);return await s.cancelOrder(t,n)}async fetchOrders(e,t){const n=this.getExchange(e);if(!n)throw new Error(`Exchange ${e} not connected`);return await n.fetchOrders(t)}async fetchOpenOrders(e,t){const n=this.getExchange(e);if(!n)throw new Error(`Exchange ${e} not connected`);return await n.fetchOpenOrders(t)}async fetchTicker(e,t){const n=this.getExchange(e);if(!n)throw new Error(`Exchange ${e} not connected`);return await n.fetchTicker(t)}async fetchOHLCV(e,t,n,s=100){const a=this.getExchange(e);if(!a)throw new Error(`Exchange ${e} not connected`);return await a.fetchOHLCV(t,n,void 0,s)}async withdraw(e,t,n,s,a){const i=this.getExchange(e);if(!i)throw new Error(`Exchange ${e} not connected`);return await i.withdraw(t,n,s,a)}async fetchDeposits(e,t){const n=this.getExchange(e);if(!n)throw new Error(`Exchange ${e} not connected`);return await n.fetchDeposits(t)}async fetchWithdrawals(e,t){const n=this.getExchange(e);if(!n)throw new Error(`Exchange ${e} not connected`);return await n.fetchWithdrawals(t)}async fetchDepositAddress(e,t){const n=this.getExchange(e);if(!n)throw new Error(`Exchange ${e} not connected`);return await n.fetchDepositAddress(t)}disconnectExchange(e){this.exchanges.delete(e)}disconnectAll(){this.exchanges.clear()}}const Kr=new Tf,Sf=()=>{const[r,e]=T.useState([]),[t,n]=T.useState([]),[s,a]=T.useState([]),[i,o]=T.useState({}),[l,d]=T.useState(!1),[f,u]=T.useState(!1);T.useEffect(()=>{(async()=>{const{data:{session:E}}=await te.auth.getSession();E!=null&&E.user&&(await Hr.initialize(E.user.id),u(!0),await y(),await x())})()},[]);const h=T.useCallback(async(I,E,C,O=!0)=>{try{await Hr.saveCredentials(I,E,C,O),Kr.createExchange(I,E,C,O),W.success(`Connected to ${I}`),await x()}catch(k){console.error("Failed to connect exchange:",k),W.error(`Failed to connect to ${I}: ${k.message}`)}},[]),g=T.useCallback(I=>{Kr.disconnectExchange(I),W.success(`Disconnected from ${I}`)},[]),x=T.useCallback(async()=>{if(f)try{const{data:I}=await te.from("exchange_credentials").select("exchange");if(!I)return;const E={};for(const C of I)try{const O=await Kr.fetchBalance(C.exchange);E[C.exchange]=O.free||{}}catch(O){console.error(`Failed to fetch balance for ${C.exchange}:`,O)}o(E)}catch(I){console.error("Failed to refresh balances:",I)}},[f]),p=T.useCallback(async(I,E,C,O,k,D)=>{if(!f)return W.error("Trading engine not initialized"),null;d(!0);try{const M=await Kr.createOrder(I,E,O,C,k,D),j=await Hr.executeOrder(I,E,C,O,k,D||M.price);return e(J=>[j,...J]),W.success(`Order executed: ${C.toUpperCase()} ${k} ${E} @ $${(D||M.price).toFixed(2)}`),await x(),await y(),j}catch(M){return console.error("Order execution error:",M),W.error(`Failed to execute order: ${M.message}`),null}finally{d(!1)}},[f]),m=T.useCallback(async(I,E,C)=>{try{await Kr.cancelOrder(I,E,C),await Hr.cancelOrder(E),e(O=>O.map(k=>k.id===E?{...k,status:"cancelled"}:k)),W.success("Order cancelled"),await y()}catch(O){console.error("Failed to cancel order:",O),W.error(`Failed to cancel order: ${O.message}`)}},[]),y=T.useCallback(async()=>{if(f)try{const I=await Hr.getOrders();e(I)}catch(I){console.error("Failed to refresh orders:",I)}},[f]),A=T.useCallback((I,E="USDT")=>{var C;return((C=i[I])==null?void 0:C[E])||0},[i]),N=T.useCallback((I="USDT")=>{let E=0;return Object.values(i).forEach(C=>{E+=C[I]||0}),E},[i]);return{orders:r,positions:t,trades:s,balances:i,isExecuting:l,isInitialized:f,connectExchange:h,disconnectExchange:g,executeOrder:p,cancelOrder:m,refreshOrders:y,refreshBalances:x,getBalance:A,getTotalBalance:N}},Of=({exchange:r,symbol:e,currentPrice:t})=>{const{executeOrder:n,isExecuting:s,getBalance:a}=Sf(),[i,o]=T.useState("market"),[l,d]=T.useState("buy"),[f,u]=T.useState(""),[h,g]=T.useState(t.toString()),[x,p]=T.useState(!1),[m,y]=T.useState("25"),A=a(r,"USDT"),N=()=>{if(x){const E=parseFloat(m)/100;return A*E/(i==="market"?t:parseFloat(h))}return parseFloat(f)},I=async()=>{const E=N();if(isNaN(E)||E<=0){W.error("Invalid amount");return}const C=i==="market"?void 0:parseFloat(h);if(i!=="market"&&(!C||isNaN(C))){W.error("Invalid price");return}const O=E*(C||t);if(l==="buy"&&O>A){W.error(`Insufficient balance. Required: ${O.toFixed(2)} USDT, Available: ${A.toFixed(2)} USDT`);return}try{await n(r,e,l,i,E,C),W.success(`${l.toUpperCase()} order executed successfully`),u(""),y("25")}catch(k){W.error(`Order execution failed: ${k instanceof Error?k.message:"Unknown error"}`)}};return c.jsxs(nc,{className:"p-4 bg-gradient-to-br from-background to-primary/5 border-primary/20",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(qr,{className:"w-5 h-5 text-primary"}),c.jsx("h3",{className:"text-lg font-bold",children:"Place Order"})]}),c.jsxs(Xr,{variant:"outline",className:"text-xs",children:[c.jsx(Fn,{className:"w-3 h-3 mr-1"}),A.toFixed(2)," USDT"]})]}),c.jsx(ui,{value:i,onValueChange:E=>o(E),className:"mb-4",children:c.jsxs(hi,{className:"grid w-full grid-cols-3",children:[c.jsx(Zr,{value:"market",children:"Market"}),c.jsx(Zr,{value:"limit",children:"Limit"}),c.jsx(Zr,{value:"stop",children:"Stop"})]})}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[c.jsxs(ee,{variant:l==="buy"?"default":"outline",onClick:()=>d("buy"),className:l==="buy"?"bg-success hover:bg-success/90":"",children:[c.jsx(_e,{className:"w-4 h-4 mr-1"}),"Buy"]}),c.jsxs(ee,{variant:l==="sell"?"default":"outline",onClick:()=>d("sell"),className:l==="sell"?"bg-destructive hover:bg-destructive/90":"",children:[c.jsx(Yt,{className:"w-4 h-4 mr-1"}),"Sell"]})]}),i!=="market"&&c.jsxs("div",{className:"space-y-2",children:[c.jsx(gn,{htmlFor:"price",className:"text-xs",children:"Price (USDT)"}),c.jsx(Pn,{id:"price",type:"number",step:"0.01",value:h,onChange:E=>g(E.target.value),className:"h-9 text-sm"})]}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx(gn,{htmlFor:"usePercentage",className:"text-xs",children:"Use % of Balance"}),c.jsx(Cc,{id:"usePercentage",checked:x,onCheckedChange:p})]}),x?c.jsxs("div",{className:"space-y-2",children:[c.jsx(gn,{htmlFor:"percentage",className:"text-xs",children:"Percentage (%)"}),c.jsx(Pn,{id:"percentage",type:"number",min:"1",max:"100",value:m,onChange:E=>y(E.target.value),className:"h-9 text-sm"}),c.jsx("div",{className:"flex gap-2",children:["25","50","75","100"].map(E=>c.jsxs(ee,{variant:"outline",size:"sm",onClick:()=>y(E),className:"flex-1 h-7 text-xs",children:[E,"%"]},E))})]}):c.jsxs("div",{className:"space-y-2",children:[c.jsxs(gn,{htmlFor:"amount",className:"text-xs",children:["Amount (",e.replace("USDT",""),")"]}),c.jsx(Pn,{id:"amount",type:"number",step:"0.00001",value:f,onChange:E=>u(E.target.value),placeholder:"0.00",className:"h-9 text-sm"})]}),c.jsxs("div",{className:"p-3 bg-muted/50 rounded-lg space-y-1 text-xs",children:[c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{className:"text-muted-foreground",children:"Order Type:"}),c.jsx("span",{className:"font-semibold uppercase",children:i})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{className:"text-muted-foreground",children:"Est. Cost:"}),c.jsxs("span",{className:"font-semibold",children:[(N()*(i==="market"?t:parseFloat(h)||0)).toFixed(2)," USDT"]})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{className:"text-muted-foreground",children:"Fee (0.1%):"}),c.jsxs("span",{className:"font-semibold",children:[(N()*(i==="market"?t:parseFloat(h)||0)*.001).toFixed(2)," USDT"]})]})]}),c.jsx(ee,{onClick:I,disabled:s,className:`w-full ${l==="buy"?"bg-success hover:bg-success/90":"bg-destructive hover:bg-destructive/90"}`,children:s?"Executing...":c.jsxs(c.Fragment,{children:[c.jsx(en,{className:"w-4 h-4 mr-1"}),l==="buy"?"Buy":"Sell"," ",e]})}),c.jsxs("div",{className:"text-xs text-muted-foreground text-center",children:[c.jsx(mc,{className:"w-3 h-3 inline mr-1"}),"Real trades executed on ",r]})]})]})},Bf=()=>{const[r,e]=T.useState([{id:"1",symbol:"BTCUSDT",condition:"above",price:7e4,active:!0},{id:"2",symbol:"ETHUSDT",condition:"below",price:3e3,active:!0}]),[t,n]=T.useState("BTCUSDT"),[s,a]=T.useState("above"),[i,o]=T.useState(""),l=()=>{if(!i||parseFloat(i)<=0){W.error("Please enter a valid price");return}const f={id:Date.now().toString(),symbol:t,condition:s,price:parseFloat(i),active:!0};e([f,...r]),o(""),W.success("Alert created!")},d=f=>{e(r.filter(u=>u.id!==f)),W.info("Alert deleted")};return c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(gs,{className:"w-4 h-4 text-chart-4"}),c.jsx("h3",{className:"text-sm font-semibold text-foreground uppercase tracking-wide",children:"Price Alerts"})]}),c.jsxs("div",{className:"space-y-2 p-3 rounded-lg bg-muted/20 border border-border",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[c.jsxs(Qr,{value:t,onValueChange:n,children:[c.jsx($r,{className:"h-9",children:c.jsx(Jr,{})}),c.jsxs(Wr,{children:[c.jsx(Ze,{value:"BTCUSDT",children:"BTC"}),c.jsx(Ze,{value:"ETHUSDT",children:"ETH"}),c.jsx(Ze,{value:"BNBUSDT",children:"BNB"}),c.jsx(Ze,{value:"SOLUSDT",children:"SOL"})]})]}),c.jsxs(Qr,{value:s,onValueChange:f=>a(f),children:[c.jsx($r,{className:"h-9",children:c.jsx(Jr,{})}),c.jsxs(Wr,{children:[c.jsx(Ze,{value:"above",children:"Above"}),c.jsx(Ze,{value:"below",children:"Below"})]})]})]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx(Pn,{type:"number",placeholder:"Price...",value:i,onChange:f=>o(f.target.value),className:"h-9"}),c.jsxs(ee,{onClick:l,size:"sm",className:"gap-1",children:[c.jsx(yc,{className:"w-3 h-3"}),"Add"]})]})]}),c.jsx("div",{className:"space-y-2",children:r.length===0?c.jsx("div",{className:"text-sm text-muted-foreground text-center py-4",children:"No alerts set"}):r.map(f=>c.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-muted/30 border border-border hover:border-primary/30 transition-colors group",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[f.condition==="above"?c.jsx(_e,{className:"w-4 h-4 text-success"}):c.jsx(Yt,{className:"w-4 h-4 text-destructive"}),c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-medium text-foreground",children:f.symbol.replace("USDT","")}),c.jsxs("div",{className:"text-xs text-muted-foreground",children:[f.condition," $",f.price.toLocaleString()]})]})]}),c.jsx(ee,{variant:"ghost",size:"sm",onClick:()=>d(f.id),className:"h-7 w-7 p-0 opacity-0 group-hover:opacity-100 transition-opacity",children:c.jsx(wc,{className:"w-3 h-3 text-destructive"})})]},f.id))})]})},Rf=()=>{const[r]=T.useState([{price:7e4,volume:125e4,type:"resistance",strength:"strong"},{price:68500,volume:85e4,type:"resistance",strength:"medium"},{price:66e3,volume:21e5,type:"support",strength:"strong"},{price:64500,volume:65e4,type:"support",strength:"weak"},{price:62e3,volume:18e5,type:"support",strength:"strong"}]),e=n=>{switch(n){case"strong":return"bg-primary/30 border-primary/50";case"medium":return"bg-chart-2/30 border-chart-2/50";case"weak":return"bg-muted/30 border-muted-foreground/30";default:return"bg-muted/30 border-border"}},t=n=>{switch(n){case"strong":return"w-full";case"medium":return"w-2/3";case"weak":return"w-1/3";default:return"w-1/2"}};return c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Ac,{className:"w-4 h-4 text-chart-4"}),c.jsx("h3",{className:"text-sm font-semibold text-foreground uppercase tracking-wide",children:"Liquidity Zones"})]}),c.jsxs("div",{className:"flex items-center justify-between text-xs",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"w-2 h-2 rounded-full bg-success"}),c.jsx("span",{className:"text-muted-foreground",children:"Support"})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"w-2 h-2 rounded-full bg-destructive"}),c.jsx("span",{className:"text-muted-foreground",children:"Resistance"})]})]}),c.jsx("div",{className:"space-y-2",children:r.map((n,s)=>c.jsxs("div",{className:`p-3 rounded-lg border transition-all hover:scale-[1.02] ${e(n.strength)}`,children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[n.type==="support"?c.jsx(_e,{className:"w-3 h-3 text-success"}):c.jsx(Yt,{className:"w-3 h-3 text-destructive"}),c.jsxs("span",{className:"text-sm font-bold text-foreground",children:["$",n.price.toLocaleString()]})]}),c.jsx("span",{className:`text-[10px] px-2 py-0.5 rounded uppercase font-medium ${n.type==="support"?"bg-success/20 text-success":"bg-destructive/20 text-destructive"}`,children:n.type})]}),c.jsxs("div",{className:"space-y-1",children:[c.jsxs("div",{className:"flex items-center justify-between text-xs",children:[c.jsx("span",{className:"text-muted-foreground",children:"Volume"}),c.jsxs("span",{className:"text-foreground font-medium",children:["$",(n.volume/1e6).toFixed(2),"M"]})]}),c.jsxs("div",{className:"space-y-1",children:[c.jsxs("div",{className:"flex items-center justify-between text-[10px]",children:[c.jsx("span",{className:"text-muted-foreground",children:"Strength"}),c.jsx("span",{className:"text-foreground capitalize",children:n.strength})]}),c.jsx("div",{className:"h-1.5 w-full bg-muted/50 rounded-full overflow-hidden",children:c.jsx("div",{className:`h-full bg-gradient-to-r ${n.type==="support"?"from-success to-success/50":"from-destructive to-destructive/50"} ${t(n.strength)} transition-all`})})]})]})]},s))}),c.jsx("div",{className:"p-3 rounded-lg bg-muted/20 border border-border text-xs text-muted-foreground",children:"💡 Zones are calculated based on volume profile and historical price action"})]})},Uf=()=>{const[r]=T.useState([{key:"B",description:"Quick Buy Order",category:"trading"},{key:"S",description:"Quick Sell Order",category:"trading"},{key:"Esc",description:"Cancel All Orders",category:"trading"},{key:"Space",description:"Toggle Chart Type",category:"chart"},{key:"1-7",description:"Switch Timeframes",category:"chart"},{key:"I",description:"Toggle Indicators",category:"chart"},{key:"H",description:"Toggle Heatmap",category:"navigation"},{key:"P",description:"Open Portfolio",category:"navigation"},{key:"W",description:"Open Watchlist",category:"navigation"},{key:"T",description:"Toggle Terminal",category:"navigation"},{key:"/",description:"Search Symbols",category:"navigation"},{key:"F",description:"Fullscreen Chart",category:"chart"}]),e=n=>{switch(n){case"trading":return"text-success";case"chart":return"text-chart-4";case"navigation":return"text-primary";default:return"text-muted-foreground"}},t=Array.from(new Set(r.map(n=>n.category)));return c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Ec,{className:"w-4 h-4 text-chart-4"}),c.jsx("h3",{className:"text-sm font-semibold text-foreground uppercase tracking-wide",children:"Keyboard Shortcuts"})]}),c.jsx(en,{className:"w-4 h-4 text-chart-4 animate-pulse"})]}),t.map(n=>c.jsxs("div",{className:"space-y-2",children:[c.jsx("div",{className:`text-xs font-semibold uppercase tracking-wide ${e(n)}`,children:n}),c.jsx("div",{className:"space-y-1",children:r.filter(s=>s.category===n).map((s,a)=>c.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg bg-muted/30 border border-border hover:border-primary/30 transition-colors",children:[c.jsx("span",{className:"text-xs text-muted-foreground",children:s.description}),c.jsx("kbd",{className:"px-2 py-1 text-xs font-semibold text-foreground bg-background border border-border rounded",children:s.key})]},a))})]},n)),c.jsxs(ee,{variant:"outline",size:"sm",className:"w-full gap-2",children:[c.jsx(Nc,{className:"w-3 h-3"}),"Customize Hotkeys"]})]})},Ff=T.lazy(()=>nr(()=>import("./PortfolioTracker.1762535000437.CJH3Vvp2.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9])).then(r=>({default:r.PortfolioTracker}))),Df=T.lazy(()=>nr(()=>import("./AutoTradingSignals.1762535000437.BhYq4dUW.js"),__vite__mapDeps([10,1,2,3,4,5,7,8])).then(r=>({default:r.AutoTradingSignals}))),Lf=T.lazy(()=>nr(()=>import("./SocialTrading.1762535000437.1MWJWSky.js"),__vite__mapDeps([11,1,2,3,4,5])).then(r=>({default:r.SocialTrading}))),jf=T.lazy(()=>nr(()=>import("./MarketScanner.1762535000437.ClU16pVo.js"),__vite__mapDeps([12,1,2,3,4,5])).then(r=>({default:r.MarketScanner}))),Mf=T.lazy(()=>nr(()=>import("./MarketSentiment.1762535000437.DlFAJ5OK.js"),__vite__mapDeps([13,1,2,6,3,4,5])).then(r=>({default:r.MarketSentiment}))),Gf=T.lazy(()=>nr(()=>import("./EconomicCalendar.1762535000437.B_H-ztPa.js"),__vite__mapDeps([14,1,2,3,4,5])).then(r=>({default:r.EconomicCalendar}))),_f=T.lazy(()=>nr(()=>import("./TradeJournal.1762535000437.BkeoCVHW.js"),__vite__mapDeps([15,1,2,3,4,5])).then(r=>({default:r.TradeJournal}))),ec=T.memo(({symbol:r,exchange:e,currentPrice:t,assetType:n,onSelectSymbol:s})=>c.jsxs("aside",{className:"glass-panel space-y-4 rounded-2xl p-5 shadow-2xl transition-all duration-300 hover:shadow-primary/10 animate-slide-in-right",children:[c.jsxs(ui,{defaultValue:"trading",className:"w-full",children:[c.jsxs(hi,{className:"grid w-full grid-cols-2",children:[c.jsx(Zr,{value:"trading",children:"Trading"}),c.jsx(Zr,{value:"settings",children:"Settings"})]}),c.jsxs(sc,{value:"trading",className:"space-y-4 mt-4",children:[c.jsx(ac,{onSelectSymbol:s,selectedSymbol:r}),c.jsx(Of,{exchange:e,symbol:r,currentPrice:t}),c.jsx(Bc,{}),c.jsx(T.Suspense,{fallback:c.jsx(Ot,{className:"h-48 w-full rounded-lg"}),children:c.jsx(Ff,{})}),c.jsx(Bf,{}),c.jsx(Rc,{}),c.jsx(Rf,{}),c.jsx(Uf,{}),c.jsx(ic,{exchange:e,symbol:r})]})]}),c.jsx(T.Suspense,{fallback:c.jsx(Ot,{className:"h-48 w-full rounded-lg"}),children:c.jsx(Df,{})}),c.jsx(T.Suspense,{fallback:c.jsx(Ot,{className:"h-48 w-full rounded-lg"}),children:c.jsx(Lf,{})}),c.jsx(T.Suspense,{fallback:c.jsx(Ot,{className:"h-48 w-full rounded-lg"}),children:c.jsx(jf,{})}),c.jsx(T.Suspense,{fallback:c.jsx(Ot,{className:"h-48 w-full rounded-lg"}),children:c.jsx(Mf,{})}),c.jsx(T.Suspense,{fallback:c.jsx(Ot,{className:"h-48 w-full rounded-lg"}),children:c.jsx(Gf,{})}),c.jsx(T.Suspense,{fallback:c.jsx(Ot,{className:"h-48 w-full rounded-lg"}),children:c.jsx(_f,{})}),c.jsx(Sc,{})]}));ec.displayName="RightSidebar";const ci={"1m":500,"5m":500,"15m":500,"1h":500,"4h":400,"1d":365,"1w":200},li={"1m":"1m","5m":"5m","15m":"15m","1h":"1h","4h":"4h","1d":"1d","1w":"1w"};function Hf(r,e,t,n="15m"){const[s,a]=T.useState([]),[i,o]=T.useState(0),[l,d]=T.useState([]),[f,u]=T.useState(!1),h=T.useRef(null),g=T.useRef(null),x=T.useCallback(async()=>{try{u(!0);let y=[];if(r==="BINANCE"&&yt.isConfigured()){const A=li[n],N=ci[n];y=await yt.fetchKlines(e,A,N);const I=await yt.fetchTicker(e);I&&I.price!==void 0&&o(Number(I.price))}else if(r==="STOCKS"&&gr.isConfigured()){y=await gr.getCandles(e,n);const A=await gr.getQuote(e);A&&A.price!==void 0&&o(Number(A.price))}else if(r==="FOREX"&&wt.isConfigured()){y=await wt.getCandles(e,n);const A=await wt.getQuote(e);A&&A.bid!==void 0&&A.ask!==void 0&&o((Number(A.bid)+Number(A.ask))/2)}else{const A=fr[r],N=ci[n],I=li[n];let E=A.restKlines(e,N);r==="BINANCE"&&(E=E.replace(/interval=[^&]*/,`interval=${I}`));const C=await fetch(E);if(!C.ok)throw new Error(`HTTP ${C.status}`);const O=await C.json();if(r==="BINANCE"?y=O.map(k=>({x:k[0],y:[parseFloat(k[1]),parseFloat(k[2]),parseFloat(k[3]),parseFloat(k[4])]})):r==="OKX"?y=(O.data||O||[]).map(D=>({x:parseInt(D[0]),y:[parseFloat(D[1]),parseFloat(D[2]),parseFloat(D[3]),parseFloat(D[4])]})):r==="KUCOIN"?y=(O.data||O||[]).map(D=>({x:D[0]>1e12?D[0]:D[0]*1e3,y:[parseFloat(D[1]),parseFloat(D[2]),parseFloat(D[3]),parseFloat(D[4])]})):r==="COINBASE"&&(y=O.map(k=>({x:k[0]*1e3,y:[parseFloat(k[3]),parseFloat(k[2]),parseFloat(k[1]),parseFloat(k[4])]}))),y=y.map(k=>({x:k.x>1e12?k.x:k.x*1e3,y:k.y.map(D=>parseFloat(D.toString()))})),y.length>0){const k=y[y.length-1];k&&k.y&&k.y[3]!==void 0&&o(Number(k.y[3]))}}a(y),W.success(`Loaded ${y.length} candles from real API`)}catch(y){console.error("Failed to fetch candles:",y),W.error("Failed to load chart data")}finally{u(!1)}},[r,e,n]),p=T.useCallback(()=>{h.current&&h.current.close();try{if(r==="BINANCE"){const y=new WebSocket(fr.BINANCE.wsTrade(e));h.current=y,y.onopen=()=>{W.success("WebSocket connected")},y.onmessage=A=>{try{const N=JSON.parse(A.data),I=parseFloat(N.p||N.price),E=parseFloat(N.q||N.qty||0),C=N.T?Math.floor(N.T/1e3):Math.floor(Date.now()/1e3);I&&(o(I),d(O=>[{price:I,volume:E,timestamp:C*1e3,side:"buy"},...O.slice(0,99)]))}catch(N){console.error("WebSocket message error:",N)}},y.onerror=()=>{W.error("WebSocket error")},y.onclose=()=>{h.current=null}}}catch(y){console.error("WebSocket connection error:",y),W.error("Failed to connect WebSocket")}},[r,e]),m=T.useCallback(()=>{x(),g.current&&clearInterval(g.current),g.current=setInterval(()=>{x()},15e3)},[x]);return T.useEffect(()=>(x(),t==="ws"?p():m(),()=>{h.current&&h.current.close(),g.current&&clearInterval(g.current)}),[r,e,t,x,p,m]),{candles:s,lastPrice:i,trades:l,loading:f,refetch:x}}const Kf=T.memo(pi),Vf=T.memo(Uc),zf=T.memo(bi),Qf=T.memo(ec),$f=T.memo(Pc),Jf=()=>{const[r,e]=T.useState(localStorage.getItem("omni_exchange")||"BINANCE"),[t,n]=T.useState(localStorage.getItem("omni_symbol")||cs("BINANCE")[0].toLowerCase()),[s,a]=T.useState(localStorage.getItem("omni_source")||"ws"),[i,o]=T.useState(localStorage.getItem("omni_timeframe")||"15m"),[l,d]=T.useState(null),[f,u]=T.useState([]),[h,g]=T.useState("crypto"),[x,p]=T.useState({showSMA:!0,showEMA:!0,showRSI:!0,showMACD:!1,showBB:!1,showFib:!1,showPatterns:!0,smaPeriod:parseInt(localStorage.getItem("omni_sma")||"20"),emaPeriod:parseInt(localStorage.getItem("omni_ema")||"20"),rsiPeriod:parseInt(localStorage.getItem("omni_rsi")||"14")}),[m,y]=T.useState([]),A=T.useCallback((L,X="info")=>{y(S=>[{message:L,level:X,timestamp:new Date},...S.slice(0,199)])},[]),{candles:N,lastPrice:I,trades:E,refetch:C}=Hf(r,t,s,i),O=T.useMemo(()=>!x.showPatterns||N.length<10?[]:kc(N),[N,x.showPatterns]);T.useEffect(()=>{const L=cs(r).map(X=>X.toLowerCase());u(L),L.includes(t)||n(L[0])},[r]),T.useEffect(()=>{localStorage.setItem("omni_exchange",r),localStorage.setItem("omni_symbol",t),localStorage.setItem("omni_source",s),localStorage.setItem("omni_timeframe",i)},[r,t,s,i]),T.useEffect(()=>{typeof I=="number"&&(A(`Price updated: $${I.toFixed(6)}`,"info"),d(I))},[I]),T.useEffect(()=>{t&&r&&A(`Trading terminal initialized - ${r} / ${t.toUpperCase()}`,"info")},[]);const k=L=>{e(L);const X=cs(L);n(X[0].toLowerCase()),A(`Switched to ${L}`,"info"),W.success(`Switched to ${L}`)},D=L=>{L&&(n(L),A(`Symbol changed to ${L.toUpperCase()}`,"info"))},M=L=>{a(L),A(`Data source changed to ${L.toUpperCase()}`,"info"),W.info(`Using ${L.toUpperCase()} data source`)},j=()=>{C(),A("Manual refresh triggered","info"),W.success("Data refreshed")},J=L=>{p(L),localStorage.setItem("omni_sma",L.smaPeriod.toString()),localStorage.setItem("omni_ema",L.emaPeriod.toString()),localStorage.setItem("omni_rsi",L.rsiPeriod.toString()),A("Indicators updated","info"),W.success("Indicators applied")};return c.jsxs(c.Fragment,{children:[c.jsx(Kf,{}),c.jsxs("div",{className:"relative min-h-screen bg-gradient-to-br from-black via-gray-900 to-black",children:[c.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-cyan-900/20 via-transparent to-transparent"}),c.jsx("div",{className:"absolute inset-0 bg-grid-white/[0.02] bg-[size:50px_50px]"}),c.jsx("div",{className:"relative z-10 pt-20 p-4 animate-fade-in",children:c.jsxs("div",{className:"mx-auto max-w-[2000px] space-y-4",children:[c.jsx("div",{className:"bg-black/40 backdrop-blur-xl border border-cyan-500/20 rounded-2xl p-4 shadow-2xl shadow-cyan-500/10",children:c.jsx(Vf,{exchange:r,symbol:t,source:s,symbols:f,onExchangeChange:k,onSymbolChange:D,onSourceChange:M,onRefresh:j})}),c.jsxs("div",{className:"grid grid-cols-1 gap-4 xl:grid-cols-[320px_1fr_320px] lg:grid-cols-[280px_1fr_280px]",children:[c.jsx("div",{className:"bg-black/40 backdrop-blur-xl border border-cyan-500/20 rounded-2xl shadow-2xl shadow-cyan-500/10 overflow-hidden",children:c.jsx(zf,{symbols:f,activeSymbol:t,timeframe:i,indicatorSettings:x,detectedPatterns:O,candles:N,lastPrice:I,logs:m,onSymbolClick:D,onTimeframeChange:o,onApplyIndicators:J})}),c.jsx("div",{className:"bg-black/40 backdrop-blur-xl border border-cyan-500/20 rounded-2xl shadow-2xl shadow-cyan-500/10 overflow-hidden",children:c.jsx($f,{symbol:t,exchange:r,source:s,candles:N,trades:E,lastPrice:I,previousPrice:l,indicatorSettings:x})}),c.jsx("div",{className:"bg-black/40 backdrop-blur-xl border border-cyan-500/20 rounded-2xl shadow-2xl shadow-cyan-500/10 overflow-hidden",children:c.jsx(Qf,{symbol:t,exchange:r,currentPrice:I,assetType:h,onSelectSymbol:(L,X)=>{n(L.toLowerCase()),g(X)}})})]}),c.jsx("div",{className:"bg-black/40 backdrop-blur-xl border border-cyan-500/20 rounded-2xl p-4 shadow-2xl shadow-cyan-500/10",children:c.jsxs("div",{className:"flex items-center justify-between text-sm",children:[c.jsxs("div",{className:"flex items-center gap-6",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"h-2 w-2 bg-green-500 rounded-full animate-pulse"}),c.jsx("span",{className:"text-cyan-400/80",children:"Live Data"})]}),c.jsxs("div",{className:"text-cyan-400/60",children:["Last Update: ",new Date().toLocaleTimeString()]})]}),c.jsxs("div",{className:"flex items-center gap-4 text-cyan-400/60",children:[c.jsx("span",{children:"Latency: 12ms"}),c.jsx("span",{children:"•"}),c.jsxs("span",{children:["Connected: ",r]})]})]})})]})})]})]})},Mu=Object.freeze(Object.defineProperty({__proto__:null,default:Jf},Symbol.toStringTag,{value:"Module"}));export{Mu as I,Lc as u};
