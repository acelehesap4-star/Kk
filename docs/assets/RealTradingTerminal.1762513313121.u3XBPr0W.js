import{j as e,m as X}from"./vendor-features.1762513313121.CLVBT4pW.js";import{r as a}from"./vendor-core.1762513313121.BARHdY6Y.js";import{e as S,B as p,C as j,g as b,h as u,I as k,f as y,c as d,T as Y,a as G,b as D,u as w}from"./trading-core.1762513313121.CV3UFgjj.js";import{A as J,a2 as Q,v as Z,x as E,H as ee,T as O,d as se,R as te,az as $,aA as M,W as ae,j as re}from"./trading-orders-wrapper.1762513313121.D5ppsxYC.js";import"./vendor-ui.1762513313121.MPt5PFRX.js";const he=({user:B})=>{const[x,z]=a.useState("BTC/USDT"),[i,R]=a.useState("market"),[h,L]=a.useState("buy"),[l,P]=a.useState(""),[m,U]=a.useState(""),[F,N]=a.useState(!1),[f,H]=a.useState(!0),[T,_]=a.useState([{symbol:"BTC/USDT",price:67902.36,change:2.45,volume:"1.2B",high:68500,low:66800,exchange:"Binance"},{symbol:"ETH/USDT",price:3379.01,change:-1.23,volume:"890M",high:3420.5,low:3350,exchange:"Coinbase"},{symbol:"SOL/USDT",price:158.15,change:5.67,volume:"456M",high:162,low:148.5,exchange:"Kraken"},{symbol:"ADA/USDT",price:.534,change:-.89,volume:"234M",high:.548,low:.521,exchange:"OKX"},{symbol:"AAPL",price:189.95,change:1.24,volume:"45M",high:191.2,low:187.8,exchange:"NYSE"},{symbol:"EUR/USD",price:1.0845,change:.15,volume:"2.1B",high:1.0867,low:1.0823,exchange:"OANDA"}]),[A,C]=a.useState([{id:1,symbol:"BTC/USDT",type:"long",size:.5,entry:66500,current:67902.36,pnl:701.18,pnlPercent:2.11},{id:2,symbol:"ETH/USDT",type:"short",size:2,entry:3420,current:3379.01,pnl:81.98,pnlPercent:1.2},{id:3,symbol:"SOL/USDT",type:"long",size:10,entry:145,current:158.15,pnl:131.5,pnlPercent:9.07}]),[I,q]=a.useState([{id:1,symbol:"BTC/USDT",type:"buy",amount:.5,price:66500,status:"filled",time:"10:30:45"},{id:2,symbol:"ETH/USDT",type:"sell",amount:1,price:3420,status:"filled",time:"09:15:22"},{id:3,symbol:"SOL/USDT",type:"buy",amount:10,price:145,status:"filled",time:"08:45:10"}]),[le,V]=a.useState({});a.useEffect(()=>{(async()=>{try{N(!0);const{data:r,error:c}=await supabase.from("real_balances").select("*").eq("user_id",B.id).eq("exchange",exchange);if(c)throw c;const v=r.reduce((o,n)=>(o[n.asset]=n.total_balance,o),{});V(v)}catch(r){console.error("Error fetching balances:",r),w.error("Bakiye bilgileri alınamadı")}finally{N(!1)}})()},[B.id,exchange]);const t=T.find(s=>s.symbol===x)||T[0],K=async()=>{if(!l||i==="limit"&&!m){w.error("Lütfen tüm alanları doldurun");return}N(!0);try{const s=parseFloat(l),r=i==="limit"?parseFloat(m):void 0,{data:c,error:v}=await supabase.rpc("execute_trade",{market_type:marketType,symbol:x,side:h,order_type:i,quantity:s,price:r,exchange});if(v)throw v;if(w.success("İşlem başarıyla gerçekleştirildi"),fetchBalances(),fetchOrders(),q(o=>[newOrder,...o]),h==="buy"){const o=A.find(n=>n.symbol===x&&n.type==="long");if(o)C(n=>n.map(g=>g.id===o.id?{...g,size:g.size+parseFloat(l)}:g));else{const n={id:Date.now(),symbol:x,type:"long",size:parseFloat(l),entry:newOrder.price,current:t.price,pnl:0,pnlPercent:0};C(g=>[...g,n])}}w.success(`${h.toUpperCase()} order executed successfully!`),P(""),U("")}catch{w.error("Trade execution failed. Please try again.")}finally{N(!1)}},W=s=>{C(r=>r.filter(c=>c.id!==s)),w.success("Position closed successfully!")};return a.useEffect(()=>{const s=setInterval(()=>{_(r=>r.map(c=>({...c,price:c.price*(1+(Math.random()-.5)*.002),change:c.change+(Math.random()-.5)*.1})))},2e3);return()=>clearInterval(s)},[]),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-white mb-2",children:"Trading Terminal"}),e.jsx("p",{className:"text-gray-400",children:"Real-time trading across multiple exchanges"})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs(S,{className:"bg-green-500/20 text-green-400 border-green-500/30",children:[e.jsx(J,{className:"h-3 w-3 mr-1"}),"Live Market Data"]}),e.jsx(p,{variant:"outline",size:"sm",onClick:()=>H(!f),className:"border-white/20 text-white hover:bg-white/10",children:f?e.jsx(Q,{className:"h-4 w-4"}):e.jsx(Z,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-4 gap-6",children:[e.jsx("div",{className:"xl:col-span-1",children:e.jsxs(j,{className:"bg-black/30 border-white/20",children:[e.jsxs(b,{children:[e.jsxs(u,{className:"text-white flex items-center",children:[e.jsx(E,{className:"h-5 w-5 mr-2"}),"Markets"]}),e.jsxs("div",{className:"relative",children:[e.jsx(ee,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(k,{placeholder:"Search markets...",className:"pl-10 bg-white/10 border-white/20 text-white text-sm"})]})]}),e.jsx(y,{className:"p-0",children:e.jsx("div",{className:"space-y-1",children:T.map(s=>e.jsx(X.div,{onClick:()=>z(s.symbol),className:d("p-3 cursor-pointer transition-all duration-200 border-l-2",x===s.symbol?"bg-purple-500/20 border-purple-500":"hover:bg-white/5 border-transparent"),whileHover:{x:2},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-white text-sm",children:s.symbol}),e.jsx("p",{className:"text-xs text-gray-400",children:s.exchange})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-sm font-bold text-white",children:["$",s.price.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:6})]}),e.jsxs("div",{className:d("flex items-center text-xs",s.change>0?"text-green-400":"text-red-400"),children:[s.change>0?e.jsx(O,{className:"h-3 w-3 mr-1"}):e.jsx(se,{className:"h-3 w-3 mr-1"}),Math.abs(s.change).toFixed(2),"%"]})]})]})},s.symbol))})})]})}),e.jsxs("div",{className:"xl:col-span-2 space-y-6",children:[e.jsxs(j,{className:"bg-black/30 border-white/20",children:[e.jsxs(b,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(u,{className:"text-white",children:x}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(S,{className:d("px-2 py-1",t.change>0?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"),children:[t.change>0?"+":"",t.change.toFixed(2),"%"]}),e.jsx(p,{variant:"ghost",size:"sm",className:"text-white hover:bg-white/10",children:e.jsx(te,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"flex items-center space-x-6 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Price: "}),e.jsxs("span",{className:"text-white font-bold",children:["$",t.price.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:6})]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"24h High: "}),e.jsxs("span",{className:"text-green-400",children:["$",t.high.toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"24h Low: "}),e.jsxs("span",{className:"text-red-400",children:["$",t.low.toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Volume: "}),e.jsx("span",{className:"text-white",children:t.volume})]})]})]}),e.jsx(y,{children:e.jsx("div",{className:"h-64 flex items-center justify-center text-gray-400 bg-black/20 rounded-lg",children:e.jsxs("div",{className:"text-center",children:[e.jsx(E,{className:"h-16 w-16 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"Advanced TradingView chart integration"}),e.jsx("p",{className:"text-sm",children:"Real-time candlestick data"})]})})})]}),e.jsxs(j,{className:"bg-black/30 border-white/20",children:[e.jsx(b,{children:e.jsx(u,{className:"text-white",children:"Place Order"})}),e.jsxs(y,{className:"space-y-4",children:[e.jsx(Y,{value:i,onValueChange:R,children:e.jsxs(G,{className:"bg-black/30 border border-white/20 w-full",children:[e.jsx(D,{value:"market",className:"flex-1 data-[state=active]:bg-white/20",children:"Market"}),e.jsx(D,{value:"limit",className:"flex-1 data-[state=active]:bg-white/20",children:"Limit"}),e.jsx(D,{value:"stop",className:"flex-1 data-[state=active]:bg-white/20",children:"Stop"})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs(p,{onClick:()=>L("buy"),className:d("transition-all duration-200",h==="buy"?"bg-green-500 hover:bg-green-600 text-white":"bg-white/10 hover:bg-white/20 text-gray-400"),children:[e.jsx($,{className:"h-4 w-4 mr-2"}),"Buy"]}),e.jsxs(p,{onClick:()=>L("sell"),className:d("transition-all duration-200",h==="sell"?"bg-red-500 hover:bg-red-600 text-white":"bg-white/10 hover:bg-white/20 text-gray-400"),children:[e.jsx(M,{className:"h-4 w-4 mr-2"}),"Sell"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Amount"}),e.jsx(k,{type:"number",value:l,onChange:s=>P(s.target.value),placeholder:"0.00",className:"bg-white/10 border-white/20 text-white"})]}),i==="limit"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Price"}),e.jsx(k,{type:"number",value:m,onChange:s=>U(s.target.value),placeholder:"0.00",className:"bg-white/10 border-white/20 text-white"})]}),e.jsxs("div",{className:"p-3 bg-white/5 rounded-lg border border-white/10",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"Estimated Total:"}),e.jsxs("span",{className:"text-white font-medium",children:["$",l&&(i==="market"?t.price:m||t.price)?(parseFloat(l||"0")*(i==="market"?t.price:parseFloat(m||"0"))).toLocaleString():"0.00"]})]}),e.jsxs("div",{className:"flex justify-between text-sm mt-1",children:[e.jsx("span",{className:"text-gray-400",children:"Trading Fee (0.1%):"}),e.jsxs("span",{className:"text-white",children:["$",l&&(i==="market"?t.price:m||t.price)?(parseFloat(l||"0")*(i==="market"?t.price:parseFloat(m||"0"))*.001).toFixed(2):"0.00"]})]})]}),e.jsx(p,{onClick:K,disabled:F||!l,className:d("w-full font-semibold py-3 transition-all duration-200",h==="buy"?"bg-green-500 hover:bg-green-600 text-white":"bg-red-500 hover:bg-red-600 text-white"),children:F?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),e.jsx("span",{children:"Executing..."})]}):e.jsxs("span",{children:[h==="buy"?"Buy":"Sell"," ",x]})})]})]})]}),e.jsxs("div",{className:"xl:col-span-1 space-y-6",children:[e.jsxs(j,{className:"bg-black/30 border-white/20",children:[e.jsx(b,{children:e.jsxs(u,{className:"text-white flex items-center",children:[e.jsx(ae,{className:"h-5 w-5 mr-2"}),"Balance"]})}),e.jsx(y,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"text-center p-3 bg-gradient-to-r from-purple-500/20 to-cyan-500/20 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Total Balance"}),e.jsx("p",{className:"text-xl font-bold text-white",children:f?`$${balance.total.toLocaleString()}`:"••••••"})]}),Object.entries(balance).filter(([s])=>s!=="total").map(([s,r])=>e.jsxs("div",{className:"flex justify-between items-center p-2 bg-white/5 rounded",children:[e.jsx("span",{className:"text-gray-400 text-sm",children:s}),e.jsx("span",{className:"text-white font-medium",children:f?r.toLocaleString():"••••"})]},s))]})})]}),e.jsxs(j,{className:"bg-black/30 border-white/20",children:[e.jsx(b,{children:e.jsxs(u,{className:"text-white flex items-center",children:[e.jsx(O,{className:"h-5 w-5 mr-2"}),"Positions"]})}),e.jsx(y,{children:e.jsx("div",{className:"space-y-3",children:A.map(s=>e.jsxs("div",{className:"p-3 bg-white/5 rounded-lg border border-white/10",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-white",children:s.symbol}),e.jsxs("p",{className:"text-xs text-gray-400",children:[s.type.toUpperCase()," • ",s.size]})]}),e.jsxs(S,{className:d("px-2 py-1 text-xs",s.pnl>0?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"),children:[s.pnl>0?"+":"","$",s.pnl.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-400 mb-2",children:[e.jsxs("span",{children:["Entry: $",s.entry.toLocaleString()]}),e.jsxs("span",{children:["Current: $",s.current.toLocaleString()]})]}),e.jsx(p,{onClick:()=>W(s.id),size:"sm",variant:"outline",className:"w-full border-white/20 text-white hover:bg-white/10 text-xs",children:"Close Position"})]},s.id))})})]})]})]}),e.jsxs(j,{className:"bg-black/30 border-white/20",children:[e.jsx(b,{children:e.jsx(u,{className:"text-white",children:"Recent Orders"})}),e.jsx(y,{children:e.jsx("div",{className:"space-y-2",children:I.slice(0,5).map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white/5 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:d("w-8 h-8 rounded-full flex items-center justify-center",s.type==="buy"?"bg-green-500/20":"bg-red-500/20"),children:s.type==="buy"?e.jsx($,{className:"h-4 w-4 text-green-400"}):e.jsx(M,{className:"h-4 w-4 text-red-400"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium text-white",children:[s.type.toUpperCase()," ",s.symbol]}),e.jsxs("p",{className:"text-xs text-gray-400",children:[s.amount," @ $",s.price.toLocaleString()]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs(S,{className:"bg-green-500/20 text-green-400 mb-1",children:[e.jsx(re,{className:"h-3 w-3 mr-1"}),s.status]}),e.jsx("p",{className:"text-xs text-gray-400",children:s.time})]})]},s.id))})})]})]})};export{he as default};
